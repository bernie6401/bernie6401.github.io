<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  Uncovering Intent based Leak of Sensitive Data in Android Framework
  #


  tags: Meeting Paper NTU
  #

:::info
Zhou, H., Luo, X., Wang, H., & Cai, H. (2022, November). Uncovering Intent based Leak of Sensitive Data in Android Framework. In Proceedings of the 2022 ACM SIGSAC Conference on Computer and Communications Security (pp. 3239-3252).
:::

  Background
  #

:::spoiler [Android] Activity基本介紹



什麼是Activity?
Activity是App中，提供畫面的一個元件，
例如：使用Google地圖App時，顯示地圖的那個畫面。


只有Activity可以顯示畫面嗎？
不是，除了Activity以外還有其他元件可以顯示畫面，
例如：Dialog，但每一個App至少要有一個Activity，但這有個例外，如果這個App不提供介面的話也是可以不用有Activity的。




Activity其他注意事項

兩個Activity傳遞資訊是透過Intent
Intent intent = new Intent(this, TwoActivity.class);
startActivity(intent);

Intent 能傳遞的資訊大小要小於512k
每一個Activity都要在AndroidManifest中聲明
<manifest ... >
  <application ... >
      <activity android:name=".MainActivity" />
      ...
  </application ... >
  ...
</manifest >


:::'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/survey-papers/android-+-security/uncovering-intent-based-leak-of-sensitive-data-in-android-framework/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Uncovering Intent based Leak of Sensitive Data in Android Framework"><meta property="og:description" content='Uncovering Intent based Leak of Sensitive Data in Android Framework # tags: Meeting Paper NTU # :::info Zhou, H., Luo, X., Wang, H., & Cai, H. (2022, November). Uncovering Intent based Leak of Sensitive Data in Android Framework. In Proceedings of the 2022 ACM SIGSAC Conference on Computer and Communications Security (pp. 3239-3252). :::
Background # :::spoiler [Android] Activity基本介紹
什麼是Activity? Activity是App中，提供畫面的一個元件， 例如：使用Google地圖App時，顯示地圖的那個畫面。
只有Activity可以顯示畫面嗎？ 不是，除了Activity以外還有其他元件可以顯示畫面， 例如：Dialog，但每一個App至少要有一個Activity，但這有個例外，如果這個App不提供介面的話也是可以不用有Activity的。
Activity其他注意事項
兩個Activity傳遞資訊是透過Intent Intent intent = new Intent(this, TwoActivity.class); startActivity(intent); Intent 能傳遞的資訊大小要小於512k 每一個Activity都要在AndroidManifest中聲明 <manifest ... > <application ... > <activity android:name=".MainActivity" /> ... </application ... > ... </manifest > :::'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="survey-papers"><meta property="article:tag" content="Meeting Paper"><meta property="article:tag" content="NTU"><title>Uncovering Intent based Leak of Sensitive Data in Android Framework | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/survey-papers/android-+-security/uncovering-intent-based-leak-of-sensitive-data-in-android-framework/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Uncovering Intent based Leak of Sensitive Data in Android Framework</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a><ul><li><a href=#種類>種類</a></li><li><a href=#範例>範例</a></li><li><a href=#android-framework>Android Framework</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=uncovering-intent-based-leak-of-sensitive-data-in-android-framework>Uncovering Intent based Leak of Sensitive Data in Android Framework
<a class=anchor href=#uncovering-intent-based-leak-of-sensitive-data-in-android-framework>#</a></h1><h6 id=tags-meeting-paper-ntu>tags: <code>Meeting Paper</code> <code>NTU</code>
<a class=anchor href=#tags-meeting-paper-ntu>#</a></h6><p>:::info
Zhou, H., Luo, X., Wang, H., & Cai, H. (2022, November). Uncovering Intent based Leak of Sensitive Data in Android Framework. In Proceedings of the 2022 ACM SIGSAC Conference on Computer and Communications Security (pp. 3239-3252).
:::</p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>:::spoiler <a href=https://ironglion.com/archives/334>[Android] Activity基本介紹</a></p><blockquote><ul><li><p>什麼是Activity?
Activity是App中，提供畫面的一個元件，
例如：使用Google地圖App時，顯示地圖的那個畫面。</p></li><li><p>只有Activity可以顯示畫面嗎？
不是，除了Activity以外還有其他元件可以顯示畫面，
例如：Dialog，但每一個App至少要有一個Activity，但這有個例外，如果這個App不提供介面的話也是可以不用有Activity的。</p></li></ul></blockquote><hr><blockquote><p>Activity其他注意事項</p><ul><li>兩個Activity傳遞資訊是透過Intent<pre tabindex=0><code class=language-kotlin! data-lang=kotlin!>Intent intent = new Intent(this, TwoActivity.class);
startActivity(intent);
</code></pre></li><li>Intent 能傳遞的資訊大小要小於512k</li><li>每一個Activity都要在AndroidManifest中聲明<pre tabindex=0><code class=language-kotlin! data-lang=kotlin!>&lt;manifest ... &gt;
  &lt;application ... &gt;
      &lt;activity android:name=&#34;.MainActivity&#34; /&gt;
      ...
  &lt;/application ... &gt;
  ...
&lt;/manifest &gt;
</code></pre></li></ul></blockquote><p>:::</p><p>:::spoiler <a href=https://ithelp.ithome.com.tw/articles/10231988>Android基本(2)-Intent基本觀念與使用釐清</a></p><blockquote><p>我們該如何從一個 activity 去啟動另外一個 activity，又或者我們要怎麼進行兩個 activity 間的資料通等等的問題，這時候最常見的方式就是使用我們今天的主角 Intent</p><h3 id=種類>種類
<a class=anchor href=#%e7%a8%ae%e9%a1%9e>#</a></h3><p>下方名稱網路上對他們的名稱有些需的差異，在這邊以 android doc 上名稱為主。</p><ol><li>明確意圖(Explicit intents)：官方的說明有點冗長，講白一點就是在指定啟動元件的時候，我們直接使用名稱(完整的類別名稱)進行指定。
例如：
<code>Intent intent = new Intent(FirstActivity.this, SecondActivity.class);</code></li><li>隱含意圖(Implicit intents)：在宣告的時候不指定給特定的元件，而是針對功能、動作進行宣告，來讓定一個應用程式的元件進行處理。
例如：在APP中開啟網頁，系統發現手機上有chrome以及預設瀏覽器提供網頁瀏覽的功能，這時候便會跳出選單讓使用者選擇。</li></ol><h3 id=範例>範例
<a class=anchor href=#%e7%af%84%e4%be%8b>#</a></h3><ul><li><p>明確意圖範例</p><pre tabindex=0><code class=language-kotlin! data-lang=kotlin!>Intent intent = new Intent(FirstActivity.this, SecondActivity.class);
startActivity(intent);
</code></pre><p>這邊我的例子是在兩個 activity 間的互動，service相關使用可以參考 google doc 中的範例。</p></li><li><p>隱含意圖範例</p><pre tabindex=0><code class=language-kotlin! data-lang=kotlin!>Intent intent = new Intent();
intent.setAction(Intent.ACTION_VIEW);
intent.setData(Uri.parse(&#34;https://google.com&#34;));
startActivity(intent);
</code></pre><p>這邊這個例子是開啟網頁的使用，另外在 google doc 中的例子是發送電子郵件，也可以進行參考。
:::</p></li></ul></blockquote><p>:::spoiler What is entity in android?</p><blockquote><p>fields and classes defined in Android framework
:::</p></blockquote><p>:::spoiler What is field in Android?</p><h4 id=documentation><a href=https://developer.android.com/reference/java/lang/reflect/Field>Documentation</a>
<a class=anchor href=#documentation>#</a></h4><blockquote><p>A Field provides information about, and dynamic access to, a single field of a class or an interface. The reflected field may be a class (static) field or an instance field.</p><p>A Field permits widening conversions to occur during a get or set access operation, but throws an IllegalArgumentException if a narrowing conversion would occur.</p></blockquote><hr><h4 id=012-定義類別與建立物件><a href=https://sites.google.com/site/dychen1127/developer-android/classnewobject>012-定義類別與建立物件</a>
<a class=anchor href=#012-%e5%ae%9a%e7%be%a9%e9%a1%9e%e5%88%a5%e8%88%87%e5%bb%ba%e7%ab%8b%e7%89%a9%e4%bb%b6>#</a></h4><blockquote><p>在類別中, 需使用成員變數 (Member Variable) 來描述類別的屬性, 在 Java語言中又稱其為類別的欄位 (Field)。
成員變數的宣告方式, 和前面所用的一般變數差不多, 例如我們的汽車類別要有記錄載油量、耗油率, 可寫成：</p><pre tabindex=0><code class=language-java! data-lang=java!>class Car{
  double gas; //載油量
  double eff; //耗油率
}
</code></pre></blockquote><p>:::</p><p>:::spoiler <a href="https://www.reviversoft.com/file-extensions/dex?ncr=1&amp;lang=en">what is a dex file?</a></p><blockquote><p>Dalvik executable files are developer files affixed with the .dex extension, and these DEX files are used to initialize and execute applications developed for the Android mobile OS. The data stored in these DEX files includes compiled code that locates and initializes other program files of the associated application required to run the program.
:::</p></blockquote><h3 id=android-framework>Android Framework
<a class=anchor href=#android-framework>#</a></h3><p>:::spoiler What is TTY
Reference:
<a href="https://swf.com.tw/?p=622&amp;cpage=1">What is TTY</a>
<a href="https://ithelp.ithome.com.tw/articles/10299117?sc=iThelpR">Day 12深入Docker Container內部(上)</a></p><blockquote><p>TTY的原意是"teletypewriter"（電傳打字機，早期用來操作並和大型電腦連線的終端機）</p></blockquote><hr><blockquote><p>在上古時代，一台電腦是要透過多用戶進行操作的，畢竟當時的電腦很貴，要操作的事情也很繁瑣，而多個用戶自然就需要多台打字機對著電腦進行輸入。</p><p>而 tty 正是英文 Teletypewriter的縮寫，但其實在現代，終端機和打字機的界線已經模糊不清，可以想像，終端機就是 tty，反之亦然
:::</p></blockquote><p>:::spoiler <a href=https://android.googlesource.com/platform/packages/services/Telecomm/+/2750faaa1ec819eed9acffea7bd3daf867fda444/src/com/android/server/telecom/TelecomServiceImpl.java#725>com.android.server.telecom.TelecomServiceImpl</a></p><pre tabindex=0><code class="language-java=725" data-lang="java=725">...
/**
 * @see android.telecom.TelecomManager#getCurrentTtyMode
 */
@Override
public int getCurrentTtyMode(String callingPackage) {
    if (!canReadPhoneState(callingPackage, &#34;getCurrentTtyMode&#34;)) {
        return TelecomManager.TTY_MODE_OFF;
    }
    synchronized (mLock) {
        return mCallsManager.getCurrentTtyMode();
    }
}
...
</code></pre><p>:::</p><p>:::spoiler <a href=https://android.googlesource.com/platform/packages/services/Telecomm/+/2750faaa1ec819eed9acffea7bd3daf867fda444/src/com/android/server/telecom/CallsManager.java#467>com.android.server.telecom.CallsManager</a></p><pre tabindex=0><code class="language-java=467" data-lang="java=467">...
int getCurrentTtyMode() {
    return mTtyManager.getCurrentTtyMode();
}
</code></pre><p>:::</p><p>:::spoiler <a href=https://android.googlesource.com/platform/packages/services/Telecomm/+/2750faaa1ec819eed9acffea7bd3daf867fda444/src/com/android/server/telecom/TtyManager.java#61>com.android.server.telecom.TtyManager</a></p><pre tabindex=0><code class="language-java=61" data-lang="java=61">...
int getCurrentTtyMode() {
    return mCurrentTtyMode;
}
...
</code></pre><p>:::</p><hr><p>:::spoiler <a href=https://shengyu7697.github.io/android-adb/>Android adb基本用法教學</a></p><blockquote><p>adb(Android Debug Bridge)指令是開發 Android 時常用到的工具，使用 adb 指令可對 android 裝置進行除錯、測試、檔案處理、安裝/移除 apk 等的操作
:::</p></blockquote><p>:::spoiler <a href=https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/adb/AdbService.java#367>com.android.server.adb.AdbService</a></p><pre tabindex=0><code class="language-java=367" data-lang="java=367">@Override
public FingerprintAndPairDevice[] getPairedDevices() {
    mContext.enforceCallingOrSelfPermission(android.Manifest.permission.MANAGE_DEBUGGING, null);
    if (mDebuggingManager == null) {
        return null;
    }
    Map&lt;String, PairDevice&gt; map = mDebuggingManager.getPairedDevices();
    FingerprintAndPairDevice[] ret = new FingerprintAndPairDevice[map.size()];
    int i = 0;
    for (Map.Entry&lt;String, PairDevice&gt; entry : map.entrySet()) {
        ret[i] = new FingerprintAndPairDevice();
        ret[i].keyFingerprint = entry.getKey();
        ret[i].device = entry.getValue();
        i++;
    }
    return ret;
}
</code></pre><p>:::</p><p>:::spoiler <a href=https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/adb/AdbDebuggingManager.java#1697>com.android.server.adb.AdbDebuggingManager</a></p><pre tabindex=0><code class="language-java=1697" data-lang="java=1697">/**
 * Returns the list of paired devices.
 */
public Map&lt;String, PairDevice&gt; getPairedDevices() {
    AdbKeyStore keystore = new AdbKeyStore();
    return keystore.getPairedDevices();
}
</code></pre><p>:::</p><p>:::spoiler <a href=https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/adb/AdbDebuggingManager.java#1854>com.android.server.adb.AdbDebuggingManager.AdbKeyStore</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AdbKeyStore</span> {
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Map<span style=color:#f92672>&lt;</span>String, PairDevice<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getPairedDevices</span>() {
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, PairDevice<span style=color:#f92672>&gt;</span> pairedDevices <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;</span>String, PairDevice<span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (Map.<span style=color:#a6e22e>Entry</span><span style=color:#f92672>&lt;</span>String, Long<span style=color:#f92672>&gt;</span> keyEntry : mKeyMap.<span style=color:#a6e22e>entrySet</span>()) {
</span></span><span style=display:flex><span>            String fingerprints <span style=color:#f92672>=</span> getFingerprints(keyEntry.<span style=color:#a6e22e>getKey</span>());
</span></span><span style=display:flex><span>            String hostname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;nouser@nohostname&#34;</span>;
</span></span><span style=display:flex><span>            String<span style=color:#f92672>[]</span> args <span style=color:#f92672>=</span> keyEntry.<span style=color:#a6e22e>getKey</span>().<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#34;\\s+&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (args.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> 1) {
</span></span><span style=display:flex><span>                hostname <span style=color:#f92672>=</span> args<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            PairDevice pairDevice <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PairDevice();
</span></span><span style=display:flex><span>            pairDevice.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> hostname;
</span></span><span style=display:flex><span>            pairDevice.<span style=color:#a6e22e>guid</span> <span style=color:#f92672>=</span> fingerprints;
</span></span><span style=display:flex><span>            pairDevice.<span style=color:#a6e22e>connected</span> <span style=color:#f92672>=</span> mWifiConnectedKeys.<span style=color:#a6e22e>contains</span>(keyEntry.<span style=color:#a6e22e>getKey</span>());
</span></span><span style=display:flex><span>            pairedDevices.<span style=color:#a6e22e>put</span>(keyEntry.<span style=color:#a6e22e>getKey</span>(), pairDevice);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pairedDevices;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><p>:::spoiler <a href=https://www.quora.com/What-is-a-stock-ROM>What is a stock ROM?</a>
stock rom其實就有點像是廠商為特定商品出的ROM而且廠商不會對其有其他更改</p><blockquote><p>Stock ROM: A Stock ROM/Firmware is an official software that is designed by the manufacturer for a particular device. A Truly Stock ROM is one type that does not undergo any cosmetic/functional changes in the code by hardware manufacturer. The &ldquo;stock ROM&rdquo; comes installed on the phone or tablet at the time of buying which is given by the device manufacturer. Stock Rom is one that doesn’t undergo any kind of modifications that is done in a custom Rom.</p></blockquote><blockquote><p>Custom ROM: A “Custom Rom” is a software(OS) that is modified by user either to add, delete or Modify features or behavior which improves look and feel, design, themes, performance of OS for a particular device. Users including me love to install custom rom because they have extra features, better UI or performance compared to “Stock ROM”.
:::</p></blockquote></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a><ul><li><a href=#種類>種類</a></li><li><a href=#範例>範例</a></li><li><a href=#android-framework>Android Framework</a></li></ul></li></ul></nav></div></aside></main></body></html>