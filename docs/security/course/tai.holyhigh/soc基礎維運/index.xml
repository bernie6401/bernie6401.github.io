<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>SBK Hugo Site</title><link>https://bernie6401.github.io/docs/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/</link><description>Recent content on SBK Hugo Site</description><generator>Hugo</generator><language>en-us</language><atom:link href="https://bernie6401.github.io/docs/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/index.xml" rel="self" type="application/rss+xml"/><item><title>TaiwanHolyHigh - SoC基礎維運 - ArcSight教學</title><link>https://bernie6401.github.io/docs/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/taiwanholyhigh---soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B---arcsight%E6%95%99%E5%AD%B8/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://bernie6401.github.io/docs/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/taiwanholyhigh---soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B---arcsight%E6%95%99%E5%AD%B8/</guid><description>&lt;h1 id="taiwanholyhigh---soc基礎維運---arcsight教學">
 TaiwanHolyHigh - SoC基礎維運 - ArcSight教學
 &lt;a class="anchor" href="#taiwanholyhigh---soc%e5%9f%ba%e7%a4%8e%e7%b6%ad%e9%81%8b---arcsight%e6%95%99%e5%ad%b8">#&lt;/a>
&lt;/h1>
&lt;h2 id="set-up">
 Set Up
 &lt;a class="anchor" href="#set-up">#&lt;/a>
&lt;/h2>
&lt;p>先進到https://bit.ly/44IFecN下載ArcSight Console，並且全部default下一步&lt;/p>
&lt;ol>
&lt;li>(editor需要admin權限)進入localhost host DNS解析 -&amp;gt; C:\Windows\System32\drivers\etc\host
新增 211.75.237.80 chtpoc&lt;/li>
&lt;li>打開ArcSight Console，用之前提供的帳密以及最後打chtpoc，進行登入
&lt;img src="https://hackmd.io/_uploads/B1_MkKc8p.png" alt="圖片" />&lt;/li>
&lt;li>登入之後的狀態
&lt;img src="https://hackmd.io/_uploads/BJNleKc8p.png" alt="圖片" />&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://hackmd.io/_uploads/Hy8IUYqIa.png" alt="圖片" />
&lt;img src="https://hackmd.io/_uploads/Syx6UK986.png" alt="圖片" />
&lt;img src="https://hackmd.io/_uploads/S1vRUKcUp.png" alt="圖片" />
ArcSight預設有分大小寫
&lt;img src="https://hackmd.io/_uploads/SJrXPY5UT.png" alt="圖片" />&lt;/p>
&lt;p>活動頻道可以儲存0
&lt;img src="https://hackmd.io/_uploads/SJCEqt9Up.png" alt="圖片" />
&lt;img src="https://hackmd.io/_uploads/HkSr5t5La.png" alt="圖片" />&lt;/p>
&lt;h2 id="規則">
 規則
 &lt;a class="anchor" href="#%e8%a6%8f%e5%89%87">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>WAF規則
&lt;img src="https://hackmd.io/_uploads/B1Ljrc9UT.png" alt="圖片" />&lt;/li>
&lt;li>Firewall規則
&lt;img src="https://hackmd.io/_uploads/rJY6S55IT.png" alt="圖片" />&lt;/li>
&lt;li>IPS
&lt;img src="https://hackmd.io/_uploads/Bykw2m3Ia.png" alt="image" />&lt;/li>
&lt;li>Firewall-BotNet
&lt;img src="https://hackmd.io/_uploads/HkZK2QnIT.png" alt="image" />&lt;/li>
&lt;li>Snort
&lt;img src="https://hackmd.io/_uploads/rJ3onmnUp.png" alt="image" />&lt;/li>
&lt;li>Trojan
&lt;img src="https://hackmd.io/_uploads/BkPhnX2U6.png" alt="image" />&lt;/li>
&lt;li>WineventLog
&lt;img src="https://hackmd.io/_uploads/SkSan7hUT.png" alt="image" />&lt;/li>
&lt;/ul>
&lt;h2 id="清單">
 清單
 &lt;a class="anchor" href="#%e6%b8%85%e5%96%ae">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>抑制清單
&lt;img src="https://hackmd.io/_uploads/rkPcT7hL6.png" alt="image" />&lt;/li>
&lt;li>弱掃清單
&lt;img src="https://hackmd.io/_uploads/HJNlNSnU6.png" alt="image" />&lt;/li>
&lt;/ul>
&lt;h2 id="規則-1">
 規則
 &lt;a class="anchor" href="#%e8%a6%8f%e5%89%87-1">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>即時規則
&lt;img src="https://hackmd.io/_uploads/BJFeaX2La.png" alt="image" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>中繼站監控
&lt;img src="https://hackmd.io/_uploads/HyqNaX3Lp.png" alt="image" />
&lt;img src="https://hackmd.io/_uploads/H1mr672Up.png" alt="image" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>中繼站監控持續連線
&lt;img src="https://hackmd.io/_uploads/Sk4wpm28T.png" alt="image" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>WAF弱掃
&lt;img src="https://hackmd.io/_uploads/H1kMNHhL6.png" alt="image" />
&lt;img src="https://hackmd.io/_uploads/rJ6GEHnUp.png" alt="image" />
&lt;img src="https://hackmd.io/_uploads/HymmES386.png" alt="image" />&lt;/p></description></item><item><title>TaiwanHolyHigh - SoC基礎維運 - HW2</title><link>https://bernie6401.github.io/docs/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/taiwanholyhigh---soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B---hw2/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://bernie6401.github.io/docs/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/taiwanholyhigh---soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B---hw2/</guid><description>&lt;h1 id="taiwanholyhigh---soc基礎維運---hw2">
 TaiwanHolyHigh - SoC基礎維運 - HW2
 &lt;a class="anchor" href="#taiwanholyhigh---soc%e5%9f%ba%e7%a4%8e%e7%b6%ad%e9%81%8b---hw2">#&lt;/a>
&lt;/h1>
&lt;h2 id="background">
 Background
 &lt;a class="anchor" href="#background">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://learn.microsoft.com/zh-tw/sysinternals/downloads/sysmon">Sysmon Event ID&lt;/a>
&lt;blockquote>
&lt;h3 id="事件識別碼-1處理程序建立">
 事件識別碼 1：處理程序建立
 &lt;a class="anchor" href="#%e4%ba%8b%e4%bb%b6%e8%ad%98%e5%88%a5%e7%a2%bc-1%e8%99%95%e7%90%86%e7%a8%8b%e5%ba%8f%e5%bb%ba%e7%ab%8b">#&lt;/a>
&lt;/h3>
&lt;p>處理程序建立事件會提供新建立處理程序的延伸資訊。 完整的命令列提供處理程序執行的內容。 &lt;code>ProcessGUID&lt;/code> 欄位是跨定義域此處理程式的唯一值，可讓事件相互關聯更容易。 雜湊是檔案的完整雜湊，具有 &lt;code>HashType&lt;/code> 欄位中的演算法。&lt;/p>
&lt;hr>
&lt;h3 id="事件識別碼-8createremotethread">
 事件識別碼 8：CreateRemoteThread
 &lt;a class="anchor" href="#%e4%ba%8b%e4%bb%b6%e8%ad%98%e5%88%a5%e7%a2%bc-8createremotethread">#&lt;/a>
&lt;/h3>
&lt;p>&lt;code>CreateRemoteThread&lt;/code> 事件會偵測處理程序何時在另一個處理程序中建立執行緒。 惡意程式碼會使用這項技術來插入程式碼，並隱藏在其他處理程序中。 事件表示來源和目標處理程序。 其會提供將在新執行緒中執行之程式碼的資訊：StartAddress、&lt;code>StartModule&lt;/code> 和 &lt;code>StartFunction&lt;/code>。 請注意，系統會推斷 &lt;code>StartModule&lt;/code> 和 &lt;code>StartFunction&lt;/code> 欄位，如果起始位址位於載入的模組或已知的匯出函式之外，這些欄位可能會是空的。&lt;/p>
&lt;hr>
&lt;h3 id="事件識別碼-11filecreate">
 事件識別碼 11：FileCreate
 &lt;a class="anchor" href="#%e4%ba%8b%e4%bb%b6%e8%ad%98%e5%88%a5%e7%a2%bc-11filecreate">#&lt;/a>
&lt;/h3>
&lt;p>建立或覆寫檔案時，系統會記錄檔案建立作業。 此事件適用於監視自動啟動位置，例如開機資料夾，以及暫存和下載目錄，這是初始感染期間惡意程式碼放置的常見位置。&lt;/p>
&lt;hr>
&lt;h3 id="事件識別碼-13registryevent-值已設定">
 事件識別碼 13：RegistryEvent (值已設定)
 &lt;a class="anchor" href="#%e4%ba%8b%e4%bb%b6%e8%ad%98%e5%88%a5%e7%a2%bc-13registryevent-%e5%80%bc%e5%b7%b2%e8%a8%ad%e5%ae%9a">#&lt;/a>
&lt;/h3>
&lt;p>此登錄事件類型會識別登錄值修改。 事件會記錄針對類型為 &lt;code>DWORD&lt;/code> 和 &lt;code>QWORD&lt;/code> 的登錄值所寫入的值。&lt;/p>&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h2 id="recon---event-log呈現的攻擊順序">
 Recon - Event Log呈現的攻擊順序
 &lt;a class="anchor" href="#recon---event-log%e5%91%88%e7%8f%be%e7%9a%84%e6%94%bb%e6%93%8a%e9%a0%86%e5%ba%8f">#&lt;/a>
&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>Event ID: 8 → CreateRemoteThread
首先看到23/12/17 15:1024的時候，由==NT AUTHORITY\SYSTEM==發起的新的thread，從原本的Process(ID: 820)幫另外一個Process(ID: 7464)建立，誠如MSDN上的說明這應該是惡意程式為了不要被砍掉
&lt;img src="https://hackmd.io/_uploads/rJjOTA-wa.png" alt="圖片" />
比較經典的案例是類似NTU CS助教 - @Ice1187 在Window Malware講到的&lt;a href="https://attack.mitre.org/techniques/T1055/001/">reflective dll injection&lt;/a>，也就是Mitre紀載的==T1055.001==，其本質上就是利用CreateRemoteThread在一個正常的process開一個thread，然後做一些惡意的事情，這樣的話defender也不會把它砍掉，因為從外部看，就只是一個正常的process
&lt;img src="https://hackmd.io/_uploads/Hy9wgyfPp.png" alt="圖片" />&lt;/p></description></item></channel></rss>