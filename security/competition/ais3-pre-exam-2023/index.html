<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  AIS3 Pre-Exam 2023
  #


  tags: CTF EOF2023
  #

:::spoiler TOC
[TOC]
:::

  Web
  #


  E-Portfolio baby
  #


  Recon
  #

直接用Burp Suite可以繞過reCAPTCHA，而且About Guest的內容會被完整的render出來達到XSS

  Login Panel
  #


  Recon
  #


我又找到了一個破解谷歌驗證碼的新方案！
yescaptcha


  Reverse
  #


  Pwn
  #


  Simply Pwn
  #


  Recon
  #


checksec
$ checksec pwn
[*] Checking for new versions of pwntools
    To disable this functionality, set the contents of /home/sbk6401/.cache/.pwntools-cache-3.7/update to 'never' (old way).
    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):
        [update]
        interval=never
[*] You have the latest version of Pwntools (4.9.0)
[*] '/home/sbk6401/CTF/AIS3-Pre-Exam/PWN/Simply Pwn/pwn'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX disabled
    PIE:      No PIE (0x400000)
    RWX:      Has RWX segments



  Misc
  #


  Welcome
  #

縮小檔案就看的到flag了
Flag: AIS3{WELCOME-TO-2023-PRE-EXAM-&-MY-FIRST-CTF}"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/competition/ais3-pre-exam-2023/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="AIS3 Pre-Exam 2023"><meta property="og:description" content="AIS3 Pre-Exam 2023 # tags: CTF EOF2023 # :::spoiler TOC [TOC] :::
Web # E-Portfolio baby # Recon # 直接用Burp Suite可以繞過reCAPTCHA，而且About Guest的內容會被完整的render出來達到XSS
Login Panel # Recon # 我又找到了一個破解谷歌驗證碼的新方案！ yescaptcha Reverse # Pwn # Simply Pwn # Recon # checksec $ checksec pwn [*] Checking for new versions of pwntools To disable this functionality, set the contents of /home/sbk6401/.cache/.pwntools-cache-3.7/update to 'never' (old way). Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide): [update] interval=never [*] You have the latest version of Pwntools (4.9.0) [*] '/home/sbk6401/CTF/AIS3-Pre-Exam/PWN/Simply Pwn/pwn' Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX disabled PIE: No PIE (0x400000) RWX: Has RWX segments Misc # Welcome # 縮小檔案就看的到flag了 Flag: AIS3{WELCOME-TO-2023-PRE-EXAM-&-MY-FIRST-CTF}"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CTF"><meta property="article:tag" content="AIS3"><title>AIS3 Pre-Exam 2023 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/competition/ais3-pre-exam-2023/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>AIS3 Pre-Exam 2023</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#web>Web</a><ul><li><a href=#e-portfolio-baby>E-Portfolio baby</a></li><li><a href=#login-panel>Login Panel</a></li></ul></li><li><a href=#reverse>Reverse</a></li><li><a href=#pwn>Pwn</a><ul><li><a href=#simply-pwn>Simply Pwn</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#welcome>Welcome</a></li><li><a href=#robot>Robot</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#fernet>Fernet</a></li><li><a href=#2des>2DES</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=ais3-pre-exam-2023>AIS3 Pre-Exam 2023
<a class=anchor href=#ais3-pre-exam-2023>#</a></h1><h6 id=tags-ctf-eof2023>tags: <code>CTF</code> <code>EOF2023</code>
<a class=anchor href=#tags-ctf-eof2023>#</a></h6><p>:::spoiler TOC
[TOC]
:::</p><h2 id=web>Web
<a class=anchor href=#web>#</a></h2><h3 id=e-portfolio-baby>E-Portfolio baby
<a class=anchor href=#e-portfolio-baby>#</a></h3><h4 id=recon>Recon
<a class=anchor href=#recon>#</a></h4><p>直接用Burp Suite可以繞過reCAPTCHA，而且About Guest的內容會被完整的render出來達到XSS</p><h3 id=login-panel>Login Panel
<a class=anchor href=#login-panel>#</a></h3><h4 id=recon-1>Recon
<a class=anchor href=#recon-1>#</a></h4><ul><li><a href=https://www.readfog.com/a/1640970212456108032>我又找到了一個破解谷歌驗證碼的新方案！</a></li><li><a href=https://yescaptcha.com/dashboard.html>yescaptcha</a></li></ul><h2 id=reverse>Reverse
<a class=anchor href=#reverse>#</a></h2><h2 id=pwn>Pwn
<a class=anchor href=#pwn>#</a></h2><h3 id=simply-pwn>Simply Pwn
<a class=anchor href=#simply-pwn>#</a></h3><h4 id=recon-2>Recon
<a class=anchor href=#recon-2>#</a></h4><ol><li><code>checksec</code><pre tabindex=0><code class=language-bash! data-lang=bash!>$ checksec pwn
[*] Checking for new versions of pwntools
    To disable this functionality, set the contents of /home/sbk6401/.cache/.pwntools-cache-3.7/update to &#39;never&#39; (old way).
    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):
        [update]
        interval=never
[*] You have the latest version of Pwntools (4.9.0)
[*] &#39;/home/sbk6401/CTF/AIS3-Pre-Exam/PWN/Simply Pwn/pwn&#39;
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX disabled
    PIE:      No PIE (0x400000)
    RWX:      Has RWX segments
</code></pre></li></ol><h2 id=misc>Misc
<a class=anchor href=#misc>#</a></h2><h3 id=welcome>Welcome
<a class=anchor href=#welcome>#</a></h3><p>縮小檔案就看的到flag了
Flag: <code>AIS3{WELCOME-TO-2023-PRE-EXAM-&-MY-FIRST-CTF}</code></p><h3 id=robot>Robot
<a class=anchor href=#robot>#</a></h3><p>簡單的Script，但是題目敘述太不直覺了吧
:::spoiler Script</p><pre tabindex=0><code class="language-python=" data-lang="python=">from pwn import *

context.arch = &#39;amd64&#39;
r = remote(&#34;chals1.ais3.org&#34;, 12348)

r.recvline()
r.recvline()

for i in range(30):
    question = r.recvline().decode().strip()
    ans = eval(question)
    sleep(1)
    r.sendline(str(ans).encode())

print(r.recvline())
r.interactive()
</code></pre><p>:::
Flag: <code>AIS3{don't_eval_unknown_code_or_pipe_curl_to_sh}</code></p><h2 id=crypto>Crypto
<a class=anchor href=#crypto>#</a></h2><h3 id=fernet>Fernet
<a class=anchor href=#fernet>#</a></h3><p>就直接按照decrypt的流程跑一次就好了
:::spoiler Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python=">import os
import base64
from cryptography.fernet import Fernet
from Crypto.Hash import SHA256
from Crypto.Protocol.KDF import PBKDF2
from pwn import *

def decrypt(ciphertext, password, salt):
    key = PBKDF2(password.encode(), salt, 32, count=1000, hmac_hash_module=SHA256)  
    f = Fernet(base64.urlsafe_b64encode(key))  
    plaintext = f.decrypt(ciphertext)  
    return plaintext

leak_password = &#39;mysecretpassword&#39;
ciphertext = &#39;iAkZMT9sfXIjD3yIpw0ldGdBQUFBQUJrVzAwb0pUTUdFbzJYeU0tTGQ4OUUzQXZhaU9HMmlOaC1PcnFqRUIzX0xtZXg0MTh1TXFNYjBLXzVBOVA3a0FaenZqOU1sNGhBcHR3Z21RTTdmN1dQUkcxZ1JaOGZLQ0E0WmVMSjZQTXN3Z252VWRtdXlaVW1fZ0pzV0xsaUM5VjR1ZHdj&#39;
tmp = base64.b64decode(ciphertext)
salt = tmp[:16]
ciphertext = tmp[16:]
print(decrypt(ciphertext, leak_password, salt))
</code></pre><p>:::
Flag: <code>FLAG{W3lc0m3_t0_th3_CTF_W0rld_!!_!!!_!}</code></p><h3 id=2des>2DES
<a class=anchor href=#2des>#</a></h3><ul><li><a href=https://bryceknowhow.blogspot.com/2018/05/cryptography-des-meet-in-middle-attack.html>meet in the middle attack</a>
這一題沒有解出來，兩個exploit source code都有點問題導致無法實踐，但邏輯應該是對的
:::spoiler JS Source Code</li></ul><pre tabindex=0><code class="language-javascript=" data-lang="javascript=">const crypto = require(&#39;crypto&#39;)
const assert = require(&#39;assert&#39;)


const hint_pt = Buffer.from(&#39;AIS3{??????????}&#39;, &#39;utf8&#39;)
let hint = &#39;118cd68957ac93b269335416afda70e6d79ad65a09b0c0c6c50917e0cee18c93&#39;
const iv = Buffer.concat([Buffer.from(&#39;AIS3 三&#39;)])
console.log(iv)

function encrypt(msg, key, iv) {
    const cipher = crypto.createCipheriv(&#39;des-cbc&#39;, key, iv)
    let encrypted = cipher.update(msg)
    encrypted = Buffer.concat([encrypted, cipher.final()])
    return encrypted
}

function decrypt(msg, key, iv) {
    const decipher = crypto.createDecipheriv(&#39;des-cbc&#39;, key, iv)
    let decrypted = decipher.update(msg, &#39;nyan~&#39;)
    decrypted = Buffer.concat([decrypted, decipher.final()])
    return decrypted
}

function intToHexStr(num) {
    var hexString = &#39;&#39;;
    for (var i = 0; i &lt; 8; i++) {
      var byte = num &amp; 0xff; // 获取低8位
      var hex = byte.toString(16).padStart(2, &#39;0&#39;); // 转换为两位的十六进制字符串
      hexString = hex + hexString; // 将转换后的字符串拼接到结果中
      num = num &gt;&gt; 8; // 右移8位，处理下一个字节
    }
    return hexString;
}

var key1_table = []
var key2_table = []
var key1 = key2 = Buffer.from(intToHexStr(256), &#39;hex&#39;)

for (let idx = 0; idx &lt; 2**32; idx++)
{
    tmp = encrypt(hint_pt, key1, iv)
    key1_table.push(tmp)
    key2_table.push(decrypt(hint, key2, iv))

    var key1 = key2 = Buffer.from(intToHexStr(idx + 1), &#39;hex&#39;)
}

for (let i = 0; i &lt; 2**32; i++)
{
    for (let j = 0; j &lt; 2**32; j++)
    {
        if (key1_table[i] == key2_table[j])
        {
            console.log(&#34;key1 = &#34;, i, &#34;\nkey2 = &#34;, j)
            break
        }
    }
}
</code></pre><p>:::</p><p>:::spoiler Python Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python="># from Crypto.Cipher import DES
from tqdm import trange
from pyDes import des, CBC, PAD_PKCS5


hint_pt = &#39;AIS3{??????????}&#39;
hint = &#39;118cd68957ac93b269335416afda70e6d79ad65a09b0c0c6c50917e0cee18c93&#39;
iv = b&#39;4149533320e4b889&#39;
key1_table = []
key2_table = []

def encrypt(m, key, iv):
    # des = DES.new(key, DES.MODE_CBC, iv)
    k = des(&#34;0&#34; * 8, CBC, &#34;0&#34;*8, pad=None, padmode=PAD_PKCS5)
    k.setKey(key)
    k.setIV(iv)
    return k.encrypt(m, padmode=PAD_PKCS5)

def decrypt(c, key, iv):
    # des = DES.new(key, DES.MODE_CBC, iv)
    k = des(&#34;0&#34; * 8, CBC, &#34;0&#34;*8, pad=None, padmode=PAD_PKCS5)
    k.setKey(key)
    k.setIV(iv)
    return k.decrypt(c, padmode=PAD_PKCS5)

key1 = key2 = &#39;{0:0&gt;16x}&#39;.format(0).encode()
for idx in range(2**32):
    key1_table.append(encrypt(hint_pt, key1, iv))
    key2_table.append(decrypt(hint, key2, iv))

    key1 = key2 = &#39;{0:0&gt;16x}&#39;.format(idx + 1).encode()

for i in range(len(key1)):
    for j in range(len(key2_table)):
        if key1_table[i] == key2_table[j]:
            print(&#34;key1 = {}\nkey2 = {}&#34;.format(i, j))
</code></pre><p>:::</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#web>Web</a><ul><li><a href=#e-portfolio-baby>E-Portfolio baby</a></li><li><a href=#login-panel>Login Panel</a></li></ul></li><li><a href=#reverse>Reverse</a></li><li><a href=#pwn>Pwn</a><ul><li><a href=#simply-pwn>Simply Pwn</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#welcome>Welcome</a></li><li><a href=#robot>Robot</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#fernet>Fernet</a></li><li><a href=#2des>2DES</a></li></ul></li></ul></nav></div></aside></main></body></html>