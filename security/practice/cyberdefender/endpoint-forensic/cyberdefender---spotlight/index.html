<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  CyberDefender - Spotlight
  #

Challenge: https://cyberdefenders.org/blueteam-ctf-challenges/34#nav-questions
:::spoiler TOC
[TOC]
:::

  Tools:
  #


Autopsy
mac_apt
SQLite
steghide

:::info
因為這一個lab是有關Mac-OS的forensics，也沒有相關的背景知識，所以解出來的部分大多參考12，就是當作第一次學習的課題
:::

  ==Q1==
  #


What version of macOS is running on this image?

  Recon
  #

這個是參考1

  Exploit
  #

在./root/System/Library/CoreServices/中可以找到SystemVersion.plist

:::spoiler Flag
Flag: 10.15
:::

  ==Q2==
  #


What &ldquo;competitive advantage&rdquo; did Hansel lie about in the file AnotherExample.jpg? (two words)

  Exploit
  #

直接翻一下AnotherExample.jpg所在的資料夾，就可以發現有一個secret的text檔案，裡面就有這題的flag，不太知道和這張圖片有甚麼關係
:::info
11/13更新: 直接strings search這張圖片也可以找到secret strings的東西
:::"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/cyberdefender/endpoint-forensic/cyberdefender---spotlight/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CyberDefender - Spotlight"><meta property="og:description" content="CyberDefender - Spotlight # Challenge: https://cyberdefenders.org/blueteam-ctf-challenges/34#nav-questions
:::spoiler TOC [TOC] :::
Tools: # Autopsy mac_apt SQLite steghide :::info 因為這一個lab是有關Mac-OS的forensics，也沒有相關的背景知識，所以解出來的部分大多參考12，就是當作第一次學習的課題 :::
==Q1== # What version of macOS is running on this image?
Recon # 這個是參考1
Exploit # 在./root/System/Library/CoreServices/中可以找到SystemVersion.plist :::spoiler Flag Flag: 10.15 :::
==Q2== # What “competitive advantage” did Hansel lie about in the file AnotherExample.jpg? (two words)
Exploit # 直接翻一下AnotherExample.jpg所在的資料夾，就可以發現有一個secret的text檔案，裡面就有這題的flag，不太知道和這張圖片有甚麼關係 :::info 11/13更新: 直接strings search這張圖片也可以找到secret strings的東西 :::"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CyberDefender"><meta property="article:tag" content="Endpoint Forensics"><title>CyberDefender - Spotlight | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/cyberdefender/endpoint-forensic/cyberdefender---spotlight/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CyberDefender - Spotlight</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#tools>Tools:</a></li><li><a href=#q1>==Q1==</a><ul><li></li></ul></li><li><a href=#q2>==Q2==</a><ul><li></li></ul></li><li><a href=#q3>==Q3==</a><ul><li></li></ul></li><li><a href=#q4>==Q4==</a><ul><li></li></ul></li><li><a href=#q5>==Q5==</a><ul><li></li></ul></li><li><a href=#q6>==Q6==</a><ul><li></li></ul></li><li><a href=#q7>==Q7==</a><ul><li></li></ul></li><li><a href=#q8>==Q8==</a><ul><li></li></ul></li><li><a href=#q9>==Q9==</a><ul><li></li></ul></li><li><a href=#q10>==Q10==</a><ul><li><a href=#recon-7>Recon</a></li><li><a href=#exploit-9>Exploit</a></li></ul></li><li><a href=#q11>==Q11==</a><ul><li><a href=#recon-8>Recon</a></li><li><a href=#exploit-10>Exploit</a></li></ul></li><li><a href=#q12>==Q12==</a><ul><li><a href=#recon-9>Recon</a></li><li><a href=#exploit-11>Exploit</a></li></ul></li><li><a href=#q13>==Q13==</a><ul><li></li></ul></li><li><a href=#q14>==Q14==</a><ul><li><a href=#recon-10>Recon</a></li><li><a href=#exploit-13>Exploit</a></li></ul></li><li><a href=#q15>==Q15==</a><ul><li><a href=#recon-11>Recon</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=cyberdefender---spotlight>CyberDefender - Spotlight
<a class=anchor href=#cyberdefender---spotlight>#</a></h1><p>Challenge: <a href=https://cyberdefenders.org/blueteam-ctf-challenges/34#nav-questions>https://cyberdefenders.org/blueteam-ctf-challenges/34#nav-questions</a></p><p>:::spoiler TOC
[TOC]
:::</p><h2 id=tools>Tools:
<a class=anchor href=#tools>#</a></h2><ul><li>Autopsy</li><li><a href=https://github.com/ydkhatri/mac_apt/releases>mac_apt</a></li><li>SQLite</li><li>steghide</li></ul><p>:::info
因為這一個lab是有關Mac-OS的forensics，也沒有相關的背景知識，所以解出來的部分大多參考<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup><sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，就是當作第一次學習的課題
:::</p><h2 id=q1>==Q1==
<a class=anchor href=#q1>#</a></h2><blockquote><p>What version of macOS is running on this image?</p></blockquote><h4 id=recon>Recon
<a class=anchor href=#recon>#</a></h4><p>這個是參考<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h4 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h4><p>在<code>./root/System/Library/CoreServices/</code>中可以找到<code>SystemVersion.plist</code>
<img src=https://hackmd.io/_uploads/HJqsQEjQp.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>10.15</code>
:::</p><h2 id=q2>==Q2==
<a class=anchor href=#q2>#</a></h2><blockquote><p>What &ldquo;competitive advantage&rdquo; did Hansel lie about in the file AnotherExample.jpg? (two words)</p></blockquote><h4 id=exploit-1>Exploit
<a class=anchor href=#exploit-1>#</a></h4><p>直接翻一下<code>AnotherExample.jpg</code>所在的資料夾，就可以發現有一個secret的text檔案，裡面就有這題的flag，不太知道和這張圖片有甚麼關係
:::info
11/13更新: 直接strings search這張圖片也可以找到secret strings的東西
:::</p><p>:::spoiler Flag
Flag: <code>flip phone</code>
:::</p><h2 id=q3>==Q3==
<a class=anchor href=#q3>#</a></h2><blockquote><p>How many bookmarks are registered in safari?</p></blockquote><h4 id=recon-1>Recon
<a class=anchor href=#recon-1>#</a></h4><p>這個是參考<sup id=fnref2:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h4 id=exploit-2>Exploit
<a class=anchor href=#exploit-2>#</a></h4><p>首先可以在<code>./root/Users/hansel.apricot/Library/Safari</code>的地方找到<code>Bookmarks.plist</code>，只要利用plistutil轉換成一般的xml格式就可以了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plistutil -i Bookmarks.plist | grep <span style=color:#e6db74>&#34;URLString&#34;</span> | wc -l
</span></span><span style=display:flex><span><span style=color:#ae81ff>13</span>
</span></span></code></pre></div><p>:::spoiler Flag
Flag: <code>13</code>
:::</p><h2 id=q4>==Q4==
<a class=anchor href=#q4>#</a></h2><blockquote><p>What&rsquo;s the content of the note titled &ldquo;Passwords&rdquo;?</p></blockquote><h4 id=recon-2>Recon
<a class=anchor href=#recon-2>#</a></h4><p>這一題是參考<sup id=fnref1:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，mac會把使用者的Note放在<code>./root/Users/hansel.apricot/Library/Group Containers/group.com.apple.notes</code>中的==NoteStore.sqlite==</p><h4 id=exploit-3>Exploit
<a class=anchor href=#exploit-3>#</a></h4><p>可以看到Title是Passwords但沒有內容，依照<sup id=fnref2:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>的說明，他是覺得答案應該是視title為content的一部份
<img src=https://hackmd.io/_uploads/ryf4P6kVa.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>Passwords</code>
:::</p><h2 id=q5>==Q5==
<a class=anchor href=#q5>#</a></h2><blockquote><p>Provide the MAC address of the ethernet adapter for this machine.</p></blockquote><h4 id=recon-3>Recon
<a class=anchor href=#recon-3>#</a></h4><p>這一題是參考<sup id=fnref3:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，就是直接grep search ==en0==</p><h4 id=exploit-4>Exploit
<a class=anchor href=#exploit-4>#</a></h4><p>可以發現<code>root/private/var/log/daily.out</code>有符合</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ grep -i -r <span style=color:#e6db74>&#34;en0&#34;</span>
</span></span><span style=display:flex><span>grep: root/.fseventsd/00000000007f0fb2: binary file matches
</span></span><span style=display:flex><span>root/private/var/log/daily.out:en0   <span style=color:#ae81ff>1500</span>  &lt;Link#4&gt;    00:0c:29:c4:65:77   <span style=color:#ae81ff>372733</span>     <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>73025</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>root/private/var/log/daily.out:en0   <span style=color:#ae81ff>1500</span>  fe80::8c8:8 fe80:4::8c8:87c2:   <span style=color:#ae81ff>372733</span>     -    <span style=color:#ae81ff>73025</span>     -     -
</span></span><span style=display:flex><span>root/private/var/log/daily.out:en0   <span style=color:#ae81ff>1500</span>  184.171.151/2 stu-181-151-171   <span style=color:#ae81ff>372733</span>     -    <span style=color:#ae81ff>73025</span>     -     -
</span></span><span style=display:flex><span>root/private/var/log/daily.out:en0   <span style=color:#ae81ff>1500</span>  &lt;Link#4&gt;    00:0c:29:c4:65:77      <span style=color:#ae81ff>790</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>694</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>root/private/var/log/daily.out:en0   <span style=color:#ae81ff>1500</span>  fe80::1cba: fe80:4::1cba:cac8      <span style=color:#ae81ff>790</span>     -      <span style=color:#ae81ff>694</span>     -     -
</span></span><span style=display:flex><span>root/private/var/log/daily.out:en0   <span style=color:#ae81ff>1500</span>  184.171.151/2 stu-181-151-171      <span style=color:#ae81ff>790</span>     -      <span style=color:#ae81ff>694</span>     -     -
</span></span><span style=display:flex><span>grep: root/private/var/log/DiagnosticMessages/2020.04.19.asl: binary file matches
</span></span><span style=display:flex><span>grep: root/Users/hansel.apricot/Library/Safari/CloudAutoFillCorrections.db: binary file matches
</span></span><span style=display:flex><span>grep: root/Users/sneaky/.Trash/silenteye-0.4.1b-snowleopard.dmg: binary file matches
</span></span></code></pre></div><p>:::spoiler Flag
Flag: <code>00:0c:29:c4:65:77</code>
:::</p><h2 id=q6>==Q6==
<a class=anchor href=#q6>#</a></h2><blockquote><p>Name the data URL of the quarantined item.</p></blockquote><h4 id=recon-4>Recon
<a class=anchor href=#recon-4>#</a></h4><p>這一題是參考<sup id=fnref4:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><blockquote><p>Quarantined Events are a log of all downloaded items on MacOS.</p></blockquote><h4 id=exploit-5>Exploit
<a class=anchor href=#exploit-5>#</a></h4><p>主要macOS會把==com.apple.LaunchServices.QuarantineEventsV2==放在<code>./root/Users/sneaky/Library/Preferences/</code>，目前只有一個quarantined目標</p><p>:::spoiler Flag
Flag: <code>https://futureboy.us/stegano/encode.pl</code>
:::</p><h2 id=q7>==Q7==
<a class=anchor href=#q7>#</a></h2><blockquote><p>What app did the user &ldquo;sneaky&rdquo; try to install via a .dmg file? (one word)</p></blockquote><h4 id=exploit-6>Exploit
<a class=anchor href=#exploit-6>#</a></h4><p>我是直接翻<code>./root/Users/sneaky/.Trash</code>就直接看到了
<img src=https://hackmd.io/_uploads/H1Hk-Vo7T.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>silenteye</code>
:::</p><h2 id=q8>==Q8==
<a class=anchor href=#q8>#</a></h2><blockquote><p>What was the file &lsquo;Examplesteg.jpg&rsquo; renamed to?</p></blockquote><h4 id=recon-5>Recon
<a class=anchor href=#recon-5>#</a></h4><p>這一題是參考<sup id=fnref5:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，必須使用<code>mac_apt</code>這套工具中的==FSEVENTS==幫忙parse <code>.fseventsd</code>中所有的event logs files</p><blockquote><p>FSEVENTS: Reads file system event logs (from .fseventsd)</p></blockquote><h4 id=exploit-7>Exploit
<a class=anchor href=#exploit-7>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./mac_apt_artifact_only.exe -i .fseventsd -o ./ FSEVENTS
</span></span><span style=display:flex><span>Output path was : ./
</span></span><span style=display:flex><span>MAIN-INFO-Started macOS Artifact Parsing Tool - Artifact Only mode, version 1.5.8.dev <span style=color:#f92672>(</span>20230617<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>MAIN-INFO-Dates and times are in UTC unless the specific artifact being parsed saves it as local time!
</span></span><span style=display:flex><span>MAIN-INFO---------------------------------------------------
</span></span><span style=display:flex><span>MAIN-INFO-Running plugin FSEVENTS
</span></span><span style=display:flex><span>MAIN-INFO---------------------------------------------------
</span></span><span style=display:flex><span>MAIN.FSEVENTS-INFO-Module Started as standalone
</span></span><span style=display:flex><span>MAIN.FSEVENTS-INFO-Writing <span style=color:#ae81ff>231662</span> fsevent<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>MAIN.FSEVENTS-INFO-The source_date field on the fsevents are from the individual file modified date <span style=color:#f92672>(</span>metadata not data<span style=color:#f92672>)</span>! This may have changed <span style=color:#66d9ef>if</span> you are not on a live or read-only image.
</span></span><span style=display:flex><span>MAIN.FSEVENTS-INFO-231662 logs found
</span></span><span style=display:flex><span>MAIN-INFO---------------------------------------------------
</span></span><span style=display:flex><span>MAIN-INFO-Finished in time <span style=color:#f92672>=</span> 00:00:04
</span></span><span style=display:flex><span>MAIN-INFO-Review the Log file and report any ERRORs or EXCEPTIONS to the developers
</span></span></code></pre></div><p>command結束會吐一個db file和一個log file，分析db file後就直接filter <code>Examplesteg.jpg</code>這張圖片
<img src=https://hackmd.io/_uploads/ry1oHAkEa.png alt=圖片></p><p>此時我們可以複製該file的ID，再接續filter
File ID: <code>12885043806</code>
<img src=https://hackmd.io/_uploads/SJeaBC1Ea.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>GoodExample.jpg</code>
:::</p><h2 id=q9>==Q9==
<a class=anchor href=#q9>#</a></h2><blockquote><p>How much time was spent on mail.zoho.com on 4/20/2020?</p></blockquote><h4 id=recon-6>Recon
<a class=anchor href=#recon-6>#</a></h4><p>這一題是參考<sup id=fnref6:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，有關於screentime這個資訊會放在<code>./root/private/var/folders/bf/r04p_gb17xxg37r9ksq855mh0000gn/0/com.apple.ScreenTimeAgent/Store/</code>的==RMAdminStore-Local.sqlite== db file中，也是一樣透過mac_apt幫忙parse(SCREENTIME)
:::info
記得要把<code>RMAdminStore-Local.sqlite-wal</code>和<code>RMAdminStore-Local.sqlite</code>這個檔案放在一起再執行
:::</p><h4 id=exploit-8>Exploit
<a class=anchor href=#exploit-8>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ls
</span></span><span style=display:flex><span>RMAdminStore-Local.sqlite-shm mac_apt_artifact_only.exe RMAdminStore-Local.sqlite  RMAdminStore-Local.sqlite-wal  mac_apt.exe  mac_apt_mounted_sys_data.exe
</span></span><span style=display:flex><span>$ ./mac_apt_artifact_only.exe -i RMAdminStore-Local.sqlite -o . SCREENTIME
</span></span><span style=display:flex><span>Output path was : .
</span></span><span style=display:flex><span>MAIN-INFO-Started macOS Artifact Parsing Tool - Artifact Only mode, version 1.5.8.dev <span style=color:#f92672>(</span>20230617<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>MAIN-INFO-Dates and times are in UTC unless the specific artifact being parsed saves it as local time!
</span></span><span style=display:flex><span>MAIN-INFO---------------------------------------------------
</span></span><span style=display:flex><span>MAIN-INFO-Running plugin SCREENTIME
</span></span><span style=display:flex><span>MAIN-INFO---------------------------------------------------
</span></span><span style=display:flex><span>MAIN.SCREENTIME-INFO-Module Started as standalone
</span></span><span style=display:flex><span>MAIN.SCREENTIME-INFO-Processing file RMAdminStore-Local.sqlite
</span></span><span style=display:flex><span>MAIN-INFO---------------------------------------------------
</span></span><span style=display:flex><span>MAIN-INFO-Finished in time <span style=color:#f92672>=</span> 00:00:00
</span></span><span style=display:flex><span>MAIN-INFO-Review the Log file and report any ERRORs or EXCEPTIONS to the developers
</span></span></code></pre></div><p>接下來就是設定filter就知道他在4/20有兩次的request
<img src=https://hackmd.io/_uploads/SktS5Rk4a.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>20:58</code>
:::</p><h2 id=q10>==Q10==
<a class=anchor href=#q10>#</a></h2><blockquote><p>What&rsquo;s hansel.apricot&rsquo;s password hint? (two words)</p></blockquote><h3 id=recon-7>Recon
<a class=anchor href=#recon-7>#</a></h3><p>這一題是參考<sup id=fnref7:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><blockquote><p>Password information can be found in the user plist, in private/db/dslocal/nodes/Default/users/(username).plist</p></blockquote><h3 id=exploit-9>Exploit
<a class=anchor href=#exploit-9>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plistutil -i hansel.apricot.plist -o hansel.apricot.plist.txt
</span></span><span style=display:flex><span>$ vim hansel.apricot.plist.txt
</span></span></code></pre></div><p><img src=https://hackmd.io/_uploads/B17MpgGV6.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>Family Opinion</code>
:::</p><h2 id=q11>==Q11==
<a class=anchor href=#q11>#</a></h2><blockquote><p>The main file that stores Hansel&rsquo;s iMessages had a few permissions changes. How many times did the permissions change?</p></blockquote><h3 id=recon-8>Recon
<a class=anchor href=#recon-8>#</a></h3><p>直覺是承接第8題，看他的event log，而根據<sup id=fnref8:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>的說明</p><blockquote><p>The mail file storing iMessages in MacOS is <code>chat.db</code></p></blockquote><h3 id=exploit-10>Exploit
<a class=anchor href=#exploit-10>#</a></h3><p><img src=https://hackmd.io/_uploads/HkTk4-fNa.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>7</code>
:::</p><h2 id=q12>==Q12==
<a class=anchor href=#q12>#</a></h2><blockquote><p>What&rsquo;s the UID of the user who is responsible for connecting mobile devices?</p></blockquote><h3 id=recon-9>Recon
<a class=anchor href=#recon-9>#</a></h3><p>這一題是參考<sup id=fnref9:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，主要是找到位於<code>root/private/var/db/dslocal/nodes/Default/users/</code>的<code>_usbmuxd.plist</code>，這個file主要是:</p><blockquote><p>The process responsible for connecting iPhones/iPads with MacOS is lockdown</p></blockquote><p>但就算不找到這個file，應該還是有其他file是可以擷取出UID的資訊</p><h3 id=exploit-11>Exploit
<a class=anchor href=#exploit-11>#</a></h3><p><img src=https://hackmd.io/_uploads/S1R8U-f4a.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>213</code>
:::</p><h2 id=q13>==Q13==
<a class=anchor href=#q13>#</a></h2><blockquote><p>Find the flag in the GoodExample.jpg image. It&rsquo;s hidden with better tools.</p></blockquote><h4 id=exploit-12>Exploit
<a class=anchor href=#exploit-12>#</a></h4><p>這個直接用steghide隱藏起來，密碼為空，解出來的file內容如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ steghide extract -sf GoodExample.jpg
</span></span><span style=display:flex><span>Enter passphrase:
</span></span><span style=display:flex><span>wrote extracted data to <span style=color:#e6db74>&#34;steganopayload27635.txt&#34;</span>.
</span></span><span style=display:flex><span>$ cat steganopayload27635.txt
</span></span><span style=display:flex><span>Our latest phone will have flag&lt;helicopter&gt; blades and <span style=color:#ae81ff>6</span> cameras on it. No
</span></span><span style=display:flex><span>other phone has those features!%
</span></span></code></pre></div><p>:::spoiler Flag
Flag: <code>helicopter</code>
:::</p><h2 id=q14>==Q14==
<a class=anchor href=#q14>#</a></h2><blockquote><p>What was exactly typed in the Spotlight search bar on 4/20/2020 02:09:48</p></blockquote><h3 id=recon-10>Recon
<a class=anchor href=#recon-10>#</a></h3><p>因為本身不是mac使用者，所以不知道Spotlight功能具體功用為何
<a href=https://support.apple.com/zh-tw/guide/mac-help/mchlp1008/mac>在 Mac 上使用 Spotlight 搜尋</a></p><blockquote><p>Spotlight 可協助你快速找到 Mac 上的 App、文件、電子郵件和其他項目</p></blockquote><p>感覺有點類似windows的cortona?
根據<a href=https://chat.openai.com/c/0279d872-547b-4ebd-b0fd-2ae9096b6b96>ChatGPT的說明</a>，兩者有部分功能類似，不過Cortana比較像是智能助理的感覺，而spotlight只是能夠快速找到一些使用者像要找的file/app/email之類的個人資訊</p><h3 id=exploit-13>Exploit
<a class=anchor href=#exploit-13>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ grep -r -i <span style=color:#e6db74>&#39;2020-04-20&#39;</span> *
</span></span><span style=display:flex><span>grep: macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/private/var/log/powermanagement/2020.04.19.asl: binary file matches
</span></span><span style=display:flex><span>macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/Users/sneaky/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts:               &lt;date&gt;2020-04-20T02:44:27Z&lt;/date&gt;
</span></span><span style=display:flex><span>macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/Users/sneaky/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts:               &lt;date&gt;2020-04-20T02:09:48Z&lt;/date&gt;
</span></span><span style=display:flex><span>macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/Users/sneaky/Library/Application Support/com.apple.touristd/com.apple.touristd.plist:     &lt;date&gt;2020-04-20T02:04:09Z&lt;/date&gt;
</span></span><span style=display:flex><span>macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/Users/sneaky/Library/Application Support/CrashReporter/Intervals_564D2904-54C9-8D99-F8CA-9D7111C46577.plist:              &lt;date&gt;2020-04-20T02:04:08Z&lt;/date&gt;
</span></span><span style=display:flex><span>macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/Users/sneaky/Library/Application Support/CrashReporter/Intervals_564D2904-54C9-8D99-F8CA-9D7111C46577.plist:      &lt;date&gt;2020-04-20T02:04:08Z&lt;/date&gt;
</span></span><span style=display:flex><span>macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/Users/sneaky/Library/Application Support/CrashReporter/Intervals_564D2904-54C9-8D99-F8CA-9D7111C46577.plist:      &lt;date&gt;2020-04-20T02:04:08Z&lt;/date&gt;
</span></span><span style=display:flex><span>macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/Users/sneaky/Library/Application Support/CrashReporter/Intervals_564D2904-54C9-8D99-F8CA-9D7111C46577.plist:              &lt;date&gt;2020-04-20T04:29:01Z&lt;/date&gt;
</span></span><span style=display:flex><span>macOS Catalina - Data <span style=color:#f92672>[</span>volume_0<span style=color:#f92672>]</span>/root/Users/sneaky/Library/Preferences/com.apple.security.KCN.plist:    &lt;date&gt;2020-04-20T03:19:33Z&lt;/date&gt;
</span></span></code></pre></div><p>直接用grep search找到位於<code>./root/Users/sneaky/Library/Application Support/com.apple.spotlight/</code>的==com.apple.spotlight.Shortcuts==</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat macOS<span style=color:#ae81ff>\ </span>Catalina<span style=color:#ae81ff>\ </span>-<span style=color:#ae81ff>\ </span>Data<span style=color:#ae81ff>\ \[</span>volume_0<span style=color:#ae81ff>\]</span>/root/Users/sneaky/Library/Application<span style=color:#ae81ff>\ </span>Support/com.apple.spotlight/com.apple.spotlight.Shortcuts
</span></span><span style=display:flex><span>&lt;?xml version<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.0&#34;</span> encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>?&gt;
</span></span><span style=display:flex><span>&lt;!DOCTYPE plist PUBLIC <span style=color:#e6db74>&#34;-//Apple//DTD PLIST 1.0//EN&#34;</span> <span style=color:#e6db74>&#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;plist version<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.0&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;dict&gt;
</span></span><span style=display:flex><span>        &lt;key&gt;silent&lt;/key&gt;
</span></span><span style=display:flex><span>        &lt;dict&gt;
</span></span><span style=display:flex><span>                &lt;key&gt;DISPLAY_NAME&lt;/key&gt;
</span></span><span style=display:flex><span>                &lt;string&gt;silenteye-0.4.1b-snowleopard_installer&lt;/string&gt;
</span></span><span style=display:flex><span>                &lt;key&gt;LAST_USED&lt;/key&gt;
</span></span><span style=display:flex><span>                &lt;date&gt;2020-04-20T02:44:27Z&lt;/date&gt;
</span></span><span style=display:flex><span>                &lt;key&gt;URL&lt;/key&gt;
</span></span><span style=display:flex><span>                &lt;string&gt;/Applications/silenteye-0.4.1b-snowleopard_installer.app&lt;/string&gt;
</span></span><span style=display:flex><span>        &lt;/dict&gt;
</span></span><span style=display:flex><span>        &lt;key&gt;term&lt;/key&gt;
</span></span><span style=display:flex><span>        &lt;dict&gt;
</span></span><span style=display:flex><span>                &lt;key&gt;DISPLAY_NAME&lt;/key&gt;
</span></span><span style=display:flex><span>                &lt;string&gt;Terminal&lt;/string&gt;
</span></span><span style=display:flex><span>                &lt;key&gt;LAST_USED&lt;/key&gt;
</span></span><span style=display:flex><span>                &lt;date&gt;2020-04-20T02:09:48Z&lt;/date&gt;
</span></span><span style=display:flex><span>                &lt;key&gt;URL&lt;/key&gt;
</span></span><span style=display:flex><span>                &lt;string&gt;/System/Applications/Utilities/Terminal.app&lt;/string&gt;
</span></span><span style=display:flex><span>        &lt;/dict&gt;
</span></span><span style=display:flex><span>&lt;/dict&gt;
</span></span><span style=display:flex><span>&lt;/plist&gt;
</span></span></code></pre></div><p>從結果來看，使用者在<code>2020-04-20 02:44:27</code>輸入過==silent==這個關鍵字，並且顯示silenteye-0.4.1b-snowleopard_installer這個strings，同樣的在<code>2020-04-20 02:09:48</code>時，使用者輸入了==term==這個關鍵字，並且系統回傳Terminal這個strings</p><p>:::spoiler Flag
Flag: <code>term</code>
:::</p><h2 id=q15>==Q15==
<a class=anchor href=#q15>#</a></h2><blockquote><p>What is hansel.apricot&rsquo;s Open Directory user UUID?</p></blockquote><h3 id=recon-11>Recon
<a class=anchor href=#recon-11>#</a></h3><p>這一題還是參考<sup id=fnref10:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，主要是承接第10題的結果，可以在下面看到generateduid的strings
<img src=https://hackmd.io/_uploads/HkQyHfzV6.png alt=圖片></p><p>:::spoiler Flag
Flag: <code>5BB00259-4F58-4FDE-BC67-C2659BA0A5A4</code>
:::</p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://medium.com/@nishadbabu1015/spotlight-blue-team-challenge-f3edaea5dba3>Spotlight Blue Team Challenge</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref2:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://forensicskween.com/ctf/cyberdefenders/spotlight/>CyberDefenders: Spotlight</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref2:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref3:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref4:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref5:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref6:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref7:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref8:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref9:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref10:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#tools>Tools:</a></li><li><a href=#q1>==Q1==</a><ul><li></li></ul></li><li><a href=#q2>==Q2==</a><ul><li></li></ul></li><li><a href=#q3>==Q3==</a><ul><li></li></ul></li><li><a href=#q4>==Q4==</a><ul><li></li></ul></li><li><a href=#q5>==Q5==</a><ul><li></li></ul></li><li><a href=#q6>==Q6==</a><ul><li></li></ul></li><li><a href=#q7>==Q7==</a><ul><li></li></ul></li><li><a href=#q8>==Q8==</a><ul><li></li></ul></li><li><a href=#q9>==Q9==</a><ul><li></li></ul></li><li><a href=#q10>==Q10==</a><ul><li><a href=#recon-7>Recon</a></li><li><a href=#exploit-9>Exploit</a></li></ul></li><li><a href=#q11>==Q11==</a><ul><li><a href=#recon-8>Recon</a></li><li><a href=#exploit-10>Exploit</a></li></ul></li><li><a href=#q12>==Q12==</a><ul><li><a href=#recon-9>Recon</a></li><li><a href=#exploit-11>Exploit</a></li></ul></li><li><a href=#q13>==Q13==</a><ul><li></li></ul></li><li><a href=#q14>==Q14==</a><ul><li><a href=#recon-10>Recon</a></li><li><a href=#exploit-13>Exploit</a></li></ul></li><li><a href=#q15>==Q15==</a><ul><li><a href=#recon-11>Recon</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>