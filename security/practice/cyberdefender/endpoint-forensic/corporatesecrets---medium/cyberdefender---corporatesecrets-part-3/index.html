<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  CyberDefender - CorporateSecrets (Part 3)
  #

Challenge: https://cyberdefenders.org/blueteam-ctf-challenges/33
Part 1: https://hackmd.io/@SBK6401/r18z7VIm6
Part 2: https://hackmd.io/@SBK6401/ByFhEE8X6
Part 4: https://hackmd.io/@SBK6401/H1rAEV87p
:::spoiler TOC
[TOC]
:::

  Tools:
  #


FTK Imager
Registry Explorer
RegRipper
HxD
DB Browser for SQLite
HindSight
Event Log Explorer
MFTDump


  ==Q19==
  #


Which user installed LibreCAD on the system?

  Exploit
  #

我是直接看該檔案在哪個user的資料夾來判斷，當然這個做法有點問題
:::spoiler Flag
Flag: miriam.grapes
:::

  ==Q20==
  #


How many times &ldquo;admin&rdquo; logged into the system?

  Recon
  #

呈第14題"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-3/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CyberDefender - CorporateSecrets (Part 3)"><meta property="og:description" content="CyberDefender - CorporateSecrets (Part 3) # Challenge: https://cyberdefenders.org/blueteam-ctf-challenges/33 Part 1: https://hackmd.io/@SBK6401/r18z7VIm6 Part 2: https://hackmd.io/@SBK6401/ByFhEE8X6 Part 4: https://hackmd.io/@SBK6401/H1rAEV87p
:::spoiler TOC [TOC] :::
Tools: # FTK Imager Registry Explorer RegRipper HxD DB Browser for SQLite HindSight Event Log Explorer MFTDump ==Q19== # Which user installed LibreCAD on the system?
Exploit # 我是直接看該檔案在哪個user的資料夾來判斷，當然這個做法有點問題
:::spoiler Flag Flag: miriam.grapes :::
==Q20== # How many times “admin” logged into the system?
Recon # 呈第14題"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CyberDefender"><meta property="article:tag" content="Endpoint Forensics"><title>CyberDefender - CorporateSecrets (Part 3) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-3/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CyberDefender - CorporateSecrets (Part 3)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#tools>Tools:</a></li><li><a href=#q19>==Q19==</a><ul><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#q20>==Q20==</a><ul><li><a href=#recon>Recon</a></li><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#q21>==Q21==</a><ul><li><a href=#recon-1>Recon</a></li></ul></li><li><a href=#q22>==Q22==</a><ul><li><a href=#recon-2>Recon</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#q23>==Q23==</a><ul><li><a href=#exploit-3>Exploit</a></li></ul></li><li><a href=#q24>==Q24==</a><ul><li><a href=#recon-3>Recon</a></li><li><a href=#exploit-4>Exploit</a></li></ul></li><li><a href=#q25>==Q25==</a><ul><li><a href=#recon-4>Recon</a></li><li><a href=#exploit-5>Exploit</a></li></ul></li><li><a href=#q26>==Q26==</a><ul><li><a href=#exploit-6>Exploit</a></li></ul></li><li><a href=#q27>==Q27==</a><ul><li><a href=#exploit-7>Exploit</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=cyberdefender---corporatesecrets-part-3>CyberDefender - CorporateSecrets (Part 3)
<a class=anchor href=#cyberdefender---corporatesecrets-part-3>#</a></h1><p>Challenge: <a href=https://cyberdefenders.org/blueteam-ctf-challenges/33>https://cyberdefenders.org/blueteam-ctf-challenges/33</a>
Part 1: <a href=https://hackmd.io/@SBK6401/r18z7VIm6>https://hackmd.io/@SBK6401/r18z7VIm6</a>
Part 2: <a href=https://hackmd.io/@SBK6401/ByFhEE8X6>https://hackmd.io/@SBK6401/ByFhEE8X6</a>
Part 4: <a href=https://hackmd.io/@SBK6401/H1rAEV87p>https://hackmd.io/@SBK6401/H1rAEV87p</a></p><p>:::spoiler TOC
[TOC]
:::</p><h2 id=tools>Tools:
<a class=anchor href=#tools>#</a></h2><ul><li>FTK Imager</li><li>Registry Explorer</li><li>RegRipper</li><li>HxD</li><li>DB Browser for SQLite</li><li>HindSight</li><li>Event Log Explorer</li><li>MFTDump</li></ul><h2 id=q19>==Q19==
<a class=anchor href=#q19>#</a></h2><blockquote><p>Which user installed LibreCAD on the system?</p></blockquote><h3 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h3><p>我是直接看該檔案在哪個user的資料夾來判斷，當然這個做法有點問題</p><p>:::spoiler Flag
Flag: <code>miriam.grapes</code>
:::</p><h2 id=q20>==Q20==
<a class=anchor href=#q20>#</a></h2><blockquote><p>How many times &ldquo;admin&rdquo; logged into the system?</p></blockquote><h3 id=recon>Recon
<a class=anchor href=#recon>#</a></h3><p>呈第14題</p><h3 id=exploit-1>Exploit
<a class=anchor href=#exploit-1>#</a></h3><p>不過我不知道為甚麼答案是21，然後我只有找到20個，看了4672也沒有紀錄(怪怪的)
<img src=https://hackmd.io/_uploads/Syfldc8Xa.png alt=圖片.png></p><p>:::spoiler Flag
Flag: <code>21</code>
:::</p><h2 id=q21>==Q21==
<a class=anchor href=#q21>#</a></h2><blockquote><p>What is the name of the DHCP domain the device was connected to?</p></blockquote><h3 id=recon-1>Recon
<a class=anchor href=#recon-1>#</a></h3><p>直接看<code>SYSTEM/ControlSet001/Services/Tcpip/Parameters/Interfaces/</code>
<img src=https://hackmd.io/_uploads/HJqjU5IQ6.png alt=圖片.png></p><p>:::spoiler Flag
Flag: <code>fruitinc.xyz</code>
:::</p><h2 id=q22>==Q22==
<a class=anchor href=#q22>#</a></h2><blockquote><p>What time did Tim download his background image?
(Oh Boy 3AM . Answer in MM/DD/YYYY HH:MM format (UTC).)</p></blockquote><h3 id=recon-2>Recon
<a class=anchor href=#recon-2>#</a></h3><p>原本的直覺是像第18題一樣把db file export出來看他的網路操作行為，不過其實可以直接看他下載的file，看他的create time就好</p><h3 id=exploit-2>Exploit
<a class=anchor href=#exploit-2>#</a></h3><p><img src=https://hackmd.io/_uploads/SJfBFLvXa.png alt=圖片.png></p><p>:::spoiler Flag
Flag: <code>04/05/2020 03:49</code>
:::</p><h2 id=q23>==Q23==
<a class=anchor href=#q23>#</a></h2><blockquote><p>How many times did Jim launch the Tor Browser?</p></blockquote><h3 id=exploit-3>Exploit
<a class=anchor href=#exploit-3>#</a></h3><p>直接把Jim的NTUSER.dat export出來後用timeline explorer看userassist，不過我不確定為甚麼答案是2，因為我查到的都是3
<img src=https://hackmd.io/_uploads/rJz_098Q6.png alt=圖片.png>
<img src=https://hackmd.io/_uploads/ByTKR9UmT.png alt=圖片.png>
還有另外一個方法是看prefetch，從FTK中export出<code>TOR.EXE-4B50033F.pf</code>，用PECmd.exe解析，但這個更怪了，結果顯示只有執行過一次，所以prefetch參考就好
:::spoiler</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./PECmd.exe -f TOR.EXE-4B50033F.pf
</span></span><span style=display:flex><span>PECmd version 1.5.0.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Author: Eric Zimmerman <span style=color:#f92672>(</span>saericzimmerman@gmail.com<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>https://github.com/EricZimmerman/PECmd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Command line: -f TOR.EXE-4B50033F.pf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Keywords: temp, tmp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Processing TOR.EXE-4B50033F.pf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Created on: 2023-11-06 17:15:55
</span></span><span style=display:flex><span>Modified on: 2020-04-16 04:52:40
</span></span><span style=display:flex><span>Last accessed on: 2023-11-06 17:17:52
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Executable name: TOR.EXE
</span></span><span style=display:flex><span>Hash: 4B50033F
</span></span><span style=display:flex><span>File size <span style=color:#f92672>(</span>bytes<span style=color:#f92672>)</span>: 88,080
</span></span><span style=display:flex><span>Version: Windows <span style=color:#ae81ff>10</span> or Windows <span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Run count: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Last run: 2020-04-16 04:52:30
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Volume information:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#0: Name: \VOLUME{01d60963b1096880-ecb16432} Serial: ECB16432 Created: 2020-04-03 02:58:03 Directories: 11 File references: 71</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Directories referenced: <span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>00: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1
</span></span><span style=display:flex><span>01: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER
</span></span><span style=display:flex><span>02: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER
</span></span><span style=display:flex><span>03: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA
</span></span><span style=display:flex><span>04: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR
</span></span><span style=display:flex><span>05: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\T</span>OR
</span></span><span style=display:flex><span>06: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS
</span></span><span style=display:flex><span>07: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\G</span>LOBALIZATION
</span></span><span style=display:flex><span>08: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\G</span>LOBALIZATION<span style=color:#ae81ff>\S</span>ORTING
</span></span><span style=display:flex><span>09: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32
</span></span><span style=display:flex><span>10: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\E</span>N-US
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Files referenced: <span style=color:#ae81ff>58</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>00: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\N</span>TDLL.DLL
</span></span><span style=display:flex><span>01: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\T</span>OR.EXE <span style=color:#f92672>(</span>Executable: True<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>02: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\K</span>ERNEL32.DLL
</span></span><span style=display:flex><span>03: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\K</span>ERNELBASE.DLL
</span></span><span style=display:flex><span>04: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\L</span>OCALE.NLS
</span></span><span style=display:flex><span>05: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\A</span>DVAPI32.DLL
</span></span><span style=display:flex><span>06: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\M</span>SVCRT.DLL
</span></span><span style=display:flex><span>07: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\S</span>ECHOST.DLL
</span></span><span style=display:flex><span>08: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\R</span>PCRT4.DLL
</span></span><span style=display:flex><span>09: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\S</span>HELL32.DLL
</span></span><span style=display:flex><span>10: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\C</span>FGMGR32.DLL
</span></span><span style=display:flex><span>11: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\U</span>CRTBASE.DLL
</span></span><span style=display:flex><span>12: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\S</span>HCORE.DLL
</span></span><span style=display:flex><span>13: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\C</span>OMBASE.DLL
</span></span><span style=display:flex><span>14: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\B</span>CRYPTPRIMITIVES.DLL
</span></span><span style=display:flex><span>15: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\W</span>INDOWS.STORAGE.DLL
</span></span><span style=display:flex><span>16: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\S</span>HLWAPI.DLL
</span></span><span style=display:flex><span>17: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\G</span>DI32.DLL
</span></span><span style=display:flex><span>18: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\G</span>DI32FULL.DLL
</span></span><span style=display:flex><span>19: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\M</span>SVCP_WIN.DLL
</span></span><span style=display:flex><span>20: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\U</span>SER32.DLL
</span></span><span style=display:flex><span>21: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\W</span>IN32U.DLL
</span></span><span style=display:flex><span>22: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\K</span>ERNEL.APPCORE.DLL
</span></span><span style=display:flex><span>23: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\P</span>OWRPROF.DLL
</span></span><span style=display:flex><span>24: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\P</span>ROFAPI.DLL
</span></span><span style=display:flex><span>25: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\W</span>S2_32.DLL
</span></span><span style=display:flex><span>26: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\$</span>MFT
</span></span><span style=display:flex><span>27: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\I</span>PHLPAPI.DLL
</span></span><span style=display:flex><span>28: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\L</span>IBSSP-0.DLL
</span></span><span style=display:flex><span>29: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\L</span>IBEVENT-2-1-6.DLL
</span></span><span style=display:flex><span>30: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\Z</span>LIB1.DLL
</span></span><span style=display:flex><span>31: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\L</span>IBWINPTHREAD-1.DLL
</span></span><span style=display:flex><span>32: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\L</span>IBSSL-1_1-X64.DLL
</span></span><span style=display:flex><span>33: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\L</span>IBCRYPTO-1_1-X64.DLL
</span></span><span style=display:flex><span>34: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\C</span>RYPTSP.DLL
</span></span><span style=display:flex><span>35: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\R</span>SAENH.DLL
</span></span><span style=display:flex><span>36: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\B</span>CRYPT.DLL
</span></span><span style=display:flex><span>37: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\G</span>LOBALIZATION<span style=color:#ae81ff>\S</span>ORTING<span style=color:#ae81ff>\S</span>ORTDEFAULT.NLS
</span></span><span style=display:flex><span>38: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\C</span>RYPTBASE.DLL
</span></span><span style=display:flex><span>39: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\I</span>MM32.DLL
</span></span><span style=display:flex><span>40: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\T</span>ORRC-DEFAULTS
</span></span><span style=display:flex><span>41: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\T</span>ORRC
</span></span><span style=display:flex><span>42: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\M</span>SWSOCK.DLL
</span></span><span style=display:flex><span>43: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\S</span>TATE
</span></span><span style=display:flex><span>44: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\C</span>ONTROL_AUTH_COOKIE.TMP <span style=color:#f92672>(</span>Keyword: True<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>45: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\G</span>EOIP
</span></span><span style=display:flex><span>46: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\G</span>EOIP6
</span></span><span style=display:flex><span>47: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\C</span>ACHED-CERTS
</span></span><span style=display:flex><span>48: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\E</span>N-US<span style=color:#ae81ff>\K</span>ERNELBASE.DLL.MUI
</span></span><span style=display:flex><span>49: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\C</span>ACHED-MICRODESC-CONSENSUS
</span></span><span style=display:flex><span>50: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\C</span>ACHED-MICRODESCS
</span></span><span style=display:flex><span>51: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\C</span>ACHED-MICRODESCS.NEW
</span></span><span style=display:flex><span>52: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\U</span>NVERIFIED-MICRODESC-CONSENSUS
</span></span><span style=display:flex><span>53: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\S</span>TATE.TMP <span style=color:#f92672>(</span>Keyword: True<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>54: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\N</span>SI.DLL
</span></span><span style=display:flex><span>55: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\D</span>HCPCSVC6.DLL
</span></span><span style=display:flex><span>56: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\W</span>INDOWS<span style=color:#ae81ff>\S</span>YSTEM32<span style=color:#ae81ff>\D</span>HCPCSVC.DLL
</span></span><span style=display:flex><span>57: <span style=color:#ae81ff>\V</span>OLUME<span style=color:#f92672>{</span>01d60963b1096880-ecb16432<span style=color:#f92672>}</span><span style=color:#ae81ff>\P</span>ROGRAM1<span style=color:#ae81ff>\B</span>ROWSER<span style=color:#ae81ff>\T</span>ORBROWSER<span style=color:#ae81ff>\D</span>ATA<span style=color:#ae81ff>\T</span>OR<span style=color:#ae81ff>\C</span>ACHED-MICRODESC-CONSENSUS.TMP <span style=color:#f92672>(</span>Keyword: True<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---------- Processed TOR.EXE-4B50033F.pf in 0.04772100 seconds ----------
</span></span></code></pre></div><p>:::</p><p>:::spoiler Flag
Flag: <code>2</code>
:::</p><h2 id=q24>==Q24==
<a class=anchor href=#q24>#</a></h2><blockquote><p>There is a png photo of an iPhone in Grapes&rsquo;s files. Find it and provide the SHA-1 hash.</p></blockquote><h3 id=recon-3>Recon
<a class=anchor href=#recon-3>#</a></h3><p>看了第一個hint才知道有stego的成分在裡面，首先要找到藏圖片的檔案是哪一張，我判斷是<code>samplePhone.jpg</code>這一張</p><h3 id=exploit-4>Exploit
<a class=anchor href=#exploit-4>#</a></h3><p>有了圖片之後就是最擅長的misc基本操作，結果在binwalk的時候發現有附加檔案在裡面，就直接foremost提出來</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ binwalk -e samplePhone.jpg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span style=display:flex><span>--------------------------------------------------------------------------------
</span></span><span style=display:flex><span><span style=color:#ae81ff>5962</span>          0x174A          PNG image, <span style=color:#ae81ff>1000</span> x 1000, 8-bit/color RGBA, non-interlaced
</span></span><span style=display:flex><span><span style=color:#ae81ff>6003</span>          0x1773          Zlib compressed data, best compression
</span></span><span style=display:flex><span>$ foremost -v samplePhone.jpg
</span></span><span style=display:flex><span>Foremost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick Mikus
</span></span><span style=display:flex><span>Audit File
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Foremost started at Tue Nov  <span style=color:#ae81ff>7</span> 01:32:54 <span style=color:#ae81ff>2023</span>
</span></span><span style=display:flex><span>Invocation: foremost -v samplePhone.jpg
</span></span><span style=display:flex><span>Output directory: /mnt/d/NTU/CTF/CyberDefenders/CorporateSecrets/Exported File/output
</span></span><span style=display:flex><span>Configuration file: /etc/foremost.conf
</span></span><span style=display:flex><span>Processing: samplePhone.jpg
</span></span><span style=display:flex><span>|------------------------------------------------------------------
</span></span><span style=display:flex><span>File: samplePhone.jpg
</span></span><span style=display:flex><span>Start: Tue Nov  <span style=color:#ae81ff>7</span> 01:32:54 <span style=color:#ae81ff>2023</span>
</span></span><span style=display:flex><span>Length: <span style=color:#ae81ff>164</span> KB <span style=color:#f92672>(</span><span style=color:#ae81ff>167947</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Num      Name <span style=color:#f92672>(</span>bs<span style=color:#f92672>=</span>512<span style=color:#f92672>)</span>         Size      File Offset     Comment
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>0:      00000011.png         <span style=color:#ae81ff>158</span> KB            <span style=color:#ae81ff>5962</span>       <span style=color:#f92672>(</span><span style=color:#ae81ff>1000</span> x 1000<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>*|
</span></span><span style=display:flex><span>Finish: Tue Nov  <span style=color:#ae81ff>7</span> 01:32:54 <span style=color:#ae81ff>2023</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> FILES EXTRACTED
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>png:<span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>------------------------------------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Foremost finished at Tue Nov  <span style=color:#ae81ff>7</span> 01:32:54 <span style=color:#ae81ff>2023</span>
</span></span><span style=display:flex><span>$ cd output/png
</span></span><span style=display:flex><span>$ file *
</span></span><span style=display:flex><span>00000011.png: PNG image data, <span style=color:#ae81ff>1000</span> x 1000, 8-bit/color RGBA, non-interlaced
</span></span></code></pre></div><p><img src=https://hackmd.io/_uploads/BJMD8sUX6.png alt=圖片.png></p><p>:::info
也可以像<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>直接用<code>$ binwalk --dd=".*" samplePhone.jpg</code>，一樣可以解壓縮出原本的圖片
:::</p><p>:::spoiler Flag
Flag: <code>537fe19a560ba3578d2f9095dc2f591489ff2cde</code>
:::</p><h2 id=q25>==Q25==
<a class=anchor href=#q25>#</a></h2><blockquote><p>When was the last time a docx file was opened on the device?
(An apple a day keeps the docx away. Answer in UTC, YYYY-MM-DD HH:MM:SS)</p></blockquote><h3 id=recon-4>Recon
<a class=anchor href=#recon-4>#</a></h3><p>我原本的直覺是想可以parse $MFT或是該檔案的lnk去看他的改動時間，但很不幸的MFT沒有這筆資料(?)，另外也沒有lnk檔案，所以只能通靈，以下解題過程是參考解完的hint</p><h3 id=exploit-5>Exploit
<a class=anchor href=#exploit-5>#</a></h3><p>直接看RecentDocs的資訊就找的到了，該紀錄在Jim的NTUSER.DAT中，<code>Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</code>
<img src=https://hackmd.io/_uploads/SJvJlOw7p.png alt=圖片.png></p><p>:::spoiler Flag
Flag: <code>2020-04-11 23:23:36</code>
:::</p><h2 id=q26>==Q26==
<a class=anchor href=#q26>#</a></h2><blockquote><p>How many entries does the MFT of the filesystem have?</p></blockquote><h3 id=exploit-6>Exploit
<a class=anchor href=#exploit-6>#</a></h3><p>我是直接在<code>/root</code>的地方export出$MFT file，然後去看magic header(<code>FILE0</code>)的數量有多少(<code>219811</code>)，但這樣不準確(不清楚為甚麼)，我記得之前<a href=https://hackmd.io/@SBK6401/HJ-hG7Kzp#Lab---Offset-43110400d>@Jimmy說過</a></p><blockquote><p>$MFT長度一段就是1024 Bytes(0x400)</p></blockquote><p>所以我想說可以把最後出現的位置除已0x400可能就是答案$\to 0xd6aac00/0x400=219819.0$
<img src=https://hackmd.io/_uploads/BkUuMwDmp.png alt=圖片.png></p><ul><li>方法一
不過以上的方法是確實可行的，因為計算entries不是只要看有多少有紀錄的File，而是整個$MFT有多少空間，意思是我們要看最後位址是多少再除以0x400，而不是只算到最後一個FILE0的地方就直接除已0x400
<img src=https://hackmd.io/_uploads/SJCs2DwX6.png alt=圖片.png>
該檔案的最後位址是在0xd6bfff0
$(0xd6bfff0+0x10)/0x400 = 219904.0$
加上0x10是因為要算出完整的0x400才算一個，也就是我們要算最後一個就要padding</li><li>方法二
後來參考<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>才知道比較正確的解法<ol><li>clone <a href=https://github.com/mcs6502/mftdump/blob/master/mftdump.py>mftdump</a></li><li>create python 2 environment</li><li>dump mft file<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ conda activate py27
</span></span><span style=display:flex><span>$ python mftdump.py <span style=color:#e6db74>&#34;MFT&#34;</span> &gt; MFTdumpOutput.txt
</span></span></code></pre></div></li><li>看解出多少entries再扣掉最前面兩行不算的部分
<img src=https://hackmd.io/_uploads/HJ20owwQp.png alt=圖片.png>
<img src=https://hackmd.io/_uploads/SkmssPvXa.png alt=圖片.png>
$219906-2=219904$</li></ol></li></ul><p>:::spoiler Flag
Flag: <code>219904</code>
:::</p><h2 id=q27>==Q27==
<a class=anchor href=#q27>#</a></h2><blockquote><p>Tim wanted to fire an employee because they were &mldr;&mldr;?(Be careful what you wish for)</p></blockquote><h3 id=exploit-7>Exploit
<a class=anchor href=#exploit-7>#</a></h3><p>呈第15題，直接看Tim的瀏覽紀錄就會知道了</p><p>:::spoiler Flag
Flag: <code>stinky</code>
:::</p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://forensicskween.com/ctf/cyberdefenders/corporatesecrets/>CyberDefenders: CorporateSecrets</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#tools>Tools:</a></li><li><a href=#q19>==Q19==</a><ul><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#q20>==Q20==</a><ul><li><a href=#recon>Recon</a></li><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#q21>==Q21==</a><ul><li><a href=#recon-1>Recon</a></li></ul></li><li><a href=#q22>==Q22==</a><ul><li><a href=#recon-2>Recon</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#q23>==Q23==</a><ul><li><a href=#exploit-3>Exploit</a></li></ul></li><li><a href=#q24>==Q24==</a><ul><li><a href=#recon-3>Recon</a></li><li><a href=#exploit-4>Exploit</a></li></ul></li><li><a href=#q25>==Q25==</a><ul><li><a href=#recon-4>Recon</a></li><li><a href=#exploit-5>Exploit</a></li></ul></li><li><a href=#q26>==Q26==</a><ul><li><a href=#exploit-6>Exploit</a></li></ul></li><li><a href=#q27>==Q27==</a><ul><li><a href=#exploit-7>Exploit</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>