<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  CyberDefender - Szechuan Sauce (Part 2)
  #

Challenge: https://cyberdefenders.org/blueteam-ctf-challenges/31
Part 1: https://hackmd.io/@SBK6401/rkp952e76
:::spoiler TOC
[TOC]
:::

  Scenario
  #


An employee at a large company was assigned a task with a two-day deadline. Realizing that he could not complete the task in that timeframe, he sought help from someone else. After one day, he received a notification from that person who informed him that he had managed to finish the assignment and sent it to the employee as a test. However, the person also sent a message to the employee stating that if he wanted the completed assignment, he would have to pay $160."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/cyberdefender/endpoint-forensic/szechuan-sauce---medium/cyberdefender---szechuan-sauce-part-2/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CyberDefender - Szechuan Sauce (Part 2)"><meta property="og:description" content="CyberDefender - Szechuan Sauce (Part 2) # Challenge: https://cyberdefenders.org/blueteam-ctf-challenges/31 Part 1: https://hackmd.io/@SBK6401/rkp952e76
:::spoiler TOC [TOC] :::
Scenario # An employee at a large company was assigned a task with a two-day deadline. Realizing that he could not complete the task in that timeframe, he sought help from someone else. After one day, he received a notification from that person who informed him that he had managed to finish the assignment and sent it to the employee as a test. However, the person also sent a message to the employee stating that if he wanted the completed assignment, he would have to pay $160."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CyberDefender"><meta property="article:tag" content="Endpoint Forensics"><title>CyberDefender - Szechuan Sauce (Part 2) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/cyberdefender/endpoint-forensic/szechuan-sauce---medium/cyberdefender---szechuan-sauce-part-2/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CyberDefender - Szechuan Sauce (Part 2)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#scenario>Scenario</a></li><li><a href=#tools>Tools</a></li><li><a href=#q11>==Q11==</a><ul><li><a href=#recon>Recon</a></li></ul></li><li><a href=#q12>==Q12==</a><ul><li><a href=#recon-1>Recon</a></li></ul></li><li><a href=#q13>==Q13==</a><ul><li><a href=#recon-2>Recon</a></li><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#q14>==Q14==</a><ul><li><a href=#background>Background</a></li><li><a href=#recon-3>Recon</a></li><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#q15>==Q15==</a><ul><li><a href=#recon-4>Recon</a></li></ul></li><li><a href=#q16>==Q16==</a><ul><li><a href=#recon-5>Recon</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#q17>==Q17==</a><ul><li><a href=#recon-6>Recon</a></li><li><a href=#exploit-3>Exploit</a></li></ul></li><li><a href=#q18>==Q18==</a><ul><li><a href=#recon-7>Recon</a></li></ul></li><li><a href=#q19>==Q19==</a><ul><li><a href=#exploit-4>Exploit</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=cyberdefender---szechuan-sauce-part-2>CyberDefender - Szechuan Sauce (Part 2)
<a class=anchor href=#cyberdefender---szechuan-sauce-part-2>#</a></h1><p>Challenge: <a href=https://cyberdefenders.org/blueteam-ctf-challenges/31>https://cyberdefenders.org/blueteam-ctf-challenges/31</a>
Part 1: <a href=https://hackmd.io/@SBK6401/rkp952e76>https://hackmd.io/@SBK6401/rkp952e76</a></p><p>:::spoiler TOC
[TOC]
:::</p><h2 id=scenario>Scenario
<a class=anchor href=#scenario>#</a></h2><blockquote><p>An employee at a large company was assigned a task with a two-day deadline. Realizing that he could not complete the task in that timeframe, he sought help from someone else. After one day, he received a notification from that person who informed him that he had managed to finish the assignment and sent it to the employee as a test. However, the person also sent a message to the employee stating that if he wanted the completed assignment, he would have to pay $160.</p><p>The helper&rsquo;s demand for payment revealed that he was actually a threat actor. The company&rsquo;s digital forensics team was called in to investigate and identify the attacker, determine the extent of the attack, and assess potential data breaches. The team must analyze the employee&rsquo;s computer and communication logs to prevent similar attacks in the future.</p></blockquote><h2 id=tools>Tools
<a class=anchor href=#tools>#</a></h2><ul><li>volatility2</li><li>FTK</li><li>Timeline Explorer</li><li>Wireshark</li><li>Registry Explorer</li></ul><h2 id=q11>==Q11==
<a class=anchor href=#q11>#</a></h2><blockquote><p>What&rsquo;s the name of the attack tool you think this malware belongs to? (one word)</p></blockquote><h3 id=recon>Recon
<a class=anchor href=#recon>#</a></h3><p>和malware相關的資訊，直覺會先看virustotal上的資訊，也的確發現答案的蹤跡</p><p>:::spoiler Flag
Flag: <code>Metasploit</code>
:::</p><h2 id=q12>==Q12==
<a class=anchor href=#q12>#</a></h2><blockquote><p>One of the involved malicious IP&rsquo;s is based in Thailand. What was the IP?</p></blockquote><h3 id=recon-1>Recon
<a class=anchor href=#recon-1>#</a></h3><p>這個在virustotal上也有完整的資訊，只能說那個network graph真的太屌了，不只清楚也很炫泡
<img src=https://hackmd.io/_uploads/BJw07aEX6.png alt=圖片.png></p><p>:::spoiler Flag
Flag: <code>203.78.103.109</code>
:::</p><h2 id=q13>==Q13==
<a class=anchor href=#q13>#</a></h2><blockquote><p>Another malicious IP once resolved to klient-293.xyz . What is this IP?</p></blockquote><h3 id=recon-2>Recon
<a class=anchor href=#recon-2>#</a></h3><p>我是直接在network packets裡面撈比較常見的IP，不過看<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>才知道也可以直接用virustotal搜URL</p><h3 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h3><ul><li>方法一:
我看最多次request的IP有點可疑
<img src=https://hackmd.io/_uploads/H12W_a4mT.png alt=圖片.png></li><li>方法二:
<img src=https://hackmd.io/_uploads/HJ1xYpEQa.png alt=圖片.png></li></ul><p>所以根據上一題可知我們現在有兩個可疑的IP，一個是傳送payload的IP$\to$<code>194.61.24.102</code>，而另外一個是駭客的C2 server(在泰國的那個)$\to$<code>203.78.103.109</code></p><p>:::spoiler Flag
Flag: <code>194.61.24.102</code>
:::</p><h2 id=q14>==Q14==
<a class=anchor href=#q14>#</a></h2><blockquote><p>The attacker performed some lateral movements and accessed another system in the environment via RDP. What is the hostname of that system?</p></blockquote><h3 id=background>Background
<a class=anchor href=#background>#</a></h3><ul><li><a href=https://netpc.pixnet.net/blog/post/12409336>LLMNR</a><blockquote><p>LLMNR 是定義於標題為 &ldquo;Link-local Multicast Name Resolution (LLMNR)&rdquo; (連結-本機多點傳送名稱解析 (LLMNR)) (draft-ietf-dnsext-mdns-47.txt) 之網際網路草稿中的通訊協定，同時允許 IPv6 和 IPv4 主機為鄰接電腦執行名稱解析，而不需設定 DNS 伺服器或 DNS 用戶端。</p><p>也就是，這是在LAN才會出現的，例如:嘗試使用WakeOnLan的時候，故若你沒有提出此要求，而發現有此封包在攻擊你的電腦時，它肯定就是病毒啦!!</p></blockquote></li><li><a href=https://learn.microsoft.com/zh-tw/windows/security/threat-protection/auditing/event-4624>Logon Type</a>
<img src=https://hackmd.io/_uploads/ByVq_0EXa.png alt=圖片.png></li></ul><h3 id=recon-3>Recon
<a class=anchor href=#recon-3>#</a></h3><p>這一題找很久，不管是從wireshark或是從timeline explorer，參考<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>才知道有比較正確的方式</p><h3 id=exploit-1>Exploit
<a class=anchor href=#exploit-1>#</a></h3><p>首先，攻擊的方向變成橫向移動，這件事情從rdp的封包就看的出來(內網和內網)
<img src=https://hackmd.io/_uploads/rkj7UCE7T.png alt=圖片.png></p><p>WP中有提到兩種解析方式，一種是看network packets，另外一種是看event log</p><ul><li>方法一
可以直接用LLMNR的protocol當作filter
<img src=https://hackmd.io/_uploads/r1SdBCVma.png alt=圖片.png></li><li>方法二
看了MSDN的logon type可以發現，如果是用RDP登入的話，要看type 10(RemoteInteractive)和3(使用者或電腦從網路登入這部電腦。)，所以橫向移動應該是logon type 3的範疇
<img src=https://hackmd.io/_uploads/rJ9EK0EX6.png alt=圖片.png></li></ul><p>:::spoiler Flag
Flag: <code>DESKTOP-SDN1RPT</code>
:::</p><h2 id=q15>==Q15==
<a class=anchor href=#q15>#</a></h2><blockquote><p>Other than the administrator, which user has logged into the Desktop machine? (two words)</p></blockquote><h3 id=recon-4>Recon
<a class=anchor href=#recon-4>#</a></h3><p>這一題直覺就是延續上一題的狀況，直接看timeline explorer有登入的target
<img src=https://hackmd.io/_uploads/HyOgT0E76.png alt=圖片.png></p><p>:::spoiler Flag
Flag: <code>rick sanchez</code>
:::</p><h2 id=q16>==Q16==
<a class=anchor href=#q16>#</a></h2><blockquote><p>What was the password for &ldquo;jerrysmith&rdquo; account?</p></blockquote><h3 id=recon-5>Recon
<a class=anchor href=#recon-5>#</a></h3><p>原本的直覺是follow之前寫的<a href=https://hackmd.io/@SBK6401/S1KgaEz0h>0x13 - Brute Force SAM</a>可以爆破密碼，但我似乎搞錯題目的意思，應該說要找<code>jerrysmith</code>的密碼，直覺要對domain controller下手，不過應該不是找SAM hive，因為這個只有存取單一主機的認證authentication，所以如果要找儲存其他AD的密碼資訊，算是一個新的觀念:</p><p><a href=https://medium.com/@harikrishnanp006/understanding-ntds-dit-the-core-of-active-directory-faac54cc628a>What is NTDS.DIT?</a></p><blockquote><p>NTDS.DIT stands for New Technology Directory Services Directory Information Tree. It serves as the primary database file within Microsoft’s Active Directory Domain Services (AD DS). Essentially, NTDS.DIT stores and organizes all the information related to objects in the domain, including users, groups, computers, and more. It acts as the backbone of Active Directory, housing critical data such as user account details, passwords, group memberships, and other object attributes.</p></blockquote><h3 id=exploit-2>Exploit
<a class=anchor href=#exploit-2>#</a></h3><ol><li><p>Export NTDS.DIT & SYSTEM
NTDS.DIT在Domain Server的<code>C:\Windows\NTDS\ntds.dit</code>，而SYSTEM在<code>C:\Windows\System32\config\SAM</code></p></li><li><p>用Kali裡面的<a href=https://www.kali.org/tools/impacket/><code>impacket-secretsdump</code></a>轉成hash
:::spoiler Result</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ impacket-secretsdump -system SYSTEM -ntds ntds.dit LOCAL -outputfile hashes.txt
</span></span><span style=display:flex><span>Impacket v0.11.0 - Copyright <span style=color:#ae81ff>2023</span> Fortra
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Target system bootKey: 0xdfa37c24984935de32e2063e02918c28
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Dumping Domain Credentials <span style=color:#f92672>(</span>domain<span style=color:#ae81ff>\u</span>id:rid:lmhash:nthash<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Searching <span style=color:#66d9ef>for</span> pekList, be patient
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> PEK <span style=color:#75715e># 0 found and decrypted: 6e884ac48cd2aa3a8d5f50c64d4bc38a</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Reading and decrypting hashes from ntds.dit 
</span></span><span style=display:flex><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:10e63d3f2c9924bae49241cff847e405:::
</span></span><span style=display:flex><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>CITADEL-DC01$:1001:aad3b435b51404eeaad3b435b51404ee:33c082748b7d35ec846a513b7be92d94:::
</span></span><span style=display:flex><span>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:25c9610b742a5bca9aa3801c08b8ca4e:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\j</span>errysmith:1104:aad3b435b51404eeaad3b435b51404ee:bc51f858ccacc9db408c0ba511d5d639:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\s</span>ummersmith:1105:aad3b435b51404eeaad3b435b51404ee:26b2cc706093c4fa46e0519ec5feaeaf:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\r</span>icksanchez:1106:aad3b435b51404eeaad3b435b51404ee:746447f27820a9d863eea94d176cc135:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\m</span>ortysmith:1108:aad3b435b51404eeaad3b435b51404ee:dc8b282b8f4e1dd3c5f95fd491ff6d8d:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>ethsmith:1109:aad3b435b51404eeaad3b435b51404ee:b9cc9177094af2e17b413a0cbf63fac2:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>irdman:1118:aad3b435b51404eeaad3b435b51404ee:944055b77ebe7d6fd80f24b5fce634fb:::
</span></span><span style=display:flex><span>DESKTOP-SDN1RPT$:1602:aad3b435b51404eeaad3b435b51404ee:fa6ecdc900cbeeb623cfc92297e5b653:::
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Kerberos keys from ntds.dit 
</span></span><span style=display:flex><span>CITADEL-DC01$:aes256-cts-hmac-sha1-96:3635b6b22a960673e327ca4c378e162befa74ee56e46b3841b84cabecfc062e8
</span></span><span style=display:flex><span>CITADEL-DC01$:aes128-cts-hmac-sha1-96:9324dad1f82699bf65cdbfd5a4572067
</span></span><span style=display:flex><span>CITADEL-DC01$:des-cbc-md5:94abfd29f1929d19
</span></span><span style=display:flex><span>krbtgt:aes256-cts-hmac-sha1-96:141aca9186cc33caa6ef3db5cf3a53b783bd29e7431a153c89f8b1d4562de7f1
</span></span><span style=display:flex><span>krbtgt:aes128-cts-hmac-sha1-96:d695009f7f7b6eb48a6b1b749493f199
</span></span><span style=display:flex><span>krbtgt:des-cbc-md5:b025018c62ec023b
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\j</span>errysmith:aes256-cts-hmac-sha1-96:87eb9c5715de1eb078cc6691871672019356976f093348c03b0ca21a75fc0e9f
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\j</span>errysmith:aes128-cts-hmac-sha1-96:ea468a0f250c15fea4e8f4c74d20c56e
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\j</span>errysmith:des-cbc-md5:7c40d03464e5e9a8
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\s</span>ummersmith:aes256-cts-hmac-sha1-96:38060a9e953e8dde6e991db5de72e566c8a652c195b0e88d9c81e26d05ee1ce5
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\s</span>ummersmith:aes128-cts-hmac-sha1-96:8851e24f50c80026e2e1578a2a3d3802
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\s</span>ummersmith:des-cbc-md5:3bd09e3b73bfb0f4
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\r</span>icksanchez:aes256-cts-hmac-sha1-96:08bc14d8f69e1ceadd0079303cd1bc434ed61d6a4895f71073662ff24eb8e4dd
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\r</span>icksanchez:aes128-cts-hmac-sha1-96:0c428543d20db44c45cbf6948b4cf5d4
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\r</span>icksanchez:des-cbc-md5:cdf891a75889f107
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\m</span>ortysmith:aes256-cts-hmac-sha1-96:ee5442baa6535d2580ac694ac6c0cbe3a65f137ba3ace39a18cba58a160ce73c
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\m</span>ortysmith:aes128-cts-hmac-sha1-96:697ece25fd3cffbfa24d82ab9789596c
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\m</span>ortysmith:des-cbc-md5:3280f79b131aea4c
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>ethsmith:aes256-cts-hmac-sha1-96:1e98c29b4ba43d21d200bd1802ff5109c0549621931e2f3af0c0809099405b88
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>ethsmith:aes128-cts-hmac-sha1-96:ea3285637fe5bb216bcd5cd0cfbc6663
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>ethsmith:des-cbc-md5:151f891ff4cb6b4f
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>irdman:aes256-cts-hmac-sha1-96:f20039a71fad3a9a0a374c09e55f1d1bed1600c2329fee84aada8a502d903023
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>irdman:aes128-cts-hmac-sha1-96:6507f6ac1b4ec9c23e65d1528ec92ec1
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>irdman:des-cbc-md5:2f4068527aeafb85
</span></span><span style=display:flex><span>DESKTOP-SDN1RPT$:aes256-cts-hmac-sha1-96:424f9a36c72c7bec7a2f7082111ed818c375e8945e6cfc9bc599b6587fb1b3ea
</span></span><span style=display:flex><span>DESKTOP-SDN1RPT$:aes128-cts-hmac-sha1-96:14122a1520d70f1dc6fccbf8aee330b0
</span></span><span style=display:flex><span>DESKTOP-SDN1RPT$:des-cbc-md5:6d20ad583729b03e
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Cleaning up...
</span></span><span style=display:flex><span>$ cat hashes.txt.ntds
</span></span><span style=display:flex><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:10e63d3f2c9924bae49241cff847e405:::
</span></span><span style=display:flex><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>CITADEL-DC01$:1001:aad3b435b51404eeaad3b435b51404ee:33c082748b7d35ec846a513b7be92d94:::
</span></span><span style=display:flex><span>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:25c9610b742a5bca9aa3801c08b8ca4e:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\j</span>errysmith:1104:aad3b435b51404eeaad3b435b51404ee:bc51f858ccacc9db408c0ba511d5d639:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\s</span>ummersmith:1105:aad3b435b51404eeaad3b435b51404ee:26b2cc706093c4fa46e0519ec5feaeaf:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\r</span>icksanchez:1106:aad3b435b51404eeaad3b435b51404ee:746447f27820a9d863eea94d176cc135:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\m</span>ortysmith:1108:aad3b435b51404eeaad3b435b51404ee:dc8b282b8f4e1dd3c5f95fd491ff6d8d:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>ethsmith:1109:aad3b435b51404eeaad3b435b51404ee:b9cc9177094af2e17b413a0cbf63fac2:::
</span></span><span style=display:flex><span>C137.local<span style=color:#ae81ff>\b</span>irdman:1118:aad3b435b51404eeaad3b435b51404ee:944055b77ebe7d6fd80f24b5fce634fb:::
</span></span><span style=display:flex><span>DESKTOP-SDN1RPT$:1602:aad3b435b51404eeaad3b435b51404ee:fa6ecdc900cbeeb623cfc92297e5b653:::
</span></span></code></pre></div><p>:::</p></li><li><p>Brute Force</p><ul><li><a href=https://www.cmd5.com/>Online Tool 1</a></li><li><a href=https://hashes.com/en/decrypt/hash>Online Tool 2</a></li><li>john:
<code>$ john hashes.txt.ntds --format=NT</code></li></ul><p>我是直接用第二個線上工具解出一半的密碼，如下:</p><pre tabindex=0><code>10e63d3f2c9924bae49241cff847e405:)&amp;Denver89
31d6cfe0d16ae931b73c59d7e0c089c0:
33c082748b7d35ec846a513b7be92d94: (None)
25c9610b742a5bca9aa3801c08b8ca4e: (None)
bc51f858ccacc9db408c0ba511d5d639: !BETHEYBOO12!
26b2cc706093c4fa46e0519ec5feaeaf: (None)
746447f27820a9d863eea94d176cc135: (None)
dc8b282b8f4e1dd3c5f95fd491ff6d8d: Jessica@1
b9cc9177094af2e17b413a0cbf63fac2: RedWine1!
944055b77ebe7d6fd80f24b5fce634fb: (dimension5150)
fa6ecdc900cbeeb623cfc92297e5b653: (None)
</code></pre></li></ol><p>:::spoiler Flag
Flag: <code>!BETHEYBOO12!</code>
:::</p><h2 id=q17>==Q17==
<a class=anchor href=#q17>#</a></h2><blockquote><p>What was the original filename for Beth’s secrets?</p></blockquote><h3 id=recon-6>Recon
<a class=anchor href=#recon-6>#</a></h3><p>直覺會用volatility看filescan的結果，不過沒有甚麼收穫，看了答案的hint才知道要去撈recycle bin的東西(誰知道啊)</p><h3 id=exploit-3>Exploit
<a class=anchor href=#exploit-3>#</a></h3><p><img src=https://hackmd.io/_uploads/rysZqVH76.png alt=圖片.png></p><p>:::spoiler Flag
Flag: <code>SECRET_beth.txt</code>
:::</p><h2 id=q18>==Q18==
<a class=anchor href=#q18>#</a></h2><blockquote><p>What was the content of Beth’s secret file? ( six words, spaces in between)</p></blockquote><h3 id=recon-7>Recon
<a class=anchor href=#recon-7>#</a></h3><p>直接呈上題，下一個檔案就是他的file content</p><p>:::spoiler Flag
Flag: <code>Earth beth is the real beth</code>
:::</p><h2 id=q19>==Q19==
<a class=anchor href=#q19>#</a></h2><blockquote><p>The malware tried to obtain persistence in a similar way to how Carbanak malware obtains persistence. What is the corresponding MITRE technique ID?</p></blockquote><h3 id=exploit-4>Exploit
<a class=anchor href=#exploit-4>#</a></h3><p>直接看Carbanak的MITRE頁面，詳細的訊息可以看<a href=https://attack.mitre.org/groups/G0008/>這邊</a></p><p>:::spoiler Flag
Flag: <code>T1543.003</code>
:::</p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://ellisstannard.medium.com/cyberdefenders-szechuan-sauce-writeup-ab172eb7666c>CyberDefenders: Szechuan Sauce CTF Writeup</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#scenario>Scenario</a></li><li><a href=#tools>Tools</a></li><li><a href=#q11>==Q11==</a><ul><li><a href=#recon>Recon</a></li></ul></li><li><a href=#q12>==Q12==</a><ul><li><a href=#recon-1>Recon</a></li></ul></li><li><a href=#q13>==Q13==</a><ul><li><a href=#recon-2>Recon</a></li><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#q14>==Q14==</a><ul><li><a href=#background>Background</a></li><li><a href=#recon-3>Recon</a></li><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#q15>==Q15==</a><ul><li><a href=#recon-4>Recon</a></li></ul></li><li><a href=#q16>==Q16==</a><ul><li><a href=#recon-5>Recon</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#q17>==Q17==</a><ul><li><a href=#recon-6>Recon</a></li><li><a href=#exploit-3>Exploit</a></li></ul></li><li><a href=#q18>==Q18==</a><ul><li><a href=#recon-7>Recon</a></li></ul></li><li><a href=#q19>==Q19==</a><ul><li><a href=#exploit-4>Exploit</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>