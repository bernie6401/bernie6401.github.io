<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  PicoCTF - asm4
  #


  Description
  #


What will asm4(&ldquo;picoCTF_f97bb&rdquo;) return? Submit the flag as a hexadecimal value (starting with &lsquo;0x&rsquo;). NOTE: Your submission for this question will NOT be in the normal flag format.

  Source code
  #

:::spoiler Source Code
asm4:
	<+0>:	push   ebp
	<+1>:	mov    ebp,esp
	<+3>:	push   ebx
	<+4>:	sub    esp,0x10
	<+7>:	mov    DWORD PTR [ebp-0x10],0x27a
	<+14>:	mov    DWORD PTR [ebp-0xc],0x0
	<+21>:	jmp    0x518 <asm4+27>
	<+23>:	add    DWORD PTR [ebp-0xc],0x1
	<+27>:	mov    edx,DWORD PTR [ebp-0xc]
	<+30>:	mov    eax,DWORD PTR [ebp+0x8]
	<+33>:	add    eax,edx
	<+35>:	movzx  eax,BYTE PTR [eax]
	<+38>:	test   al,al
	<+40>:	jne    0x514 <asm4+23>
	<+42>:	mov    DWORD PTR [ebp-0x8],0x1
	<+49>:	jmp    0x587 <asm4+138>
	<+51>:	mov    edx,DWORD PTR [ebp-0x8]
	<+54>:	mov    eax,DWORD PTR [ebp+0x8]
	<+57>:	add    eax,edx
	<+59>:	movzx  eax,BYTE PTR [eax]
	<+62>:	movsx  edx,al
	<+65>:	mov    eax,DWORD PTR [ebp-0x8]
	<+68>:	lea    ecx,[eax-0x1]
	<+71>:	mov    eax,DWORD PTR [ebp+0x8]
	<+74>:	add    eax,ecx
	<+76>:	movzx  eax,BYTE PTR [eax]
	<+79>:	movsx  eax,al
	<+82>:	sub    edx,eax
	<+84>:	mov    eax,edx
	<+86>:	mov    edx,eax
	<+88>:	mov    eax,DWORD PTR [ebp-0x10]
	<+91>:	lea    ebx,[edx+eax*1]
	<+94>:	mov    eax,DWORD PTR [ebp-0x8]
	<+97>:	lea    edx,[eax+0x1]
	<+100>:	mov    eax,DWORD PTR [ebp+0x8]
	<+103>:	add    eax,edx
	<+105>:	movzx  eax,BYTE PTR [eax]
	<+108>:	movsx  edx,al
	<+111>:	mov    ecx,DWORD PTR [ebp-0x8]
	<+114>:	mov    eax,DWORD PTR [ebp+0x8]
	<+117>:	add    eax,ecx
	<+119>:	movzx  eax,BYTE PTR [eax]
	<+122>:	movsx  eax,al
	<+125>:	sub    edx,eax
	<+127>:	mov    eax,edx
	<+129>:	add    eax,ebx
	<+131>:	mov    DWORD PTR [ebp-0x10],eax
	<+134>:	add    DWORD PTR [ebp-0x8],0x1
	<+138>:	mov    eax,DWORD PTR [ebp-0xc]
	<+141>:	sub    eax,0x1
	<+144>:	cmp    DWORD PTR [ebp-0x8],eax
	<+147>:	jl     0x530 <asm4+51>
	<+149>:	mov    eax,DWORD PTR [ebp-0x10]
	<+152>:	add    esp,0x10
	<+155>:	pop    ebx
	<+156>:	pop    ebp
	<+157>:	ret    
:::"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/reverse/picoctf---asm4/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - asm4"><meta property="og:description" content="PicoCTF - asm4 # Description # What will asm4(“picoCTF_f97bb”) return? Submit the flag as a hexadecimal value (starting with ‘0x’). NOTE: Your submission for this question will NOT be in the normal flag format.
Source code # :::spoiler Source Code
asm4: <+0>:	push ebp <+1>:	mov ebp,esp <+3>:	push ebx <+4>:	sub esp,0x10 <+7>:	mov DWORD PTR [ebp-0x10],0x27a <+14>:	mov DWORD PTR [ebp-0xc],0x0 <+21>:	jmp 0x518 <asm4+27> <+23>:	add DWORD PTR [ebp-0xc],0x1 <+27>:	mov edx,DWORD PTR [ebp-0xc] <+30>:	mov eax,DWORD PTR [ebp+0x8] <+33>:	add eax,edx <+35>:	movzx eax,BYTE PTR [eax] <+38>:	test al,al <+40>:	jne 0x514 <asm4+23> <+42>:	mov DWORD PTR [ebp-0x8],0x1 <+49>:	jmp 0x587 <asm4+138> <+51>:	mov edx,DWORD PTR [ebp-0x8] <+54>:	mov eax,DWORD PTR [ebp+0x8] <+57>:	add eax,edx <+59>:	movzx eax,BYTE PTR [eax] <+62>:	movsx edx,al <+65>:	mov eax,DWORD PTR [ebp-0x8] <+68>:	lea ecx,[eax-0x1] <+71>:	mov eax,DWORD PTR [ebp+0x8] <+74>:	add eax,ecx <+76>:	movzx eax,BYTE PTR [eax] <+79>:	movsx eax,al <+82>:	sub edx,eax <+84>:	mov eax,edx <+86>:	mov edx,eax <+88>:	mov eax,DWORD PTR [ebp-0x10] <+91>:	lea ebx,[edx+eax*1] <+94>:	mov eax,DWORD PTR [ebp-0x8] <+97>:	lea edx,[eax+0x1] <+100>:	mov eax,DWORD PTR [ebp+0x8] <+103>:	add eax,edx <+105>:	movzx eax,BYTE PTR [eax] <+108>:	movsx edx,al <+111>:	mov ecx,DWORD PTR [ebp-0x8] <+114>:	mov eax,DWORD PTR [ebp+0x8] <+117>:	add eax,ecx <+119>:	movzx eax,BYTE PTR [eax] <+122>:	movsx eax,al <+125>:	sub edx,eax <+127>:	mov eax,edx <+129>:	add eax,ebx <+131>:	mov DWORD PTR [ebp-0x10],eax <+134>:	add DWORD PTR [ebp-0x8],0x1 <+138>:	mov eax,DWORD PTR [ebp-0xc] <+141>:	sub eax,0x1 <+144>:	cmp DWORD PTR [ebp-0x8],eax <+147>:	jl 0x530 <asm4+51> <+149>:	mov eax,DWORD PTR [ebp-0x10] <+152>:	add esp,0x10 <+155>:	pop ebx <+156>:	pop ebp <+157>:	ret :::"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Reverse"><title>PicoCTF - asm4 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/reverse/picoctf---asm4/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - asm4</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#source-code>Source code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---asm4>PicoCTF - asm4
<a class=anchor href=#picoctf---asm4>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>What will asm4(&ldquo;picoCTF_f97bb&rdquo;) return? Submit the flag as a hexadecimal value (starting with &lsquo;0x&rsquo;). NOTE: Your submission for this question will NOT be in the normal flag format.</p></blockquote><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class=language-assembly data-lang=assembly>asm4:
	&lt;+0&gt;:	push   ebp
	&lt;+1&gt;:	mov    ebp,esp
	&lt;+3&gt;:	push   ebx
	&lt;+4&gt;:	sub    esp,0x10
	&lt;+7&gt;:	mov    DWORD PTR [ebp-0x10],0x27a
	&lt;+14&gt;:	mov    DWORD PTR [ebp-0xc],0x0
	&lt;+21&gt;:	jmp    0x518 &lt;asm4+27&gt;
	&lt;+23&gt;:	add    DWORD PTR [ebp-0xc],0x1
	&lt;+27&gt;:	mov    edx,DWORD PTR [ebp-0xc]
	&lt;+30&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+33&gt;:	add    eax,edx
	&lt;+35&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+38&gt;:	test   al,al
	&lt;+40&gt;:	jne    0x514 &lt;asm4+23&gt;
	&lt;+42&gt;:	mov    DWORD PTR [ebp-0x8],0x1
	&lt;+49&gt;:	jmp    0x587 &lt;asm4+138&gt;
	&lt;+51&gt;:	mov    edx,DWORD PTR [ebp-0x8]
	&lt;+54&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+57&gt;:	add    eax,edx
	&lt;+59&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+62&gt;:	movsx  edx,al
	&lt;+65&gt;:	mov    eax,DWORD PTR [ebp-0x8]
	&lt;+68&gt;:	lea    ecx,[eax-0x1]
	&lt;+71&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+74&gt;:	add    eax,ecx
	&lt;+76&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+79&gt;:	movsx  eax,al
	&lt;+82&gt;:	sub    edx,eax
	&lt;+84&gt;:	mov    eax,edx
	&lt;+86&gt;:	mov    edx,eax
	&lt;+88&gt;:	mov    eax,DWORD PTR [ebp-0x10]
	&lt;+91&gt;:	lea    ebx,[edx+eax*1]
	&lt;+94&gt;:	mov    eax,DWORD PTR [ebp-0x8]
	&lt;+97&gt;:	lea    edx,[eax+0x1]
	&lt;+100&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+103&gt;:	add    eax,edx
	&lt;+105&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+108&gt;:	movsx  edx,al
	&lt;+111&gt;:	mov    ecx,DWORD PTR [ebp-0x8]
	&lt;+114&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+117&gt;:	add    eax,ecx
	&lt;+119&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+122&gt;:	movsx  eax,al
	&lt;+125&gt;:	sub    edx,eax
	&lt;+127&gt;:	mov    eax,edx
	&lt;+129&gt;:	add    eax,ebx
	&lt;+131&gt;:	mov    DWORD PTR [ebp-0x10],eax
	&lt;+134&gt;:	add    DWORD PTR [ebp-0x8],0x1
	&lt;+138&gt;:	mov    eax,DWORD PTR [ebp-0xc]
	&lt;+141&gt;:	sub    eax,0x1
	&lt;+144&gt;:	cmp    DWORD PTR [ebp-0x8],eax
	&lt;+147&gt;:	jl     0x530 &lt;asm4+51&gt;
	&lt;+149&gt;:	mov    eax,DWORD PTR [ebp-0x10]
	&lt;+152&gt;:	add    esp,0x10
	&lt;+155&gt;:	pop    ebx
	&lt;+156&gt;:	pop    ebp
	&lt;+157&gt;:	ret    
</code></pre><p>:::</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題和前幾個系列的題目差不多，只是變得更臭更長，一直在找能夠動態執行的工具或腳本，不過忍不住看了<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>的script後，才發現自己幹一個比較快</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>asm4</span>(<span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> in)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> val;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>asm</span> (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;nop;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;nop;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;nop;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//&#34;push   ebp;&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//&#34;mov    ebp,esp;&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#e6db74>&#34;push   ebx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;sub    esp,0x10;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    DWORD PTR [ebp-0x10],0x27a;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    DWORD PTR [ebp-0xc],0x0;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;jmp    asm4_27;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;asm4_23:&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    DWORD PTR [ebp-0xc],0x1;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;asm4_27:&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    edx,DWORD PTR [ebp-0xc];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    eax,edx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;test   al,al;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;jne    asm4_23;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    DWORD PTR [ebp-0x8],0x1;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;jmp    asm4_138;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;asm4_51:&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    edx,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    eax,edx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movsx  edx,al;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;lea    ecx,[eax-0x1];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    eax,ecx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movsx  eax,al;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;sub    edx,eax;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,edx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    edx,eax;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [ebp-0x10];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;lea    ebx,[edx+eax*1];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;lea    edx,[eax+0x1];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    eax,edx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movsx  edx,al;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    ecx,DWORD PTR [ebp-0x8];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [%[pInput]];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    eax,ecx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movzx  eax,BYTE PTR [eax];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;movsx  eax,al;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;sub    edx,eax;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,edx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    eax,ebx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    DWORD PTR [ebp-0x10],eax;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    DWORD PTR [ebp-0x8],0x1;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;asm4_138:&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [ebp-0xc];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;sub    eax,0x1;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;cmp    DWORD PTR [ebp-0x8],eax;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;jl     asm4_51;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;mov    eax,DWORD PTR [ebp-0x10];&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;add    esp,0x10;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pop    ebx;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//&#34;pop    ebp;&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//&#34;ret    ;&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#e6db74>&#34;nop;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;nop;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;nop;&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>:</span><span style=color:#e6db74>&#34;=r&#34;</span>(val)
</span></span><span style=display:flex><span>            <span style=color:#f92672>:</span> [pInput] <span style=color:#e6db74>&#34;m&#34;</span>(in)
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> val;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span><span style=color:#f92672>**</span> argv)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    printf(<span style=color:#e6db74>&#34;0x%x</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, asm4(<span style=color:#e6db74>&#34;picoCTF_f97bb&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gcc -masm<span style=color:#f92672>=</span>intel -m32 exp.c -o exp
</span></span><span style=display:flex><span>$ ./exp
</span></span><span style=display:flex><span>0x265
</span></span></code></pre></div><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>[asm4](<a href=https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/asm4.md>https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/asm4.md</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#source-code>Source code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>