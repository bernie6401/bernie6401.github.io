<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  PicoCTF - File types
  #


  tags: PicoCTF CTF Misc
  #

Challenge: File types

  Background
  #


  For Shell Script
  #

Linux MD5
Linux egrep命令
Shell test 命令

-f 文件名: 如果文件存在且为普通文件则为真
How to modify $PATH
touch - time stamp
What is $$ in bash?

  For Compress Command
  #

Linux 備份檔案操作 cpio 指令教學與範例
bzip2 command in Linux
Gzip Command in Linux
Lzip Manual
lz4 manual
lzma manual
lzop(1) - Linux man page

  Source code
  #

:::spoiler Flag.pdf"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/misc/general/picoctf---file-types/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - File types"><meta property="og:description" content="PicoCTF - File types # tags: PicoCTF CTF Misc # Challenge: File types
Background # For Shell Script # Linux MD5 Linux egrep命令 Shell test 命令
-f 文件名: 如果文件存在且为普通文件则为真
How to modify $PATH touch - time stamp What is $$ in bash?
For Compress Command # Linux 備份檔案操作 cpio 指令教學與範例 bzip2 command in Linux Gzip Command in Linux Lzip Manual lz4 manual lzma manual lzop(1) - Linux man page
Source code # :::spoiler Flag.pdf"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><title>PicoCTF - File types | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/misc/general/picoctf---file-types/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - File types</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a><ul><li><a href=#for-shell-script>For Shell Script</a></li><li><a href=#for-compress-command>For Compress Command</a></li></ul></li><li><a href=#source-code>Source code</a></li><li><a href=#exploit---google-and-uncompress>Exploit - Google and Uncompress</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---file-types>PicoCTF - File types
<a class=anchor href=#picoctf---file-types>#</a></h1><h6 id=tags-picoctf-ctf-misc>tags: <code>PicoCTF</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-picoctf-ctf-misc>#</a></h6><p>Challenge: <a href>File types</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><h3 id=for-shell-script>For Shell Script
<a class=anchor href=#for-shell-script>#</a></h3><p><a href=https://blog.gtwang.org/linux/generate-verify-check-files-md5-sha1-checksum-linux/>Linux MD5</a>
<a href=https://www.runoob.com/linux/linux-comm-egrep.html>Linux egrep命令</a>
<a href=https://www.runoob.com/linux/linux-shell-test.html>Shell test 命令</a></p><blockquote><p>-f 文件名: 如果文件存在且为普通文件则为真</p></blockquote><p><a href=https://phoenixnap.com/kb/linux-add-to-path>How to modify $PATH</a>
<a href=https://blog.gtwang.org/linux/linux-touch-command-tutorial-examples/>touch - time stamp</a>
<a href=https://unix.stackexchange.com/questions/291570/what-is-in-bash>What is $$ in bash?</a></p><h3 id=for-compress-command>For Compress Command
<a class=anchor href=#for-compress-command>#</a></h3><p><a href=https://officeguide.cc/linux-copy-files-to-and-from-archives-cpio-command-tutorial-examples/>Linux 備份檔案操作 cpio 指令教學與範例</a>
<a href=https://www.geeksforgeeks.org/bzip2-command-in-linux-with-examples/>bzip2 command in Linux</a>
<a href=https://linuxize.com/post/gzip-command-in-linux/>Gzip Command in Linux</a>
<a href=https://www.nongnu.org/lzip/manual/lzip_manual.html>Lzip Manual</a>
<a href=https://manpages.ubuntu.com/manpages/xenial/man1/lz4.1.html>lz4 manual</a>
<a href=https://manpages.ubuntu.com/manpages/xenial/man1/lzmp.1.html>lzma manual</a>
<a href=https://linux.die.net/man/1/lzop>lzop(1) - Linux man page</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Flag.pdf</p><pre tabindex=0><code class="language-bash=" data-lang="bash=">#!/bin/sh
# This is a shell archive (produced by GNU sharutils 4.15.2).
# To extract the files from this archive, save it to some FILE, remove
# everything before the &#39;#!/bin/sh&#39; line above, then type &#39;sh FILE&#39;.
#
lock_dir=_sh00046
# Made on 2022-03-15 06:50 UTC by &lt;root@e8647f66bc56&gt;.
# Source directory was &#39;/app&#39;.
#
# Existing files will *not* be overwritten, unless &#39;-c&#39; is specified.
#
# This shar contains:
# length mode       name
# ------ ---------- ------------------------------------------
#   1092 -rw-r--r-- flag
#
MD5SUM=${MD5SUM-md5sum}
f=`${MD5SUM} --version | egrep &#39;^md5sum .*(core|text)utils&#39;`
test -n &#34;${f}&#34; &amp;&amp; md5check=true || md5check=false
${md5check} || \
  echo &#39;Note: not verifying md5sums.  Consider installing GNU coreutils.&#39;
if test &#34;X$1&#34; = &#34;X-c&#34;
then keep_file=&#39;&#39;
else keep_file=true
fi
echo=echo
save_IFS=&#34;${IFS}&#34;
IFS=&#34;${IFS}:&#34;
gettext_dir=
locale_dir=
set_echo=false

for dir in $PATH
do
  if test -f $dir/gettext \
     &amp;&amp; ($dir/gettext --version &gt;/dev/null 2&gt;&amp;1)
  then
    case `$dir/gettext --version 2&gt;&amp;1 | sed 1q` in
      *GNU*) gettext_dir=$dir
      set_echo=true
      break ;;
    esac
  fi
done

if ${set_echo}
then
  set_echo=false
  for dir in $PATH
  do
    if test -f $dir/shar \
       &amp;&amp; ($dir/shar --print-text-domain-dir &gt;/dev/null 2&gt;&amp;1)
    then
      locale_dir=`$dir/shar --print-text-domain-dir`
      set_echo=true
      break
    fi
  done

  if ${set_echo}
  then
    TEXTDOMAINDIR=$locale_dir
    export TEXTDOMAINDIR
    TEXTDOMAIN=sharutils
    export TEXTDOMAIN
    echo=&#34;$gettext_dir/gettext -s&#34;
  fi
fi
IFS=&#34;$save_IFS&#34;
if (echo &#34;testing\c&#34;; echo 1,2,3) | grep c &gt;/dev/null
then if (echo -n test; echo 1,2,3) | grep n &gt;/dev/null
     then shar_n= shar_c=&#39;
&#39;
     else shar_n=-n shar_c= ; fi
else shar_n= shar_c=&#39;\c&#39; ; fi
f=shar-touch.$$
st1=200112312359.59
st2=123123592001.59
st2tr=123123592001.5 # old SysV 14-char limit
st3=1231235901

if   touch -am -t ${st1} ${f} &gt;/dev/null 2&gt;&amp;1 &amp;&amp; \
     test ! -f ${st1} &amp;&amp; test -f ${f}; then
  shar_touch=&#39;touch -am -t $1$2$3$4$5$6.$7 &#34;$8&#34;&#39;

elif touch -am ${st2} ${f} &gt;/dev/null 2&gt;&amp;1 &amp;&amp; \
     test ! -f ${st2} &amp;&amp; test ! -f ${st2tr} &amp;&amp; test -f ${f}; then
  shar_touch=&#39;touch -am $3$4$5$6$1$2.$7 &#34;$8&#34;&#39;

elif touch -am ${st3} ${f} &gt;/dev/null 2&gt;&amp;1 &amp;&amp; \
     test ! -f ${st3} &amp;&amp; test -f ${f}; then
  shar_touch=&#39;touch -am $3$4$5$6$2 &#34;$8&#34;&#39;

else
  shar_touch=:
  echo
  ${echo} &#39;WARNING: not restoring timestamps.  Consider getting and
installing GNU &#39;\&#39;&#39;touch&#39;\&#39;&#39;, distributed in GNU coreutils...&#39;
  echo
fi
rm -f ${st1} ${st2} ${st2tr} ${st3} ${f}
#
if test ! -d ${lock_dir} ; then :
else ${echo} &#34;lock directory ${lock_dir} exists&#34;
     exit 1
fi
if mkdir ${lock_dir}
then ${echo} &#34;x - created lock directory ${lock_dir}.&#34;
else ${echo} &#34;x - failed to create lock directory ${lock_dir}.&#34;
     exit 1
fi
# ============= flag ==============
if test -n &#34;${keep_file}&#34; &amp;&amp; test -f &#39;flag&#39;
then
${echo} &#34;x - SKIPPING flag (file already exists)&#34;

else
${echo} &#34;x - extracting flag (text)&#34;
  sed &#39;s/^X//&#39; &lt;&lt; &#39;SHAR_EOF&#39; | uudecode &amp;&amp;
begin 600 flag
M(3QA&lt;F-H/@IF;&amp;%G+R`@(&#34;`@(&#34;`@(&#34;`@,&#34;`@(&#34;`@(&#34;`@(&#34;`@,&#34;`@(&#34;`@,&#34;`@
M(&#34;`@-C0T(&#34;`@(&#34;`Q,#(T(&#34;`@(&#34;`@8`K&#39;&lt;6D`&amp;[RD@0`````!````,&amp;(\-P4`
M``#_`69L86&lt;``$)::#DQ05DF4UG8%@C,```E___[Y[M[G]GO[=^W[_N__^6^
MYJGOD+YKS[D]VU]`&gt;Q]/?;`!&amp;;&#34;0&amp;@:`!H:`T:9-`#3330T:::`!H-&#39;J:``8
MC0:!H,C1HR#1HR,C)ZFFCU-&#39;E&#39;J8T:AR`Q#1B`-`&amp;3330`80:`!B,!,1DT-`
M`#$&amp;1ID9#!,@R::&amp;$PAHR#3&#34;JGZ4R,C1HTT#U&amp;(80#1H`9,C1ZF0Q`9``&gt;H`
M!D````]3$`,F(`T&amp;AHT!`$`-$2N?R0*H(%R04*&lt;D(7$`\&#34;P&#34;6J(/ORS5EV&#39;E
MY1A`\T1&gt;[HJ%R[CD]7UCS7E.#93IHR*#^?R7/$W6*1]HGQ=6EJ_/A$B_2&lt;_G
M5]3/.*(B)V8P\40AS.5X&lt;KE?9IM4&#39;Q&lt;3&amp;PH+K&#34;FJ)I6/1XOFW@W&lt;,00&lt;]B&gt;2
MPX5/&gt;V_P:DLC2^&gt;A1^[&gt;Y#?DS&#34;9KG7[]/=&lt;ASJ7MJ$$R&amp;\`6.9W&#34;)P6VS9LD
M.F7L4&#34;\Y$H\1@O$:/N]]&lt;+E+8B9)&#34;&#39;%;)PX-A@F\-3%=ICS(%E2AC+#,!8,&lt;
MZ%O`&lt;_HMM@M%6#]!6&#34;7]`2W:!\.3@RYX$/2&amp;/(\:I$&lt;N@*34)6G+(BNGHY5V
M0T)XU&amp;!)Q5B-(=%VD-NN&#39;6ZZ(BF`XC3PJ\R/QN6:)#XCNK?X%$*H&gt;1Z(HQ&gt;C
M#5HSE`/XJAZ-J?*((R/%CB[DBG&#34;A(;`L$9@`QW$``````````````0``````
M```+``````!44D%)3$52(2$A````````````````````````````````````
M````````````````````````````````````````````````````````````
M````````````````````````````````````````````````````````````
M````````````````````````````````````````````````````````````
M````````````````````````````````````````````````````````````
M````````````````````````````````````````````````````````````
M````````````````````````````````````````````````````````````
M````````````````````````````````````````````````````````````
M````````````````````````````````````````````````````````````
M````````````````````````````````````````````````````````````
,````````````````
`
end
SHAR_EOF
  (set 20 22 03 15 06 50 36 &#39;flag&#39;
   eval &#34;${shar_touch}&#34;) &amp;&amp; \
  chmod 0644 &#39;flag&#39;
if test $? -ne 0
then ${echo} &#34;restore of flag failed&#34;
fi
  if ${md5check}
  then (
       ${MD5SUM} -c &gt;/dev/null 2&gt;&amp;1 || ${echo} &#39;flag&#39;: &#39;MD5 check failed&#39;
       ) &lt;&lt; \SHAR_EOF
b5cc2c5756410f2467168f6d4c468f52  flag
SHAR_EOF

else
test `LC_ALL=C wc -c &lt; &#39;flag&#39;` -ne 1092 &amp;&amp; \
  ${echo} &#34;restoration warning:  size of &#39;flag&#39; is not 1092&#34;
  fi
fi
if rm -fr ${lock_dir}
then ${echo} &#34;x - removed lock directory ${lock_dir}.&#34;
else ${echo} &#34;x - failed to remove lock directory ${lock_dir}.&#34;
     exit 1
fi
exit 0
</code></pre><p>:::</p><h2 id=exploit---google-and-uncompress>Exploit - Google and Uncompress
<a class=anchor href=#exploit---google-and-uncompress>#</a></h2><p>:::spoiler whole process</p><pre tabindex=0><code class=language-bash! data-lang=bash!># shell script
$ file Flag.pdf  
Flag.pdf: POSIX shell script, ASCII text executable, with CRLF line terminators
$ mv Flag.pdf Flag.sh

# debug
$ chmod 777 Flag.sh
$ ./Flag.sh 
zsh: ./Flag.sh: bad interpreter: /bin/sh^M: no such file or directory
$ sed -i -e &#39;s/\r$//&#39; Flag.sh
$ ./Flag.sh 
x - created lock directory _sh00046.
x - extracting flag (text)
x - removed lock directory _sh00046.

# ar
$ ls
Flag.pdf  Flag.sh  flag
$ file flag 
flag: current ar archive
$ mv flag flag.ar
$ ar -x flag.ar  

# cpio
$ ls
Flag.pdf  Flag.sh  flag  flag.ar
$ file flag 
flag: cpio archive
$ mv flag flag.cpio   
$ cpio -iv &lt; flag.cpio
flag
2 blocks

# bzip2
$ ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio
$ file flag 
flag: bzip2 compressed data, block size = 900k
$ mv flag flag.bz2    
$ bzip2 -d flag.bz2   

# gzip
$ ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio
$ file flag 
flag: gzip compressed data, was &#34;flag&#34;, last modified: Tue Mar 15 06:50:36 2022, from Unix, original size modulo 2^32 329
$ mv flag flag.gz
$ gzip -d flag.gz

# lzip
$ ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio
$ file flag 
flag: lzip compressed data, version: 1
$ mv flag flag.lz
$ lzip -d flag.lz

# lz4
$ ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio
$ file flag 
flag: LZ4 compressed data (v1.4+)
$ mv flag flag.lz4    
$ lz4 -d flag.lz4
Decoding file flag
flag.lz4   : decoded 266 bytes

# lzma
$ ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio  flag.lz4
$ file flag 
flag: LZMA compressed data, non-streamed, size 255
$ mv flag flag.lzma
$lzma -d flag.lzma

# lzop
$ ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio  flag.lz4
$ file flag 
flag: lzop compressed data - version 1.040, LZO1X-1, os: Unix
$ mv flag flag.lzo
$ lzop -d flag.lzo

# lzip
$ ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio  flag.lz4  flag.lzo
$ file flag 
flag: lzip compressed data, version: 1
$ mv flag flag.lz
$ lzip -d flag.lz

# xz
$ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio  flag.lz4  flag.lzo
$file flag 
flag: XZ compressed data
$mv flag flag.xz
 ~/CTF/P/M/File_types
$ xz -d flag.xz  

# Completely Uncompressed
$ls
Flag.pdf  Flag.sh  flag  flag.ar  flag.cpio  flag.lz4  flag.lzo
$file flag 
flag: ASCII text
$cat flag | xxd -r -p
picoCTF{f1len@m3_m@n1pul@t10n_f0r_0b2cur17y_3c79c5ba}
</code></pre><p>:::</p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://stackoverflow.com/questions/14219092/bash-script-bin-bashm-bad-interpreter-no-such-file-or-directory>Bash script – &ldquo;/bin/bash^M: bad interpreter: No such file or directory&rdquo;</a>
<a href=https://www.baeldung.com/linux/character-hex-to-ascii>Convert Hex to ASCII</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a><ul><li><a href=#for-shell-script>For Shell Script</a></li><li><a href=#for-compress-command>For Compress Command</a></li></ul></li><li><a href=#source-code>Source code</a></li><li><a href=#exploit---google-and-uncompress>Exploit - Google and Uncompress</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>