<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  PicoCTF - Surfing the Waves
  #


  tags: PicoCTF CTF Misc
  #

Challenge: Surfing the Waves

  Description & Hint
  #

While you&rsquo;re going through the FBI&rsquo;s servers, you stumble across their incredible taste in music. One main.wav you found is particularly interesting, see if you can find the flag!
Hint:

Music is cool, but what other kinds of waves are there?
Look deep below the surface


  Exploit - 通靈
  #


Audacity to Analyze
The sound seems quite normal but when you zoom in the audio track, it looks like something encode.

Read it - scipy.io
Use scipy.io library to read it and print the data out.
>>> from scipy.io.wavfile import read
>>> rate, data = read("./main.wav")
>>> print(data)
[2007 2503 2005 ... 4503 4501 7501]
>>> import numpy as np
>>> print(np.unique(data))
[1000 1001 1002 1003 1004 1005 1006 1007 1008 1009 1500 1501 1502 1503
 1504 1505 1506 1507 1508 1509 2000 2001 2002 2003 2004 2005 2006 2007
 2008 2009 2500 2501 2502 2503 2504 2505 2506 2507 2508 2509 3000 3001
 3002 3003 3004 3005 3006 3007 3008 3009 3500 3501 3502 3503 3504 3505
 3506 3507 3508 3509 4000 4001 4002 4003 4004 4005 4006 4007 4008 4009
 4500 4501 4502 4503 4504 4505 4506 4507 4508 4509 5000 5001 5002 5003
 5004 5005 5006 5007 5008 5009 5500 5501 5502 5503 5504 5505 5506 5507
 5508 5509 6000 6001 6002 6003 6004 6005 6006 6007 6008 6009 6500 6501
 6502 6503 6504 6505 6506 6507 6508 6509 7000 7001 7002 7003 7004 7005
 7006 7007 7008 7009 7500 7501 7502 7503 7504 7505 7506 7507 7508 7509
 8000 8001 8002 8003 8004 8005 8006 8007 8008 8009 8500 8501 8502 8503
 8504 8505 8506 8507 8508 8509]
Seems it has some rule $\to$
1000 ~ 1009
1500 ~ 1509
2000 ~ 2009
&mldr;
8500 ~ 8509
It has exactly 16 intervals $\to$ hex value
Let&rsquo;s try to exploit it


Whole exploit
:::spoiler exploit
from scipy.io.wavfile import read
from tqdm import trange

path = &#39;.&#39;
rate, data = read(path + "/main.wav")

decode_dic = {
    10 : "0",
    15 : "1",
    20 : "2",
    25 : "3",
    30 : "4",
    35 : "5",
    40 : "6",
    45 : "7",
    50 : "8",
    55 : "9",
    60 : "A",
    65 : "B",
    70 : "C",
    75 : "D",
    80 : "E",
    85 : "F",
}

message = &#39;&#39;
for i in trange(len(data)):
    message += decode_dic[data[i] // 100]

print(bytes.fromhex(message).decode())
:::
Then you can get the source code and flag&mldr;


  Reference
  #

picoCTF 2021 Surfing the Waves'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/misc/audio/picoctf---surfing-the-waves/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - Surfing the Waves"><meta property="og:description" content='PicoCTF - Surfing the Waves # tags: PicoCTF CTF Misc # Challenge: Surfing the Waves
Description & Hint # While you’re going through the FBI’s servers, you stumble across their incredible taste in music. One main.wav you found is particularly interesting, see if you can find the flag! Hint:
Music is cool, but what other kinds of waves are there? Look deep below the surface Exploit - 通靈 # Audacity to Analyze The sound seems quite normal but when you zoom in the audio track, it looks like something encode. Read it - scipy.io Use scipy.io library to read it and print the data out. >>> from scipy.io.wavfile import read >>> rate, data = read("./main.wav") >>> print(data) [2007 2503 2005 ... 4503 4501 7501] >>> import numpy as np >>> print(np.unique(data)) [1000 1001 1002 1003 1004 1005 1006 1007 1008 1009 1500 1501 1502 1503 1504 1505 1506 1507 1508 1509 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2500 2501 2502 2503 2504 2505 2506 2507 2508 2509 3000 3001 3002 3003 3004 3005 3006 3007 3008 3009 3500 3501 3502 3503 3504 3505 3506 3507 3508 3509 4000 4001 4002 4003 4004 4005 4006 4007 4008 4009 4500 4501 4502 4503 4504 4505 4506 4507 4508 4509 5000 5001 5002 5003 5004 5005 5006 5007 5008 5009 5500 5501 5502 5503 5504 5505 5506 5507 5508 5509 6000 6001 6002 6003 6004 6005 6006 6007 6008 6009 6500 6501 6502 6503 6504 6505 6506 6507 6508 6509 7000 7001 7002 7003 7004 7005 7006 7007 7008 7009 7500 7501 7502 7503 7504 7505 7506 7507 7508 7509 8000 8001 8002 8003 8004 8005 8006 8007 8008 8009 8500 8501 8502 8503 8504 8505 8506 8507 8508 8509] Seems it has some rule $\to$ 1000 ~ 1009 1500 ~ 1509 2000 ~ 2009 … 8500 ~ 8509 It has exactly 16 intervals $\to$ hex value Let’s try to exploit it Whole exploit :::spoiler exploit from scipy.io.wavfile import read from tqdm import trange path = &#39;.&#39; rate, data = read(path + "/main.wav") decode_dic = { 10 : "0", 15 : "1", 20 : "2", 25 : "3", 30 : "4", 35 : "5", 40 : "6", 45 : "7", 50 : "8", 55 : "9", 60 : "A", 65 : "B", 70 : "C", 75 : "D", 80 : "E", 85 : "F", } message = &#39;&#39; for i in trange(len(data)): message += decode_dic[data[i] // 100] print(bytes.fromhex(message).decode()) ::: Then you can get the source code and flag… Reference # picoCTF 2021 Surfing the Waves'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><title>PicoCTF - Surfing the Waves | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/misc/audio/picoctf---surfing-the-waves/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - Surfing the Waves</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#description--hint>Description & Hint</a></li><li><a href=#exploit---通靈>Exploit - <font color=FF0000>通靈</font></a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---surfing-the-waves>PicoCTF - Surfing the Waves
<a class=anchor href=#picoctf---surfing-the-waves>#</a></h1><h6 id=tags-picoctf-ctf-misc>tags: <code>PicoCTF</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-picoctf-ctf-misc>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/117?category=4&amp;page=3">Surfing the Waves</a></p><h2 id=description--hint>Description & Hint
<a class=anchor href=#description--hint>#</a></h2><p>While you&rsquo;re going through the FBI&rsquo;s servers, you stumble across their incredible taste in music. One <a href=https://mercury.picoctf.net/static/cf917a179937f814d966e53bb1fd4b90/main.wav>main.wav</a> you found is particularly interesting, see if you can find the flag!
Hint:</p><ul><li>Music is cool, but what other kinds of waves are there?</li><li>Look deep below the surface</li></ul><h2 id=exploit---通靈>Exploit - <font color=FF0000>通靈</font>
<a class=anchor href=#exploit---%e9%80%9a%e9%9d%88>#</a></h2><ol><li>Audacity to Analyze
The sound seems quite normal but when you zoom in the audio track, it looks like something encode.
<img src=https://i.imgur.com/D1H1jpU.png alt></li><li>Read it - <code>scipy.io</code>
Use <code>scipy.io</code> library to read it and print the data out.<pre tabindex=0><code class=language-python! data-lang=python!>&gt;&gt;&gt; from scipy.io.wavfile import read
&gt;&gt;&gt; rate, data = read(&#34;./main.wav&#34;)
&gt;&gt;&gt; print(data)
[2007 2503 2005 ... 4503 4501 7501]
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; print(np.unique(data))
[1000 1001 1002 1003 1004 1005 1006 1007 1008 1009 1500 1501 1502 1503
 1504 1505 1506 1507 1508 1509 2000 2001 2002 2003 2004 2005 2006 2007
 2008 2009 2500 2501 2502 2503 2504 2505 2506 2507 2508 2509 3000 3001
 3002 3003 3004 3005 3006 3007 3008 3009 3500 3501 3502 3503 3504 3505
 3506 3507 3508 3509 4000 4001 4002 4003 4004 4005 4006 4007 4008 4009
 4500 4501 4502 4503 4504 4505 4506 4507 4508 4509 5000 5001 5002 5003
 5004 5005 5006 5007 5008 5009 5500 5501 5502 5503 5504 5505 5506 5507
 5508 5509 6000 6001 6002 6003 6004 6005 6006 6007 6008 6009 6500 6501
 6502 6503 6504 6505 6506 6507 6508 6509 7000 7001 7002 7003 7004 7005
 7006 7007 7008 7009 7500 7501 7502 7503 7504 7505 7506 7507 7508 7509
 8000 8001 8002 8003 8004 8005 8006 8007 8008 8009 8500 8501 8502 8503
 8504 8505 8506 8507 8508 8509]
</code></pre>Seems it has some rule $\to$
<code>1000 ~ 1009</code>
<code>1500 ~ 1509</code>
<code>2000 ~ 2009</code>
&mldr;
<code>8500 ~ 8509</code>
It has exactly 16 intervals $\to$ hex value</li><li>Let&rsquo;s try to exploit it</li></ol><ul><li>Whole exploit
:::spoiler exploit<pre tabindex=0><code class=language-python! data-lang=python!>from scipy.io.wavfile import read
from tqdm import trange

path = &#39;.&#39;
rate, data = read(path + &#34;/main.wav&#34;)

decode_dic = {
    10 : &#34;0&#34;,
    15 : &#34;1&#34;,
    20 : &#34;2&#34;,
    25 : &#34;3&#34;,
    30 : &#34;4&#34;,
    35 : &#34;5&#34;,
    40 : &#34;6&#34;,
    45 : &#34;7&#34;,
    50 : &#34;8&#34;,
    55 : &#34;9&#34;,
    60 : &#34;A&#34;,
    65 : &#34;B&#34;,
    70 : &#34;C&#34;,
    75 : &#34;D&#34;,
    80 : &#34;E&#34;,
    85 : &#34;F&#34;,
}

message = &#39;&#39;
for i in trange(len(data)):
    message += decode_dic[data[i] // 100]

print(bytes.fromhex(message).decode())
</code></pre>:::
Then you can get the source code and flag&mldr;</li></ul><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://youtu.be/tDPetapjm74>picoCTF 2021 Surfing the Waves</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#description--hint>Description & Hint</a></li><li><a href=#exploit---通靈>Exploit - <font color=FF0000>通靈</font></a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>