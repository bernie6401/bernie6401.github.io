<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  PicoCTF - Torrent Analyze
  #


  Background
  #

What are seeds, peers and leechers in Torrents’ language?
慎選peer，是加速BT下載的王道！


seed個數：seed（即一般所說的「種子」）意指擁有完整檔案的BT參與者，是主要的檔案提供者。seed越多，可用的BT分享頻寬就越多，速度當然就快。
seed與peer的比例：雖然peer（指尚未取得完整檔案的BT參與者）可同時自seed與其他peer下載檔案，但peer間會彼此競爭，以爭取有限的BT下載頻寬。因此，peer個數越多，分配後的BT分享頻寬就越少，速度自然就受影響。

教你該如何使用bt的info hash特徵碼，下載BT之torrent種子檔

  Description & Hint
  #


SOS, someone is torrenting on our network. One of your colleagues has been using torrent to download some files on the company’s network. Can you identify the file(s) that were downloaded? The file name will be the flag, like picoCTF{filename}.
Hint 1: Download and open the file with a packet analyzer like Wireshark.
Hint 2: You may want to enable BitTorrent protocol (BT-DHT, etc.) on Wireshark. Analyze -> Enabled Protocols
Hint 3: Try to understand peers, leechers and seeds. Article
Hint 4: The file name ends with .iso"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/misc/flow/picoctf---torrent-analyze/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - Torrent Analyze"><meta property="og:description" content="PicoCTF - Torrent Analyze # Background # What are seeds, peers and leechers in Torrents’ language? 慎選peer，是加速BT下載的王道！
seed個數：seed（即一般所說的「種子」）意指擁有完整檔案的BT參與者，是主要的檔案提供者。seed越多，可用的BT分享頻寬就越多，速度當然就快。 seed與peer的比例：雖然peer（指尚未取得完整檔案的BT參與者）可同時自seed與其他peer下載檔案，但peer間會彼此競爭，以爭取有限的BT下載頻寬。因此，peer個數越多，分配後的BT分享頻寬就越少，速度自然就受影響。 教你該如何使用bt的info hash特徵碼，下載BT之torrent種子檔
Description & Hint # SOS, someone is torrenting on our network. One of your colleagues has been using torrent to download some files on the company’s network. Can you identify the file(s) that were downloaded? The file name will be the flag, like picoCTF{filename}. Hint 1: Download and open the file with a packet analyzer like Wireshark. Hint 2: You may want to enable BitTorrent protocol (BT-DHT, etc.) on Wireshark. Analyze -> Enabled Protocols Hint 3: Try to understand peers, leechers and seeds. Article Hint 4: The file name ends with .iso"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><title>PicoCTF - Torrent Analyze | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/misc/flow/picoctf---torrent-analyze/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - Torrent Analyze</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#description--hint>Description & Hint</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---torrent-analyze>PicoCTF - Torrent Analyze
<a class=anchor href=#picoctf---torrent-analyze>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://www.techworm.net/2017/03/seeds-peers-leechers-torrents-language.html>What are seeds, peers and leechers in Torrents’ language?</a>
<a href="https://www.mobile01.com/topicdetail.php?f=507&amp;t=1365797">慎選peer，是加速BT下載的王道！</a></p><blockquote><ol><li>seed個數：seed（即一般所說的「種子」）意指擁有完整檔案的BT參與者，是主要的檔案提供者。seed越多，可用的BT分享頻寬就越多，速度當然就快。</li><li>seed與peer的比例：雖然peer（指尚未取得完整檔案的BT參與者）可同時自seed與其他peer下載檔案，但peer間會彼此競爭，以爭取有限的BT下載頻寬。因此，peer個數越多，分配後的BT分享頻寬就越少，速度自然就受影響。</li></ol></blockquote><p><a href=http://zfly9.blogspot.com/2014/10/hashmethod.html>教你該如何使用bt的info hash特徵碼，下載BT之torrent種子檔</a></p><h2 id=description--hint>Description & Hint
<a class=anchor href=#description--hint>#</a></h2><blockquote><p>SOS, someone is torrenting on our network. One of your colleagues has been using torrent to download some files on the company’s network. Can you identify the file(s) that were downloaded? The file name will be the flag, like picoCTF{filename}.
Hint 1: Download and open the file with a packet analyzer like <a href=https://www.wireshark.org/>Wireshark</a>.
Hint 2: You may want to enable BitTorrent protocol (BT-DHT, etc.) on Wireshark. Analyze -> Enabled Protocols
Hint 3: Try to understand peers, leechers and seeds. <a href=https://www.techworm.net/2017/03/seeds-peers-leechers-torrents-language.html>Article</a>
Hint 4: The file name ends with <code>.iso</code></p></blockquote><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這是非常有趣的題目，不過完全沒有用過bittorrent或是info hash相關的背景知識，所以看了<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>的WP覺得學到很多</p><ol><li>簡單來說，這支pcap紀錄了利用bittorrent下載/上傳的流量，而我們要找出他下載/上傳的file name為何，有趣的地方是利用bittorrent這種P2P的方式，一定會自帶一個file的info hash，驗明正身，所以我們只要找到BT-UDP protocol中，有夾帶info-hash的packet出來，再丟到網路上查詢就可以了</li><li>Set Filter as <code>bt-dht contains "info_hash"</code>
設定filter後，就可以看到每一個bt-dht protocol packets都含有info_hash的keys，不過其中有很多不同的info hash所以要一個一個試很麻煩就寫了一個script dump出來，最後只有8個，不過如果把全部packet不管有沒有重複全部print出來的話，很明顯最後一個<code>e2467cbf021192c241367b892230dc1e05c0580e</code>是最多的，那這個應該就是答案，因為.iso通常都很大，所以下載的packets數量應該是比較多的</li></ol><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><pre tabindex=0><code class="language-python=" data-lang="python=">import pyshark

capture = pyshark.FileCapture(&#39;PicoCTF/Misc/Torrent Analyze/torrent.pcap&#39;, display_filter=&#39;bt-dht contains &#34;info_hash&#34;&#39;)

info_hashs = []
for pkt in capture:
    info_hash = pkt.layers[3].get_field_by_showname(&#39;info_hash&#39;).showname_value
    if info_hash not in info_hashs:
        print(info_hash)
        info_hashs.append(info_hash)
    
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>17d62de1495d4404f6fb385bdfd7ead5c897ea22
</span></span><span style=display:flex><span>17c1e42e811a83f12c697c21bed9c72b5cb3000d
</span></span><span style=display:flex><span>d59b1ce3bf41f1d282c1923544629062948afadd
</span></span><span style=display:flex><span>078e18df4efe53eb39d3425e91d1e9f4777d85ac
</span></span><span style=display:flex><span>7af6be54c2ed4dcb8d17bf599516b97bb66c0bfd
</span></span><span style=display:flex><span>17c0c2c3b7825ba4fbe2f8c8055e000421def12c
</span></span><span style=display:flex><span>17c02f9957ea8604bc5a04ad3b56766a092b5556
</span></span><span style=display:flex><span>e2467cbf021192c241367b892230dc1e05c0580e
</span></span></code></pre></div><p>Info Hash: <code>e2467cbf021192c241367b892230dc1e05c0580e</code>
File Name: <code>ubuntu-19.10-desktop-amd64.iso</code>
Flag: <code>picoCTF{ubuntu-19.10-desktop-amd64.iso}</code>
<img src=https://hackmd.io/_uploads/BJ-y_mPxp.png alt></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href="https://youtu.be/XWQDnY2qaZg?si=LbdCmgY2zJG1e25z">picoGym (picoCTF) Exercise: Torrent Analyze </a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#description--hint>Description & Hint</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>