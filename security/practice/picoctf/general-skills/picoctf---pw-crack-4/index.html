<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  PicoCTF - PW Crack 4
  #


  tags: PicoCTF CTF General Skills
  #

Challenge: PW Crack 4

  Source code
  #

:::spoiler source code
import hashlib

### THIS FUNCTION WILL NOT HELP YOU FIND THE FLAG --LT ########################
def str_xor(secret, key):
    #extend key to secret length
    new_key = key
    i = 0
    while len(new_key) < len(secret):
        new_key = new_key + key[i]
        i = (i + 1) % len(key)        
    return "".join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)])
###############################################################################

flag_enc = open(&#39;level4.flag.txt.enc&#39;, &#39;rb&#39;).read()
correct_pw_hash = open(&#39;level4.hash.bin&#39;, &#39;rb&#39;).read()


def hash_pw(pw_str):
    pw_bytes = bytearray()
    pw_bytes.extend(pw_str.encode())
    m = hashlib.md5()
    m.update(pw_bytes)
    return m.digest()


def level_4_pw_check():
    user_pw = input("Please enter correct password for flag: ")
    user_pw_hash = hash_pw(user_pw)
    
    if( user_pw_hash == correct_pw_hash ):
        print("Welcome back... your flag, user:")
        decryption = str_xor(flag_enc.decode(), user_pw)
        print(decryption)
        return
    print("That password is incorrect")



level_4_pw_check()



# The strings below are 100 possibilities for the correct password. 
#   (Only 1 is correct)
pos_pw_list = ["6288", "6152", "4c7a", "b722", "9a6e", "6717", "4389", "1a28", "37ac", "de4f", "eb28", "351b", "3d58", "948b", "231b", "973a", "a087", "384a", "6d3c", "9065", "725c", "fd60", "4d4f", "6a60", "7213", "93e6", "8c54", "537d", "a1da", "c718", "9de8", "ebe3", "f1c5", "a0bf", "ccab", "4938", "8f97", "3327", "8029", "41f2", "a04f", "c7f9", "b453", "90a5", "25dc", "26b0", "cb42", "de89", "2451", "1dd3", "7f2c", "8919", "f3a9", "b88f", "eaa8", "776a", "6236", "98f5", "492b", "507d", "18e8", "cfb5", "76fd", "6017", "30de", "bbae", "354e", "4013", "3153", "e9cc", "cba9", "25ea", "c06c", "a166", "faf1", "2264", "2179", "cf30", "4b47", "3446", "b213", "88a3", "6253", "db88", "c38c", "a48c", "3e4f", "7208", "9dcb", "fc77", "e2cf", "8552", "f6f8", "7079", "42ef", "391e", "8a6d", "2154", "d964", "49ec"]
:::'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/general-skills/picoctf---pw-crack-4/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - PW Crack 4"><meta property="og:description" content='PicoCTF - PW Crack 4 # tags: PicoCTF CTF General Skills # Challenge: PW Crack 4
Source code # :::spoiler source code
import hashlib ### THIS FUNCTION WILL NOT HELP YOU FIND THE FLAG --LT ######################## def str_xor(secret, key): #extend key to secret length new_key = key i = 0 while len(new_key) < len(secret): new_key = new_key + key[i] i = (i + 1) % len(key) return "".join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)]) ############################################################################### flag_enc = open(&#39;level4.flag.txt.enc&#39;, &#39;rb&#39;).read() correct_pw_hash = open(&#39;level4.hash.bin&#39;, &#39;rb&#39;).read() def hash_pw(pw_str): pw_bytes = bytearray() pw_bytes.extend(pw_str.encode()) m = hashlib.md5() m.update(pw_bytes) return m.digest() def level_4_pw_check(): user_pw = input("Please enter correct password for flag: ") user_pw_hash = hash_pw(user_pw) if( user_pw_hash == correct_pw_hash ): print("Welcome back... your flag, user:") decryption = str_xor(flag_enc.decode(), user_pw) print(decryption) return print("That password is incorrect") level_4_pw_check() # The strings below are 100 possibilities for the correct password. # (Only 1 is correct) pos_pw_list = ["6288", "6152", "4c7a", "b722", "9a6e", "6717", "4389", "1a28", "37ac", "de4f", "eb28", "351b", "3d58", "948b", "231b", "973a", "a087", "384a", "6d3c", "9065", "725c", "fd60", "4d4f", "6a60", "7213", "93e6", "8c54", "537d", "a1da", "c718", "9de8", "ebe3", "f1c5", "a0bf", "ccab", "4938", "8f97", "3327", "8029", "41f2", "a04f", "c7f9", "b453", "90a5", "25dc", "26b0", "cb42", "de89", "2451", "1dd3", "7f2c", "8919", "f3a9", "b88f", "eaa8", "776a", "6236", "98f5", "492b", "507d", "18e8", "cfb5", "76fd", "6017", "30de", "bbae", "354e", "4013", "3153", "e9cc", "cba9", "25ea", "c06c", "a166", "faf1", "2264", "2179", "cf30", "4b47", "3446", "b213", "88a3", "6253", "db88", "c38c", "a48c", "3e4f", "7208", "9dcb", "fc77", "e2cf", "8552", "f6f8", "7079", "42ef", "391e", "8a6d", "2154", "d964", "49ec"] :::'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><meta property="article:tag" content="General Skill"><title>PicoCTF - PW Crack 4 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/general-skills/picoctf---pw-crack-4/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - PW Crack 4</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#source-code>Source code</a></li><li><a href=#exploit---brute-force>Exploit - Brute Force</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---pw-crack-4>PicoCTF - PW Crack 4
<a class=anchor href=#picoctf---pw-crack-4>#</a></h1><h6 id=tags-picoctf-ctf-general-skills>tags: <code>PicoCTF</code> <code>CTF</code> <code>General Skills</code>
<a class=anchor href=#tags-picoctf-ctf-general-skills>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/248?category=5&amp;page=2">PW Crack 4</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler source code</p><pre tabindex=0><code class="language-python=" data-lang="python=">import hashlib

### THIS FUNCTION WILL NOT HELP YOU FIND THE FLAG --LT ########################
def str_xor(secret, key):
    #extend key to secret length
    new_key = key
    i = 0
    while len(new_key) &lt; len(secret):
        new_key = new_key + key[i]
        i = (i + 1) % len(key)        
    return &#34;&#34;.join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)])
###############################################################################

flag_enc = open(&#39;level4.flag.txt.enc&#39;, &#39;rb&#39;).read()
correct_pw_hash = open(&#39;level4.hash.bin&#39;, &#39;rb&#39;).read()


def hash_pw(pw_str):
    pw_bytes = bytearray()
    pw_bytes.extend(pw_str.encode())
    m = hashlib.md5()
    m.update(pw_bytes)
    return m.digest()


def level_4_pw_check():
    user_pw = input(&#34;Please enter correct password for flag: &#34;)
    user_pw_hash = hash_pw(user_pw)
    
    if( user_pw_hash == correct_pw_hash ):
        print(&#34;Welcome back... your flag, user:&#34;)
        decryption = str_xor(flag_enc.decode(), user_pw)
        print(decryption)
        return
    print(&#34;That password is incorrect&#34;)



level_4_pw_check()



# The strings below are 100 possibilities for the correct password. 
#   (Only 1 is correct)
pos_pw_list = [&#34;6288&#34;, &#34;6152&#34;, &#34;4c7a&#34;, &#34;b722&#34;, &#34;9a6e&#34;, &#34;6717&#34;, &#34;4389&#34;, &#34;1a28&#34;, &#34;37ac&#34;, &#34;de4f&#34;, &#34;eb28&#34;, &#34;351b&#34;, &#34;3d58&#34;, &#34;948b&#34;, &#34;231b&#34;, &#34;973a&#34;, &#34;a087&#34;, &#34;384a&#34;, &#34;6d3c&#34;, &#34;9065&#34;, &#34;725c&#34;, &#34;fd60&#34;, &#34;4d4f&#34;, &#34;6a60&#34;, &#34;7213&#34;, &#34;93e6&#34;, &#34;8c54&#34;, &#34;537d&#34;, &#34;a1da&#34;, &#34;c718&#34;, &#34;9de8&#34;, &#34;ebe3&#34;, &#34;f1c5&#34;, &#34;a0bf&#34;, &#34;ccab&#34;, &#34;4938&#34;, &#34;8f97&#34;, &#34;3327&#34;, &#34;8029&#34;, &#34;41f2&#34;, &#34;a04f&#34;, &#34;c7f9&#34;, &#34;b453&#34;, &#34;90a5&#34;, &#34;25dc&#34;, &#34;26b0&#34;, &#34;cb42&#34;, &#34;de89&#34;, &#34;2451&#34;, &#34;1dd3&#34;, &#34;7f2c&#34;, &#34;8919&#34;, &#34;f3a9&#34;, &#34;b88f&#34;, &#34;eaa8&#34;, &#34;776a&#34;, &#34;6236&#34;, &#34;98f5&#34;, &#34;492b&#34;, &#34;507d&#34;, &#34;18e8&#34;, &#34;cfb5&#34;, &#34;76fd&#34;, &#34;6017&#34;, &#34;30de&#34;, &#34;bbae&#34;, &#34;354e&#34;, &#34;4013&#34;, &#34;3153&#34;, &#34;e9cc&#34;, &#34;cba9&#34;, &#34;25ea&#34;, &#34;c06c&#34;, &#34;a166&#34;, &#34;faf1&#34;, &#34;2264&#34;, &#34;2179&#34;, &#34;cf30&#34;, &#34;4b47&#34;, &#34;3446&#34;, &#34;b213&#34;, &#34;88a3&#34;, &#34;6253&#34;, &#34;db88&#34;, &#34;c38c&#34;, &#34;a48c&#34;, &#34;3e4f&#34;, &#34;7208&#34;, &#34;9dcb&#34;, &#34;fc77&#34;, &#34;e2cf&#34;, &#34;8552&#34;, &#34;f6f8&#34;, &#34;7079&#34;, &#34;42ef&#34;, &#34;391e&#34;, &#34;8a6d&#34;, &#34;2154&#34;, &#34;d964&#34;, &#34;49ec&#34;]
</code></pre><p>:::</p><h2 id=exploit---brute-force>Exploit - Brute Force
<a class=anchor href=#exploit---brute-force>#</a></h2><pre tabindex=0><code class="language-python=" data-lang="python=">import subprocess
from subprocess import Popen as p

pos_pw_list = [&#34;6288&#34;, &#34;6152&#34;, &#34;4c7a&#34;, &#34;b722&#34;, &#34;9a6e&#34;, &#34;6717&#34;, &#34;4389&#34;, &#34;1a28&#34;, &#34;37ac&#34;, &#34;de4f&#34;, &#34;eb28&#34;, &#34;351b&#34;, &#34;3d58&#34;, &#34;948b&#34;, &#34;231b&#34;, &#34;973a&#34;, &#34;a087&#34;, &#34;384a&#34;, &#34;6d3c&#34;, &#34;9065&#34;, &#34;725c&#34;, &#34;fd60&#34;, &#34;4d4f&#34;, &#34;6a60&#34;, &#34;7213&#34;, &#34;93e6&#34;, &#34;8c54&#34;, &#34;537d&#34;, &#34;a1da&#34;, &#34;c718&#34;, &#34;9de8&#34;, &#34;ebe3&#34;, &#34;f1c5&#34;, &#34;a0bf&#34;, &#34;ccab&#34;, &#34;4938&#34;, &#34;8f97&#34;, &#34;3327&#34;, &#34;8029&#34;, &#34;41f2&#34;, &#34;a04f&#34;, &#34;c7f9&#34;, &#34;b453&#34;, &#34;90a5&#34;, &#34;25dc&#34;, &#34;26b0&#34;, &#34;cb42&#34;, &#34;de89&#34;, &#34;2451&#34;, &#34;1dd3&#34;, &#34;7f2c&#34;, &#34;8919&#34;, &#34;f3a9&#34;, &#34;b88f&#34;, &#34;eaa8&#34;, &#34;776a&#34;, &#34;6236&#34;, &#34;98f5&#34;, &#34;492b&#34;, &#34;507d&#34;, &#34;18e8&#34;, &#34;cfb5&#34;, &#34;76fd&#34;, &#34;6017&#34;, &#34;30de&#34;, &#34;bbae&#34;, &#34;354e&#34;, &#34;4013&#34;, &#34;3153&#34;, &#34;e9cc&#34;, &#34;cba9&#34;, &#34;25ea&#34;, &#34;c06c&#34;, &#34;a166&#34;, &#34;faf1&#34;, &#34;2264&#34;, &#34;2179&#34;, &#34;cf30&#34;, &#34;4b47&#34;, &#34;3446&#34;, &#34;b213&#34;, &#34;88a3&#34;, &#34;6253&#34;, &#34;db88&#34;, &#34;c38c&#34;, &#34;a48c&#34;, &#34;3e4f&#34;, &#34;7208&#34;, &#34;9dcb&#34;, &#34;fc77&#34;, &#34;e2cf&#34;, &#34;8552&#34;, &#34;f6f8&#34;, &#34;7079&#34;, &#34;42ef&#34;, &#34;391e&#34;, &#34;8a6d&#34;, &#34;2154&#34;, &#34;d964&#34;, &#34;49ec&#34;]

for i in range(len(pos_pw_list)):
    echo_str = p([&#34;echo&#34;, pos_pw_list[i] + &#39;\n&#39;], stdout=subprocess.PIPE, text=True)
    return_str = p([&#34;python&#34;, &#34;level4.py&#34;], stdin=echo_str.stdout, stdout=subprocess.PIPE, text=True)
    output, error = return_str.communicate()
    if &#34;That password is incorrect&#34; not in output:
        print(pos_pw_list[i])
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#source-code>Source code</a></li><li><a href=#exploit---brute-force>Exploit - Brute Force</a></li></ul></nav></div></aside></main></body></html>