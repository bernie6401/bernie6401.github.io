<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  PicoCTF - New Caesar
  #


  tags: PicoCTF CTF Crypto
  #

Challenge: New Caesar

  Source code
  #

::: spoiler source code
import string

LOWERCASE_OFFSET = ord("a")
ALPHABET = string.ascii_lowercase[:16]

def b16_encode(plain):
	enc = ""
	for c in plain:
		binary = "{0:08b}".format(ord(c))
		enc += ALPHABET[int(binary[:4], 2)]
		enc += ALPHABET[int(binary[4:], 2)]
	return enc

def shift(c, k):
	t1 = ord(c) - LOWERCASE_OFFSET
	t2 = ord(k) - LOWERCASE_OFFSET
	return ALPHABET[(t1 + t2) % len(ALPHABET)]

flag = "redacted"
key = "redacted"
assert all([k in ALPHABET for k in key])
assert len(key) == 1

b16 = b16_encode(flag)
enc = ""
for i, c in enumerate(b16):
	enc += shift(c, key[i % len(key)])
print(enc)
:::'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/crypto/classic/picoctf---new-caesar/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - New Caesar"><meta property="og:description" content='PicoCTF - New Caesar # tags: PicoCTF CTF Crypto # Challenge: New Caesar
Source code # ::: spoiler source code
import string LOWERCASE_OFFSET = ord("a") ALPHABET = string.ascii_lowercase[:16] def b16_encode(plain): enc = "" for c in plain: binary = "{0:08b}".format(ord(c)) enc += ALPHABET[int(binary[:4], 2)] enc += ALPHABET[int(binary[4:], 2)] return enc def shift(c, k): t1 = ord(c) - LOWERCASE_OFFSET t2 = ord(k) - LOWERCASE_OFFSET return ALPHABET[(t1 + t2) % len(ALPHABET)] flag = "redacted" key = "redacted" assert all([k in ALPHABET for k in key]) assert len(key) == 1 b16 = b16_encode(flag) enc = "" for i, c in enumerate(b16): enc += shift(c, key[i % len(key)]) print(enc) :::'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Crypto"><title>PicoCTF - New Caesar | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/crypto/classic/picoctf---new-caesar/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - New Caesar</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#source-code>Source code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit---recover>Exploit - Recover</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---new-caesar>PicoCTF - New Caesar
<a class=anchor href=#picoctf---new-caesar>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/158?category=2&amp;page=1">New Caesar</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>::: spoiler source code</p><pre tabindex=0><code class="language-python=" data-lang="python=">import string

LOWERCASE_OFFSET = ord(&#34;a&#34;)
ALPHABET = string.ascii_lowercase[:16]

def b16_encode(plain):
	enc = &#34;&#34;
	for c in plain:
		binary = &#34;{0:08b}&#34;.format(ord(c))
		enc += ALPHABET[int(binary[:4], 2)]
		enc += ALPHABET[int(binary[4:], 2)]
	return enc

def shift(c, k):
	t1 = ord(c) - LOWERCASE_OFFSET
	t2 = ord(k) - LOWERCASE_OFFSET
	return ALPHABET[(t1 + t2) % len(ALPHABET)]

flag = &#34;redacted&#34;
key = &#34;redacted&#34;
assert all([k in ALPHABET for k in key])
assert len(key) == 1

b16 = b16_encode(flag)
enc = &#34;&#34;
for i, c in enumerate(b16):
	enc += shift(c, key[i % len(key)])
print(enc)
</code></pre><p>:::</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ol><li>Hint in the code
It gave two hints in the code that represented by <code>assert</code>
1.1 The key must in the first 16 character of alphabet strings, that is, the key is composed of <code>a~p</code>.
1.2 The key length is just 1</li><li>Encode to binary
Then it encodes each character to hex and split it in the middle. Then map the value to alphabet sequence, that is,
<code>a</code> $\to$ <code>0</code>
<code>b</code> $\to$ <code>1</code>
&mldr;
<code>o</code> $\to$ <code>14</code>
<code>p</code> $\to$ <code>15</code></li><li>Shift string
This process is just like <code>rot n</code> that it shift the concatenated strings with <code>n</code> characters.</li></ol><h2 id=exploit---recover>Exploit - Recover
<a class=anchor href=#exploit---recover>#</a></h2><ol><li>Guess it shift <code>n</code> character
First, we can guess the <code>n</code> value for example 1. And then we try to shift it back.</li><li>Regroup and Re-mapping
Then we can represent the shifted string as binary. If the length of the binary value is equal to <code>8</code>, that means we can regroup it to a real strings as ascii.</li><li>Then repeat 16 times
Here is the 16 outcomes&mldr;<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>et_tu?_23217b54456fb10e908b5e87c6e89156
</span></span><span style=display:flex><span>v<span style=color:#e6db74>`</span>@<span style=color:#e6db74>`</span>CDCBHsFEEFGwsBAvJAIsFvIHtGvIJBFG
</span></span><span style=display:flex><span>qQqTUTSYWVVWXSR<span style=color:#f92672>[</span>RZWZYXZ<span style=color:#f92672>[</span>SWX
</span></span><span style=display:flex><span>§§¨befedjhgghidclckhkjikldhi
</span></span><span style=display:flex><span>©¸¸¹svwvu<span style=color:#f92672>{</span>¦yxxyzª¦ut©<span style=color:#f92672>}</span>t|¦y©|<span style=color:#f92672>{</span>§z©|<span style=color:#f92672>}</span>uyz
</span></span><span style=display:flex><span>ºÉ¤ÉÊ¤·»·º·º¸º
</span></span><span style=display:flex><span>ËÚµÚÛµÈÌÈËÈËÉË
</span></span><span style=display:flex><span>ÜëÆëì¦Æ©ª©¨®Ù¬««¬­ÝÙ¨§Ü §¯Ù¬Ü¯®Ú­Ü¯ ¨¬­
</span></span><span style=display:flex><span>íü×üý·×º»º¹¿ê½¼¼½¾îê¹¸í±¸°ê½í°¿ë¾í°±¹½¾
</span></span><span style=display:flex><span>ÈèËÌËÊÀûÎÍÍÎÏÿûÊÉþÂÉÁûÎþÁÀüÏþÁÂÊÎÏ
</span></span></code></pre></div>Seems the first one is quite normal. And we got the flag&mldr;
Flag: <code>picoCTF{et_tu?_23217b54456fb10e908b5e87c6e89156}</code>
:::spoiler whole exploit</li></ol><pre tabindex=0><code class="language-python!=" data-lang="python!=">import string

LOWERCASE_OFFSET = ord(&#34;a&#34;)
ALPHABET = string.ascii_lowercase[:16]
cipher_flag = &#34;apbopjbobpnjpjnmnnnmnlnbamnpnononpnaaaamnlnkapndnkncamnpapncnbannaapncndnlnpna&#34;

def binToHexa(n):
    bnum = int(n)
    temp = 0
    mul = 1
    count = 1
    hexaDeciNum = [&#39;0&#39;] * 100
    i = 0
    while bnum != 0:
        rem = bnum % 10
        temp = temp + (rem*mul)
        if count % 4 == 0:
            if temp &lt; 10:
                hexaDeciNum[i] = chr(temp+48)
            else:
                hexaDeciNum[i] = chr(temp+55)
            mul = 1
            temp = 0
            count = 1
            i = i+1
        else:
            mul = mul*2
            count = count+1
        bnum = int(bnum/10)
    if count != 1:
        hexaDeciNum[i] = chr(temp+48)
    if count == 1:
        i = i-1
    hex_string = &#39;&#39;
    while i &gt;= 0:
        hex_string += hexaDeciNum[i]
        i = i-1
    if hex_string == &#39;&#39;:
        hex_string = &#39;00&#39;
    return hex_string

tmp = &#34;&#34;
guess_strings = &#34;&#34;
for i in range(1, 16):
    for e in cipher_flag:
        tmp += &#34;{0:04b}&#34;.format((ord(e) - LOWERCASE_OFFSET + i) % len(ALPHABET))
        if len(tmp) % 8 == 0:
            guess_strings += chr(int(binToHexa(tmp), 16))
            tmp = &#34;&#34;
    tmp = &#34;&#34;
    print(guess_strings)
    guess_strings = &#34;&#34;
:::
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#source-code>Source code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit---recover>Exploit - Recover</a></li></ul></nav></div></aside></main></body></html>