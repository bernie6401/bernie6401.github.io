<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  PicoCTF - corrupt-key-1
  #


  tags: PicoCTF CTF Crypto
  #


  Source code
  #


private.key
-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQC4yxzKmbasQYdsGIRXMqXL/Idd80bukALOYIUItfz2tgpax3Iq
LWTvdOFEOjOOcKc+Y6MD86ya3xmFlWmfbp8wwAnSGcfZjE7IQgNhCDQCnHlWfvwI
9mtLw/Vkv7VxVGoGt+SPs1u5zOqaLNRDSfgpJCB436ZNUlknv9VdCZwCTwIDAQAB
AoGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQQDnAFaP9Qa9WJKv
klkhJeBsvpvUXf6v6TGjM8E0YwI9TwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAkEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJBAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
-----END RSA PRIVATE KEY-----

msg.enc
71dc d160 9ac4 a05c d14f 04a9 b43c 2aa3
83d2 a8d6 749b b978 75d5 437a a944 45f2
4073 f605 ef1c 5657 8d0e 7a2d f3be b5c1
7741 8476 0b3d 44fc b97e 6631 b6fe 2487
6258 d445 a7d7 4c7c e3cc 00ec f925 f442
c91d 10c9 cefb 9ca6 9c88 da3c 9d26 6c96
9033 63d5 6a13 7b64 1fc3 8709 2416 f7fb
eb4c 4c94 cc8e 157f cc0e d122 159c 27d5



  Recon
  #

可見private.key的內文被corrupted了，必須要修復才能夠解密ciphertext，但看來看去也找不到相關的write up，或是修復的方法，從連結這篇write up也看不懂如何修復，雖然他有附上code，但是很多error也無法debug(主要是看不懂)，總而言之我們的目標就是找出$p$為何"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/picoctf/crypto/rsa/picoctf---corrupt-key-1/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PicoCTF - corrupt-key-1"><meta property="og:description" content="PicoCTF - corrupt-key-1 # tags: PicoCTF CTF Crypto # Source code # private.key -----BEGIN RSA PRIVATE KEY----- MIICXAIBAAKBgQC4yxzKmbasQYdsGIRXMqXL/Idd80bukALOYIUItfz2tgpax3Iq LWTvdOFEOjOOcKc+Y6MD86ya3xmFlWmfbp8wwAnSGcfZjE7IQgNhCDQCnHlWfvwI 9mtLw/Vkv7VxVGoGt+SPs1u5zOqaLNRDSfgpJCB436ZNUlknv9VdCZwCTwIDAQAB AoGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQQDnAFaP9Qa9WJKv klkhJeBsvpvUXf6v6TGjM8E0YwI9TwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAkEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJBAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA= -----END RSA PRIVATE KEY----- msg.enc 71dc d160 9ac4 a05c d14f 04a9 b43c 2aa3 83d2 a8d6 749b b978 75d5 437a a944 45f2 4073 f605 ef1c 5657 8d0e 7a2d f3be b5c1 7741 8476 0b3d 44fc b97e 6631 b6fe 2487 6258 d445 a7d7 4c7c e3cc 00ec f925 f442 c91d 10c9 cefb 9ca6 9c88 da3c 9d26 6c96 9033 63d5 6a13 7b64 1fc3 8709 2416 f7fb eb4c 4c94 cc8e 157f cc0e d122 159c 27d5 Recon # 可見private.key的內文被corrupted了，必須要修復才能夠解密ciphertext，但看來看去也找不到相關的write up，或是修復的方法，從連結這篇write up也看不懂如何修復，雖然他有附上code，但是很多error也無法debug(主要是看不懂)，總而言之我們的目標就是找出$p$為何"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="PicoCTF"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Crypto"><title>PicoCTF - corrupt-key-1 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/picoctf/crypto/rsa/picoctf---corrupt-key-1/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PicoCTF - corrupt-key-1</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#source-code>Source code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit---recover-private-key-file>Exploit - Recover Private Key File</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=picoctf---corrupt-key-1>PicoCTF - corrupt-key-1
<a class=anchor href=#picoctf---corrupt-key-1>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><ul><li>private.key<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>-----BEGIN RSA PRIVATE KEY-----
</span></span><span style=display:flex><span>MIICXAIBAAKBgQC4yxzKmbasQYdsGIRXMqXL/Idd80bukALOYIUItfz2tgpax3Iq
</span></span><span style=display:flex><span>LWTvdOFEOjOOcKc+Y6MD86ya3xmFlWmfbp8wwAnSGcfZjE7IQgNhCDQCnHlWfvwI
</span></span><span style=display:flex><span>9mtLw/Vkv7VxVGoGt+SPs1u5zOqaLNRDSfgpJCB436ZNUlknv9VdCZwCTwIDAQAB
</span></span><span style=display:flex><span>AoGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQQDnAFaP9Qa9WJKv
</span></span><span style=display:flex><span>klkhJeBsvpvUXf6v6TGjM8E0YwI9TwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAkEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJBAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>-----END RSA PRIVATE KEY-----
</span></span></code></pre></div></li><li>msg.enc<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>71dc d160 9ac4 a05c d14f 04a9 b43c 2aa3
</span></span><span style=display:flex><span>83d2 a8d6 749b b978 75d5 437a a944 45f2
</span></span><span style=display:flex><span><span style=color:#ae81ff>4073</span> f605 ef1c <span style=color:#ae81ff>5657</span> 8d0e 7a2d f3be b5c1
</span></span><span style=display:flex><span><span style=color:#ae81ff>7741</span> <span style=color:#ae81ff>8476</span> 0b3d 44fc b97e <span style=color:#ae81ff>6631</span> b6fe <span style=color:#ae81ff>2487</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>6258</span> d445 a7d7 4c7c e3cc 00ec f925 f442
</span></span><span style=display:flex><span>c91d 10c9 cefb 9ca6 9c88 da3c 9d26 6c96
</span></span><span style=display:flex><span><span style=color:#ae81ff>9033</span> 63d5 6a13 7b64 1fc3 <span style=color:#ae81ff>8709</span> <span style=color:#ae81ff>2416</span> f7fb
</span></span><span style=display:flex><span>eb4c 4c94 cc8e 157f cc0e d122 159c 27d5
</span></span></code></pre></div></li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>可見private.key的內文被corrupted了，必須要修復才能夠解密ciphertext，但看來看去也找不到相關的write up，或是修復的方法，從<a href=https://connor-mccartney.github.io/cryptography/rsa/corrupt-key-1-picoMini>連結</a>這篇write up也看不懂如何修復，雖然他有附上code，但是很多error也無法debug(主要是看不懂)，總而言之我們的目標就是找出$p$為何</p><p>2023/6/18 更新：有空可以看一下<a href=https://github.com/Mr-Aur0ra/RSA/blob/master/%289%29%E7%A7%81%E9%92%A5%E6%96%87%E4%BB%B6%E4%BF%AE%E5%A4%8D/godlikeRSA/fix.py>RSA Private Key Recovery</a>的code</p><h2 id=exploit---recover-private-key-file>Exploit - Recover Private Key File
<a class=anchor href=#exploit---recover-private-key-file>#</a></h2><ol><li>先看沒有corrupt的部份的訊息為何<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ openssl rsa -in private.key -text -noout
</span></span><span style=display:flex><span>RSA Private-Key: <span style=color:#f92672>(</span><span style=color:#ae81ff>1024</span> bit, <span style=color:#ae81ff>2</span> primes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>modulus:
</span></span><span style=display:flex><span>    00:b8:cb:1c:ca:99:b6:ac:41:87:6c:18:84:57:32:
</span></span><span style=display:flex><span>    a5:cb:fc:87:5d:f3:46:ee:90:02:ce:60:85:08:b5:
</span></span><span style=display:flex><span>    fc:f6:b6:0a:5a:c7:72:2a:2d:64:ef:74:e1:44:3a:
</span></span><span style=display:flex><span>    33:8e:70:a7:3e:63:a3:03:f3:ac:9a:df:19:85:95:
</span></span><span style=display:flex><span>    69:9f:6e:9f:30:c0:09:d2:19:c7:d9:8c:4e:c8:42:
</span></span><span style=display:flex><span>    03:61:08:34:02:9c:79:56:7e:fc:08:f6:6b:4b:c3:
</span></span><span style=display:flex><span>    f5:64:bf:b5:71:54:6a:06:b7:e4:8f:b3:5b:b9:cc:
</span></span><span style=display:flex><span>    ea:9a:2c:d4:43:49:f8:29:24:20:78:df:a6:4d:52:
</span></span><span style=display:flex><span>    59:27:bf:d5:5d:09:9c:02:4f
</span></span><span style=display:flex><span>publicExponent: <span style=color:#ae81ff>65537</span> <span style=color:#f92672>(</span>0x10001<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>privateExponent: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>prime1:
</span></span><span style=display:flex><span>    00:e7:00:56:8f:f5:06:bd:58:92:af:92:59:21:25:
</span></span><span style=display:flex><span>    e0:6c:be:9b:d4:5d:fe:af:e9:31:a3:33:c1:34:63:
</span></span><span style=display:flex><span>    02:3d:4f:00:00:00:00:00:00:00:00:00:00:00:00:
</span></span><span style=display:flex><span>    00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:
</span></span><span style=display:flex><span>    00:00:00:00:00
</span></span><span style=display:flex><span>prime2: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>exponent1: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>exponent2: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>coefficient: <span style=color:#ae81ff>0</span>
</span></span></code></pre></div>所以由上可知<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>n <span style=color:#f92672>=</span> 0x00b8cb1cca99b6ac41876c18845732a5cbfc875df346ee9002ce608508b5fcf6b60a5ac7722a2d64ef74e1443a338e70a73e63a303f3ac9adf198595699f6e9f30c009d219c7d98c4ec84203610834029c79567efc08f66b4bc3f564bfb571546a06b7e48fb35bb9ccea9a2cd44349f829242078dfa64d525927bfd55d099c024f
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> 0x10001
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> 0xe700568ff506bd5892af92592125e06cbe9bd45dfeafe931a333c13463023d4f0000000000000000000000000000000000000000000000000000000000000000
</span></span></code></pre></div></li><li>由<a href=https://connor-mccartney.github.io/cryptography/rsa/corrupt-key-1-picoMini>連結</a>提供的code進行修復，雖然這個code很多error也不能work但先假設可以找到$p$</li><li>找到$p$就是一個正常的RSA decrypt<pre tabindex=0><code class="language-python=" data-lang="python=">from Crypto.Util.number import *

n = 0x00b8cb1cca99b6ac41876c18845732a5cbfc875df346ee9002ce608508b5fcf6b60a5ac7722a2d64ef74e1443a338e70a73e63a303f3ac9adf198595699f6e9f30c009d219c7d98c4ec84203610834029c79567efc08f66b4bc3f564bfb571546a06b7e48fb35bb9ccea9a2cd44349f829242078dfa64d525927bfd55d099c024f
e = 0x10001
p = 0xe700568ff506bd5892af92592125e06cbe9bd45dfeafe931a333c13463023d4fc25c71b1e8c70d8c28c10fe025474ea96f90887e707f76205565e9e241d571bb
q = n//p
d = pow(e, -1, (p-1)*(q-1))
c = open(&#39;msg.enc&#39;, &#39;rb&#39;).read()
c = bytes_to_long(c)
m = pow(c, d, n)
print(long_to_bytes(m))
</code></pre><pre tabindex=0><code class=language-bash! data-lang=bash!>$ python exp-flag.py
b&#39;\x02\x858\xd4\x05\xd3\xf3Z\xdf!\xffW\x9e\x1ee\xaf\x02+1[8\xc5|t\xc6\x95\xe7\xe3m&#34;/*V\x02\x04\xedZ\xe9Q\x05}/\x999\xce\xb7\xe1\xcc\x9e\xb8W^\xb6\xcd\x05\xa4\xd7xG\x9aI\xe2\x86F\xebW\x00Here is your flag: picoCTF{d741543f172970457e6a9aaa890935b8}&#39;
</code></pre></li></ol><h1 id=reference>Reference
<a class=anchor href=#reference>#</a></h1><p><a href=https://connor-mccartney.github.io/cryptography/rsa/corrupt-key-1-picoMini>corrupt-key-1 Write Up</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#source-code>Source code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit---recover-private-key-file>Exploit - Recover Private Key File</a></li></ul></nav></div></aside></main></body></html>