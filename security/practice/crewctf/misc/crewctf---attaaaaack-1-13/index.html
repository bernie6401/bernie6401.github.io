<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  CrewCTF - Attaaaaack 1-13
  #

:::spoiler TOC
[TOC]
:::
One of our employees at the company complained about suspicious behavior on the machine, our IR team took a memory dump from the machine and we need to investigate it.

  ==Attaaaaack 1==
  #


Q1. What is the best profile for the the machine?

  Exploit
  #

$ volatility_2.6_win64_standalone.exe -f memdump.raw imageinfo
Volatility Foundation Volatility Framework 2.6
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86
                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)
                     AS Layer2 : FileAddressSpace (D:\NTU\CTF\CrewCTF\Misc\Attaaaaack\memdump.raw)
                      PAE type : PAE
                           DTB : 0x185000L
                          KDBG : 0x82b7ab78L
          Number of Processors : 1
     Image Type (Service Pack) : 1
                KPCR for CPU 0 : 0x80b96000L
             KUSER_SHARED_DATA : 0xffdf0000L
           Image date and time : 2023-02-20 19:10:54 UTC+0000
     Image local date and time : 2023-02-20 21:10:54 +0200
Flag: crew{Win7SP1x86_23418}"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/crewctf/misc/crewctf---attaaaaack-1-13/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CrewCTF - Attaaaaack 1-13"><meta property="og:description" content="CrewCTF - Attaaaaack 1-13 # :::spoiler TOC [TOC] :::
One of our employees at the company complained about suspicious behavior on the machine, our IR team took a memory dump from the machine and we need to investigate it.
==Attaaaaack 1== # Q1. What is the best profile for the the machine?
Exploit # $ volatility_2.6_win64_standalone.exe -f memdump.raw imageinfo Volatility Foundation Volatility Framework 2.6 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86 AS Layer1 : IA32PagedMemoryPae (Kernel AS) AS Layer2 : FileAddressSpace (D:\NTU\CTF\CrewCTF\Misc\Attaaaaack\memdump.raw) PAE type : PAE DTB : 0x185000L KDBG : 0x82b7ab78L Number of Processors : 1 Image Type (Service Pack) : 1 KPCR for CPU 0 : 0x80b96000L KUSER_SHARED_DATA : 0xffdf0000L Image date and time : 2023-02-20 19:10:54 UTC+0000 Image local date and time : 2023-02-20 21:10:54 +0200 Flag: crew{Win7SP1x86_23418}"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CTF"><meta property="article:tag" content="CrewCTF"><meta property="article:tag" content="Misc"><title>CrewCTF - Attaaaaack 1-13 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/crewctf/misc/crewctf---attaaaaack-1-13/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CrewCTF - Attaaaaack 1-13</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#attaaaaack-1>==Attaaaaack 1==</a><ul><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#attaaaaack-2>==Attaaaaack 2==</a><ul><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#attaaaaack-3>==Attaaaaack 3==</a><ul><li><a href=#recon>Recon</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#attaaaaack-4>==Attaaaaack 4==</a><ul><li><a href=#recon-1>Recon</a></li><li><a href=#exploit-3>Exploit</a></li></ul></li><li><a href=#attaaaaack-5>==Attaaaaack 5==</a><ul><li><a href=#exploit-4>Exploit</a></li></ul></li><li><a href=#attaaaaack-6>==Attaaaaack 6==</a><ul><li><a href=#recon-2>Recon</a></li><li><a href=#exploit-5>Exploit</a></li></ul></li><li><a href=#attaaaaack-7>==Attaaaaack 7==</a><ul><li><a href=#recon-3>Recon</a></li><li><a href=#exploit-6>Exploit</a></li></ul></li><li><a href=#attaaaaack-8>==Attaaaaack 8==</a><ul><li><a href=#background>Background</a></li><li><a href=#recon-4>Recon</a></li><li><a href=#exploit-7>Exploit</a></li></ul></li><li><a href=#attaaaaack-9>==Attaaaaack 9==</a><ul><li><a href=#background-1>Background</a></li><li><a href=#recon-5>Recon</a></li><li><a href=#exploit-8>Exploit</a></li></ul></li><li><a href=#attaaaaack-10>==Attaaaaack 10==</a><ul><li><a href=#background-2>Background</a></li><li><a href=#recon-6>Recon</a></li><li><a href=#exploit-9>Exploit</a></li></ul></li><li><a href=#attaaaaack-11>==Attaaaaack 11==</a><ul><li><a href=#exploit-10>Exploit</a></li></ul></li><li><a href=#attaaaaack-12>==Attaaaaack 12==</a><ul><li><a href=#background-3>Background</a></li><li><a href=#recon-7>Recon</a></li><li><a href=#exploit-11>Exploit</a></li></ul></li><li><a href=#attaaaaack-13>==Attaaaaack 13==</a><ul><li><a href=#recon-8>Recon</a></li><li><a href=#exploit-12>Exploit</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=crewctf---attaaaaack-1-13>CrewCTF - Attaaaaack 1-13
<a class=anchor href=#crewctf---attaaaaack-1-13>#</a></h1><p>:::spoiler TOC
[TOC]
:::</p><p>One of our employees at the company complained about suspicious behavior on the machine, our IR team took a memory dump from the machine and we need to investigate it.</p><h2 id=attaaaaack-1>==Attaaaaack 1==
<a class=anchor href=#attaaaaack-1>#</a></h2><blockquote><p>Q1. What is the best profile for the the machine?</p></blockquote><h3 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw imageinfo
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>INFO    : volatility.debug    : Determining profile based on KDBG search...
</span></span><span style=display:flex><span>          Suggested Profile<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86
</span></span><span style=display:flex><span>                     AS Layer1 : IA32PagedMemoryPae <span style=color:#f92672>(</span>Kernel AS<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                     AS Layer2 : FileAddressSpace <span style=color:#f92672>(</span>D:<span style=color:#ae81ff>\N</span>TU<span style=color:#ae81ff>\C</span>TF<span style=color:#ae81ff>\C</span>rewCTF<span style=color:#ae81ff>\M</span>isc<span style=color:#ae81ff>\A</span>ttaaaaack<span style=color:#ae81ff>\m</span>emdump.raw<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                      PAE type : PAE
</span></span><span style=display:flex><span>                           DTB : 0x185000L
</span></span><span style=display:flex><span>                          KDBG : 0x82b7ab78L
</span></span><span style=display:flex><span>          Number of Processors : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>     Image Type <span style=color:#f92672>(</span>Service Pack<span style=color:#f92672>)</span> : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                KPCR <span style=color:#66d9ef>for</span> CPU <span style=color:#ae81ff>0</span> : 0x80b96000L
</span></span><span style=display:flex><span>             KUSER_SHARED_DATA : 0xffdf0000L
</span></span><span style=display:flex><span>           Image date and time : 2023-02-20 19:10:54 UTC+0000
</span></span><span style=display:flex><span>     Image local date and time : 2023-02-20 21:10:54 +0200
</span></span></code></pre></div><p>Flag: <code>crew{Win7SP1x86_23418}</code></p><h2 id=attaaaaack-2>==Attaaaaack 2==
<a class=anchor href=#attaaaaack-2>#</a></h2><blockquote><p>Q2. How many processes were running ? (number)</p></blockquote><h3 id=exploit-1>Exploit
<a class=anchor href=#exploit-1>#</a></h3><p>:::spoiler Command Result</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 pslist
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>Offset<span style=color:#f92672>(</span>V<span style=color:#f92672>)</span>  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit
</span></span><span style=display:flex><span>---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
</span></span><span style=display:flex><span>0x8419c020 System                    <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>89</span>      <span style=color:#ae81ff>536</span> ------      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:19 UTC+0000
</span></span><span style=display:flex><span>0x962f2020 smss.exe                <span style=color:#ae81ff>268</span>      <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>29</span> ------      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:19 UTC+0000
</span></span><span style=display:flex><span>0x860a8c78 csrss.exe               <span style=color:#ae81ff>352</span>    <span style=color:#ae81ff>344</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>462</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:20 UTC+0000
</span></span><span style=display:flex><span>0x855dfd20 wininit.exe             <span style=color:#ae81ff>404</span>    <span style=color:#ae81ff>344</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>76</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:20 UTC+0000
</span></span><span style=display:flex><span>0x8550b030 csrss.exe               <span style=color:#ae81ff>416</span>    <span style=color:#ae81ff>396</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>268</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:20 UTC+0000
</span></span><span style=display:flex><span>0x85ea2368 services.exe            <span style=color:#ae81ff>480</span>    <span style=color:#ae81ff>404</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>220</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:20 UTC+0000
</span></span><span style=display:flex><span>0x85ea8610 lsass.exe               <span style=color:#ae81ff>488</span>    <span style=color:#ae81ff>404</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>568</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:20 UTC+0000
</span></span><span style=display:flex><span>0x85eab718 lsm.exe                 <span style=color:#ae81ff>496</span>    <span style=color:#ae81ff>404</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>151</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:20 UTC+0000
</span></span><span style=display:flex><span>0x85eacb80 winlogon.exe            <span style=color:#ae81ff>508</span>    <span style=color:#ae81ff>396</span>      <span style=color:#ae81ff>5</span>      <span style=color:#ae81ff>115</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:20 UTC+0000
</span></span><span style=display:flex><span>0x85f4d030 svchost.exe             <span style=color:#ae81ff>632</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>357</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:21 UTC+0000
</span></span><span style=display:flex><span>0x85ef0a90 svchost.exe             <span style=color:#ae81ff>700</span>    <span style=color:#ae81ff>480</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>280</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:21 UTC+0000
</span></span><span style=display:flex><span>0x919e2958 svchost.exe             <span style=color:#ae81ff>752</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>22</span>      <span style=color:#ae81ff>507</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:21 UTC+0000
</span></span><span style=display:flex><span>0x85f9c3a8 svchost.exe             <span style=color:#ae81ff>868</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>13</span>      <span style=color:#ae81ff>309</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:21 UTC+0000
</span></span><span style=display:flex><span>0x85fae030 svchost.exe             <span style=color:#ae81ff>908</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>715</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:21 UTC+0000
</span></span><span style=display:flex><span>0x85fb7670 svchost.exe             <span style=color:#ae81ff>952</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>34</span>      <span style=color:#ae81ff>995</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:22 UTC+0000
</span></span><span style=display:flex><span>0x85ff1380 svchost.exe            <span style=color:#ae81ff>1104</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>391</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:22 UTC+0000
</span></span><span style=display:flex><span>0x8603a030 spoolsv.exe            <span style=color:#ae81ff>1236</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>13</span>      <span style=color:#ae81ff>270</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:22 UTC+0000
</span></span><span style=display:flex><span>0x86071818 svchost.exe            <span style=color:#ae81ff>1280</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>19</span>      <span style=color:#ae81ff>312</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:22 UTC+0000
</span></span><span style=display:flex><span>0x860b73c8 svchost.exe            <span style=color:#ae81ff>1420</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>146</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:22 UTC+0000
</span></span><span style=display:flex><span>0x860ba030 taskhost.exe           <span style=color:#ae81ff>1428</span>    <span style=color:#ae81ff>480</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>205</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:22 UTC+0000
</span></span><span style=display:flex><span>0x861321c8 dwm.exe                <span style=color:#ae81ff>1576</span>    <span style=color:#ae81ff>868</span>      <span style=color:#ae81ff>5</span>      <span style=color:#ae81ff>114</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:23 UTC+0000
</span></span><span style=display:flex><span>0x8613c030 explorer.exe           <span style=color:#ae81ff>1596</span>   <span style=color:#ae81ff>1540</span>     <span style=color:#ae81ff>29</span>      <span style=color:#ae81ff>842</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:23 UTC+0000
</span></span><span style=display:flex><span>0x841d7500 VGAuthService.         <span style=color:#ae81ff>1636</span>    <span style=color:#ae81ff>480</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>84</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:23 UTC+0000
</span></span><span style=display:flex><span>0x86189d20 vmtoolsd.exe           <span style=color:#ae81ff>1736</span>   <span style=color:#ae81ff>1596</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>179</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:23 UTC+0000
</span></span><span style=display:flex><span>0x8619dd20 vm3dservice.ex         <span style=color:#ae81ff>1848</span>    <span style=color:#ae81ff>480</span>      <span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>60</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:24 UTC+0000
</span></span><span style=display:flex><span>0x861a9030 vmtoolsd.exe           <span style=color:#ae81ff>1884</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>13</span>      <span style=color:#ae81ff>290</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:24 UTC+0000
</span></span><span style=display:flex><span>0x861b5360 vm3dservice.ex         <span style=color:#ae81ff>1908</span>   <span style=color:#ae81ff>1848</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>44</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:24 UTC+0000
</span></span><span style=display:flex><span>0x861fc700 svchost.exe             <span style=color:#ae81ff>580</span>    <span style=color:#ae81ff>480</span>      <span style=color:#ae81ff>6</span>       <span style=color:#ae81ff>91</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:25 UTC+0000
</span></span><span style=display:flex><span>0x86261030 WmiPrvSE.exe           <span style=color:#ae81ff>1748</span>    <span style=color:#ae81ff>632</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>204</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:25 UTC+0000
</span></span><span style=display:flex><span>0x86251bf0 dllhost.exe             <span style=color:#ae81ff>400</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>196</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:26 UTC+0000
</span></span><span style=display:flex><span>0x8629e518 msdtc.exe              <span style=color:#ae81ff>2168</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>158</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:31 UTC+0000
</span></span><span style=display:flex><span>0x8629e188 SearchIndexer.         <span style=color:#ae81ff>2276</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>12</span>      <span style=color:#ae81ff>581</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:31 UTC+0000
</span></span><span style=display:flex><span>0x8630b228 wmpnetwk.exe           <span style=color:#ae81ff>2404</span>    <span style=color:#ae81ff>480</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>212</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:32 UTC+0000
</span></span><span style=display:flex><span>0x862cca38 svchost.exe            <span style=color:#ae81ff>2576</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>232</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:33 UTC+0000
</span></span><span style=display:flex><span>0x85351030 WmiPrvSE.exe           <span style=color:#ae81ff>3020</span>    <span style=color:#ae81ff>632</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>242</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:01:45 UTC+0000
</span></span><span style=display:flex><span>0x853faac8 ProcessHacker.         <span style=color:#ae81ff>3236</span>   <span style=color:#ae81ff>1596</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>416</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:02:37 UTC+0000
</span></span><span style=display:flex><span>0x843068f8 sppsvc.exe             <span style=color:#ae81ff>2248</span>    <span style=color:#ae81ff>480</span>      <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>146</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:25 UTC+0000
</span></span><span style=display:flex><span>0x85f89640 svchost.exe            <span style=color:#ae81ff>2476</span>    <span style=color:#ae81ff>480</span>     <span style=color:#ae81ff>13</span>      <span style=color:#ae81ff>369</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:25 UTC+0000
</span></span><span style=display:flex><span>0x843658d0 cmd.exe                <span style=color:#ae81ff>2112</span>   <span style=color:#ae81ff>2876</span>      <span style=color:#ae81ff>1</span>       <span style=color:#ae81ff>20</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:40 UTC+0000
</span></span><span style=display:flex><span>0x84368798 cmd.exe                <span style=color:#ae81ff>2928</span>   <span style=color:#ae81ff>2876</span>      <span style=color:#ae81ff>1</span>       <span style=color:#ae81ff>20</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:40 UTC+0000
</span></span><span style=display:flex><span>0x84365c90 conhost.exe            <span style=color:#ae81ff>1952</span>    <span style=color:#ae81ff>416</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>49</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:40 UTC+0000
</span></span><span style=display:flex><span>0x84384d20 conhost.exe            <span style=color:#ae81ff>2924</span>    <span style=color:#ae81ff>416</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>49</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:40 UTC+0000
</span></span><span style=display:flex><span>0x84398998 runddl32.exe            <span style=color:#ae81ff>300</span>   <span style=color:#ae81ff>2876</span>     <span style=color:#ae81ff>10</span>     <span style=color:#ae81ff>2314</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:40 UTC+0000
</span></span><span style=display:flex><span>0x84390030 notepad.exe            <span style=color:#ae81ff>2556</span>    <span style=color:#ae81ff>300</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>58</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:41 UTC+0000
</span></span><span style=display:flex><span>0x84df2458 audiodg.exe            <span style=color:#ae81ff>1556</span>    <span style=color:#ae81ff>752</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>129</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:10:50 UTC+0000
</span></span><span style=display:flex><span>0x84f1caf8 DumpIt.exe             <span style=color:#ae81ff>2724</span>   <span style=color:#ae81ff>1596</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>38</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:10:52 UTC+0000
</span></span><span style=display:flex><span>0x84f3d878 conhost.exe            <span style=color:#ae81ff>3664</span>    <span style=color:#ae81ff>416</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>51</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:10:52 UTC+0000
</span></span></code></pre></div><p>:::</p><p>Flag: <code>47</code></p><h2 id=attaaaaack-3>==Attaaaaack 3==
<a class=anchor href=#attaaaaack-3>#</a></h2><blockquote><p>Q3. i think the user left note on the machine. can you find it ?</p></blockquote><h3 id=recon>Recon
<a class=anchor href=#recon>#</a></h3><p>這一題真的要通靈，看到note第一直覺應該是想到要看有沒有類似notepad這樣的文字編輯器，果不其然pslist有這個process，所以可以把該process的memory dump出來，然後strings search再grep特定的regular expression，不過這邊有一個需要通靈的地方，就是通靈regular expression的形式，還必須要注意strings的形式是16 bits和little endian的形式才找的到，上述方法是參考<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，另外一個方法是可以通靈到作者有可能會把字串暫存在clipboard上，這樣就可以搭配clipboard這個plugin，可以直接print出clipboard中的內容</p><h3 id=exploit-2>Exploit
<a class=anchor href=#exploit-2>#</a></h3><ul><li>方法一<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 clipboard
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>Session    WindowStation Format                 Handle Object     Data
</span></span><span style=display:flex><span>---------- ------------- ------------------ ---------- ---------- --------------------------------------------------
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>1</span> WinSta0       CF_UNICODETEXT        0xa00d9 0xfe897838 1_l0v3_M3m0ry_F0r3ns1cs_S0_muchhhhhhhhh
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>1</span> WinSta0       0x0L                     0x10 ----------
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>1</span> WinSta0       0x2000L                   0x0 ----------
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>1</span> WinSta0       0x0L                   0x3000 ----------
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>1</span> ------------- ------------------   0x1a02a9 0xfe670a68
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>1</span> ------------- ------------------   0x100067 0xffbab448
</span></span></code></pre></div></li><li>方法二<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 pslist | findstr notepad
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>0x84390030 notepad.exe            <span style=color:#ae81ff>2556</span>    <span style=color:#ae81ff>300</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>58</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:41 UTC+0000
</span></span><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 memdump --pid <span style=color:#ae81ff>2556</span> -D .<span style=color:#ae81ff>\o</span>utput
</span></span><span style=display:flex><span>$ strings -el 2556.dmp | grep -E <span style=color:#e6db74>&#34;(.*?)_(.*?)_&#34;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>_040515AD&amp;REV_00
</span></span><span style=display:flex><span>PCI<span style=color:#ae81ff>\V</span>EN_15AD&amp;DEV_0405&amp;SUBSYS_040515AD&amp;REV_TERMINAL
</span></span><span style=display:flex><span>CI<span style=color:#ae81ff>\V</span>EN_15AD&amp;DEV_0405&amp;CC_0300
</span></span><span style=display:flex><span>DEV_0405&amp;CC_030000
</span></span><span style=display:flex><span>PCI<span style=color:#ae81ff>\V</span>EN_15AD&amp;DEV_0405&amp;CC_0300
</span></span><span style=display:flex><span>1_l0v3_M3m0ry_F0r3ns1cs_S0_muchhhhhhhhh
</span></span><span style=display:flex><span>EN_15AD&amp;DEV_0405&amp;CC_0300
</span></span><span style=display:flex><span><span style=color:#ae81ff>\?</span>?<span style=color:#ae81ff>\H</span>ID#VID_0E0F&amp;PID_0003&amp;MI_00#8&amp;167f267&amp;0&amp;0000#<span style=color:#f92672>{</span>378de44c-56ef-11d1-bc8c-00a0c91405dd<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\?</span>?<span style=color:#ae81ff>\I</span>DE#CdRomNECVMWar_VMware_SATA_CD01_______________1.00____#6&amp;22d3c06&amp;0&amp;1.0.0#<span style=color:#f92672>{</span>53f56308-b6bf-11d0-94f2-00a0c91efb8b<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>\?</span>?<span style=color:#ae81ff>\H</span>ID#VID_0E0F&amp;PID_0003&amp;MI_01#8&amp;226f4b5b&amp;0&amp;0000#<span style=color:#f92672>{</span>378de44c-56ef-11d1-bc8c-00a0c91405dd<span style=color:#f92672>}</span>
</span></span></code></pre></div></li></ul><p>Flag: <code>crew{1_l0v3_M3m0ry_F0r3ns1cs_S0_muchhhhhhhhh}</code></p><h2 id=attaaaaack-4>==Attaaaaack 4==
<a class=anchor href=#attaaaaack-4>#</a></h2><blockquote><p>Q4. What is the name and PID of the suspicious process ?
example : crew{abcd.exe_111}</p></blockquote><h3 id=recon-1>Recon
<a class=anchor href=#recon-1>#</a></h3><p>因為是賽後解，所以其實&mldr;如果是線上解的話可以try&amp;error，反正這一題也是頗單純，如果觀察pslist的process，會發現有一個runddl32.exe他就是在模仿rundll32，所以這就是一個怪可疑的process</p><h3 id=exploit-3>Exploit
<a class=anchor href=#exploit-3>#</a></h3><p>Flag: <code>crew{runddl32.exe_300}</code></p><h2 id=attaaaaack-5>==Attaaaaack 5==
<a class=anchor href=#attaaaaack-5>#</a></h2><blockquote><p>Q5. What is the another process that is related to this process and it&rsquo;s strange ?
example : crew{spotify.exe}</p></blockquote><h3 id=exploit-4>Exploit
<a class=anchor href=#exploit-4>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 pslist
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>Offset<span style=color:#f92672>(</span>V<span style=color:#f92672>)</span>  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit
</span></span><span style=display:flex><span>---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>0x84398998 runddl32.exe            <span style=color:#ae81ff>300</span>   <span style=color:#ae81ff>2876</span>     <span style=color:#ae81ff>10</span>     <span style=color:#ae81ff>2314</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:40 UTC+0000
</span></span><span style=display:flex><span>0x84390030 notepad.exe            <span style=color:#ae81ff>2556</span>    <span style=color:#ae81ff>300</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>58</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-20 19:03:41 UTC+0000
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Flag: <code>crew{notepad.exe}</code></p><h2 id=attaaaaack-6>==Attaaaaack 6==
<a class=anchor href=#attaaaaack-6>#</a></h2><blockquote><p>Q6. What is the full path (including executable name) of the hidden executable?
example : crew{C:\Windows\System32\abc.exe}</p></blockquote><h3 id=recon-2>Recon
<a class=anchor href=#recon-2>#</a></h3><p>這一題指的是runddl32.exe在哪邊，就直接filescan然後string search就找到了</p><h3 id=exploit-5>Exploit
<a class=anchor href=#exploit-5>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 filescan | findstr runddl32.exe
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>0x0000000024534f80      <span style=color:#ae81ff>5</span>      <span style=color:#ae81ff>0</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume1<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\0</span>XSH3R~1<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\L</span>ocal<span style=color:#ae81ff>\T</span>emp<span style=color:#ae81ff>\M</span>SDCSC<span style=color:#ae81ff>\r</span>unddl32.exe
</span></span><span style=display:flex><span>0x000000003ea44038      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>0</span> RWD--- <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume1<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\0</span>XSH3R~1<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\L</span>ocal<span style=color:#ae81ff>\T</span>emp<span style=color:#ae81ff>\M</span>SDCSC<span style=color:#ae81ff>\r</span>unddl32.exe
</span></span></code></pre></div><p>Flag: <code>crew{C:\Users\0XSH3R~1\AppData\Local\Temp\MSDCSC\runddl32.exe}</code></p><h2 id=attaaaaack-7>==Attaaaaack 7==
<a class=anchor href=#attaaaaack-7>#</a></h2><blockquote><p>Q7. What is the API used by the malware to retrieve the status of a specified virtual key on the keyboard ?
flag format: crew{AbcDef}</p></blockquote><h3 id=recon-3>Recon
<a class=anchor href=#recon-3>#</a></h3><p>仔細分析題目的話，會知道他要我們找出malware使用哪個API(method/function)取得keyboard上的虛擬按鍵，所以直覺的做法是直接把該執行檔dump出來，然後string search這隻檔案有哪些和key相關的東西</p><h3 id=exploit-6>Exploit
<a class=anchor href=#exploit-6>#</a></h3><p>如果把該支malware丟到virustotal後，結果可以看<a href=https://www.virustotal.com/gui/file/25aaa2657e649d8976cb321a6bf63eb56e8451ebde550003ef98782dd1b5ae62>這邊</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 procdump --pid <span style=color:#ae81ff>300</span> -D .<span style=color:#ae81ff>\o</span>utput
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>Process<span style=color:#f92672>(</span>V<span style=color:#f92672>)</span> ImageBase  Name                 Result
</span></span><span style=display:flex><span>---------- ---------- -------------------- ------
</span></span><span style=display:flex><span>0x84398998 0x00400000 runddl32.exe         OK: executable.300.exe
</span></span><span style=display:flex><span>$ strings executable.300.exe | grep -i key
</span></span><span style=display:flex><span>AutoHotkeysd-C
</span></span><span style=display:flex><span>AutoHotkeys
</span></span><span style=display:flex><span>AutoHotkeys
</span></span><span style=display:flex><span>TWMKey
</span></span><span style=display:flex><span>System<span style=color:#ae81ff>\C</span>urrentControlSet<span style=color:#ae81ff>\C</span>ontrol<span style=color:#ae81ff>\K</span>eyboard Layouts<span style=color:#ae81ff>\%</span>.8x
</span></span><span style=display:flex><span>        TKeyEvent
</span></span><span style=display:flex><span>TKeyPressEvent
</span></span><span style=display:flex><span>HelpKeyword nA
</span></span><span style=display:flex><span>80211_SHARED_KEY
</span></span><span style=display:flex><span>KEYNAME
</span></span><span style=display:flex><span>KEYNAME
</span></span><span style=display:flex><span>KEYNAME
</span></span><span style=display:flex><span>KEYNAME
</span></span><span style=display:flex><span>RegOpenKeyExA
</span></span><span style=display:flex><span>RegCloseKey
</span></span><span style=display:flex><span>GetKeyboardType
</span></span><span style=display:flex><span>keybd_event
</span></span><span style=display:flex><span>VkKeyScanA
</span></span><span style=display:flex><span>MapVirtualKeyA
</span></span><span style=display:flex><span>LoadKeyboardLayoutA
</span></span><span style=display:flex><span>GetKeyboardState
</span></span><span style=display:flex><span>GetKeyboardLayoutNameA
</span></span><span style=display:flex><span>GetKeyboardLayoutList
</span></span><span style=display:flex><span>GetKeyboardLayout
</span></span><span style=display:flex><span>GetKeyState
</span></span><span style=display:flex><span>GetKeyNameTextA
</span></span><span style=display:flex><span>ActivateKeyboardLayout
</span></span><span style=display:flex><span>RegQueryInfoKeyA
</span></span><span style=display:flex><span>RegOpenKeyExA
</span></span><span style=display:flex><span>RegOpenKeyA
</span></span><span style=display:flex><span>RegFlushKey
</span></span><span style=display:flex><span>RegEnumKeyExA
</span></span><span style=display:flex><span>RegDeleteKeyA
</span></span><span style=display:flex><span>RegCreateKeyExA
</span></span><span style=display:flex><span>RegCreateKeyA
</span></span><span style=display:flex><span>RegCloseKey
</span></span><span style=display:flex><span>UntKeylogger
</span></span><span style=display:flex><span>UntControlKey
</span></span></code></pre></div><p>一個一個try就可以了</p><p>Flag: <code>crew{GetKeyState}</code></p><h2 id=attaaaaack-8>==Attaaaaack 8==
<a class=anchor href=#attaaaaack-8>#</a></h2><blockquote><p>Q8. What is the Attacker&rsquo;s C2 domain name and port number ? (domain name:port number)
example : crew{abcd.com:8080}</p></blockquote><h3 id=background>Background
<a class=anchor href=#background>#</a></h3><p><a href=https://hackmd.io/@SBK6401/B1LqaNGCh/https%3A%2F%2Fhackmd.io%2F%40SBK6401%2FBJpJqDhlp#Q21>CyberDefender - MrRobot - POS - Q21</a></p><h3 id=recon-4>Recon
<a class=anchor href=#recon-4>#</a></h3><p>這一題直覺會想用netscan，畢竟從前面的題目以及找到的資訊，還有virustotal上的資訊，幾乎確定他就是一個keylogger，然後會把得到的資訊傳回去C&amp;C server中，但奇怪的是察看netscan沒有相關的connection，不確定到底是怎麼樣，找了很久，最後是參考<a href=https://siunam321.github.io/ctf/CrewCTF-2023/Forensics/Attaaaaack1-13/#attaaaaack8>siunam321</a>的writeup，他也是找了很久，結果其實virustotal都已經寫好了，</p><h3 id=exploit-7>Exploit
<a class=anchor href=#exploit-7>#</a></h3><p><img src=https://hackmd.io/_uploads/S1-f44e-p.png alt>
在Behavior的地方</p><p>Flag: <code>crew{test213.no-ip.info:1604}</code></p><h2 id=attaaaaack-9>==Attaaaaack 9==
<a class=anchor href=#attaaaaack-9>#</a></h2><blockquote><p>Q9. Seems that there is Keylogger, can you find it&rsquo;s path ?
example : crew{C:\Windows\System32\abc.def}</p></blockquote><h3 id=background-1>Background
<a class=anchor href=#background-1>#</a></h3><h3 id=recon-5>Recon
<a class=anchor href=#recon-5>#</a></h3><p>這一題完全不會，所以看了<a href=https://siunam321.github.io/ctf/CrewCTF-2023/Forensics/Attaaaaack1-13/#attaaaaack9>siunam321</a>的writeup，他的做法是到網路上找有沒有<code>test213.no-ip.info keylogger</code>的相關文章，結果<a href=http://www.tekdefense.com/news/2013/12/23/analyzing-darkcomet-in-memory.html>TekDefense</a>就有提到這隻malware</p><blockquote><p>The OFFLINEK option had me confused for a bit. So to explain it a bit better, when OFFLINEK is enabled “{1}” the malware will continue to log keystroke to a local file that can then be picked up by the attacker as they want. When disabled, the attacker only has access to keystrokes when the attacker has a live session open with the victim.</p></blockquote><p>簡單來說就是他有一個參數(OFFLINEK)，如果被設定為1，則在離線的時候還是會繼續記錄，然後把結果存在local file，這也回應了前面位甚麼用netscan找不到的原因，因為作者沒有連線，所以當然不會有相關的process，而該bloger也找到了他存在local端的地方就在
<code>C:\Users\{Username}\AppData\Roaming\dclogs\{timestamp}.dc</code>
<img src=https://hackmd.io/_uploads/SyycDNx-6.png alt></p><h3 id=exploit-8>Exploit
<a class=anchor href=#exploit-8>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 filescan | findstr .dc | findstr <span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\R</span>oaming<span style=color:#ae81ff>\d</span>clogs
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>0x000000003fcb3350      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>0</span> -W-r-- <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume1<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\0</span>xSh3rl0ck<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\R</span>oaming<span style=color:#ae81ff>\d</span>clogs<span style=color:#ae81ff>\2</span>023-02-20-2.dc
</span></span></code></pre></div><p>Flag: <code>crew{C:\Users\0xSh3rl0ck\AppData\Roaming\dclogs\2023-02-20-2.dc}</code></p><h2 id=attaaaaack-10>==Attaaaaack 10==
<a class=anchor href=#attaaaaack-10>#</a></h2><blockquote><p>Q10. we think that the malware uses persistence technique can you detect it ?
example : crew{Scheduled_tasks} (first letter of the first word is uppercase and the first letter of other is lowercase)</p></blockquote><h3 id=background-2>Background
<a class=anchor href=#background-2>#</a></h3><p><a href=https://hackmd.io/@SBK6401/B1LqaNGCh/https%3A%2F%2Fhackmd.io%2F%40SBK6401%2FSkJAThwla#Q5>NTUSTISC - CyberDefender - MrRobot - Target 1 - Q5</a></p><h3 id=recon-6>Recon
<a class=anchor href=#recon-6>#</a></h3><p>這題background可以看前面寫的文章，然後基本上都差不多，只是要特別注意-K後面帶的參數，一定要是從Software開始，他和原本cyberdefender的版本有點不太一樣，下-k參數之前先看printkey印出甚麼東西，然後再從他的subkey往後推看是要接Software還是Mircosoft，基本上都會寫在**<code>\REGISTRY\USER\</code>**的部分</p><h3 id=exploit-9>Exploit
<a class=anchor href=#exploit-9>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 printkey -K <span style=color:#e6db74>&#34;Software\Microsoft\Windows\CurrentVersion\Run&#34;</span>
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>Legend: <span style=color:#f92672>(</span>S<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> Stable   <span style=color:#f92672>(</span>V<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> Volatile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>----------------------------
</span></span><span style=display:flex><span>Registry: <span style=color:#ae81ff>\?</span>?<span style=color:#ae81ff>\C</span>:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\0</span>xSh3rl0ck<span style=color:#ae81ff>\n</span>tuser.dat
</span></span><span style=display:flex><span>Key name: Run <span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Last updated: 2023-02-20 19:03:40 UTC+0000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Subkeys:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Values:
</span></span><span style=display:flex><span>REG_SZ        MicroUpdate     : <span style=color:#f92672>(</span>S<span style=color:#f92672>)</span> C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\0</span>XSH3R~1<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\L</span>ocal<span style=color:#ae81ff>\T</span>emp<span style=color:#ae81ff>\M</span>SDCSC<span style=color:#ae81ff>\r</span>unddl32.exe
</span></span><span style=display:flex><span>----------------------------
</span></span><span style=display:flex><span>Registry: <span style=color:#ae81ff>\R</span>EGISTRY<span style=color:#ae81ff>\U</span>SER<span style=color:#ae81ff>\S</span>-1-5-20
</span></span><span style=display:flex><span>Key name: Run <span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Last updated: 2009-07-14 04:34:14 UTC+0000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Subkeys:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Values:
</span></span><span style=display:flex><span>REG_EXPAND_SZ Sidebar         : <span style=color:#f92672>(</span>S<span style=color:#f92672>)</span> %ProgramFiles%<span style=color:#ae81ff>\W</span>indows Sidebar<span style=color:#ae81ff>\S</span>idebar.exe /autoRun
</span></span><span style=display:flex><span>----------------------------
</span></span><span style=display:flex><span>Registry: <span style=color:#ae81ff>\?</span>?<span style=color:#ae81ff>\C</span>:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>erviceProfiles<span style=color:#ae81ff>\L</span>ocalService<span style=color:#ae81ff>\N</span>TUSER.DAT
</span></span><span style=display:flex><span>Key name: Run <span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Last updated: 2009-07-14 04:34:14 UTC+0000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Subkeys:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Values:
</span></span><span style=display:flex><span>REG_EXPAND_SZ Sidebar         : <span style=color:#f92672>(</span>S<span style=color:#f92672>)</span> %ProgramFiles%<span style=color:#ae81ff>\W</span>indows Sidebar<span style=color:#ae81ff>\S</span>idebar.exe /autoRun
</span></span></code></pre></div><p>Flag: <code>crew{Registry_keys}</code></p><h2 id=attaaaaack-11>==Attaaaaack 11==
<a class=anchor href=#attaaaaack-11>#</a></h2><blockquote><p>Q11. can you find the key name and it&rsquo;s value ?
example : crew{CurrentVersion_ProductName}</p></blockquote><h3 id=exploit-10>Exploit
<a class=anchor href=#exploit-10>#</a></h3><p>從上一題的輸出就知道key name是run，然後value是MicroUpdate
Flag: <code>crew{Run_MicroUpdate}</code></p><h2 id=attaaaaack-12>==Attaaaaack 12==
<a class=anchor href=#attaaaaack-12>#</a></h2><blockquote><p>Q12. What is the strange handle used by the malware ?
example : crew{the name of the handle}</p></blockquote><h3 id=background-3>Background
<a class=anchor href=#background-3>#</a></h3><p><a href=https://hackmd.io/@SBK6401/B1LqaNGCh/https%3A%2F%2Fhackmd.io%2F%40SBK6401%2FSkJAThwla#Q6>NTUSTISC - CyberDefender - MrRobot - Target 1 - Q6</a></p><h3 id=recon-7>Recon
<a class=anchor href=#recon-7>#</a></h3><p>基本上就和之前寫的文章一樣，</p><h3 id=exploit-11>Exploit
<a class=anchor href=#exploit-11>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw --profile Win7SP1x86_23418 handles --pid <span style=color:#ae81ff>300</span> | findstr Mutant
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>Offset<span style=color:#f92672>(</span>V<span style=color:#f92672>)</span>     Pid     Handle     Access Type             Details
</span></span><span style=display:flex><span>---------- ------ ---------- ---------- ---------------- -------
</span></span><span style=display:flex><span>0x843b0728    <span style=color:#ae81ff>300</span>       0x58   0x1f0001 Mutant
</span></span><span style=display:flex><span>0x843b0b28    <span style=color:#ae81ff>300</span>       0x5c   0x1f0001 Mutant
</span></span><span style=display:flex><span>0x842eb8b8    <span style=color:#ae81ff>300</span>      0x170   0x1f0001 Mutant           DC_MUTEX-KHNEW06
</span></span><span style=display:flex><span>0x843ac810    <span style=color:#ae81ff>300</span>      0x234   0x1f0001 Mutant
</span></span><span style=display:flex><span>0x843ac7c0    <span style=color:#ae81ff>300</span>      0x23c   0x1f0001 Mutant
</span></span></code></pre></div><p>Flag: <code>crew{DC_MUTEX-KHNEW06}</code></p><h2 id=attaaaaack-13>==Attaaaaack 13==
<a class=anchor href=#attaaaaack-13>#</a></h2><blockquote><p>Q13. Now can you help us to know the Family of this malware ?
example : crew{Malware}</p></blockquote><h3 id=recon-8>Recon
<a class=anchor href=#recon-8>#</a></h3><p>這一題在第7題就找到了</p><h3 id=exploit-12>Exploit
<a class=anchor href=#exploit-12>#</a></h3><p>Flag: <code>crew{DarkKomet}</code></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://github.com/daffainfo/ctf-writeup/tree/main/CrewCTF%202023/Attaaaaack3>Attaaaaack3</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#attaaaaack-1>==Attaaaaack 1==</a><ul><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#attaaaaack-2>==Attaaaaack 2==</a><ul><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#attaaaaack-3>==Attaaaaack 3==</a><ul><li><a href=#recon>Recon</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#attaaaaack-4>==Attaaaaack 4==</a><ul><li><a href=#recon-1>Recon</a></li><li><a href=#exploit-3>Exploit</a></li></ul></li><li><a href=#attaaaaack-5>==Attaaaaack 5==</a><ul><li><a href=#exploit-4>Exploit</a></li></ul></li><li><a href=#attaaaaack-6>==Attaaaaack 6==</a><ul><li><a href=#recon-2>Recon</a></li><li><a href=#exploit-5>Exploit</a></li></ul></li><li><a href=#attaaaaack-7>==Attaaaaack 7==</a><ul><li><a href=#recon-3>Recon</a></li><li><a href=#exploit-6>Exploit</a></li></ul></li><li><a href=#attaaaaack-8>==Attaaaaack 8==</a><ul><li><a href=#background>Background</a></li><li><a href=#recon-4>Recon</a></li><li><a href=#exploit-7>Exploit</a></li></ul></li><li><a href=#attaaaaack-9>==Attaaaaack 9==</a><ul><li><a href=#background-1>Background</a></li><li><a href=#recon-5>Recon</a></li><li><a href=#exploit-8>Exploit</a></li></ul></li><li><a href=#attaaaaack-10>==Attaaaaack 10==</a><ul><li><a href=#background-2>Background</a></li><li><a href=#recon-6>Recon</a></li><li><a href=#exploit-9>Exploit</a></li></ul></li><li><a href=#attaaaaack-11>==Attaaaaack 11==</a><ul><li><a href=#exploit-10>Exploit</a></li></ul></li><li><a href=#attaaaaack-12>==Attaaaaack 12==</a><ul><li><a href=#background-3>Background</a></li><li><a href=#recon-7>Recon</a></li><li><a href=#exploit-11>Exploit</a></li></ul></li><li><a href=#attaaaaack-13>==Attaaaaack 13==</a><ul><li><a href=#recon-8>Recon</a></li><li><a href=#exploit-12>Exploit</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>