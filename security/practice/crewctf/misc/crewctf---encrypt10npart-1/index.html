<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  CrewCTF - Encrypt10n(Part 1)
  #


  Background
  #

Volatility 3

  Recon
  #


Description: We made a memory dump on the criminal machine after entering the crime scene. Our investigator thought he was using encryption software to hide the secret. can you help me to detect it?
Q1 : crew{password}
這種類型之前沒碰過，所以看了別人的WP學一下1
首先他有提到他有用加密的技術隱藏secret，所以我們的目的就是要找到password


  Exploit - Memory Forensics
  #


先找到運行的OS version或其他軟硬體資訊
$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw imageinfo
Volatility Foundation Volatility Framework 2.6.1
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86
                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)
                     AS Layer2 : FileAddressSpace (/mnt/d/Download/Trash/dump.raw)
                      PAE type : PAE
                           DTB : 0x185000L
                          KDBG : 0x82b3db78L
          Number of Processors : 1
     Image Type (Service Pack) : 1
                KPCR for CPU 0 : 0x839a5000L
             KUSER_SHARED_DATA : 0xffdf0000L
           Image date and time : 2023-02-16 12:03:16 UTC+0000
     Image local date and time : 2023-02-16 14:03:16 +0200
重點: Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86
列出當時系統正在運行的process
$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw pslist --profile=Win7SP0x86
Volatility Foundation Volatility Framework 2.6.1
Offset(V)  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit
---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
0x8413a938 System                    4      0     88      520 ------      0 2023-02-16 12:00:48 UTC+0000
0x84e481c8 smss.exe                252      4      2       29 ------      0 2023-02-16 12:00:49 UTC+0000
0x84cae358 csrss.exe               340    324      8      550      0      0 2023-02-16 12:00:53 UTC+0000
0x844ea030 wininit.exe             392    324      3       77      0      0 2023-02-16 12:00:54 UTC+0000
0x84ef5030 csrss.exe               400    384      9      223      1      0 2023-02-16 12:00:54 UTC+0000
0x8573dd20 winlogon.exe            456    384      6      114      1      0 2023-02-16 12:00:54 UTC+0000
0x85749868 services.exe            496    392      8      228      0      0 2023-02-16 12:00:54 UTC+0000
0x85763030 lsass.exe               508    392      7      578      0      0 2023-02-16 12:00:55 UTC+0000
0x85764030 lsm.exe                 516    392     10      149      0      0 2023-02-16 12:00:55 UTC+0000
0x857bd510 svchost.exe             624    496     11      362      0      0 2023-02-16 12:00:56 UTC+0000
0x85809510 svchost.exe             704    496      7      298      0      0 2023-02-16 12:00:56 UTC+0000
0x85859920 svchost.exe             784    496     23      510      0      0 2023-02-16 12:00:56 UTC+0000
0x8586da80 svchost.exe             832    496     15      265      0      0 2023-02-16 12:00:57 UTC+0000
0x85872bb0 svchost.exe             856    496     22      731      0      0 2023-02-16 12:00:57 UTC+0000
0x85875460 svchost.exe             880    496     47     1013      0      0 2023-02-16 12:00:57 UTC+0000
0x8588f370 audiodg.exe             960    784      6      132      0      0 2023-02-16 12:00:57 UTC+0000
0x858c2420 svchost.exe            1092    496     18      389      0      0 2023-02-16 12:00:58 UTC+0000
0x857d6030 spoolsv.exe            1288    496     15      270      0      0 2023-02-16 12:00:59 UTC+0000
0x857d1030 dwm.exe                1296    832      6      114      1      0 2023-02-16 12:00:59 UTC+0000
0x857c7030 svchost.exe            1324    496     21      310      0      0 2023-02-16 12:00:59 UTC+0000
0x857a5d20 explorer.exe           1384   1276     33      923      1      0 2023-02-16 12:00:59 UTC+0000
0x857c4d20 taskhost.exe           1400    496     10      197      1      0 2023-02-16 12:00:59 UTC+0000
0x85837898 svchost.exe            1560    496     11      146      0      0 2023-02-16 12:01:00 UTC+0000
0x841d1030 VGAuthService.         1720    496      4       85      0      0 2023-02-16 12:01:01 UTC+0000
0x841d7118 vmtoolsd.exe           1736   1384     10      181      1      0 2023-02-16 12:01:02 UTC+0000
0x85856030 vm3dservice.ex         1836    496      5       60      0      0 2023-02-16 12:01:03 UTC+0000
0x85857d20 vmtoolsd.exe           1856    496     14      291      0      0 2023-02-16 12:01:03 UTC+0000
0x841e5678 vm3dservice.ex         1880   1836      3       44      1      0 2023-02-16 12:01:03 UTC+0000
0x85a26030 svchost.exe             384    496      8       93      0      0 2023-02-16 12:01:05 UTC+0000
0x85a6e5d0 dllhost.exe             876    496     21      191      0      0 2023-02-16 12:01:05 UTC+0000
0x85941c28 dllhost.exe            1744    496     18      200      0      0 2023-02-16 12:01:05 UTC+0000
0x85ab6260 msdtc.exe              1128    496     15      154      0      0 2023-02-16 12:01:06 UTC+0000
0x85ac8b00 WmiPrvSE.exe            232    624     10      193      0      0 2023-02-16 12:01:06 UTC+0000
0x841f4470 SearchIndexer.         2148    496     14      604      0      0 2023-02-16 12:01:08 UTC+0000
0x85b2a030 VSSVC.exe              2276    496      7      118      0      0 2023-02-16 12:01:11 UTC+0000
0x85b80cb8 SearchProtocol         2372   2148      9      284      0      0 2023-02-16 12:01:13 UTC+0000
0x85b855f8 SearchFilterHo         2392   2148      6      104      0      0 2023-02-16 12:01:13 UTC+0000
0x85b97d20 svchost.exe            2480    496     15      232      0      0 2023-02-16 12:01:15 UTC+0000
0x85bc5398 wmpnetwk.exe           2632    496     11      212      0      0 2023-02-16 12:01:16 UTC+0000
0x85bba030 WmiPrvSE.exe           2860    624     15      319      0      0 2023-02-16 12:01:25 UTC+0000
0x85c53030 WmiApSrv.exe           3004    496      6      112      0      0 2023-02-16 12:01:30 UTC+0000
0x85c596c0 TrueCrypt.exe          3196   1384      2       67      1      0 2023-02-16 12:02:07 UTC+0000
0x84d54d20 sppsvc.exe             3736    496      6      154      0      0 2023-02-16 12:03:05 UTC+0000
0x84d567f0 svchost.exe            3776    496     15      353      0      0 2023-02-16 12:03:05 UTC+0000
0x844fcd20 DumpIt.exe             4072   1384      2       38      1      0 2023-02-16 12:03:14 UTC+0000
0x844ba6e0 conhost.exe            4080    400      2       51      1      0 2023-02-16 12:03:14 UTC+0000
重點：0x85c596c0 TrueCrypt.exe          3196   1384      2       67      1      0 2023-02-16 12:02:07 UTC+0000
TrueCrypt - Wiki

TrueCrypt是一款已停止開發的動態（On-the-fly）磁碟加密軟體，支援Windows、macOS和Linux作業系統。它可在單個檔案和磁碟分割區中建立加密區，也可以加密整個作業系統，解密後使用者即可像普通分割區一樣使用其中的檔案。TrueCrypt支援使用密碼、金鑰檔案作為解密憑據。"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/crewctf/misc/crewctf---encrypt10npart-1/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CrewCTF - Encrypt10n(Part 1)"><meta property="og:description" content="CrewCTF - Encrypt10n(Part 1) # Background # Volatility 3
Recon # Description: We made a memory dump on the criminal machine after entering the crime scene. Our investigator thought he was using encryption software to hide the secret. can you help me to detect it? Q1 : crew{password} 這種類型之前沒碰過，所以看了別人的WP學一下1 首先他有提到他有用加密的技術隱藏secret，所以我們的目的就是要找到password Exploit - Memory Forensics # 先找到運行的OS version或其他軟硬體資訊 $ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw imageinfo Volatility Foundation Volatility Framework 2.6.1 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86 AS Layer1 : IA32PagedMemoryPae (Kernel AS) AS Layer2 : FileAddressSpace (/mnt/d/Download/Trash/dump.raw) PAE type : PAE DTB : 0x185000L KDBG : 0x82b3db78L Number of Processors : 1 Image Type (Service Pack) : 1 KPCR for CPU 0 : 0x839a5000L KUSER_SHARED_DATA : 0xffdf0000L Image date and time : 2023-02-16 12:03:16 UTC+0000 Image local date and time : 2023-02-16 14:03:16 +0200 重點: Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86 列出當時系統正在運行的process $ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw pslist --profile=Win7SP0x86 Volatility Foundation Volatility Framework 2.6.1 Offset(V) Name PID PPID Thds Hnds Sess Wow64 Start Exit ---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------ 0x8413a938 System 4 0 88 520 ------ 0 2023-02-16 12:00:48 UTC+0000 0x84e481c8 smss.exe 252 4 2 29 ------ 0 2023-02-16 12:00:49 UTC+0000 0x84cae358 csrss.exe 340 324 8 550 0 0 2023-02-16 12:00:53 UTC+0000 0x844ea030 wininit.exe 392 324 3 77 0 0 2023-02-16 12:00:54 UTC+0000 0x84ef5030 csrss.exe 400 384 9 223 1 0 2023-02-16 12:00:54 UTC+0000 0x8573dd20 winlogon.exe 456 384 6 114 1 0 2023-02-16 12:00:54 UTC+0000 0x85749868 services.exe 496 392 8 228 0 0 2023-02-16 12:00:54 UTC+0000 0x85763030 lsass.exe 508 392 7 578 0 0 2023-02-16 12:00:55 UTC+0000 0x85764030 lsm.exe 516 392 10 149 0 0 2023-02-16 12:00:55 UTC+0000 0x857bd510 svchost.exe 624 496 11 362 0 0 2023-02-16 12:00:56 UTC+0000 0x85809510 svchost.exe 704 496 7 298 0 0 2023-02-16 12:00:56 UTC+0000 0x85859920 svchost.exe 784 496 23 510 0 0 2023-02-16 12:00:56 UTC+0000 0x8586da80 svchost.exe 832 496 15 265 0 0 2023-02-16 12:00:57 UTC+0000 0x85872bb0 svchost.exe 856 496 22 731 0 0 2023-02-16 12:00:57 UTC+0000 0x85875460 svchost.exe 880 496 47 1013 0 0 2023-02-16 12:00:57 UTC+0000 0x8588f370 audiodg.exe 960 784 6 132 0 0 2023-02-16 12:00:57 UTC+0000 0x858c2420 svchost.exe 1092 496 18 389 0 0 2023-02-16 12:00:58 UTC+0000 0x857d6030 spoolsv.exe 1288 496 15 270 0 0 2023-02-16 12:00:59 UTC+0000 0x857d1030 dwm.exe 1296 832 6 114 1 0 2023-02-16 12:00:59 UTC+0000 0x857c7030 svchost.exe 1324 496 21 310 0 0 2023-02-16 12:00:59 UTC+0000 0x857a5d20 explorer.exe 1384 1276 33 923 1 0 2023-02-16 12:00:59 UTC+0000 0x857c4d20 taskhost.exe 1400 496 10 197 1 0 2023-02-16 12:00:59 UTC+0000 0x85837898 svchost.exe 1560 496 11 146 0 0 2023-02-16 12:01:00 UTC+0000 0x841d1030 VGAuthService. 1720 496 4 85 0 0 2023-02-16 12:01:01 UTC+0000 0x841d7118 vmtoolsd.exe 1736 1384 10 181 1 0 2023-02-16 12:01:02 UTC+0000 0x85856030 vm3dservice.ex 1836 496 5 60 0 0 2023-02-16 12:01:03 UTC+0000 0x85857d20 vmtoolsd.exe 1856 496 14 291 0 0 2023-02-16 12:01:03 UTC+0000 0x841e5678 vm3dservice.ex 1880 1836 3 44 1 0 2023-02-16 12:01:03 UTC+0000 0x85a26030 svchost.exe 384 496 8 93 0 0 2023-02-16 12:01:05 UTC+0000 0x85a6e5d0 dllhost.exe 876 496 21 191 0 0 2023-02-16 12:01:05 UTC+0000 0x85941c28 dllhost.exe 1744 496 18 200 0 0 2023-02-16 12:01:05 UTC+0000 0x85ab6260 msdtc.exe 1128 496 15 154 0 0 2023-02-16 12:01:06 UTC+0000 0x85ac8b00 WmiPrvSE.exe 232 624 10 193 0 0 2023-02-16 12:01:06 UTC+0000 0x841f4470 SearchIndexer. 2148 496 14 604 0 0 2023-02-16 12:01:08 UTC+0000 0x85b2a030 VSSVC.exe 2276 496 7 118 0 0 2023-02-16 12:01:11 UTC+0000 0x85b80cb8 SearchProtocol 2372 2148 9 284 0 0 2023-02-16 12:01:13 UTC+0000 0x85b855f8 SearchFilterHo 2392 2148 6 104 0 0 2023-02-16 12:01:13 UTC+0000 0x85b97d20 svchost.exe 2480 496 15 232 0 0 2023-02-16 12:01:15 UTC+0000 0x85bc5398 wmpnetwk.exe 2632 496 11 212 0 0 2023-02-16 12:01:16 UTC+0000 0x85bba030 WmiPrvSE.exe 2860 624 15 319 0 0 2023-02-16 12:01:25 UTC+0000 0x85c53030 WmiApSrv.exe 3004 496 6 112 0 0 2023-02-16 12:01:30 UTC+0000 0x85c596c0 TrueCrypt.exe 3196 1384 2 67 1 0 2023-02-16 12:02:07 UTC+0000 0x84d54d20 sppsvc.exe 3736 496 6 154 0 0 2023-02-16 12:03:05 UTC+0000 0x84d567f0 svchost.exe 3776 496 15 353 0 0 2023-02-16 12:03:05 UTC+0000 0x844fcd20 DumpIt.exe 4072 1384 2 38 1 0 2023-02-16 12:03:14 UTC+0000 0x844ba6e0 conhost.exe 4080 400 2 51 1 0 2023-02-16 12:03:14 UTC+0000 重點：0x85c596c0 TrueCrypt.exe 3196 1384 2 67 1 0 2023-02-16 12:02:07 UTC+0000 TrueCrypt - Wiki TrueCrypt是一款已停止開發的動態（On-the-fly）磁碟加密軟體，支援Windows、macOS和Linux作業系統。它可在單個檔案和磁碟分割區中建立加密區，也可以加密整個作業系統，解密後使用者即可像普通分割區一樣使用其中的檔案。TrueCrypt支援使用密碼、金鑰檔案作為解密憑據。"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CTF"><meta property="article:tag" content="CrewCTF"><meta property="article:tag" content="Misc"><title>CrewCTF - Encrypt10n(Part 1) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/crewctf/misc/crewctf---encrypt10npart-1/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CrewCTF - Encrypt10n(Part 1)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit---memory-forensics>Exploit - Memory Forensics</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=crewctf---encrypt10npart-1>CrewCTF - Encrypt10n(Part 1)
<a class=anchor href=#crewctf---encrypt10npart-1>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://github.com/volatilityfoundation/volatility3>Volatility 3</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ul><li>Description: We made a memory dump on the criminal machine after entering the crime scene. Our investigator thought he was using encryption software to hide the secret. can you help me to detect it?</li><li>Q1 : crew{password}
這種類型之前沒碰過，所以看了別人的WP學一下<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>
首先他有提到他有用加密的技術隱藏secret，所以我們的目的就是要找到password</li></ul><h2 id=exploit---memory-forensics>Exploit - Memory Forensics
<a class=anchor href=#exploit---memory-forensics>#</a></h2><ol><li>先找到運行的OS version或其他軟硬體資訊<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw imageinfo
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6.1
</span></span><span style=display:flex><span>INFO    : volatility.debug    : Determining profile based on KDBG search...
</span></span><span style=display:flex><span>          Suggested Profile<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86
</span></span><span style=display:flex><span>                     AS Layer1 : IA32PagedMemoryPae <span style=color:#f92672>(</span>Kernel AS<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                     AS Layer2 : FileAddressSpace <span style=color:#f92672>(</span>/mnt/d/Download/Trash/dump.raw<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                      PAE type : PAE
</span></span><span style=display:flex><span>                           DTB : 0x185000L
</span></span><span style=display:flex><span>                          KDBG : 0x82b3db78L
</span></span><span style=display:flex><span>          Number of Processors : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>     Image Type <span style=color:#f92672>(</span>Service Pack<span style=color:#f92672>)</span> : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                KPCR <span style=color:#66d9ef>for</span> CPU <span style=color:#ae81ff>0</span> : 0x839a5000L
</span></span><span style=display:flex><span>             KUSER_SHARED_DATA : 0xffdf0000L
</span></span><span style=display:flex><span>           Image date and time : 2023-02-16 12:03:16 UTC+0000
</span></span><span style=display:flex><span>     Image local date and time : 2023-02-16 14:03:16 +0200
</span></span></code></pre></div>重點: <code>Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86</code></li><li>列出當時系統正在運行的process<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw pslist --profile<span style=color:#f92672>=</span>Win7SP0x86
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6.1
</span></span><span style=display:flex><span>Offset<span style=color:#f92672>(</span>V<span style=color:#f92672>)</span>  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit
</span></span><span style=display:flex><span>---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
</span></span><span style=display:flex><span>0x8413a938 System                    <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>88</span>      <span style=color:#ae81ff>520</span> ------      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:48 UTC+0000
</span></span><span style=display:flex><span>0x84e481c8 smss.exe                <span style=color:#ae81ff>252</span>      <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>29</span> ------      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:49 UTC+0000
</span></span><span style=display:flex><span>0x84cae358 csrss.exe               <span style=color:#ae81ff>340</span>    <span style=color:#ae81ff>324</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>550</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:53 UTC+0000
</span></span><span style=display:flex><span>0x844ea030 wininit.exe             <span style=color:#ae81ff>392</span>    <span style=color:#ae81ff>324</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>77</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x84ef5030 csrss.exe               <span style=color:#ae81ff>400</span>    <span style=color:#ae81ff>384</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>223</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x8573dd20 winlogon.exe            <span style=color:#ae81ff>456</span>    <span style=color:#ae81ff>384</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>114</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x85749868 services.exe            <span style=color:#ae81ff>496</span>    <span style=color:#ae81ff>392</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>228</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x85763030 lsass.exe               <span style=color:#ae81ff>508</span>    <span style=color:#ae81ff>392</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>578</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:55 UTC+0000
</span></span><span style=display:flex><span>0x85764030 lsm.exe                 <span style=color:#ae81ff>516</span>    <span style=color:#ae81ff>392</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>149</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:55 UTC+0000
</span></span><span style=display:flex><span>0x857bd510 svchost.exe             <span style=color:#ae81ff>624</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>362</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x85809510 svchost.exe             <span style=color:#ae81ff>704</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>298</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x85859920 svchost.exe             <span style=color:#ae81ff>784</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>23</span>      <span style=color:#ae81ff>510</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x8586da80 svchost.exe             <span style=color:#ae81ff>832</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>265</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x85872bb0 svchost.exe             <span style=color:#ae81ff>856</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>22</span>      <span style=color:#ae81ff>731</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x85875460 svchost.exe             <span style=color:#ae81ff>880</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>47</span>     <span style=color:#ae81ff>1013</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x8588f370 audiodg.exe             <span style=color:#ae81ff>960</span>    <span style=color:#ae81ff>784</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>132</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x858c2420 svchost.exe            <span style=color:#ae81ff>1092</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>389</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:58 UTC+0000
</span></span><span style=display:flex><span>0x857d6030 spoolsv.exe            <span style=color:#ae81ff>1288</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>270</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857d1030 dwm.exe                <span style=color:#ae81ff>1296</span>    <span style=color:#ae81ff>832</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>114</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857c7030 svchost.exe            <span style=color:#ae81ff>1324</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>21</span>      <span style=color:#ae81ff>310</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857a5d20 explorer.exe           <span style=color:#ae81ff>1384</span>   <span style=color:#ae81ff>1276</span>     <span style=color:#ae81ff>33</span>      <span style=color:#ae81ff>923</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857c4d20 taskhost.exe           <span style=color:#ae81ff>1400</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>197</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x85837898 svchost.exe            <span style=color:#ae81ff>1560</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>146</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:00 UTC+0000
</span></span><span style=display:flex><span>0x841d1030 VGAuthService.         <span style=color:#ae81ff>1720</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>85</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:01 UTC+0000
</span></span><span style=display:flex><span>0x841d7118 vmtoolsd.exe           <span style=color:#ae81ff>1736</span>   <span style=color:#ae81ff>1384</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>181</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:02 UTC+0000
</span></span><span style=display:flex><span>0x85856030 vm3dservice.ex         <span style=color:#ae81ff>1836</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>5</span>       <span style=color:#ae81ff>60</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x85857d20 vmtoolsd.exe           <span style=color:#ae81ff>1856</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>291</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x841e5678 vm3dservice.ex         <span style=color:#ae81ff>1880</span>   <span style=color:#ae81ff>1836</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>44</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x85a26030 svchost.exe             <span style=color:#ae81ff>384</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>8</span>       <span style=color:#ae81ff>93</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85a6e5d0 dllhost.exe             <span style=color:#ae81ff>876</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>21</span>      <span style=color:#ae81ff>191</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85941c28 dllhost.exe            <span style=color:#ae81ff>1744</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>200</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85ab6260 msdtc.exe              <span style=color:#ae81ff>1128</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>154</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:06 UTC+0000
</span></span><span style=display:flex><span>0x85ac8b00 WmiPrvSE.exe            <span style=color:#ae81ff>232</span>    <span style=color:#ae81ff>624</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>193</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:06 UTC+0000
</span></span><span style=display:flex><span>0x841f4470 SearchIndexer.         <span style=color:#ae81ff>2148</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>604</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:08 UTC+0000
</span></span><span style=display:flex><span>0x85b2a030 VSSVC.exe              <span style=color:#ae81ff>2276</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>118</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:11 UTC+0000
</span></span><span style=display:flex><span>0x85b80cb8 SearchProtocol         <span style=color:#ae81ff>2372</span>   <span style=color:#ae81ff>2148</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>284</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:13 UTC+0000
</span></span><span style=display:flex><span>0x85b855f8 SearchFilterHo         <span style=color:#ae81ff>2392</span>   <span style=color:#ae81ff>2148</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>104</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:13 UTC+0000
</span></span><span style=display:flex><span>0x85b97d20 svchost.exe            <span style=color:#ae81ff>2480</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>232</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:15 UTC+0000
</span></span><span style=display:flex><span>0x85bc5398 wmpnetwk.exe           <span style=color:#ae81ff>2632</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>212</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:16 UTC+0000
</span></span><span style=display:flex><span>0x85bba030 WmiPrvSE.exe           <span style=color:#ae81ff>2860</span>    <span style=color:#ae81ff>624</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>319</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:25 UTC+0000
</span></span><span style=display:flex><span>0x85c53030 WmiApSrv.exe           <span style=color:#ae81ff>3004</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>112</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:30 UTC+0000
</span></span><span style=display:flex><span>0x85c596c0 TrueCrypt.exe          <span style=color:#ae81ff>3196</span>   <span style=color:#ae81ff>1384</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>67</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:02:07 UTC+0000
</span></span><span style=display:flex><span>0x84d54d20 sppsvc.exe             <span style=color:#ae81ff>3736</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>154</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:05 UTC+0000
</span></span><span style=display:flex><span>0x84d567f0 svchost.exe            <span style=color:#ae81ff>3776</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>353</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:05 UTC+0000
</span></span><span style=display:flex><span>0x844fcd20 DumpIt.exe             <span style=color:#ae81ff>4072</span>   <span style=color:#ae81ff>1384</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>38</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:14 UTC+0000
</span></span><span style=display:flex><span>0x844ba6e0 conhost.exe            <span style=color:#ae81ff>4080</span>    <span style=color:#ae81ff>400</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>51</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:14 UTC+0000
</span></span></code></pre></div>重點：<code>0x85c596c0 TrueCrypt.exe 3196 1384 2 67 1 0 2023-02-16 12:02:07 UTC+0000</code>
<a href=https://zh.wikipedia.org/zh-tw/TrueCrypt>TrueCrypt - Wiki</a><blockquote><p>TrueCrypt是一款已停止開發的動態（On-the-fly）磁碟加密軟體，支援Windows、macOS和Linux作業系統。它可在單個檔案和磁碟分割區中建立加密區，也可以加密整個作業系統，解密後使用者即可像普通分割區一樣使用其中的檔案。TrueCrypt支援使用密碼、金鑰檔案作為解密憑據。</p></blockquote></li><li>取得密碼
用volatility 2的plugin(目前好像只有Ver. 2有這個plugin)<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw --profile<span style=color:#f92672>=</span>Win7SP0x86 truecryptsummary
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6.1
</span></span><span style=display:flex><span>Registry Version     TrueCrypt Version 7.0a
</span></span><span style=display:flex><span>Password             Strooooong_Passwword at offset 0x8d23de44
</span></span><span style=display:flex><span>Process              TrueCrypt.exe at 0x85c596c0 pid <span style=color:#ae81ff>3196</span>
</span></span><span style=display:flex><span>Service              truecrypt state SERVICE_RUNNING
</span></span><span style=display:flex><span>Kernel Module        truecrypt.sys at 0x8d20a000 - 0x8d241000
</span></span><span style=display:flex><span>Symbolic Link        Volume<span style=color:#f92672>{</span>a2e4e949-a9a8-11ed-859c-50eb71124999<span style=color:#f92672>}</span> -&gt; <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\T</span>rueCryptVolumeZ mounted 2023-02-16 12:02:56 UTC+0000
</span></span><span style=display:flex><span>Driver               <span style=color:#ae81ff>\D</span>river<span style=color:#ae81ff>\t</span>ruecrypt at 0x3f02fc98 range 0x8d20a000 - 0x8d240980
</span></span><span style=display:flex><span>Device               TrueCrypt at 0x84e2a9d8 type FILE_DEVICE_UNKNOWN
</span></span></code></pre></div></li></ol><p>Flag: <code>crew{Strooooong_Passwword}</code></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://ctftime.org/writeup/37415>CTFTime - Encrypt10n</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit---memory-forensics>Exploit - Memory Forensics</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>