<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  CrewCTF - Encrypt10n(Part 2)
  #


  Background
  #

How To Open A TrueCrypt Container Using cryptsetup

$ sudo cryptsetup --type tcrypt open container-to-mount container-name
什麽是塊設備，什麽是字符設備？有什麽區別？

  Recon
  #

這一題應該是沿用part 1得到的密碼進行解密

  Exploit
  #



用cryptsetup1先進行解密
$ sudo cryptsetup --type tcrypt open flag flag_decrypt
Enter passphrase for flag:
則輸出的結果就是一個container儲存在/dev/mapper，可以看到它是一個block device
$ ll /dev/mapper
total 0
drwxr-xr-x  2 root root       80 Jul 12 21:44 .
drwxr-xr-x 11 root root     3140 Jul 12 21:44 ..
crw-------  1 root root  10, 236 Jul 11 23:06 control
brw-rw----  1 root disk 252,   3 Jul 12 21:44 flag_dec


再來就要把這個container掛起來，要掛起來才能讀取裡面的資料"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/crewctf/misc/crewctf---encrypt10npart-2/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CrewCTF - Encrypt10n(Part 2)"><meta property="og:description" content="CrewCTF - Encrypt10n(Part 2) # Background # How To Open A TrueCrypt Container Using cryptsetup
$ sudo cryptsetup --type tcrypt open container-to-mount container-name
什麽是塊設備，什麽是字符設備？有什麽區別？
Recon # 這一題應該是沿用part 1得到的密碼進行解密
Exploit # 用cryptsetup1先進行解密
$ sudo cryptsetup --type tcrypt open flag flag_decrypt Enter passphrase for flag: 則輸出的結果就是一個container儲存在/dev/mapper，可以看到它是一個block device
$ ll /dev/mapper total 0 drwxr-xr-x 2 root root 80 Jul 12 21:44 . drwxr-xr-x 11 root root 3140 Jul 12 21:44 .. crw------- 1 root root 10, 236 Jul 11 23:06 control brw-rw---- 1 root disk 252, 3 Jul 12 21:44 flag_dec 再來就要把這個container掛起來，要掛起來才能讀取裡面的資料"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CTF"><meta property="article:tag" content="CrewCTF"><meta property="article:tag" content="Misc"><title>CrewCTF - Encrypt10n(Part 2) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/crewctf/misc/crewctf---encrypt10npart-2/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CrewCTF - Encrypt10n(Part 2)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=crewctf---encrypt10npart-2>CrewCTF - Encrypt10n(Part 2)
<a class=anchor href=#crewctf---encrypt10npart-2>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://kenfavors.com/code/how-to-open-a-truecrypt-container-using-cryptsetup/>How To Open A TrueCrypt Container Using cryptsetup</a></p><blockquote><p><code>$ sudo cryptsetup --type tcrypt open container-to-mount container-name</code></p></blockquote><p><a href=https://blog.51cto.com/majesty/991565>什麽是塊設備，什麽是字符設備？有什麽區別？</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題應該是沿用part 1得到的密碼進行解密</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ol><li><p>用<code>cryptsetup</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>先進行解密</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo cryptsetup --type tcrypt open flag flag_decrypt
</span></span><span style=display:flex><span>Enter passphrase <span style=color:#66d9ef>for</span> flag:
</span></span></code></pre></div><p>則輸出的結果就是一個container儲存在<code>/dev/mapper</code>，可以看到它是一個block device</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ll /dev/mapper
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>2</span> root root       <span style=color:#ae81ff>80</span> Jul <span style=color:#ae81ff>12</span> 21:44 .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>11</span> root root     <span style=color:#ae81ff>3140</span> Jul <span style=color:#ae81ff>12</span> 21:44 ..
</span></span><span style=display:flex><span>crw-------  <span style=color:#ae81ff>1</span> root root  10, <span style=color:#ae81ff>236</span> Jul <span style=color:#ae81ff>11</span> 23:06 control
</span></span><span style=display:flex><span>brw-rw----  <span style=color:#ae81ff>1</span> root disk 252,   <span style=color:#ae81ff>3</span> Jul <span style=color:#ae81ff>12</span> 21:44 flag_dec
</span></span></code></pre></div></li><li><p>再來就要把這個container掛起來，要掛起來才能讀取裡面的資料</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo mkdir /mnt/flag_dec
</span></span><span style=display:flex><span>$ sudo mount -o uid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> /dev/mapper/flag_dec /mnt/flag_dec
</span></span><span style=display:flex><span>$ ll /mnt/flag_dec
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>drwxrwxrwx <span style=color:#ae81ff>1</span> sbk6401 root <span style=color:#ae81ff>4096</span> Feb <span style=color:#ae81ff>16</span> 19:38 .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>7</span> root    root <span style=color:#ae81ff>4096</span> Jul <span style=color:#ae81ff>12</span> 21:57 ..
</span></span><span style=display:flex><span>-rwxrwxrwx <span style=color:#ae81ff>2</span> sbk6401 root <span style=color:#ae81ff>2360</span> Feb <span style=color:#ae81ff>12</span> 01:08 flaaaaaaaaaaaaaaaaaaaaaaaag.txt
</span></span><span style=display:flex><span>$ cat /mnt/flag_dec/flaaaaaaaaaaaaaaaaaaaaaaaag.txt
</span></span><span style=display:flex><span>Vm0wd2QyUXlVWGxWV0d4V1YwZDRXRmxVU205V01WbDNXa2M1VjFac2JETlhhMk0xVjBaS2MySkVUbGhoTWsweFZtcEJlRll5U2tWVWJHaG9UV3N3ZUZadGNFdFRNVWw1VTJ0V1ZXSkhhRzlVVmxaM1ZsWmFkR05GWkZwV01VcEpWbTEwYTFkSFNrZGpSVGxhVmpOU1IxcFZXbUZrUjA1R1UyMTRVMkpIZHpGV1ZFb3dWakZhV0ZOcmJGSmlSMmhZV1d4b2IwMHhXbGRYYlhSWFRWZDBObGxWV2xOVWJGcFlaSHBDVjAxdVVuWlZha1pYWkVaT2MxZHNhR2xTTW1oWlYxWmtNRmxXVWtkV1dHaFlZbGhTV0ZSV2FFTlNiRnBZWlVoa1YwMUVSbGRaTUZaM1ZqSktWVkpZWkZkaGExcFlXa1ZhVDJNeFpITmhSMnhUVFcxb1dsWXhaRFJWTVZsNFUydGthbEp0VWxsWmJGWmhZMVpzY2xkdFJteFdia0pIVmpKNFQxWlhTa2RqUm14aFUwaENSRlpxU2tabFZsSlpZVVprVTFKWVFrbFhXSEJIVkRKU1YxZHVUbFJpVjJoeldXeG9iMWRXV1hoYVJGSnBUV3RzTkZkclZtdFdiVXB5WTBac1dtSkhhRlJXTVZwWFkxWktjbVJHVWxkaWEwcElWbXBLZWs1V1dsaFRhMXBxVWxkb1dGUlhOVU5oUmxweFVtMUdUMkpGV2xwWlZWcGhZVWRGZUdOSE9WaGhNVnBvVmtSS1QyTXlUa1phUjJoVFRXMW9lbGRYZUc5aU1XUnpWMWhvWVZKR1NuQlVWM1J6VFRGU1ZtRkhPVmhTTUhCNVZHeGFjMWR0U2toaFJsSlhUVVp3VkZacVJuZFNWa1p5VDFkc1UwMHlhRmxXYlhCTFRrWlJlRmRzYUZSaVJuQnhWV3hrVTFsV1VsWlhiVVpPVFZad2VGVXlkREJXTVZweVkwWndXR0V4Y0hKWlZXUkdaVWRPU0U5V1pHaGhNSEJ2Vm10U1MxUnRWa2RqUld4VllsZG9WRlJYTlc5V1ZtUlhWV3M1VWsxWFVucFdNV2h2V1ZaS1IxTnNaRlZXYkZwNlZGUkdVMk15UmtaUFYyaHBVbGhDTmxkVVFtRmpNV1IwVTJ0a1dHSlhhRmhaVkVaM1ZrWmFjVkp0ZEd0U2EzQXdXbFZhYTJGV1NuTmhNMmhYWVRGd2FGWlVSbFpsUm1SMVUyczFXRkpZUW5oV1Z6QjRZakZaZUZWc2FFOVdlbXh6V1d0YWQyVkdWWGxrUkVKWFRWWndlVll5ZUhkWGJGcFhZMGhLVjJGcldreFdha3BQVWpKS1IxcEdaRTVOUlhCS1ZqRmFVMU14VlhoWFdHaFlZbXhhVjFsc2FHOVdSbXhaWTBaa1dGWnNjRmxaTUZVMVlWVXhXRlZ1Y0ZkTlYyaDJWMVphUzFJeFRuTmFSbFpYWWtadmVsWkdWbUZaVjFKR1RsWmFVRll5YUhCVmJHaENaREZrVjFadE9WVk5WbkF3VlcwMVMxWkhTbGhoUm1oYVZrVmFNMVpyV21GalZrcDFXa1pPVGxacmIzZFhiRlpyWXpGVmVWTnVTbFJoTTFKWVZGYzFiMWRHYkZWU2EzQnNVbTFTZWxsVldsTmhSVEZaVVc1b1YxWXphSEpXVkVaclVqRldjMkZGT1ZkaGVsWjVWMWQwWVdReVZrZFdibEpyVWtWS2IxbFljRWRsVmxKelZtNU9XR0pHY0ZoWk1GSlBWMnhhV0ZWclpHRldNMmhJV1RJeFIxSXlSa2hoUlRWWFYwVktSbFpxU2pSV01XeFhWVmhvWVZKWFVsWlpiWFIzWWpGV2NWTnRPVmRTYlhoNVZtMDFhMVl4V25OalNHaFdWak5vY2xaclZYaFhSbFp6WVVaa1RtRnNXazFXYWtKclV6Rk9SMVp1VWxCV2JGcFlXV3RvUTJJeFdrZFdiVVphVm14c05WVnRkRzlWUmxsNVlVWm9XbGRJUWxoVk1GcGhZMVpPY1ZWc1drNVdNVWwzVmxSS05GWXhWWGxUYTJSVVlsVmFWbFp0ZUhkTk1WcHlWMjFHYWxacmNEQlZiVEV3VmpKS2NsTnJiRmROYmxKeVdYcEdWbVF3TVVsaVIwWnNZVEZ3V1ZkWGVHOVJNVkpIVld4YVlWSldjSE5WYlRGVFYyeHNjbGRzVG1oU1ZFWjZWVEkxYjFZeFdYcGhSMmhoVWtWYVlWcFZXbXRrVmxaMFpVWk9XRkpyY0ZwV2ExcGhXVlpzVjFSclpGZGlhelZYV1cxek1WWXhXblJsUjBaWFlrWktWMVpYTlV0VlZsWlZUVVJyUFE9PQ<span style=color:#f92672>==</span>
</span></span></code></pre></div></li><li><p>Decode flag
A lots of base64 encoding
:::spoiler Screenshot
<img src=https://hackmd.io/_uploads/ryXdvQnK3.png alt>
:::</p></li><li><p>Unmount & Delete</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo umount /mnt/flag_dec
</span></span><span style=display:flex><span>$ sudo rm -R -f /mnt/flag_dec
</span></span><span style=display:flex><span>$ sudo rm -R -f /dev/mapper/flag_dec
</span></span><span style=display:flex><span>$ sudo dmsetup remove_all
</span></span></code></pre></div></li></ol><p>Flag: <code>crew{Tru33333_Crypt_w1th_V014t1l1ty!}</code></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://kenfavors.com/code/how-to-open-a-truecrypt-container-using-cryptsetup/>How To Open A TrueCrypt Container Using cryptsetup</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>