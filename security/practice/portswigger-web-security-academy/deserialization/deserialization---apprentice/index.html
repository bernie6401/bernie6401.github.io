<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  Deserialization - APPRENTICE
  #


  tags: Portswigger Web Security Academy Web
  #


  Lab: Modifying serialized objects
  #


Description: This lab uses a serialization-based session mechanism and is vulnerable to privilege escalation as a result.
Goal: To solve the lab, edit the serialized object in the session cookie to exploit this vulnerability and gain administrative privileges. Then, delete Carlos&rsquo;s account.
You can log in to your own account using the following credentials: wiener:peter


  Recon
  #


Login First & Recon the package
According to the description, we know that the user verification has insecure deserialization. Therefore, we can recon the package first as below.

You can notice the session is a base64-encoded string and we use the built-in feature in burp suite to decode it.
Session: Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czo1OiJhZG1pbiI7YjowO30%3d
Decoded String: O:4:"User":2:{s:8:"username";s:6:"wiener";s:5:"admin";b:0;}
How about Modify the session directly



  Exp - Change Directly
  #


We can use the built-in feature to change our session to admin=1 directly to then send it forward.
:::info
Each package may contain the session that should be modified. So, pay attention to before sending it forward
:::
Delete Carlos


:::spoiler Success Screenshot

:::'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/practice/portswigger-web-security-academy/deserialization/deserialization---apprentice/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Deserialization - APPRENTICE"><meta property="og:description" content='Deserialization - APPRENTICE # tags: Portswigger Web Security Academy Web # Lab: Modifying serialized objects # Description: This lab uses a serialization-based session mechanism and is vulnerable to privilege escalation as a result. Goal: To solve the lab, edit the serialized object in the session cookie to exploit this vulnerability and gain administrative privileges. Then, delete Carlosâ€™s account. You can log in to your own account using the following credentials: wiener:peter Recon # Login First & Recon the package According to the description, we know that the user verification has insecure deserialization. Therefore, we can recon the package first as below. You can notice the session is a base64-encoded string and we use the built-in feature in burp suite to decode it. Session: Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czo1OiJhZG1pbiI7YjowO30%3d Decoded String: O:4:"User":2:{s:8:"username";s:6:"wiener";s:5:"admin";b:0;} How about Modify the session directly Exp - Change Directly # We can use the built-in feature to change our session to admin=1 directly to then send it forward. :::info Each package may contain the session that should be modified. So, pay attention to before sending it forward ::: Delete Carlos :::spoiler Success Screenshot :::'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="Portswigger Web Security Academy"><meta property="article:tag" content="Web"><title>Deserialization - APPRENTICE | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/practice/portswigger-web-security-academy/deserialization/deserialization---apprentice/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Deserialization - APPRENTICE</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#lab-modifying-serialized-objects>Lab: Modifying serialized objects</a><ul><li><a href=#recon>Recon</a></li><li><a href=#exp---change-directly>Exp - Change Directly</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=deserialization---apprentice>Deserialization - APPRENTICE
<a class=anchor href=#deserialization---apprentice>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><h2 id=lab-modifying-serialized-objects>Lab: Modifying serialized objects
<a class=anchor href=#lab-modifying-serialized-objects>#</a></h2><ul><li>Description: This lab uses a serialization-based session mechanism and is vulnerable to privilege escalation as a result.</li><li>Goal: To solve the lab, edit the serialized object in the session cookie to exploit this vulnerability and gain administrative privileges. Then, delete Carlos&rsquo;s account.
You can log in to your own account using the following credentials: wiener:peter</li></ul><h3 id=recon>Recon
<a class=anchor href=#recon>#</a></h3><ol><li>Login First & Recon the package
According to the description, we know that the user verification has insecure deserialization. Therefore, we can recon the package first as below.
<img src=https://i.imgur.com/zuKHXRF.png alt>
You can notice the session is a base64-encoded string and we use the built-in feature in burp suite to decode it.
Session: <code>Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czo1OiJhZG1pbiI7YjowO30%3d</code>
Decoded String: <code>O:4:"User":2:{s:8:"username";s:6:"wiener";s:5:"admin";b:0;}</code></li><li>How about Modify the session directly
<img src=https://i.imgur.com/Ent5yuu.png alt></li></ol><h3 id=exp---change-directly>Exp - Change Directly
<a class=anchor href=#exp---change-directly>#</a></h3><ol><li>We can use the built-in feature to change our session to <code>admin=1</code> directly to then send it forward.
:::info
Each package may contain the session that should be modified. So, pay attention to before sending it forward
:::</li><li>Delete Carlos
<img src=https://i.imgur.com/9KGxgZD.png alt></li></ol><p>:::spoiler Success Screenshot
<img src=https://i.imgur.com/eQEfiaw.png alt>
:::</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#lab-modifying-serialized-objects>Lab: Modifying serialized objects</a><ul><li><a href=#recon>Recon</a></li><li><a href=#exp---change-directly>Exp - Change Directly</a></li></ul></li></ul></nav></div></aside></main></body></html>