<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Cryptography Lec 5(Symmetric Key Cryptography) - Notes
  #


  tags: Cryptography NTU
  #


  Background
  #

What is MDC and MAC? - 【CN007】数据安全笔记8 —— MDC 和 MAC


  MDC 是一種用於驗證數據完整性的摘要信息，保證數據沒有被更改。

  #

MAC 在 MDC 的基礎上增加了 Key 的使用。同時驗證數據完整性和發送者，保證發送者是特定人並且傳輸過程中數據沒有被更改。MAC 函數又稱為 Key 哈希函數（Keyed Hash Function）

:::spoiler About RC4


第一部分 前置作業

建立一個 S-box（寫作 S）
決定密鑰
建立密鑰列表 K



第二部分 把 S 打亂


第三部分 加密


S = [0,1,2,3,4,5,6,7]
K = [1,2,3,1,2,3,1,2]
P = [5,3,6,7]

j = 0 
for i in range(8):
    j = ( j + S[i] + K[i] ) %8
    S[i], S[j] = S[j], S[i]

i, j = 0, 0
flag = 0
c_list = []
while flag < len(P):
    
    i = (i + 1) % 8
    j = (j +S[i]) % 8
    S[i], S[j] = S[j], S[i]
    t = (S[i] + S[j] ) % 8
    k = S[t]
    
    k = '{:03b}'.format(k)
    p = '{:03b}'.format(P[flag])
    c  = ''
    for n in range(3):
        c += str(int(k[n])^int(p[n]))
    c_list.append(int(c, 2))
    flag += 1
    
print(c_list)

Drawback


RC4在後來被指出他所產生的密鑰並不隨機，存在統計上的偏誤，並且密文有洩漏明文資訊的可能，
因此已不再被建議使用。
:::"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntu-crypto/cryptography-lec-5symmetric-key-cryptography---notes/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Cryptography Lec 5(Symmetric Key Cryptography) - Notes"><meta property="og:description" content="Cryptography Lec 5(Symmetric Key Cryptography) - Notes # tags: Cryptography NTU # Background # What is MDC and MAC? - 【CN007】数据安全笔记8 —— MDC 和 MAC
MDC 是一種用於驗證數據完整性的摘要信息，保證數據沒有被更改。 # MAC 在 MDC 的基礎上增加了 Key 的使用。同時驗證數據完整性和發送者，保證發送者是特定人並且傳輸過程中數據沒有被更改。MAC 函數又稱為 Key 哈希函數（Keyed Hash Function） :::spoiler About RC4
第一部分 前置作業
建立一個 S-box（寫作 S） 決定密鑰 建立密鑰列表 K 第二部分 把 S 打亂
第三部分 加密
S = [0,1,2,3,4,5,6,7] K = [1,2,3,1,2,3,1,2] P = [5,3,6,7] j = 0 for i in range(8): j = ( j + S[i] + K[i] ) %8 S[i], S[j] = S[j], S[i] i, j = 0, 0 flag = 0 c_list = [] while flag < len(P): i = (i + 1) % 8 j = (j +S[i]) % 8 S[i], S[j] = S[j], S[i] t = (S[i] + S[j] ) % 8 k = S[t] k = '{:03b}'.format(k) p = '{:03b}'.format(P[flag]) c = '' for n in range(3): c += str(int(k[n])^int(p[n])) c_list.append(int(c, 2)) flag += 1 print(c_list) Drawback RC4在後來被指出他所產生的密鑰並不隨機，存在統計上的偏誤，並且密文有洩漏明文資訊的可能， 因此已不再被建議使用。 :::"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="Cryptography"><meta property="article:tag" content="NTU"><title>Cryptography Lec 5(Symmetric Key Cryptography) - Notes | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntu-crypto/cryptography-lec-5symmetric-key-cryptography---notes/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Cryptography Lec 5(Symmetric Key Cryptography) - Notes</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a></li><li><a href=#>MDC 是一種用於驗證數據完整性的摘要信息，保證數據沒有被更改。
<img src="https://img-blog.csdnimg.cn/20210603231335485.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyOTUwODM4,size_16,color_FFFFFF,t_70" alt></a></li><li><a href=#cfb密文反饋模式>CFB：密文反饋模式</a></li><li><a href=#><img src=https://i.imgur.com/WyhjpXN.png alt></a></li><li><a href=#ofb輸出反饋模式>OFB：輸出反饋模式</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=cryptography-lec-5symmetric-key-cryptography---notes>Cryptography Lec 5(Symmetric Key Cryptography) - Notes
<a class=anchor href=#cryptography-lec-5symmetric-key-cryptography---notes>#</a></h1><h6 id=tags-cryptography-ntu>tags: <code>Cryptography</code> <code>NTU</code>
<a class=anchor href=#tags-cryptography-ntu>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://blog.csdn.net/qq_42950838/article/details/117536583#Modification_Detection_Code_MDC_9>What is MDC and MAC? - 【CN007】数据安全笔记8 —— MDC 和 MAC</a></p><blockquote><h2>MDC 是一種用於驗證數據完整性的摘要信息，保證數據沒有被更改。
<img src="https://img-blog.csdnimg.cn/20210603231335485.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyOTUwODM4,size_16,color_FFFFFF,t_70" alt>
<a class=anchor href=#>#</a></h2><p>MAC 在 MDC 的基礎上增加了 Key 的使用。同時驗證數據完整性和發送者，保證發送者是特定人並且傳輸過程中數據沒有被更改。MAC 函數又稱為 Key 哈希函數（Keyed Hash Function）
<img src="https://img-blog.csdnimg.cn/20210603225822420.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyOTUwODM4,size_16,color_FFFFFF,t_70" alt></p></blockquote><p>:::spoiler <a href=https://ithelp.ithome.com.tw/articles/10263124>About RC4</a></p><ul><li><p>第一部分 前置作業</p><ol><li>建立一個 S-box（寫作 S）</li><li>決定密鑰</li><li>建立密鑰列表 K</li></ol></li><li><p>第二部分 把 S 打亂</p></li><li><p>第三部分 加密</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>S <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>6</span>,<span style=color:#ae81ff>7</span>]
</span></span><span style=display:flex><span>K <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>P <span style=color:#f92672>=</span> [<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>6</span>,<span style=color:#ae81ff>7</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>8</span>):
</span></span><span style=display:flex><span>    j <span style=color:#f92672>=</span> ( j <span style=color:#f92672>+</span> S[i] <span style=color:#f92672>+</span> K[i] ) <span style=color:#f92672>%</span><span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>    S[i], S[j] <span style=color:#f92672>=</span> S[j], S[i]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>i, j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>c_list <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> flag <span style=color:#f92672>&lt;</span> len(P):
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    i <span style=color:#f92672>=</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>    j <span style=color:#f92672>=</span> (j <span style=color:#f92672>+</span>S[i]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>    S[i], S[j] <span style=color:#f92672>=</span> S[j], S[i]
</span></span><span style=display:flex><span>    t <span style=color:#f92672>=</span> (S[i] <span style=color:#f92672>+</span> S[j] ) <span style=color:#f92672>%</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>    k <span style=color:#f92672>=</span> S[t]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    k <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{:03b}</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>format(k)
</span></span><span style=display:flex><span>    p <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{:03b}</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>format(P[flag])
</span></span><span style=display:flex><span>    c  <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> n <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>3</span>):
</span></span><span style=display:flex><span>        c <span style=color:#f92672>+=</span> str(int(k[n])<span style=color:#f92672>^</span>int(p[n]))
</span></span><span style=display:flex><span>    c_list<span style=color:#f92672>.</span>append(int(c, <span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>print(c_list)
</span></span></code></pre></div><ul><li>Drawback</li></ul><blockquote><p>RC4在後來被指出他所產生的密鑰並不隨機，存在統計上的偏誤，並且密文有洩漏明文資訊的可能，
因此已不再被建議使用。
:::</p></blockquote><hr><p><a href=https://youtu.be/dXuN-2CIdIY>About Feistel Cipher</a>
<img src=https://i.imgur.com/eHGhsBG.png alt></p><hr><p><a href=https://youtu.be/WnsgWK0DOOM>About DES</a>
<img src=https://i.imgur.com/NbaLsJb.png alt></p><hr><p><a href=https://ithelp.ithome.com.tw/articles/10249953>What is OFB and CFB?</a></p><blockquote><h2 id=cfb密文反饋模式>CFB：密文反饋模式
<a class=anchor href=#cfb%e5%af%86%e6%96%87%e5%8f%8d%e9%a5%8b%e6%a8%a1%e5%bc%8f>#</a></h2><p>與CBC模式類似，但不同的地方在於，CFB模式先生成密碼流字典，然後用密碼字典與明文進行異或操作並最終生成密文。後一分組的密碼字典的生成需要前一分組的密文參與運算。
CFB模式是用分組演算法實現流演算法，明文資料不需要按分組大小對齊。</p><h2><img src=https://i.imgur.com/WyhjpXN.png alt>
<a class=anchor href=#>#</a></h2><h2 id=ofb輸出反饋模式>OFB：輸出反饋模式
<a class=anchor href=#ofb%e8%bc%b8%e5%87%ba%e5%8f%8d%e9%a5%8b%e6%a8%a1%e5%bc%8f>#</a></h2><p>OFB模式與CFB模式不同的地方是：生成字典的時候會採用明文參與運算，CFB採用的是密文。</p><p><img src=https://i.imgur.com/X0K16vA.png alt></p></blockquote></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a></li><li><a href=#>MDC 是一種用於驗證數據完整性的摘要信息，保證數據沒有被更改。
<img src="https://img-blog.csdnimg.cn/20210603231335485.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyOTUwODM4,size_16,color_FFFFFF,t_70" alt></a></li><li><a href=#cfb密文反饋模式>CFB：密文反饋模式</a></li><li><a href=#><img src=https://i.imgur.com/WyhjpXN.png alt></a></li><li><a href=#ofb輸出反饋模式>OFB：輸出反饋模式</a></li></ul></nav></div></aside></main></body></html>