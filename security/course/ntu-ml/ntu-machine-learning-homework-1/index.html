<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  NTU Machine Learning Homework 1
  #


  tags: NTU_ML Machine Learning
  #


  How to choose features of data
  #


After observing the training data visualized image, you can be aware of the relationship between the PM2.5 feature and the others.
For instance, the CO image, NO image, NO2 image, and NOx image are much more correlated with PM2.5.

I also choose PM10, WS_HR, RAINFALL, RH,  WIND_SPEED, and PM2.5 which you can see here
I used Zscore normalization to implement in my project and can see as below
You can see the different result of using or unusing normalization with the same config.

  
      
          Epoch
          Regression
          LR
          Feats
          Batch Size
          Loss Fn.
          Opti.
          RMSE
          Data Filter
          Norm. Data
      
  
  
      
          200
          1st-order
          0.015
          [1-4, 6-9, 13, 14]
          1024
          MSE
          Adam
          2.44623
          Yes
          Yes
      
      
          200
          1st-order
          0.015
          [1-4, 6-9, 13, 14]
          1024
          MSE
          Adam
          2.44623
          Yes
          No
      
  




  Hyperparameter and Preprocessing
  #


All my testing config can be found in Training Result.xlsx
I used a filter to choose valid data and set a threshold by observing the visualized figure of all features.


  My takeaway
  #


**(Solved->See the last paragraph)**Using normalization is not like what I thought. Practically speaking, using normalization can gather all data to a specific area that the model can converge much more rapidly. But, in this case, the result is worse and also appear negative value of the PM2.5 result. According to this page, maybe the normalization method is not suitable in my case.
**(Solved->See the last paragraph)**I also figured that using the stored weight and bias by my pretrained model is not the right way. I used pickle to store the dump parameters during the training and used the best one as my pretrained parameter. But it&rsquo;s still not that good enough.
The better way in this project to enhance your accuracy is tuning your training config and select  good features.
After discussing with my friend, I figured out the problem and tried to solve it successfully by fitting numpy random seed. Then, the parameter will truly fix but normalization is still not working to help model converging.


  Update
  #


2022/12/06 update - Refer to 相關 taught by Dr.李柏堅, I use Pearson Correlation to compute the correlation of each factor and PM2.5 and the result is shown as below. According to the video, |r| < 0.4 is low correlation, 0.4 ≦ |r| < 0.7is medium correlation, and 0.7 ≦ |r| < 1 is high correlation. So, the factor CO, NO, NO2, NOx, PM10, and SO2  are quite suitable as our input data to address this regression problem.

  
      
          Factor
          AMB_TEMP
          CO
          NO
          NO2
          NOx
          O3
          PM10
          WS_HR
          RAINFALL
          RH
          SO2
          WD_HR
          WIND_DIREC
          WIND_SPEED
      
  
  
      
          r
          -0.176147465
          0.659147668
          0.227219147
          0.554273687
          0.51365014
          0.233923944
          0.818868214
          -0.102047405
          -0.060801221
          -0.081576429
          0.361333416
          0.171932397
          0.137658351
          -0.10119696
      
  


"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntu-ml/ntu-machine-learning-homework-1/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="NTU Machine Learning Homework 1"><meta property="og:description" content="NTU Machine Learning Homework 1 # tags: NTU_ML Machine Learning # How to choose features of data # After observing the training data visualized image, you can be aware of the relationship between the PM2.5 feature and the others. For instance, the CO image, NO image, NO2 image, and NOx image are much more correlated with PM2.5. I also choose PM10, WS_HR, RAINFALL, RH, WIND_SPEED, and PM2.5 which you can see here I used Zscore normalization to implement in my project and can see as below You can see the different result of using or unusing normalization with the same config. Epoch Regression LR Feats Batch Size Loss Fn. Opti. RMSE Data Filter Norm. Data 200 1st-order 0.015 [1-4, 6-9, 13, 14] 1024 MSE Adam 2.44623 Yes Yes 200 1st-order 0.015 [1-4, 6-9, 13, 14] 1024 MSE Adam 2.44623 Yes No Hyperparameter and Preprocessing # All my testing config can be found in Training Result.xlsx I used a filter to choose valid data and set a threshold by observing the visualized figure of all features. My takeaway # **(Solved->See the last paragraph)**Using normalization is not like what I thought. Practically speaking, using normalization can gather all data to a specific area that the model can converge much more rapidly. But, in this case, the result is worse and also appear negative value of the PM2.5 result. According to this page, maybe the normalization method is not suitable in my case. **(Solved->See the last paragraph)**I also figured that using the stored weight and bias by my pretrained model is not the right way. I used pickle to store the dump parameters during the training and used the best one as my pretrained parameter. But it’s still not that good enough. The better way in this project to enhance your accuracy is tuning your training config and select good features. After discussing with my friend, I figured out the problem and tried to solve it successfully by fitting numpy random seed. Then, the parameter will truly fix but normalization is still not working to help model converging. Update # 2022/12/06 update - Refer to 相關 taught by Dr.李柏堅, I use Pearson Correlation to compute the correlation of each factor and PM2.5 and the result is shown as below. According to the video, |r| < 0.4 is low correlation, 0.4 ≦ |r| < 0.7is medium correlation, and 0.7 ≦ |r| < 1 is high correlation. So, the factor CO, NO, NO2, NOx, PM10, and SO2 are quite suitable as our input data to address this regression problem. Factor AMB_TEMP CO NO NO2 NOx O3 PM10 WS_HR RAINFALL RH SO2 WD_HR WIND_DIREC WIND_SPEED r -0.176147465 0.659147668 0.227219147 0.554273687 0.51365014 0.233923944 0.818868214 -0.102047405 -0.060801221 -0.081576429 0.361333416 0.171932397 0.137658351 -0.10119696"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="NTU_ML"><meta property="article:tag" content="Machine Learning"><meta property="article:tag" content="NTU"><title>NTU Machine Learning Homework 1 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntu-ml/ntu-machine-learning-homework-1/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>NTU Machine Learning Homework 1</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#how-to-choose-features-of-data>How to choose features of data</a></li><li><a href=#hyperparameter-and-preprocessing>Hyperparameter and Preprocessing</a></li><li><a href=#my-takeaway>My takeaway</a></li><li><a href=#update>Update</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=ntu-machine-learning-homework-1>NTU Machine Learning Homework 1
<a class=anchor href=#ntu-machine-learning-homework-1>#</a></h1><h6 id=tags-ntu_ml-machine-learning>tags: <code>NTU_ML</code> <code>Machine Learning</code>
<a class=anchor href=#tags-ntu_ml-machine-learning>#</a></h6><h2 id=how-to-choose-features-of-data>How to choose features of data
<a class=anchor href=#how-to-choose-features-of-data>#</a></h2><ul><li>After observing the training data visualized image, you can be aware of the relationship between the PM2.5 feature and the others.</li><li>For instance, the CO image, NO image, NO2 image, and NOx image are much more correlated with PM2.5.
<img src=https://imgur.com/73t0b9Q.png alt=co><img src=https://imgur.com/tSGtNe9.png alt=no><img src=https://imgur.com/IobYzpN.png alt=no2><img src=https://imgur.com/vyz8COx.png alt=nox><img src=https://imgur.com/acbWSvK.png alt=pm2.5></li><li>I also choose PM10, WS_HR, RAINFALL, RH, WIND_SPEED, and PM2.5 which you can see <a href=/HW1/Programming/train_data_img/>here</a></li><li>I used Zscore normalization to implement in my project and can see as below<img src=https://imgur.com/BTmhmRm.png alt=zscore_CO><img src=https://imgur.com/7mz2uHW.png alt=zscore_NO><img src=https://imgur.com/NiF1vxl.png alt=zscore_NO2><img src=https://imgur.com/gW6xij3.png alt=zscore_NOx></li><li>You can see the different result of using or unusing normalization with the same config.<table><thead><tr><th style=text-align:center>Epoch</th><th style=text-align:center>Regression</th><th>LR</th><th style=text-align:center>Feats</th><th style=text-align:center>Batch Size</th><th style=text-align:center>Loss Fn.</th><th style=text-align:center>Opti.</th><th style=text-align:center>RMSE</th><th style=text-align:center>Data Filter</th><th style=text-align:center>Norm. Data</th></tr></thead><tbody><tr><td style=text-align:center>200</td><td style=text-align:center>1st-order</td><td>0.015</td><td style=text-align:center>[1-4, 6-9, 13, 14]</td><td style=text-align:center>1024</td><td style=text-align:center>MSE</td><td style=text-align:center>Adam</td><td style=text-align:center>2.44623</td><td style=text-align:center>Yes</td><td style=text-align:center>Yes</td></tr><tr><td style=text-align:center>200</td><td style=text-align:center>1st-order</td><td>0.015</td><td style=text-align:center>[1-4, 6-9, 13, 14]</td><td style=text-align:center>1024</td><td style=text-align:center>MSE</td><td style=text-align:center>Adam</td><td style=text-align:center>2.44623</td><td style=text-align:center>Yes</td><td style=text-align:center>No</td></tr></tbody></table></li></ul><h2 id=hyperparameter-and-preprocessing>Hyperparameter and Preprocessing
<a class=anchor href=#hyperparameter-and-preprocessing>#</a></h2><ul><li>All my testing config can be found in Training Result.xlsx</li><li>I used a filter to choose valid data and set a threshold by observing the visualized figure of all features.</li></ul><h2 id=my-takeaway>My takeaway
<a class=anchor href=#my-takeaway>#</a></h2><ul><li>**(Solved->See the last paragraph)**Using normalization is not like what I thought. Practically speaking, using normalization can gather all data to a specific area that the model can converge much more rapidly. But, in this case, the result is worse and also appear negative value of the PM2.5 result. According to <a href="https://blog.csdn.net/u010947534/article/details/86632819?spm=1001.2014.3001.5506">this page</a>, maybe the normalization method is not suitable in my case.</li><li>**(Solved->See the last paragraph)**I also figured that using the stored weight and bias by my pretrained model is not the right way. I used pickle to store the dump parameters during the training and used the best one as my pretrained parameter. But it&rsquo;s still not that good enough.</li><li>The better way in this project to enhance your accuracy is tuning your training config and select good features.</li><li>After discussing with my friend, I figured out the problem and tried to solve it successfully by fitting numpy random seed. Then, the parameter will truly fix but normalization <strong>is still not working</strong> to help model converging.</li></ul><h2 id=update>Update
<a class=anchor href=#update>#</a></h2><ul><li>2022/12/06 update - Refer to <a href="https://www.youtube.com/watch?v=z-21v0EoFh4&amp;ab_channel=CUSTCourses">相關</a> taught by Dr.李柏堅, I use <code>Pearson Correlation</code> to compute the correlation of each factor and PM2.5 and the result is shown as below. According to the <a href="https://www.youtube.com/watch?v=z-21v0EoFh4&amp;ab_channel=CUSTCourses">video</a>, <code>|r| &lt; 0.4</code> is low correlation, <code>0.4 ≦ |r| &lt; 0.7</code>is medium correlation, and <code>0.7 ≦ |r| &lt; 1</code> is high correlation. So, the factor <strong><font color=#FF0000></strong><code>CO</code>, <code>NO</code>, <code>NO2</code>, <code>NOx</code>, <code>PM10</code>, and <code>SO2</code><strong></font></strong> are quite suitable as our input data to address this regression problem.<table><thead><tr><th style=text-align:center>Factor</th><th style=text-align:center>AMB_TEMP</th><th style=text-align:center>CO</th><th style=text-align:center>NO</th><th style=text-align:center>NO2</th><th style=text-align:center>NOx</th><th style=text-align:left>O3</th><th style=text-align:left>PM10</th><th style=text-align:center>WS_HR</th><th style=text-align:center>RAINFALL</th><th style=text-align:center>RH</th><th style=text-align:center>SO2</th><th style=text-align:center>WD_HR</th><th style=text-align:center>WIND_DIREC</th><th style=text-align:center>WIND_SPEED</th></tr></thead><tbody><tr><td style=text-align:center>r</td><td style=text-align:center>-0.176147465</td><td style=text-align:center>0.659147668</td><td style=text-align:center>0.227219147</td><td style=text-align:center>0.554273687</td><td style=text-align:center>0.51365014</td><td style=text-align:left>0.233923944</td><td style=text-align:left>0.818868214</td><td style=text-align:center>-0.102047405</td><td style=text-align:center>-0.060801221</td><td style=text-align:center>-0.081576429</td><td style=text-align:center>0.361333416</td><td style=text-align:center>0.171932397</td><td style=text-align:center>0.137658351</td><td style=text-align:center>-0.10119696</td></tr></tbody></table></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#how-to-choose-features-of-data>How to choose features of data</a></li><li><a href=#hyperparameter-and-preprocessing>Hyperparameter and Preprocessing</a></li><li><a href=#my-takeaway>My takeaway</a></li><li><a href=#update>Update</a></li></ul></nav></div></aside></main></body></html>