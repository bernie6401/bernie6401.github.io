<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  Unit Test Practice
  #


  tags: NTU_ST Software Testing
  #

:::spoiler Click to open TOC
[TOC]
:::

  Install the environment
  #


Install Visual Studio with .NET that we can use C# language to implement unit test properly.


  Create a project to test
  #


Create a new project and choose C# as your language and named the project Bank.
Rename Program.cs as BankAccount.cs and replace all content by the following code.

using System;

namespace BankAccountNS

    public class BankAccount
    {
        private readonly string m_customerName;
        private double m_balance;

        private BankAccount() { }

        public BankAccount(string customerName, double balance)
        {
            m_customerName = customerName;
            m_balance = balance;
        }

        public string CustomerName
        {
            get { return m_customerName; }
        }

        public double Balance
        {
            get { return m_balance; }
        }

        public void Debit(double amount)
        {
            if (amount > m_balance)
            {
                throw new ArgumentOutOfRangeException("amount");
            }

            if (amount < 0)
            {
                throw new ArgumentOutOfRangeException("amount");
            }

            m_balance += amount; // intentionally incorrect code
        }

        public void Credit(double amount)
        {
            if (amount < 0)
            {
                throw new ArgumentOutOfRangeException("amount");
            }

            m_balance += amount;
        }

        public static void Main()
        {
            BankAccount ba = new BankAccount("Mr. Bryan Walton", 11.99);

            ba.Credit(5.77);
            ba.Debit(11.22);
            Console.WriteLine("Current balance is ${0}", ba.Balance);
        }
    }
}

Build it by clicking Build Solution in Build menu.


  Create a unit test project
  #


Create a new project at solution explorer and named it BankTests. The other part just maintain default setup.
Select MSTest Test Project<-This is important.
Add reference by selecting Add Reference at BankTests/Dependencies
In the Reference Manager dialog box, expand Projects, select Solution, and then check the Bank item.


  Create the test class
  #


Rename UnitTest1.cs to BankAccountTests.cs and replace the original code with the following section and add using statement at the top of the class file.

using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace BankTests
{
    [TestClass]
    public class BankAccountTests
    {
        [TestMethod]
        public void TestMethod1()
        {
        }
    }
}

BTW, the default class part can be ignored.


  Create the first test method
  #


Replace the default class with the following code

[TestMethod]
public void Debit_WithValidAmount_UpdatesBalance()
{
    // Arrange
    double beginningBalance = 11.99;
    double debitAmount = 4.55;
    double expected = 7.44;
    BankAccount account = new BankAccount("Mr. Bryan Walton", beginningBalance);

    // Act
    account.Debit(debitAmount);

    // Assert
    double actual = account.Balance;
    Assert.AreEqual(expected, actual, 0.001, "Account not debited correctly");
}

Analyze this part: Assert.AreEqual method will catch the exception when expected value unequal actual value or their difference larger than delta(0.001).
Comparing with BankAccount.cs, the truly process of Debit function is $beginningBalance - debitAmount = expected$ -> $11.99 - 4.55 = 7.44$


  Build and run the test
  #


On the Build menu, choose Build Solution (or press Ctrl + SHIFT + B) and press Ctrl + E, T to open Test Explorer, then Run All.
You&rsquo;ll find that all Test are failed, so you must modify somewhere incorrect.


  Fix your code and rerun your tests
  #


Return to BankAccount.cs and observe Debit() function.

Must change m_balance += amount; to m_balance -= amount;
Build and Run the code again and you&rsquo;ll find the test is correct this time


  Create and run new test methods
  #


Add the following program in test class and rebuild it.

[TestMethod]
public void Debit_WhenAmountIsLessThanZero_ShouldThrowArgumentOutOfRange()
{
    // Arrange
    double beginningBalance = 11.99;
    double debitAmount = -100.00;
    BankAccount account = new BankAccount("Mr. Bryan Walton", beginningBalance);

    // Act and assert
    Assert.ThrowsException<System.ArgumentOutOfRangeException>(() => account.Debit(debitAmount));
}

[TestMethod]
public void Debit_WhenAmountIsMoreThanBalance_ShouldThrowArgumentOutOfRange()
{
    // Arrange
    double beginningBalance = 11.99;
    double debitAmount = 200.00;
    BankAccount account = new BankAccount("Mr. Bryan Walton", beginningBalance);

    // Act and assert
    Assert.ThrowsException<System.ArgumentOutOfRangeException>(() => account.Debit(debitAmount));
}

Analyze: you&rsquo;ll find out that the debitAmout in the 1st test method is less than zero and the debitAmount in 2nd test method is larger than beginningBalance.
After runing test explorer, these 2 code block are working properly, but you don&rsquo;t know what kind of exception is(amount > m_balance or amount < 0), we just know somewhere throw back an exception message.


  Revise BankAccount.cs
  #


Trace back to BankAccount.Debit and you&rsquo;ll notice that they used the same exception, so you can determine to use ArgumentOutOfRangeException(String, Object, String) to contain the name of the argument, the argument value, and a user-defined message.

if (amount > m_balance)
{
    throw new ArgumentOutOfRangeException("amount");
}

if (amount < 0)
{
    throw new ArgumentOutOfRangeException("amount");
}

  Refactor the code under test
  #


Define 2 constants for the error message at class scope, put the following code block in the class under test, BankAccout.

public const string DebitAmountExceedsBalanceMessage = "Debit amount exceeds balance";
public const string DebitAmountLessThanZeroMessage = "Debit amount is less than zero";

Then modify the 2 conditional statements in the Debit method.

if (amount > m_balance)
{
    throw new System.ArgumentOutOfRangeException("amount", amount, DebitAmountExceedsBalanceMessage);
}

if (amount < 0)
{
    throw new System.ArgumentOutOfRangeException("amount", amount, DebitAmountLessThanZeroMessage);
}

Refactor test method like this. Replacing Assert.ThrowsException with using try/catch method to catch unexpected exception situation.

[TestMethod]
public void Debit_WhenAmountIsMoreThanBalance_ShouldThrowArgumentOutOfRange()
{
    // Arrange
    double beginningBalance = 11.99;
    double debitAmount = 20.0;
    BankAccount account = new BankAccount("Mr. Bryan Walton", beginningBalance);

    // Act
    try
    {
        account.Debit(debitAmount);
    }
    catch (System.ArgumentOutOfRangeException e)
    {
        // Assert
        StringAssert.Contains(e.Message, BankAccount.DebitAmountExceedsBalanceMessage);
    }
}

  The last part
  #


Not really understatnd about adding Assert.Fail at the end of the test method.


  Final Result
  #

'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntu-st/unit-test-practice/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Unit Test Practice"><meta property="og:description" content='Unit Test Practice # tags: NTU_ST Software Testing # :::spoiler Click to open TOC [TOC] :::
Install the environment # Install Visual Studio with .NET that we can use C# language to implement unit test properly. Create a project to test # Create a new project and choose C# as your language and named the project Bank. Rename Program.cs as BankAccount.cs and replace all content by the following code. using System; namespace BankAccountNS public class BankAccount { private readonly string m_customerName; private double m_balance; private BankAccount() { } public BankAccount(string customerName, double balance) { m_customerName = customerName; m_balance = balance; } public string CustomerName { get { return m_customerName; } } public double Balance { get { return m_balance; } } public void Debit(double amount) { if (amount > m_balance) { throw new ArgumentOutOfRangeException("amount"); } if (amount < 0) { throw new ArgumentOutOfRangeException("amount"); } m_balance += amount; // intentionally incorrect code } public void Credit(double amount) { if (amount < 0) { throw new ArgumentOutOfRangeException("amount"); } m_balance += amount; } public static void Main() { BankAccount ba = new BankAccount("Mr. Bryan Walton", 11.99); ba.Credit(5.77); ba.Debit(11.22); Console.WriteLine("Current balance is ${0}", ba.Balance); } } } Build it by clicking Build Solution in Build menu. Create a unit test project # Create a new project at solution explorer and named it BankTests. The other part just maintain default setup. Select MSTest Test Project<-This is important. Add reference by selecting Add Reference at BankTests/Dependencies In the Reference Manager dialog box, expand Projects, select Solution, and then check the Bank item. Create the test class # Rename UnitTest1.cs to BankAccountTests.cs and replace the original code with the following section and add using statement at the top of the class file. using Microsoft.VisualStudio.TestTools.UnitTesting; namespace BankTests { [TestClass] public class BankAccountTests { [TestMethod] public void TestMethod1() { } } } BTW, the default class part can be ignored. Create the first test method # Replace the default class with the following code [TestMethod] public void Debit_WithValidAmount_UpdatesBalance() { // Arrange double beginningBalance = 11.99; double debitAmount = 4.55; double expected = 7.44; BankAccount account = new BankAccount("Mr. Bryan Walton", beginningBalance); // Act account.Debit(debitAmount); // Assert double actual = account.Balance; Assert.AreEqual(expected, actual, 0.001, "Account not debited correctly"); } Analyze this part: Assert.AreEqual method will catch the exception when expected value unequal actual value or their difference larger than delta(0.001). Comparing with BankAccount.cs, the truly process of Debit function is $beginningBalance - debitAmount = expected$ -> $11.99 - 4.55 = 7.44$ Build and run the test # On the Build menu, choose Build Solution (or press Ctrl + SHIFT + B) and press Ctrl + E, T to open Test Explorer, then Run All. You’ll find that all Test are failed, so you must modify somewhere incorrect. Fix your code and rerun your tests # Return to BankAccount.cs and observe Debit() function. Must change m_balance += amount; to m_balance -= amount; Build and Run the code again and you’ll find the test is correct this time Create and run new test methods # Add the following program in test class and rebuild it. [TestMethod] public void Debit_WhenAmountIsLessThanZero_ShouldThrowArgumentOutOfRange() { // Arrange double beginningBalance = 11.99; double debitAmount = -100.00; BankAccount account = new BankAccount("Mr. Bryan Walton", beginningBalance); // Act and assert Assert.ThrowsException<System.ArgumentOutOfRangeException>(() => account.Debit(debitAmount)); } [TestMethod] public void Debit_WhenAmountIsMoreThanBalance_ShouldThrowArgumentOutOfRange() { // Arrange double beginningBalance = 11.99; double debitAmount = 200.00; BankAccount account = new BankAccount("Mr. Bryan Walton", beginningBalance); // Act and assert Assert.ThrowsException<System.ArgumentOutOfRangeException>(() => account.Debit(debitAmount)); } Analyze: you’ll find out that the debitAmout in the 1st test method is less than zero and the debitAmount in 2nd test method is larger than beginningBalance. After runing test explorer, these 2 code block are working properly, but you don’t know what kind of exception is(amount > m_balance or amount < 0), we just know somewhere throw back an exception message. Revise BankAccount.cs # Trace back to BankAccount.Debit and you’ll notice that they used the same exception, so you can determine to use ArgumentOutOfRangeException(String, Object, String) to contain the name of the argument, the argument value, and a user-defined message. if (amount > m_balance) { throw new ArgumentOutOfRangeException("amount"); } if (amount < 0) { throw new ArgumentOutOfRangeException("amount"); } Refactor the code under test # Define 2 constants for the error message at class scope, put the following code block in the class under test, BankAccout. public const string DebitAmountExceedsBalanceMessage = "Debit amount exceeds balance"; public const string DebitAmountLessThanZeroMessage = "Debit amount is less than zero"; Then modify the 2 conditional statements in the Debit method. if (amount > m_balance) { throw new System.ArgumentOutOfRangeException("amount", amount, DebitAmountExceedsBalanceMessage); } if (amount < 0) { throw new System.ArgumentOutOfRangeException("amount", amount, DebitAmountLessThanZeroMessage); } Refactor test method like this. Replacing Assert.ThrowsException with using try/catch method to catch unexpected exception situation. [TestMethod] public void Debit_WhenAmountIsMoreThanBalance_ShouldThrowArgumentOutOfRange() { // Arrange double beginningBalance = 11.99; double debitAmount = 20.0; BankAccount account = new BankAccount("Mr. Bryan Walton", beginningBalance); // Act try { account.Debit(debitAmount); } catch (System.ArgumentOutOfRangeException e) { // Assert StringAssert.Contains(e.Message, BankAccount.DebitAmountExceedsBalanceMessage); } } The last part # Not really understatnd about adding Assert.Fail at the end of the test method. Final Result #'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="NTU_ST"><meta property="article:tag" content="Software Testing"><meta property="article:tag" content="NTU"><title>Unit Test Practice | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntu-st/unit-test-practice/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Unit Test Practice</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#install-the-environment>Install the environment</a></li><li><a href=#create-a-project-to-test>Create a project to test</a></li><li><a href=#create-a-unit-test-project>Create a unit test project</a></li><li><a href=#create-the-test-class>Create the test class</a></li><li><a href=#create-the-first-test-method>Create the first test method</a></li><li><a href=#build-and-run-the-test>Build and run the test</a></li><li><a href=#fix-your-code-and-rerun-your-tests>Fix your code and rerun your tests</a></li><li><a href=#create-and-run-new-test-methods>Create and run new test methods</a></li><li><a href=#revise-bankaccountcs>Revise BankAccount.cs</a></li><li><a href=#refactor-the-code-under-test>Refactor the code under test</a></li><li><a href=#the-last-part>The last part</a></li><li><a href=#final-result>Final Result</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=unit-test-practice>Unit Test Practice
<a class=anchor href=#unit-test-practice>#</a></h1><h6 id=tags-ntu_st-software-testing>tags: <code>NTU_ST</code> <code>Software Testing</code>
<a class=anchor href=#tags-ntu_st-software-testing>#</a></h6><p>:::spoiler Click to open TOC
[TOC]
:::</p><h2 id=install-the-environment>Install the environment
<a class=anchor href=#install-the-environment>#</a></h2><ul><li>Install Visual Studio with .NET that we can use C# language to implement unit test properly.<img src=https://imgur.com/VwMKdZM.png alt="install c#"></li></ul><h2 id=create-a-project-to-test>Create a project to test
<a class=anchor href=#create-a-project-to-test>#</a></h2><ul><li>Create a new project and choose C# as your language and named the project <strong>Bank</strong>.<img src=https://imgur.com/bPDga9p.png alt="create project"></li><li>Rename Program.cs as BankAccount.cs and replace all content by the following code.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> BankAccountNS
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BankAccount</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#66d9ef>string</span> m_customerName;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>double</span> m_balance;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> BankAccount() { }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> BankAccount(<span style=color:#66d9ef>string</span> customerName, <span style=color:#66d9ef>double</span> balance)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            m_customerName = customerName;
</span></span><span style=display:flex><span>            m_balance = balance;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> CustomerName
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> m_customerName; }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> Balance
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> m_balance; }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Debit(<span style=color:#66d9ef>double</span> amount)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (amount &gt; m_balance)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentOutOfRangeException(<span style=color:#e6db74>&#34;amount&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (amount &lt; <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentOutOfRangeException(<span style=color:#e6db74>&#34;amount&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            m_balance += amount; <span style=color:#75715e>// intentionally incorrect code</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Credit(<span style=color:#66d9ef>double</span> amount)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (amount &lt; <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentOutOfRangeException(<span style=color:#e6db74>&#34;amount&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            m_balance += amount;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main()
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            BankAccount ba = <span style=color:#66d9ef>new</span> BankAccount(<span style=color:#e6db74>&#34;Mr. Bryan Walton&#34;</span>, <span style=color:#ae81ff>11.99</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            ba.Credit(<span style=color:#ae81ff>5.77</span>);
</span></span><span style=display:flex><span>            ba.Debit(<span style=color:#ae81ff>11.22</span>);
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>&#34;Current balance is ${0}&#34;</span>, ba.Balance);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Build it by clicking <strong>Build Solution</strong> in Build menu.</li></ul><h2 id=create-a-unit-test-project>Create a unit test project
<a class=anchor href=#create-a-unit-test-project>#</a></h2><ul><li>Create a new project at solution explorer and named it <strong>BankTests</strong>. The other part just maintain default setup.<img src=https://imgur.com/ryriCen.png alt></li><li>Select <strong>MSTest Test Project</strong><img src=https://imgur.com/dI5h4T0.png alt>&lt;-This is important.</li><li><strong>Add reference</strong> by selecting <strong>Add Reference</strong> at <strong>BankTests/Dependencies</strong><img src=https://imgur.com/9Miqs7p.png alt></li><li>In the <strong>Reference Manager</strong> dialog box, expand <strong>Projects</strong>, select <strong>Solution</strong>, and then check the Bank item.<img src=https://imgur.com/ZBOR73N.png alt></li></ul><h2 id=create-the-test-class>Create the test class
<a class=anchor href=#create-the-test-class>#</a></h2><ul><li>Rename UnitTest1.cs to BankAccountTests.cs and replace the original code with the following section and add using statement at the top of the class file.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span><span style=color:#66d9ef>using</span> Microsoft.VisualStudio.TestTools.UnitTesting;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> BankTests
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#a6e22e>    [TestClass]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BankAccountTests</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span><span style=color:#a6e22e>        [TestMethod]</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> TestMethod1()
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>BTW, the default class part can be ignored.</li></ul><h2 id=create-the-first-test-method>Create the first test method
<a class=anchor href=#create-the-first-test-method>#</a></h2><ul><li>Replace the default class with the following code</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span><span style=color:#a6e22e>[TestMethod]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Debit_WithValidAmount_UpdatesBalance()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Arrange</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> beginningBalance = <span style=color:#ae81ff>11.99</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> debitAmount = <span style=color:#ae81ff>4.55</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> expected = <span style=color:#ae81ff>7.44</span>;
</span></span><span style=display:flex><span>    BankAccount account = <span style=color:#66d9ef>new</span> BankAccount(<span style=color:#e6db74>&#34;Mr. Bryan Walton&#34;</span>, beginningBalance);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Act</span>
</span></span><span style=display:flex><span>    account.Debit(debitAmount);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Assert</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> actual = account.Balance;
</span></span><span style=display:flex><span>    Assert.AreEqual(expected, actual, <span style=color:#ae81ff>0.001</span>, <span style=color:#e6db74>&#34;Account not debited correctly&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Analyze this part: Assert.AreEqual method will catch the exception when <strong>expected value</strong> unequal <strong>actual value</strong> or their difference larger than <strong>delta</strong>(0.001).</li><li>Comparing with BankAccount.cs, the truly process of <strong>Debit</strong> function is $beginningBalance - debitAmount = expected$ -> $11.99 - 4.55 = 7.44$</li></ul><h2 id=build-and-run-the-test>Build and run the test
<a class=anchor href=#build-and-run-the-test>#</a></h2><ul><li>On the Build menu, choose Build Solution (or press Ctrl + SHIFT + B) and press <strong>Ctrl + E, T</strong> to open <strong>Test Explorer</strong>, then <strong>Run All</strong>.<img src=https://imgur.com/ljNqXiS.png alt></li><li>You&rsquo;ll find that all Test are failed, so you must modify somewhere incorrect.</li></ul><h2 id=fix-your-code-and-rerun-your-tests>Fix your code and rerun your tests
<a class=anchor href=#fix-your-code-and-rerun-your-tests>#</a></h2><ul><li>Return to BankAccount.cs and observe Debit() function.
<img src=https://imgur.com/sGGMxu7.png alt></li><li>Must change <code>m_balance += amount;</code> to <code>m_balance -= amount;</code></li><li>Build and Run the code again and you&rsquo;ll find the test is correct this time<img src=https://imgur.com/BNKS05j.png alt></li></ul><h2 id=create-and-run-new-test-methods>Create and run new test methods
<a class=anchor href=#create-and-run-new-test-methods>#</a></h2><ul><li>Add the following program in test class and rebuild it.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span><span style=color:#a6e22e>[TestMethod]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Debit_WhenAmountIsLessThanZero_ShouldThrowArgumentOutOfRange()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Arrange</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> beginningBalance = <span style=color:#ae81ff>11.99</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> debitAmount = -<span style=color:#ae81ff>100.00</span>;
</span></span><span style=display:flex><span>    BankAccount account = <span style=color:#66d9ef>new</span> BankAccount(<span style=color:#e6db74>&#34;Mr. Bryan Walton&#34;</span>, beginningBalance);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Act and assert</span>
</span></span><span style=display:flex><span>    Assert.ThrowsException&lt;System.ArgumentOutOfRangeException&gt;(() =&gt; account.Debit(debitAmount));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[TestMethod]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Debit_WhenAmountIsMoreThanBalance_ShouldThrowArgumentOutOfRange()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Arrange</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> beginningBalance = <span style=color:#ae81ff>11.99</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> debitAmount = <span style=color:#ae81ff>200.00</span>;
</span></span><span style=display:flex><span>    BankAccount account = <span style=color:#66d9ef>new</span> BankAccount(<span style=color:#e6db74>&#34;Mr. Bryan Walton&#34;</span>, beginningBalance);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Act and assert</span>
</span></span><span style=display:flex><span>    Assert.ThrowsException&lt;System.ArgumentOutOfRangeException&gt;(() =&gt; account.Debit(debitAmount));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Analyze: you&rsquo;ll find out that the <strong>debitAmout</strong> in the <strong>1st test method</strong> is less than zero and the <strong>debitAmount</strong> in <strong>2nd test method</strong> is larger than <strong>beginningBalance</strong>.</li><li>After runing test explorer, these 2 code block are working properly, but you don&rsquo;t know what kind of exception is(amount > m_balance or amount &lt; 0), we just know somewhere throw back an exception message.</li></ul><h2 id=revise-bankaccountcs>Revise BankAccount.cs
<a class=anchor href=#revise-bankaccountcs>#</a></h2><ul><li>Trace back to BankAccount.Debit and you&rsquo;ll notice that they used the same exception, so you can determine to use ArgumentOutOfRangeException(String, Object, String) to contain the name of the argument, the argument value, and a user-defined message.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span><span style=color:#66d9ef>if</span> (amount &gt; m_balance)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentOutOfRangeException(<span style=color:#e6db74>&#34;amount&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (amount &lt; <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentOutOfRangeException(<span style=color:#e6db74>&#34;amount&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=refactor-the-code-under-test>Refactor the code under test
<a class=anchor href=#refactor-the-code-under-test>#</a></h2><ul><li>Define 2 constants for the error message at class scope, put the following code block in the class under test, BankAccout.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>string</span> DebitAmountExceedsBalanceMessage = <span style=color:#e6db74>&#34;Debit amount exceeds balance&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>string</span> DebitAmountLessThanZeroMessage = <span style=color:#e6db74>&#34;Debit amount is less than zero&#34;</span>;
</span></span></code></pre></div><ul><li>Then modify the 2 conditional statements in the Debit method.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span><span style=color:#66d9ef>if</span> (amount &gt; m_balance)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> System.ArgumentOutOfRangeException(<span style=color:#e6db74>&#34;amount&#34;</span>, amount, DebitAmountExceedsBalanceMessage);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (amount &lt; <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> System.ArgumentOutOfRangeException(<span style=color:#e6db74>&#34;amount&#34;</span>, amount, DebitAmountLessThanZeroMessage);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Refactor test method like this. Replacing Assert.ThrowsException with using try/catch method to catch unexpected exception situation.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#a6e22e>[TestMethod]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Debit_WhenAmountIsMoreThanBalance_ShouldThrowArgumentOutOfRange()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Arrange</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> beginningBalance = <span style=color:#ae81ff>11.99</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> debitAmount = <span style=color:#ae81ff>20.0</span>;
</span></span><span style=display:flex><span>    BankAccount account = <span style=color:#66d9ef>new</span> BankAccount(<span style=color:#e6db74>&#34;Mr. Bryan Walton&#34;</span>, beginningBalance);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Act</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        account.Debit(debitAmount);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>catch</span> (System.ArgumentOutOfRangeException e)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Assert</span>
</span></span><span style=display:flex><span>        StringAssert.Contains(e.Message, BankAccount.DebitAmountExceedsBalanceMessage);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=the-last-part>The last part
<a class=anchor href=#the-last-part>#</a></h2><ul><li>Not really understatnd about adding Assert.Fail at the end of the test method.</li></ul><h2 id=final-result>Final Result
<a class=anchor href=#final-result>#</a></h2><p><img src=https://imgur.com/5NtqEKr.png alt></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><ul><li><a href="https://learn.microsoft.com/zh-tw/visualstudio/test/walkthrough-creating-and-running-unit-tests-for-managed-code?view=vs-2022&amp;source=docs">Microsoft Learn</a></li><li><a href=https://ithelp.ithome.com.tw/articles/10102643>IThelp-動手寫Unit Test</a></li><li><a href=https://progressbar.tw/posts/11>ProgressBar</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#install-the-environment>Install the environment</a></li><li><a href=#create-a-project-to-test>Create a project to test</a></li><li><a href=#create-a-unit-test-project>Create a unit test project</a></li><li><a href=#create-the-test-class>Create the test class</a></li><li><a href=#create-the-first-test-method>Create the first test method</a></li><li><a href=#build-and-run-the-test>Build and run the test</a></li><li><a href=#fix-your-code-and-rerun-your-tests>Fix your code and rerun your tests</a></li><li><a href=#create-and-run-new-test-methods>Create and run new test methods</a></li><li><a href=#revise-bankaccountcs>Revise BankAccount.cs</a></li><li><a href=#refactor-the-code-under-test>Refactor the code under test</a></li><li><a href=#the-last-part>The last part</a></li><li><a href=#final-result>Final Result</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>