<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  A&amp;D of Network Security - Lab 4(ARP & DNS SPOOFING)
  #


  tags: Practicum of A&amp;D of NS NTU
  #


  Background
  #

ARP Spoofing at 1:15:00

  ARP SPOOFING
  #



Setting 2 VMs&rsquo; network interface as Bridged adapter
:::danger
You supposed to use your own network instead of public network
:::


Checking IP


And check the victim gateway by nmap
$ sudo nmap -sP 192.168.43.0/24
Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-19 10:46 EDT
Nmap scan report for DESKTOP-D0UCTM3 (192.168.43.56)
Host is up (0.00020s latency).
MAC Address: 68:54:5A:DC:03:57 (Intel Corporate)
Nmap scan report for 192.168.43.66
Host is up (0.010s latency).
MAC Address: D4:38:9C:87:2F:C6 (Sony)
Nmap scan report for kali (192.168.43.222)
Host is up (0.00040s latency).
MAC Address: 08:00:27:B1:9D:67 (Oracle VirtualBox virtual NIC)
Nmap scan report for 192.168.43.78
Host is up.
Nmap done: 256 IP addresses (4 hosts up) scanned in 6.13 seconds
:::info
Victim VM $\to$ 192.168.43.222 / MAC $\to$ 08:00:27:F7:12:7A
Attacker VM $\to$ 192.168.43.78 / MAC $\to$ 08:00:27:B1:9D:67
Default Gateway $\to$ 192.168.43.66
:::"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntu-padns/ad-of-network-security---lab-4arp--dns-spoofing/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="A&D of Network Security - Lab 4(ARP & DNS SPOOFING)"><meta property="og:description" content="A&amp;D of Network Security - Lab 4(ARP & DNS SPOOFING) # tags: Practicum of A&amp;D of NS NTU # Background # ARP Spoofing at 1:15:00
ARP SPOOFING # Setting 2 VMs’ network interface as Bridged adapter :::danger You supposed to use your own network instead of public network :::
Checking IP And check the victim gateway by nmap
$ sudo nmap -sP 192.168.43.0/24 Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-19 10:46 EDT Nmap scan report for DESKTOP-D0UCTM3 (192.168.43.56) Host is up (0.00020s latency). MAC Address: 68:54:5A:DC:03:57 (Intel Corporate) Nmap scan report for 192.168.43.66 Host is up (0.010s latency). MAC Address: D4:38:9C:87:2F:C6 (Sony) Nmap scan report for kali (192.168.43.222) Host is up (0.00040s latency). MAC Address: 08:00:27:B1:9D:67 (Oracle VirtualBox virtual NIC) Nmap scan report for 192.168.43.78 Host is up. Nmap done: 256 IP addresses (4 hosts up) scanned in 6.13 seconds :::info Victim VM $\to$ 192.168.43.222 / MAC $\to$ 08:00:27:F7:12:7A Attacker VM $\to$ 192.168.43.78 / MAC $\to$ 08:00:27:B1:9D:67 Default Gateway $\to$ 192.168.43.66 :::"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="NTU"><meta property="article:tag" content="NTU_PADNS"><title>A&amp;D of Network Security - Lab 4(ARP & DNS SPOOFING) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntu-padns/ad-of-network-security---lab-4arp--dns-spoofing/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>A&amp;D of Network Security - Lab 4(ARP & DNS SPOOFING)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a></li><li><a href=#arp-spoofing>ARP SPOOFING</a><ul><li><a href=#problem--solved>Problem & Solved</a></li></ul></li><li><a href=#dns-spoofing>DNS SPOOFING</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=ad-of-network-security---lab-4arp--dns-spoofing>A&amp;D of Network Security - Lab 4(ARP & DNS SPOOFING)
<a class=anchor href=#ad-of-network-security---lab-4arp--dns-spoofing>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://youtu.be/ha4w30V2cLM?si=eK2wwkqROck5n3SY&amp;t=4497">ARP Spoofing at <code>1:15:00</code></a></p><h2 id=arp-spoofing>ARP SPOOFING
<a class=anchor href=#arp-spoofing>#</a></h2><ol><li><p>Setting 2 VMs&rsquo; network interface as Bridged adapter
:::danger
You supposed to use your own network instead of public network
:::</p></li><li><p>Checking IP
<img src=https://i.imgur.com/V1CTmtr.png alt></p><p><img src=https://i.imgur.com/i6RUqmM.png alt>
And check the victim gateway by <code>nmap</code></p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ sudo nmap -sP 192.168.43.0/24
Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-19 10:46 EDT
Nmap scan report for DESKTOP-D0UCTM3 (192.168.43.56)
Host is up (0.00020s latency).
MAC Address: 68:54:5A:DC:03:57 (Intel Corporate)
Nmap scan report for 192.168.43.66
Host is up (0.010s latency).
MAC Address: D4:38:9C:87:2F:C6 (Sony)
Nmap scan report for kali (192.168.43.222)
Host is up (0.00040s latency).
MAC Address: 08:00:27:B1:9D:67 (Oracle VirtualBox virtual NIC)
Nmap scan report for 192.168.43.78
Host is up.
Nmap done: 256 IP addresses (4 hosts up) scanned in 6.13 seconds
</code></pre><p>:::info
Victim VM $\to$ <code>192.168.43.222</code> / MAC $\to$ <code>08:00:27:F7:12:7A</code>
Attacker VM $\to$ <code>192.168.43.78</code> / MAC $\to$ <code>08:00:27:B1:9D:67</code>
Default Gateway $\to$ <code>192.168.43.66</code>
:::</p></li><li><p>Open NAT Port Forwarding</p></li></ol><ul><li>In Attacker VM<pre tabindex=0><code class=language-bash! data-lang=bash!>$ sudo su
$ echo 1 &gt; /proc/sys/net/ipv4/ip_forward
$ exit
$ cat /proc/sys/net/ipv4/ip_forward
1
</code></pre></li><li>In Victim VM<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ arp -a
</span></span><span style=display:flex><span>? <span style=color:#f92672>(</span>192.168.43.78<span style=color:#f92672>)</span> at 08:00:27:f7:12:7a <span style=color:#f92672>[</span>ether<span style=color:#f92672>]</span> on eth0
</span></span><span style=display:flex><span>DESKTOP-D0UCTM3 <span style=color:#f92672>(</span>192.168.43.56<span style=color:#f92672>)</span> at 68:54:5a:dc:03:57 <span style=color:#f92672>[</span>ether<span style=color:#f92672>]</span> on eth0
</span></span><span style=display:flex><span>DESKTOP-D0UCTM3 <span style=color:#f92672>(</span>192.168.43.56<span style=color:#f92672>)</span> at 68:54:5a:dc:03:57 <span style=color:#f92672>[</span>ether<span style=color:#f92672>]</span> on eth0
</span></span></code></pre></div></li></ul><ol start=4><li><p>Start to attack</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo arpspoof -i eth0 -t 192.168.43.222 192.168.43.66
</span></span><span style=display:flex><span>// sudo arpspoof -i <span style=color:#f92672>{</span>網卡介面<span style=color:#f92672>}</span> -t <span style=color:#f92672>{</span>攻擊目標 IP<span style=color:#f92672>}</span> <span style=color:#f92672>{</span>Gateway IP<span style=color:#f92672>}</span>
</span></span></code></pre></div></li><li><p>Result
<img src=https://i.imgur.com/46xo2IZ.png alt></p><p><img src=https://i.imgur.com/2CG3iER.png alt></p><p><img src=https://i.imgur.com/qkkrFfy.png alt></p></li></ol><h3 id=problem--solved>Problem & Solved
<a class=anchor href=#problem--solved>#</a></h3><p>:::info
If you can not install <code>dsniff</code>, you may update and upgrade the whole system with command <code>sudo apt-get update; sudo apt-get upgrade</code>(It may take lot&rsquo;s of time to finish the work)
:::</p><h2 id=dns-spoofing>DNS SPOOFING
<a class=anchor href=#dns-spoofing>#</a></h2></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#background>Background</a></li><li><a href=#arp-spoofing>ARP SPOOFING</a><ul><li><a href=#problem--solved>Problem & Solved</a></li></ul></li><li><a href=#dns-spoofing>DNS SPOOFING</a></li></ul></nav></div></aside></main></body></html>