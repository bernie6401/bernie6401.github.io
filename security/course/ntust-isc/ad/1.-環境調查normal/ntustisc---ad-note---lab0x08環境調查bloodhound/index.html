<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  NTUSTISC - AD Note - Lab(環境調查BloodHound)
  #

[TOC]
Lecture Video: 2022/05/04 AD 安全1

  Background
  #

[Windows Programming] IPC 通知機制與安全設定

當系統中需要同步處理某些資源的存取權時，可以使用 Windows 的同步處理物件協調不同 process 間對於共同資源的互動，Windows 提供的同步處理物件有四種，分別是: Event, Mutex, Semaphore, Waitable timer，本篇只會提到 Event 喔！
假設系統中有兩個 process：process A 得等待 process B 完成某些特定工作後才能繼續執行。windows 提供的 event 機制能讓 process B 完成工作後發出訊號通知 process A，而 process A 則進入等待狀態直到接受到訊號後才繼續執行後續工作。Process 間只需定好溝通的 event name 就可以輕鬆達成跨程序間的通訊 (Inter-process communication : IPC)，正因為簡單好實現的特性，event 常被用在程序間的溝通與同步。

  Lab Time - 環境調查
  #


  BloodHound AD
  #


說明: 環境調查的視覺化工具
版本: 4.0.3
:::info
8/29更新：經過實測還是建議使用4.1.0，詳細原因可以參考1，原作者說明這是一個bug，已在4.1.0做了修正，所以還是以4.1.0為主，雖然聽講師說可能會少東西，不過對我們小專案來說應該沒差
:::
Link: BloodHound GitHub
必要條件: 必須裝設Neo4j Server / Graph Database, 而且必須要是community version，link


Download Collector
BloodHound是一個環境調查的視覺化工具，所以要先在我們的環境先蒐集一些環境上的資訊，再導入到BloodHound中進行分析，因此我們應該先下載能夠蒐集環境資訊的Collector我是直接把整包clone下來，然後用隨身碟傳到VM(因為那時候Win10已經加入AD，我懶得改回來上網)
:::info
Note:
Windows的defender會擋BloodHound-master/Collectors/SharpHound.exe和SharpHound.ps1這兩個files，所以記得關掉defender
:::
Use the Collector First
:::info
Note: 記得要用bear的網域帳號登入，SharpHound.exe才找的到LDAP
:::
CMD直接進入C:\tools\BloodHound-master\Collectors，然後直接執行$ SharpHound.exe
:::spoiler Implementation
$ SharpHound.exe
2023-08-29T11:02:31.4846421+08:00|INFORMATION|This version of SharpHound is compatible with the 4.3.1 Release of BloodHound
2023-08-29T11:02:31.6707467+08:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
2023-08-29T11:02:31.6985917+08:00|INFORMATION|Initializing SharpHound at 上午 11:02 on 2023/8/29
2023-08-29T11:02:31.9891653+08:00|INFORMATION|[CommonLib LDAPUtils]Found usable Domain Controller for kuma.org : WIN-818G5VCOLJO.kuma.org
2023-08-29T11:02:32.3820391+08:00|INFORMATION|Loaded cache with stats: 163 ID to type mappings.
 163 name to SID mappings.
 1 machine sid mappings.
 2 sid to domain mappings.
 0 global catalog mappings.
2023-08-29T11:02:32.3915435+08:00|INFORMATION|Flags: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
2023-08-29T11:02:32.6206999+08:00|INFORMATION|Beginning LDAP search for kuma.org
2023-08-29T11:02:32.8062803+08:00|INFORMATION|Producer has finished, closing LDAP channel
2023-08-29T11:02:32.8230625+08:00|INFORMATION|LDAP channel closed, waiting for consumers
2023-08-29T11:03:03.3930708+08:00|INFORMATION|Status: 0 objects finished (+0 0)/s -- Using 42 MB RAM
2023-08-29T11:03:13.1743544+08:00|INFORMATION|Consumers finished, closing output channel
Closing writers
2023-08-29T11:03:13.2209345+08:00|INFORMATION|Output channel closed, waiting for output task to complete
2023-08-29T11:03:13.3058132+08:00|INFORMATION|Status: 204 objects finished (+204 5.1)/s -- Using 44 MB RAM
2023-08-29T11:03:13.3058132+08:00|INFORMATION|Enumeration finished in 00:00:40.6864986
2023-08-29T11:03:13.3918361+08:00|INFORMATION|Saving cache with stats: 163 ID to type mappings.
 163 name to SID mappings.
 1 machine sid mappings.
 2 sid to domain mappings.
 0 global catalog mappings.
2023-08-29T11:03:13.4075189+08:00|INFORMATION|SharpHound Enumeration Completed at 上午 11:03 on 2023/8/29! Happy Graphing!
:::
理論上成功的話，會在該folder中出現一個.zip file with name <TimeStamp>.BloodHound.zip此時按照之前啟動BloodHound的方法啟動BloodHound，然後把zip folder拖進去就可以了



  ==如何偵測AD==
  #

有兩種方法，也可以同時使用"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x08%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5bloodhound/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="NTUSTISC - AD Note - Lab(環境調查BloodHound)"><meta property="og:description" content="NTUSTISC - AD Note - Lab(環境調查BloodHound) # [TOC]
Lecture Video: 2022/05/04 AD 安全1
Background # [Windows Programming] IPC 通知機制與安全設定
當系統中需要同步處理某些資源的存取權時，可以使用 Windows 的同步處理物件協調不同 process 間對於共同資源的互動，Windows 提供的同步處理物件有四種，分別是: Event, Mutex, Semaphore, Waitable timer，本篇只會提到 Event 喔！
假設系統中有兩個 process：process A 得等待 process B 完成某些特定工作後才能繼續執行。windows 提供的 event 機制能讓 process B 完成工作後發出訊號通知 process A，而 process A 則進入等待狀態直到接受到訊號後才繼續執行後續工作。Process 間只需定好溝通的 event name 就可以輕鬆達成跨程序間的通訊 (Inter-process communication : IPC)，正因為簡單好實現的特性，event 常被用在程序間的溝通與同步。
Lab Time - 環境調查 # BloodHound AD # 說明: 環境調查的視覺化工具 版本: 4.0.3 :::info 8/29更新：經過實測還是建議使用4.1.0，詳細原因可以參考1，原作者說明這是一個bug，已在4.1.0做了修正，所以還是以4.1.0為主，雖然聽講師說可能會少東西，不過對我們小專案來說應該沒差 ::: Link: BloodHound GitHub 必要條件: 必須裝設Neo4j Server / Graph Database, 而且必須要是community version，link Download Collector BloodHound是一個環境調查的視覺化工具，所以要先在我們的環境先蒐集一些環境上的資訊，再導入到BloodHound中進行分析，因此我們應該先下載能夠蒐集環境資訊的Collector我是直接把整包clone下來，然後用隨身碟傳到VM(因為那時候Win10已經加入AD，我懶得改回來上網) :::info Note: Windows的defender會擋BloodHound-master/Collectors/SharpHound.exe和SharpHound.ps1這兩個files，所以記得關掉defender ::: Use the Collector First :::info Note: 記得要用bear的網域帳號登入，SharpHound.exe才找的到LDAP ::: CMD直接進入C:\tools\BloodHound-master\Collectors，然後直接執行$ SharpHound.exe :::spoiler Implementation $ SharpHound.exe 2023-08-29T11:02:31.4846421+08:00|INFORMATION|This version of SharpHound is compatible with the 4.3.1 Release of BloodHound 2023-08-29T11:02:31.6707467+08:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote 2023-08-29T11:02:31.6985917+08:00|INFORMATION|Initializing SharpHound at 上午 11:02 on 2023/8/29 2023-08-29T11:02:31.9891653+08:00|INFORMATION|[CommonLib LDAPUtils]Found usable Domain Controller for kuma.org : WIN-818G5VCOLJO.kuma.org 2023-08-29T11:02:32.3820391+08:00|INFORMATION|Loaded cache with stats: 163 ID to type mappings. 163 name to SID mappings. 1 machine sid mappings. 2 sid to domain mappings. 0 global catalog mappings. 2023-08-29T11:02:32.3915435+08:00|INFORMATION|Flags: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote 2023-08-29T11:02:32.6206999+08:00|INFORMATION|Beginning LDAP search for kuma.org 2023-08-29T11:02:32.8062803+08:00|INFORMATION|Producer has finished, closing LDAP channel 2023-08-29T11:02:32.8230625+08:00|INFORMATION|LDAP channel closed, waiting for consumers 2023-08-29T11:03:03.3930708+08:00|INFORMATION|Status: 0 objects finished (+0 0)/s -- Using 42 MB RAM 2023-08-29T11:03:13.1743544+08:00|INFORMATION|Consumers finished, closing output channel Closing writers 2023-08-29T11:03:13.2209345+08:00|INFORMATION|Output channel closed, waiting for output task to complete 2023-08-29T11:03:13.3058132+08:00|INFORMATION|Status: 204 objects finished (+204 5.1)/s -- Using 44 MB RAM 2023-08-29T11:03:13.3058132+08:00|INFORMATION|Enumeration finished in 00:00:40.6864986 2023-08-29T11:03:13.3918361+08:00|INFORMATION|Saving cache with stats: 163 ID to type mappings. 163 name to SID mappings. 1 machine sid mappings. 2 sid to domain mappings. 0 global catalog mappings. 2023-08-29T11:03:13.4075189+08:00|INFORMATION|SharpHound Enumeration Completed at 上午 11:03 on 2023/8/29! Happy Graphing! ::: 理論上成功的話，會在該folder中出現一個.zip file with name <TimeStamp>.BloodHound.zip此時按照之前啟動BloodHound的方法啟動BloodHound，然後把zip folder拖進去就可以了 ==如何偵測AD== # 有兩種方法，也可以同時使用"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="NTUSTISC"><meta property="article:tag" content="AD"><meta property="article:tag" content="Information Security"><title>NTUSTISC - AD Note - Lab(環境調查BloodHound) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x08%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5bloodhound/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>NTUSTISC - AD Note - Lab(環境調查BloodHound)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#lab-time---環境調查>Lab Time - 環境調查</a><ul><li><a href=#bloodhound-ad>BloodHound AD</a></li><li><a href=#如何偵測ad>==如何偵測AD==</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=ntustisc---ad-note---lab環境調查bloodhound>NTUSTISC - AD Note - Lab(環境調查BloodHound)
<a class=anchor href=#ntustisc---ad-note---lab%e7%92%b0%e5%a2%83%e8%aa%bf%e6%9f%a5bloodhound>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=SycYwgWohlu97dc3">2022/05/04 AD 安全1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://medium.com/renee0918/how-to-protect-windows-global-event-c19bba0ce890>[Windows Programming] IPC 通知機制與安全設定</a></p><blockquote><p>當系統中需要同步處理某些資源的存取權時，可以使用 Windows 的同步處理物件協調不同 process 間對於共同資源的互動，Windows 提供的同步處理物件有四種，分別是: Event, Mutex, Semaphore, Waitable timer，本篇只會提到 Event 喔！</p><p>假設系統中有兩個 process：process A 得等待 process B 完成某些特定工作後才能繼續執行。windows 提供的 event 機制能讓 process B 完成工作後發出訊號通知 process A，而 process A 則進入等待狀態直到接受到訊號後才繼續執行後續工作。Process 間只需定好溝通的 event name 就可以輕鬆達成跨程序間的通訊 (Inter-process communication : IPC)，正因為簡單好實現的特性，event 常被用在程序間的溝通與同步。</p></blockquote><h2 id=lab-time---環境調查>Lab Time - 環境調查
<a class=anchor href=#lab-time---%e7%92%b0%e5%a2%83%e8%aa%bf%e6%9f%a5>#</a></h2><h3 id=bloodhound-ad>BloodHound AD
<a class=anchor href=#bloodhound-ad>#</a></h3><ul><li>說明: 環境調查的視覺化工具</li><li>版本: 4.0.3
:::info
<font color=FF0000>8/29更新：經過實測還是建議使用4.1.0</font>，詳細原因可以參考<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，原作者說明這是一個bug，已在4.1.0做了修正，所以還是以4.1.0為主，雖然聽講師說可能會少東西，不過對我們小專案來說應該沒差
:::</li><li>Link: <a href=https://github.com/BloodHoundAD/BloodHound/releases/tag/4.0.3>BloodHound GitHub</a></li><li>必要條件: 必須裝設Neo4j Server / Graph Database, 而且必須要是community version，<a href=https://neo4j.com/download-center/#community>link</a></li></ul><ol><li>Download Collector
BloodHound是一個環境調查的視覺化工具，所以要先在我們的環境先蒐集一些環境上的資訊，再導入到BloodHound中進行分析，因此我們應該先下載能夠蒐集環境資訊的<a href=https://github.com/BloodHoundAD/BloodHound>Collector</a>我是直接把整包clone下來，然後用隨身碟傳到VM(因為那時候Win10已經加入AD，我懶得改回來上網)
:::info
Note:
Windows的defender會擋<code>BloodHound-master/Collectors/SharpHound.exe</code>和<code>SharpHound.ps1</code>這兩個files，所以記得關掉defender
:::</li><li>Use the Collector First
:::info
Note: 記得要用bear的網域帳號登入，SharpHound.exe才找的到LDAP
:::
CMD直接進入<code>C:\tools\BloodHound-master\Collectors</code>，然後直接執行<code>$ SharpHound.exe</code>
:::spoiler Implementation<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ SharpHound.exe
</span></span><span style=display:flex><span>2023-08-29T11:02:31.4846421+08:00|INFORMATION|This version of SharpHound is compatible with the 4.3.1 Release of BloodHound
</span></span><span style=display:flex><span>2023-08-29T11:02:31.6707467+08:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
</span></span><span style=display:flex><span>2023-08-29T11:02:31.6985917+08:00|INFORMATION|Initializing SharpHound at 上午 11:02 on 2023/8/29
</span></span><span style=display:flex><span>2023-08-29T11:02:31.9891653+08:00|INFORMATION|<span style=color:#f92672>[</span>CommonLib LDAPUtils<span style=color:#f92672>]</span>Found usable Domain Controller <span style=color:#66d9ef>for</span> kuma.org : WIN-818G5VCOLJO.kuma.org
</span></span><span style=display:flex><span>2023-08-29T11:02:32.3820391+08:00|INFORMATION|Loaded cache with stats: <span style=color:#ae81ff>163</span> ID to type mappings.
</span></span><span style=display:flex><span> <span style=color:#ae81ff>163</span> name to SID mappings.
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> machine sid mappings.
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2</span> sid to domain mappings.
</span></span><span style=display:flex><span> <span style=color:#ae81ff>0</span> global catalog mappings.
</span></span><span style=display:flex><span>2023-08-29T11:02:32.3915435+08:00|INFORMATION|Flags: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
</span></span><span style=display:flex><span>2023-08-29T11:02:32.6206999+08:00|INFORMATION|Beginning LDAP search <span style=color:#66d9ef>for</span> kuma.org
</span></span><span style=display:flex><span>2023-08-29T11:02:32.8062803+08:00|INFORMATION|Producer has finished, closing LDAP channel
</span></span><span style=display:flex><span>2023-08-29T11:02:32.8230625+08:00|INFORMATION|LDAP channel closed, waiting <span style=color:#66d9ef>for</span> consumers
</span></span><span style=display:flex><span>2023-08-29T11:03:03.3930708+08:00|INFORMATION|Status: <span style=color:#ae81ff>0</span> objects finished <span style=color:#f92672>(</span>+0 0<span style=color:#f92672>)</span>/s -- Using <span style=color:#ae81ff>42</span> MB RAM
</span></span><span style=display:flex><span>2023-08-29T11:03:13.1743544+08:00|INFORMATION|Consumers finished, closing output channel
</span></span><span style=display:flex><span>Closing writers
</span></span><span style=display:flex><span>2023-08-29T11:03:13.2209345+08:00|INFORMATION|Output channel closed, waiting <span style=color:#66d9ef>for</span> output task to complete
</span></span><span style=display:flex><span>2023-08-29T11:03:13.3058132+08:00|INFORMATION|Status: <span style=color:#ae81ff>204</span> objects finished <span style=color:#f92672>(</span>+204 5.1<span style=color:#f92672>)</span>/s -- Using <span style=color:#ae81ff>44</span> MB RAM
</span></span><span style=display:flex><span>2023-08-29T11:03:13.3058132+08:00|INFORMATION|Enumeration finished in 00:00:40.6864986
</span></span><span style=display:flex><span>2023-08-29T11:03:13.3918361+08:00|INFORMATION|Saving cache with stats: <span style=color:#ae81ff>163</span> ID to type mappings.
</span></span><span style=display:flex><span> <span style=color:#ae81ff>163</span> name to SID mappings.
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> machine sid mappings.
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2</span> sid to domain mappings.
</span></span><span style=display:flex><span> <span style=color:#ae81ff>0</span> global catalog mappings.
</span></span><span style=display:flex><span>2023-08-29T11:03:13.4075189+08:00|INFORMATION|SharpHound Enumeration Completed at 上午 11:03 on 2023/8/29! Happy Graphing!
</span></span></code></pre></div>:::
理論上成功的話，會在該folder中出現一個.zip file with name <code>&lt;TimeStamp>.BloodHound.zip</code>此時按照之前啟動BloodHound的方法啟動BloodHound，然後把zip folder拖進去就可以了
<img src=https://hackmd.io/_uploads/rk8rZJjT2.png alt></li></ol><h3 id=如何偵測ad>==如何偵測AD==
<a class=anchor href=#%e5%a6%82%e4%bd%95%e5%81%b5%e6%b8%acad>#</a></h3><p>有兩種方法，也可以同時使用</p><ol><li><p>Lots of Event ID: 4662
如果同一時間偵測到很多4662 event的操作，那很有可能是bloodhound，就算不是也一定是類似的情蒐工具</p></li><li><p>Event ID: 5146
bloodhound喜歡存取的對象是: ==lsarpc/samr/srvsvc==，所以只要有這幾個event出現，就很有可能是bloodhound，而這個event也是像4662一樣預設是關閉的，所以要先到Group Policy Editor打開
<img src=https://hackmd.io/_uploads/HJjbgTZRn.png alt></p><p>:::danger
我查找了5146的event但都沒有偵測到，我有把GPO打開，但是還是沒有偵測到，我是有在Event Viewer中看到很像的，例如5145/5156之類的，但看起來都不是，另外，講師的影片中在59:11的地方也是顯示Event 5145，所以我不知道該怎麼解決這個lab遇到的問題
:::</p><p>可以使用Event Viewer中的Create Custom View，自動的filter出想要的Event
<img src=https://hackmd.io/_uploads/HkDjhnWR3.png alt></p></li></ol><h4 id=result>Result
<a class=anchor href=#result>#</a></h4><p>:::spoiler Screenshot of Event 4662
<img src=https://hackmd.io/_uploads/rJRXT3Z0n.png alt></p><p><img src=https://hackmd.io/_uploads/SyZxpn-R3.png alt>
可以看到從3:53~3:54的時間當中有超多的event 4662紀錄，而同時可以看到再另外一台主機中，我也是在差不多時間執行SharpHound.exe，進行情蒐
:::</p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://github.com/BloodHoundAD/BloodHound/issues/402>Bloodhound 4.0 - doesn’t upload all data #402 </a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#lab-time---環境調查>Lab Time - 環境調查</a><ul><li><a href=#bloodhound-ad>BloodHound AD</a></li><li><a href=#如何偵測ad>==如何偵測AD==</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside></main></body></html>