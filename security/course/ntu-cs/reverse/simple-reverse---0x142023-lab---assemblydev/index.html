<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  Simple Reverse - 0x14(2023 Lab - AssemblyDev)
  #


  Background
  #

Tools
Assembly x86 Emulator
Compiler Explorer

  Source code
  #

:::spoiler arithmatic.py
#!/usr/bin/python
from module.checker import *
from module.math import *
from sys import argv

challenge_info = f&#39;&#39;&#39;
let a = MEM[RSP+0x0:RSP+0x4]
let b = MEM[RSP+0x4:RSP+0x8]
let c = MEM[RSP+0x8:RSP+0xc]

EAX = a + b
EBX = a - b
ECX = -c
EDX = 9*a + 7
&#39;&#39;&#39;

a = get_rand(4)
b = get_rand(4)
c = get_rand(4)

init_list = [
    (RSP_DEFAULT + 0x0, a, 4),
    (RSP_DEFAULT + 0x4, b, 4),
    (RSP_DEFAULT + 0x8, c, 4),
]
ans_list = [
    ("eax", add(a, b, 4)),
    ("ebx", sub(a, b, 4)),
    ("ecx", neg(c, 4)),
    ("edx", add(mul(a, 9, 4), 7, 4)),
]

if __name__ == "__main__":
    if len(argv) < 2:
        print(f"{C.BLUE}[+]{C.NC} Usage: python3 {__file__} <path_to_asm_file>")
        print(challenge_info)
        exit(0)

    code = open(argv[1], &#39;r&#39;).read()
    Checker(init_list, ans_list, code)
:::
:::spoiler data_movement.py'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntu-cs/reverse/simple-reverse---0x142023-lab---assemblydev/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Simple Reverse - 0x14(2023 Lab - AssemblyDev)"><meta property="og:description" content='Simple Reverse - 0x14(2023 Lab - AssemblyDev) # Background # Tools Assembly x86 Emulator Compiler Explorer
Source code # :::spoiler arithmatic.py
#!/usr/bin/python from module.checker import * from module.math import * from sys import argv challenge_info = f&#39;&#39;&#39; let a = MEM[RSP+0x0:RSP+0x4] let b = MEM[RSP+0x4:RSP+0x8] let c = MEM[RSP+0x8:RSP+0xc] EAX = a + b EBX = a - b ECX = -c EDX = 9*a + 7 &#39;&#39;&#39; a = get_rand(4) b = get_rand(4) c = get_rand(4) init_list = [ (RSP_DEFAULT + 0x0, a, 4), (RSP_DEFAULT + 0x4, b, 4), (RSP_DEFAULT + 0x8, c, 4), ] ans_list = [ ("eax", add(a, b, 4)), ("ebx", sub(a, b, 4)), ("ecx", neg(c, 4)), ("edx", add(mul(a, 9, 4), 7, 4)), ] if __name__ == "__main__": if len(argv) < 2: print(f"{C.BLUE}[+]{C.NC} Usage: python3 {__file__} <path_to_asm_file>") print(challenge_info) exit(0) code = open(argv[1], &#39;r&#39;).read() Checker(init_list, ans_list, code) ::: :::spoiler data_movement.py'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="Eductf"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Reverse"><title>Simple Reverse - 0x14(2023 Lab - AssemblyDev) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntu-cs/reverse/simple-reverse---0x142023-lab---assemblydev/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Simple Reverse - 0x14(2023 Lab - AssemblyDev)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#source-code>Source code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=simple-reverse---0x142023-lab---assemblydev>Simple Reverse - 0x14(2023 Lab - AssemblyDev)
<a class=anchor href=#simple-reverse---0x142023-lab---assemblydev>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Tools
<a href=https://carlosrafaelgn.com.br/Asm86/>Assembly x86 Emulator</a>
<a href=https://godbolt.org/>Compiler Explorer</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler arithmatic.py</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> module.checker <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> module.math <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sys <span style=color:#f92672>import</span> argv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>challenge_info <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let a = MEM[RSP+0x0:RSP+0x4]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let b = MEM[RSP+0x4:RSP+0x8]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let c = MEM[RSP+0x8:RSP+0xc]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EAX = a + b
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EBX = a - b
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ECX = -c
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EDX = 9*a + 7
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>init_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x0</span>, a, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x4</span>, b, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x8</span>, c, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>ans_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;eax&#34;</span>, add(a, b, <span style=color:#ae81ff>4</span>)),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ebx&#34;</span>, sub(a, b, <span style=color:#ae81ff>4</span>)),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ecx&#34;</span>, neg(c, <span style=color:#ae81ff>4</span>)),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;edx&#34;</span>, add(mul(a, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>), <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>4</span>)),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(argv) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>BLUE<span style=color:#e6db74>}</span><span style=color:#e6db74>[+]</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>NC<span style=color:#e6db74>}</span><span style=color:#e6db74> Usage: python3 </span><span style=color:#e6db74>{</span>__file__<span style=color:#e6db74>}</span><span style=color:#e6db74> &lt;path_to_asm_file&gt;&#34;</span>)
</span></span><span style=display:flex><span>        print(challenge_info)
</span></span><span style=display:flex><span>        exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    code <span style=color:#f92672>=</span> open(argv[<span style=color:#ae81ff>1</span>], <span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    Checker(init_list, ans_list, code)
</span></span></code></pre></div><p>:::
:::spoiler data_movement.py</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> module.checker <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> module.math <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sys <span style=color:#f92672>import</span> argv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>challenge_info <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>BLUE<span style=color:#e6db74>}</span><span style=color:#e6db74># Modify register value</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>NC<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>RAX += 0x87
</span></span></span><span style=display:flex><span><span style=color:#e6db74>RBX -= 0x63
</span></span></span><span style=display:flex><span><span style=color:#e6db74>RCX, RDX = RDX, RCX
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>BLUE<span style=color:#e6db74>}</span><span style=color:#e6db74># Modify memory value</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>NC<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>MEM[RSP+0x0:RSP+0x4] += 0xdeadbeef
</span></span></span><span style=display:flex><span><span style=color:#e6db74>MEM[RSP+0x4:RSP+0x8] -= 0xfaceb00c
</span></span></span><span style=display:flex><span><span style=color:#e6db74>MEM[RSP+0x8:RSP+0xc], MEM[RSP+0xc:RSP+0x10] = MEM[RSP+0xc:RSP+0x10], MEM[RSP+0x8:RSP+0xc]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>_rax <span style=color:#f92672>=</span> get_rand()
</span></span><span style=display:flex><span>_rbx <span style=color:#f92672>=</span> get_rand()
</span></span><span style=display:flex><span>_rcx <span style=color:#f92672>=</span> get_rand()
</span></span><span style=display:flex><span>_rdx <span style=color:#f92672>=</span> get_rand()
</span></span><span style=display:flex><span>mem <span style=color:#f92672>=</span> list()
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>    mem<span style=color:#f92672>.</span>append(get_rand(<span style=color:#ae81ff>4</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>init_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rax&#34;</span>, _rax),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rbx&#34;</span>, _rbx),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rcx&#34;</span>, _rcx),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rdx&#34;</span>, _rdx),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x0</span>, mem[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x4</span>, mem[<span style=color:#ae81ff>1</span>], <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x8</span>, mem[<span style=color:#ae81ff>2</span>], <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0xc</span>, mem[<span style=color:#ae81ff>3</span>], <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>ans_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rax&#34;</span>, add(_rax, <span style=color:#ae81ff>0x87</span>)),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rbx&#34;</span>, sub(_rbx, <span style=color:#ae81ff>0x63</span>)),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rcx&#34;</span>, _rdx),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rdx&#34;</span>, _rcx),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x0</span>, add(mem[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>0xdeadbeef</span>, <span style=color:#ae81ff>4</span>), <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x4</span>, sub(mem[<span style=color:#ae81ff>1</span>], <span style=color:#ae81ff>0xfaceb00c</span>, <span style=color:#ae81ff>4</span>), <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x8</span>, mem[<span style=color:#ae81ff>3</span>], <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0xc</span>, mem[<span style=color:#ae81ff>2</span>], <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(argv) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>BLUE<span style=color:#e6db74>}</span><span style=color:#e6db74>[+]</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>NC<span style=color:#e6db74>}</span><span style=color:#e6db74> Usage: python3 </span><span style=color:#e6db74>{</span>__file__<span style=color:#e6db74>}</span><span style=color:#e6db74> &lt;path_to_asm_file&gt;&#34;</span>)
</span></span><span style=display:flex><span>        print(challenge_info)
</span></span><span style=display:flex><span>        exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    code <span style=color:#f92672>=</span> open(argv[<span style=color:#ae81ff>1</span>], <span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    Checker(init_list, ans_list, code)
</span></span></code></pre></div><p>:::
:::spoiler condition.py</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> module.checker <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> module.math <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sys <span style=color:#f92672>import</span> argv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>challenge_info <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let a = MEM[RSP+0x0:RSP+0x4]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let b = MEM[RSP+0x4:RSP+0x8]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let c = MEM[RSP+0x8:RSP+0xc]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let d = MEM[RSP+0xc:RSP+0x10]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>BLUE<span style=color:#e6db74>}</span><span style=color:#e6db74># a, b -&gt; signed 4 btyes integer</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>NC<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if a &gt;= b:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    EAX = a
</span></span></span><span style=display:flex><span><span style=color:#e6db74>else:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    EAX = b
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>BLUE<span style=color:#e6db74>}</span><span style=color:#e6db74># c, d -&gt; unsigned 4 btyes integer</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>NC<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if c &lt; d:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    EBX = c
</span></span></span><span style=display:flex><span><span style=color:#e6db74>else:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    EBX = d
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if c is an odd number:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ECX = c // 8
</span></span></span><span style=display:flex><span><span style=color:#e6db74>else:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ECX = c * 4
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>init_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x0</span>, a, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x4</span>, b, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x8</span>, c, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0xc</span>, d, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> u2signed(a, <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> u2signed(b, <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>_eax <span style=color:#f92672>=</span> (a <span style=color:#66d9ef>if</span> a <span style=color:#f92672>&gt;=</span> b <span style=color:#66d9ef>else</span> b) <span style=color:#f92672>&amp;</span> mask(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>_ebx <span style=color:#f92672>=</span> (c <span style=color:#66d9ef>if</span> c <span style=color:#f92672>&lt;</span> d <span style=color:#66d9ef>else</span> d) <span style=color:#f92672>&amp;</span> mask(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>_ecx <span style=color:#f92672>=</span> div(c, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>4</span>) <span style=color:#66d9ef>if</span> is_odd(c) <span style=color:#66d9ef>else</span> mul(c, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ans_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;eax&#34;</span>, _eax),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ebx&#34;</span>, _ebx),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ecx&#34;</span>, _ecx),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(argv) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>BLUE<span style=color:#e6db74>}</span><span style=color:#e6db74>[+]</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>NC<span style=color:#e6db74>}</span><span style=color:#e6db74> Usage: python3 </span><span style=color:#e6db74>{</span>__file__<span style=color:#e6db74>}</span><span style=color:#e6db74> &lt;path_to_asm_file&gt;&#34;</span>)
</span></span><span style=display:flex><span>        print(challenge_info)
</span></span><span style=display:flex><span>        exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    code <span style=color:#f92672>=</span> open(argv[<span style=color:#ae81ff>1</span>], <span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    Checker(init_list, ans_list, code)
</span></span></code></pre></div><p>:::</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題有三小題，包含<code>arithmatic.py</code>, <code>data_movement.py</code>, 以及<code>condition.py</code>，過關的條件是要自己寫assembly然後達帶這三個關卡的register或stack條件，我是直接用compiler explorer幫我把c code直接轉assembly然後再利用assembly x86 emulator做double check，速度應該會快很多</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ul><li>題目一: 就是一般的運算(+-*/)<pre tabindex=0><code>let a = MEM[RSP+0x0:RSP+0x4]
let b = MEM[RSP+0x4:RSP+0x8]
let c = MEM[RSP+0x8:RSP+0xc]

EAX = a + b
EBX = a - b
ECX = -c
EDX = 9*a + 7
</code></pre>:::spoiler Solution<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>r8d</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span>] <span style=color:#75715e>; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>r9d</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span> <span style=color:#960050;background-color:#1e0010>+</span> <span style=color:#ae81ff>4</span>] <span style=color:#75715e>; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>r10d</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span> <span style=color:#960050;background-color:#1e0010>+</span> <span style=color:#ae81ff>8</span>] <span style=color:#75715e>;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>; EAX = a + b
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>eax</span>, <span style=color:#66d9ef>r8d</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add</span> <span style=color:#66d9ef>eax</span>, <span style=color:#66d9ef>r9d</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; EBX = a - b
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>ecx</span>, <span style=color:#66d9ef>r8d</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sub</span> <span style=color:#66d9ef>ecx</span>, <span style=color:#66d9ef>r9d</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>ebx</span>, <span style=color:#66d9ef>ecx</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; ECX = -c
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>ecx</span>, <span style=color:#66d9ef>r10d</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>neg</span> <span style=color:#66d9ef>ecx</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; EDX = 9 * a + 7
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>edx</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>rsp</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>sal</span> <span style=color:#66d9ef>edx</span>, <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add</span> <span style=color:#66d9ef>edx</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>rsp</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>add</span> <span style=color:#66d9ef>edx</span>, <span style=color:#ae81ff>7</span>
</span></span></code></pre></div>:::</li><li>題目二: 這邊是考register和stack之間的搬運和運算<pre tabindex=0><code># Modify register value
RAX += 0x87
RBX -= 0x63
RCX, RDX = RDX, RCX

{C.BLUE}# Modify memory value
MEM[RSP+0x0:RSP+0x4] += 0xdeadbeef
MEM[RSP+0x4:RSP+0x8] -= 0xfaceb00c
MEM[RSP+0x8:RSP+0xc], MEM[RSP+0xc:RSP+0x10] = MEM[RSP+0xc:RSP+0x10], MEM[RSP+0x8:RSP+0xc]
</code></pre>:::spoiler Solution<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#75715e>; Modify register value
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>add</span> <span style=color:#66d9ef>rax</span>, <span style=color:#ae81ff>0x87</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sub</span> <span style=color:#66d9ef>rbx</span>, <span style=color:#ae81ff>0x63</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>r8</span>, <span style=color:#66d9ef>rcx</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>rcx</span>, <span style=color:#66d9ef>rdx</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>rdx</span>, <span style=color:#66d9ef>r8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; MEM[RSP+0x0:RSP+0x4] += 0xdeadbeef
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>r8d</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>add</span> <span style=color:#66d9ef>r8d</span>, <span style=color:#ae81ff>0xdeadbeef</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span>], <span style=color:#66d9ef>r8d</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; MEM[RSP+0x4:RSP+0x8] -= 0xfaceb00c
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>r8d</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>sub</span> <span style=color:#66d9ef>r8d</span>, <span style=color:#ae81ff>0xfaceb00c</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>4</span>], <span style=color:#66d9ef>r8d</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; MEM[RSP+0x8:RSP+0xc], MEM[RSP+0xc:RSP+0x10] = MEM[RSP+0xc:RSP+0x10], MEM[RSP+0x8:RSP+0xc]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>r8d</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>r9d</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0xc</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>8</span>], <span style=color:#66d9ef>r9d</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>rsp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0xc</span>], <span style=color:#66d9ef>r8d</span>
</span></span></code></pre></div>:::</li><li>題目三: 需要考慮condition，然後看要跳轉到哪邊，重點是jump有分signed和unsigned，而仔細看source code他只有考慮unsinged，所以我們要特別挑選<a href=https://redirect.cs.umbc.edu/courses/undergraduate/CMSC313/spring04/burt_katz/lectures/Lect05/unsignedCondJumps.html>jump的類別</a><pre tabindex=0><code>let a = MEM[RSP+0x0:RSP+0x4]
let b = MEM[RSP+0x4:RSP+0x8]
let c = MEM[RSP+0x8:RSP+0xc]
let d = MEM[RSP+0xc:RSP+0x10]

# a, b -&gt; signed 4 btyes integer
if a &gt;= b:
    EAX = a
else:
    EAX = b

# c, d -&gt; unsigned 4 btyes integer{C.NC}
if c &lt; d:
    EBX = c
else:
    EBX = d

if c is an odd number:
    ECX = c // 8
else:
    ECX = c * 4
</code></pre>:::spoiler Solution<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#75715e>; if a &gt;= b:
</span></span></span><span style=display:flex><span><span style=color:#75715e>;     EAX = a
</span></span></span><span style=display:flex><span><span style=color:#75715e>; else:
</span></span></span><span style=display:flex><span><span style=color:#75715e>;     EAX = b
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>eax</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>rsp</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cmp</span>     <span style=color:#66d9ef>eax</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>rsp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>jl</span>      <span style=color:#66d9ef>L2</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>eax</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>rsp</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>jmp</span>     <span style=color:#66d9ef>L3</span>
</span></span><span style=display:flex><span>L2:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>eax</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>rsp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; if c &lt; d:
</span></span></span><span style=display:flex><span><span style=color:#75715e>;     EBX = c
</span></span></span><span style=display:flex><span><span style=color:#75715e>; else:
</span></span></span><span style=display:flex><span><span style=color:#75715e>;     EBX = d
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>L3:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>edi</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>esp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0x8</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span> 	<span style=color:#66d9ef>esi</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>esp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0xc</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cmp</span>     <span style=color:#66d9ef>edi</span>, <span style=color:#66d9ef>esi</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>jae</span>     <span style=color:#66d9ef>L4</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>ebx</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>esp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0x8</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>jmp</span>     <span style=color:#66d9ef>L5</span>
</span></span><span style=display:flex><span>L4:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>ebx</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>esp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0xc</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; if c is an odd number:
</span></span></span><span style=display:flex><span><span style=color:#75715e>;     ECX = c // 8
</span></span></span><span style=display:flex><span><span style=color:#75715e>; else:
</span></span></span><span style=display:flex><span><span style=color:#75715e>;     ECX = c * 4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>L5:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>edi</span>, <span style=color:#66d9ef>DWORD</span> [<span style=color:#66d9ef>esp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0x8</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>and</span>     <span style=color:#66d9ef>edi</span>, <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cmp</span>     <span style=color:#66d9ef>edi</span>, <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>jne</span>     <span style=color:#66d9ef>L6</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>ecx</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>esp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0x8</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sar</span>     <span style=color:#66d9ef>ecx</span>, <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>jmp</span>     <span style=color:#66d9ef>L7</span>
</span></span><span style=display:flex><span>L6:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mov</span>     <span style=color:#66d9ef>ecx</span>, <span style=color:#66d9ef>dword</span> [<span style=color:#66d9ef>esp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0x8</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sal</span>     <span style=color:#66d9ef>ecx</span>, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>L7:
</span></span></code></pre></div>:::</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ <span style=color:#f92672>(</span>cat arithmatic.asm | base64 -w0 ; echo <span style=color:#e6db74>&#39;&#39;</span> ; cat data_movement.asm | base64 -w0 ; echo <span style=color:#e6db74>&#39;&#39;</span> ; cat condition.asm | base64 -w0 ; echo <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>)</span> &gt; answer.txt
</span></span><span style=display:flex><span>$ cat answer.txt | nc edu-ctf.zoolab.org <span style=color:#ae81ff>10020</span>
</span></span></code></pre></div><p>:::spoiler 完整的輸出結果</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat answer.txt | nc edu-ctf.zoolab.org <span style=color:#ae81ff>10020</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── Challenge Info ──────────────────────────────────────────────
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>let a <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0x0:RSP+0x4<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>let b <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0x4:RSP+0x8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>let c <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0x8:RSP+0xc<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EAX <span style=color:#f92672>=</span> a + b
</span></span><span style=display:flex><span>EBX <span style=color:#f92672>=</span> a - b
</span></span><span style=display:flex><span>ECX <span style=color:#f92672>=</span> -c
</span></span><span style=display:flex><span>EDX <span style=color:#f92672>=</span> 9*a + <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Give me your base64 of your assembly code!
</span></span><span style=display:flex><span>&gt;
</span></span><span style=display:flex><span>──── Your Assembly ───────────────────────────────────────────────
</span></span><span style=display:flex><span>mov r8d, dword <span style=color:#f92672>[</span>rsp<span style=color:#f92672>]</span> ;
</span></span><span style=display:flex><span>mov r9d, dword <span style=color:#f92672>[</span>rsp + 4<span style=color:#f92672>]</span> ;
</span></span><span style=display:flex><span>mov r10d, dword <span style=color:#f92672>[</span>rsp + 8<span style=color:#f92672>]</span> ;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; EAX <span style=color:#f92672>=</span> a + b
</span></span><span style=display:flex><span>mov eax, r8d
</span></span><span style=display:flex><span>add eax, r9d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; EBX <span style=color:#f92672>=</span> a - b
</span></span><span style=display:flex><span>mov ecx, r8d
</span></span><span style=display:flex><span>sub ecx, r9d
</span></span><span style=display:flex><span>mov ebx, ecx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; ECX <span style=color:#f92672>=</span> -c
</span></span><span style=display:flex><span>mov ecx, r10d
</span></span><span style=display:flex><span>neg ecx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; EDX <span style=color:#f92672>=</span> <span style=color:#ae81ff>9</span> * a + <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span>mov edx, DWORD <span style=color:#f92672>[</span>rsp<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>sal edx, <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>add edx, DWORD <span style=color:#f92672>[</span>rsp<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>add edx, <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>([</span>68, 139, 4, 36, 68, 139, 76, 36, 4, 68, 139, 84, 36, 8, 68, 137, 192, 68, 1, 200, 68, 137, 193, 68, 41, 201, 137, 203, 68, 137, 209, 247, 217, 139, 20, 36, 193, 226, 3, 3, 20, 36, 131, 194, 7<span style=color:#f92672>]</span>, 44<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> Initial Context <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── register ────────────────────────────────────────────────────
</span></span><span style=display:flex><span>$rax: 0x0000000000000000
</span></span><span style=display:flex><span>$rbx: 0x0000000000000000
</span></span><span style=display:flex><span>$rcx: 0x0000000000000000
</span></span><span style=display:flex><span>$rdx: 0x0000000000000000
</span></span><span style=display:flex><span>$rdi: 0x0000000000000000
</span></span><span style=display:flex><span>$rsi: 0x0000000000000000
</span></span><span style=display:flex><span>$rbp: 0x0000000000000000
</span></span><span style=display:flex><span>$rsp: 0x0000000007100000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── stack ───────────────────────────────────────────────────────
</span></span><span style=display:flex><span>0x7100000|+0x0000: 0x3ad14697f68546bc     ← $rsp
</span></span><span style=display:flex><span>0x7100008|+0x0008: 0x00000000aa428281
</span></span><span style=display:flex><span>0x7100010|+0x0010: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100018|+0x0018: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100020|+0x0020: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100028|+0x0028: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100030|+0x0030: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100038|+0x0038: 0x0000000000000000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> Final Context <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── register ────────────────────────────────────────────────────
</span></span><span style=display:flex><span>$rax: 0x0000000031568d53
</span></span><span style=display:flex><span>$rbx: 0x00000000bbb40025
</span></span><span style=display:flex><span>$rcx: 0x0000000055bd7d7f
</span></span><span style=display:flex><span>$rdx: 0x00000000aaaf7ca3
</span></span><span style=display:flex><span>$rdi: 0x0000000000000000
</span></span><span style=display:flex><span>$rsi: 0x0000000000000000
</span></span><span style=display:flex><span>$rbp: 0x0000000000000000
</span></span><span style=display:flex><span>$rsp: 0x0000000007100000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── stack ───────────────────────────────────────────────────────
</span></span><span style=display:flex><span>0x7100000|+0x0000: 0x3ad14697f68546bc     ← $rsp
</span></span><span style=display:flex><span>0x7100008|+0x0008: 0x00000000aa428281
</span></span><span style=display:flex><span>0x7100010|+0x0010: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100018|+0x0018: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100020|+0x0020: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100028|+0x0028: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100030|+0x0030: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100038|+0x0038: 0x0000000000000000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── Result ──────────────────────────────────────────────────────
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $eax <span style=color:#f92672>=</span> 0x31568d53
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $ebx <span style=color:#f92672>=</span> 0xbbb40025
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $ecx <span style=color:#f92672>=</span> 0x55bd7d7f
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $edx <span style=color:#f92672>=</span> 0xaaaf7ca3
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> CORRECT :<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── Challenge Info ──────────────────────────────────────────────
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Modify register value</span>
</span></span><span style=display:flex><span>RAX <span style=color:#f92672>+=</span> 0x87
</span></span><span style=display:flex><span>RBX -<span style=color:#f92672>=</span> 0x63
</span></span><span style=display:flex><span>RCX, RDX <span style=color:#f92672>=</span> RDX, RCX
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Modify memory value</span>
</span></span><span style=display:flex><span>MEM<span style=color:#f92672>[</span>RSP+0x0:RSP+0x4<span style=color:#f92672>]</span> +<span style=color:#f92672>=</span> 0xdeadbeef
</span></span><span style=display:flex><span>MEM<span style=color:#f92672>[</span>RSP+0x4:RSP+0x8<span style=color:#f92672>]</span> -<span style=color:#f92672>=</span> 0xfaceb00c
</span></span><span style=display:flex><span>MEM<span style=color:#f92672>[</span>RSP+0x8:RSP+0xc<span style=color:#f92672>]</span>, MEM<span style=color:#f92672>[</span>RSP+0xc:RSP+0x10<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0xc:RSP+0x10<span style=color:#f92672>]</span>, MEM<span style=color:#f92672>[</span>RSP+0x8:RSP+0xc<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Give me your base64 of your assembly code!
</span></span><span style=display:flex><span>&gt;
</span></span><span style=display:flex><span>──── Your Assembly ───────────────────────────────────────────────
</span></span><span style=display:flex><span>; Modify register value
</span></span><span style=display:flex><span>add rax, 0x87
</span></span><span style=display:flex><span>sub rbx, 0x63
</span></span><span style=display:flex><span>mov r8, rcx
</span></span><span style=display:flex><span>mov rcx, rdx
</span></span><span style=display:flex><span>mov rdx, r8
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; MEM<span style=color:#f92672>[</span>RSP+0x0:RSP+0x4<span style=color:#f92672>]</span> +<span style=color:#f92672>=</span> 0xdeadbeef
</span></span><span style=display:flex><span>mov r8d, dword <span style=color:#f92672>[</span>rsp<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>add r8d, 0xdeadbeef
</span></span><span style=display:flex><span>mov dword <span style=color:#f92672>[</span>rsp<span style=color:#f92672>]</span>, r8d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; MEM<span style=color:#f92672>[</span>RSP+0x4:RSP+0x8<span style=color:#f92672>]</span> -<span style=color:#f92672>=</span> 0xfaceb00c
</span></span><span style=display:flex><span>mov r8d, dword <span style=color:#f92672>[</span>rsp+4<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>sub r8d, 0xfaceb00c
</span></span><span style=display:flex><span>mov dword <span style=color:#f92672>[</span>rsp+4<span style=color:#f92672>]</span>, r8d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; MEM<span style=color:#f92672>[</span>RSP+0x8:RSP+0xc<span style=color:#f92672>]</span>, MEM<span style=color:#f92672>[</span>RSP+0xc:RSP+0x10<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0xc:RSP+0x10<span style=color:#f92672>]</span>, MEM<span style=color:#f92672>[</span>RSP+0x8:RSP+0xc<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>mov r8d, dword <span style=color:#f92672>[</span>rsp+8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>mov r9d, dword <span style=color:#f92672>[</span>rsp+0xc<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>mov dword <span style=color:#f92672>[</span>rsp+8<span style=color:#f92672>]</span>, r9d
</span></span><span style=display:flex><span>mov dword <span style=color:#f92672>[</span>rsp+0xc<span style=color:#f92672>]</span>, r8d
</span></span><span style=display:flex><span><span style=color:#f92672>([</span>72, 5, 135, 0, 0, 0, 72, 131, 235, 99, 73, 137, 200, 72, 137, 209, 76, 137, 194, 68, 139, 4, 36, 65, 129, 192, 239, 190, 173, 222, 68, 137, 4, 36, 68, 139, 68, 36, 4, 65, 129, 232, 12, 176, 206, 250, 68, 137, 68, 36, 4, 68, 139, 68, 36, 8, 68, 139, 76, 36, 12, 68, 137, 76, 36, 8, 68, 137, 68, 36, 12<span style=color:#f92672>]</span>, 47<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> Initial Context <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── register ────────────────────────────────────────────────────
</span></span><span style=display:flex><span>$rax: 0xd9efd9c16a5bc322
</span></span><span style=display:flex><span>$rbx: 0xb9cf8db36cbfc14a
</span></span><span style=display:flex><span>$rcx: 0x938ee6ed0bf25e63
</span></span><span style=display:flex><span>$rdx: 0xead92779318623a4
</span></span><span style=display:flex><span>$rdi: 0x0000000000000000
</span></span><span style=display:flex><span>$rsi: 0x0000000000000000
</span></span><span style=display:flex><span>$rbp: 0x0000000000000000
</span></span><span style=display:flex><span>$rsp: 0x0000000007100000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── stack ───────────────────────────────────────────────────────
</span></span><span style=display:flex><span>0x7100000|+0x0000: 0xfc969827aea7be89     ← $rsp
</span></span><span style=display:flex><span>0x7100008|+0x0008: 0x6482df8494b54caf
</span></span><span style=display:flex><span>0x7100010|+0x0010: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100018|+0x0018: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100020|+0x0020: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100028|+0x0028: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100030|+0x0030: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100038|+0x0038: 0x0000000000000000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> Final Context <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── register ────────────────────────────────────────────────────
</span></span><span style=display:flex><span>$rax: 0xd9efd9c16a5bc3a9
</span></span><span style=display:flex><span>$rbx: 0xb9cf8db36cbfc0e7
</span></span><span style=display:flex><span>$rcx: 0xead92779318623a4
</span></span><span style=display:flex><span>$rdx: 0x938ee6ed0bf25e63
</span></span><span style=display:flex><span>$rdi: 0x0000000000000000
</span></span><span style=display:flex><span>$rsi: 0x0000000000000000
</span></span><span style=display:flex><span>$rbp: 0x0000000000000000
</span></span><span style=display:flex><span>$rsp: 0x0000000007100000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── stack ───────────────────────────────────────────────────────
</span></span><span style=display:flex><span>0x7100000|+0x0000: 0x01c7e81b8d557d78     ← $rsp
</span></span><span style=display:flex><span>0x7100008|+0x0008: 0x94b54caf6482df84
</span></span><span style=display:flex><span>0x7100010|+0x0010: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100018|+0x0018: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100020|+0x0020: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100028|+0x0028: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100030|+0x0030: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100038|+0x0038: 0x0000000000000000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── Result ──────────────────────────────────────────────────────
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $rax <span style=color:#f92672>=</span> 0xd9efd9c16a5bc3a9
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $rbx <span style=color:#f92672>=</span> 0xb9cf8db36cbfc0e7
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $rcx <span style=color:#f92672>=</span> 0xead92779318623a4
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $rdx <span style=color:#f92672>=</span> 0x938ee6ed0bf25e63
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>0x077100000<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 0x8d557d78
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>0x077100004<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 0x1c7e81b
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>0x077100008<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 0x6482df84
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>0x07710000c<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> 0x94b54caf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> CORRECT :<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── Challenge Info ──────────────────────────────────────────────
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>let a <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0x0:RSP+0x4<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>let b <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0x4:RSP+0x8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>let c <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0x8:RSP+0xc<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>let d <span style=color:#f92672>=</span> MEM<span style=color:#f92672>[</span>RSP+0xc:RSP+0x10<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># a, b -&gt; signed 4 btyes integer</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> a &gt;<span style=color:#f92672>=</span> b:
</span></span><span style=display:flex><span>    EAX <span style=color:#f92672>=</span> a
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    EAX <span style=color:#f92672>=</span> b
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># c, d -&gt; unsigned 4 btyes integer</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> c &lt; d:
</span></span><span style=display:flex><span>    EBX <span style=color:#f92672>=</span> c
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    EBX <span style=color:#f92672>=</span> d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> c is an odd number:
</span></span><span style=display:flex><span>    ECX <span style=color:#f92672>=</span> c // <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    ECX <span style=color:#f92672>=</span> c * <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Give me your base64 of your assembly code!
</span></span><span style=display:flex><span>&gt;
</span></span><span style=display:flex><span>──── Your Assembly ───────────────────────────────────────────────
</span></span><span style=display:flex><span>; <span style=color:#66d9ef>if</span> a &gt;<span style=color:#f92672>=</span> b:
</span></span><span style=display:flex><span>;     EAX <span style=color:#f92672>=</span> a
</span></span><span style=display:flex><span>; <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>;     EAX <span style=color:#f92672>=</span> b
</span></span><span style=display:flex><span>    mov     eax, DWORD <span style=color:#f92672>[</span>rsp<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    cmp     eax, DWORD <span style=color:#f92672>[</span>rsp+4<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    jl      L2
</span></span><span style=display:flex><span>    mov     eax, DWORD <span style=color:#f92672>[</span>rsp<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    jmp     L3
</span></span><span style=display:flex><span>L2:
</span></span><span style=display:flex><span>    mov     eax, DWORD <span style=color:#f92672>[</span>rsp+4<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; <span style=color:#66d9ef>if</span> c &lt; d:
</span></span><span style=display:flex><span>;     EBX <span style=color:#f92672>=</span> c
</span></span><span style=display:flex><span>; <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>;     EBX <span style=color:#f92672>=</span> d
</span></span><span style=display:flex><span>L3:
</span></span><span style=display:flex><span>        mov     edi, DWORD <span style=color:#f92672>[</span>esp+0x8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        mov     esi, DWORD <span style=color:#f92672>[</span>esp+0xc<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    cmp     edi, esi
</span></span><span style=display:flex><span>    jae     L4
</span></span><span style=display:flex><span>    mov     ebx, DWORD <span style=color:#f92672>[</span>esp+0x8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    jmp     L5
</span></span><span style=display:flex><span>L4:
</span></span><span style=display:flex><span>    mov     ebx, DWORD <span style=color:#f92672>[</span>esp+0xc<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>; <span style=color:#66d9ef>if</span> c is an odd number:
</span></span><span style=display:flex><span>;     ECX <span style=color:#f92672>=</span> c // <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>; <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>;     ECX <span style=color:#f92672>=</span> c * <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>L5:
</span></span><span style=display:flex><span>        mov     edi, DWORD <span style=color:#f92672>[</span>esp+0x8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        and     edi, <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        cmp     edi, <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        jne     L6
</span></span><span style=display:flex><span>        mov     ecx, dword <span style=color:#f92672>[</span>esp+0x8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        sar     ecx, <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>        jmp     L7
</span></span><span style=display:flex><span>L6:
</span></span><span style=display:flex><span>        mov     ecx, dword <span style=color:#f92672>[</span>esp+0x8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        sal     ecx, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>L7:
</span></span><span style=display:flex><span><span style=color:#f92672>([</span>139, 4, 36, 59, 68, 36, 4, 124, 5, 139, 4, 36, 235, 4, 139, 68, 36, 4, 103, 139, 124, 36, 8, 103, 139, 116, 36, 12, 57, 247, 115, 7, 103, 139, 92, 36, 8, 235, 5, 103, 139, 92, 36, 12, 103, 139, 124, 36, 8, 131, 231, 1, 131, 255, 1, 117, 10, 103, 139, 76, 36, 8, 193, 249, 3, 235, 8, 103, 139, 76, 36, 8, 193, 225, 2<span style=color:#f92672>]</span>, 89<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> Initial Context <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── register ────────────────────────────────────────────────────
</span></span><span style=display:flex><span>$rax: 0x0000000000000000
</span></span><span style=display:flex><span>$rbx: 0x0000000000000000
</span></span><span style=display:flex><span>$rcx: 0x0000000000000000
</span></span><span style=display:flex><span>$rdx: 0x0000000000000000
</span></span><span style=display:flex><span>$rdi: 0x0000000000000000
</span></span><span style=display:flex><span>$rsi: 0x0000000000000000
</span></span><span style=display:flex><span>$rbp: 0x0000000000000000
</span></span><span style=display:flex><span>$rsp: 0x0000000007100000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── stack ───────────────────────────────────────────────────────
</span></span><span style=display:flex><span>0x7100000|+0x0000: 0x21bd1f6bf4090a3a     ← $rsp
</span></span><span style=display:flex><span>0x7100008|+0x0008: 0xfd382fd2ccd74eca
</span></span><span style=display:flex><span>0x7100010|+0x0010: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100018|+0x0018: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100020|+0x0020: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100028|+0x0028: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100030|+0x0030: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100038|+0x0038: 0x0000000000000000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> Final Context <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── register ────────────────────────────────────────────────────
</span></span><span style=display:flex><span>$rax: 0x0000000021bd1f6b
</span></span><span style=display:flex><span>$rbx: 0x00000000ccd74eca
</span></span><span style=display:flex><span>$rcx: 0x00000000335d3b28
</span></span><span style=display:flex><span>$rdx: 0x0000000000000000
</span></span><span style=display:flex><span>$rdi: 0x0000000000000000
</span></span><span style=display:flex><span>$rsi: 0x00000000fd382fd2
</span></span><span style=display:flex><span>$rbp: 0x0000000000000000
</span></span><span style=display:flex><span>$rsp: 0x0000000007100000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── stack ───────────────────────────────────────────────────────
</span></span><span style=display:flex><span>0x7100000|+0x0000: 0x21bd1f6bf4090a3a     ← $rsp
</span></span><span style=display:flex><span>0x7100008|+0x0008: 0xfd382fd2ccd74eca
</span></span><span style=display:flex><span>0x7100010|+0x0010: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100018|+0x0018: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100020|+0x0020: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100028|+0x0028: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100030|+0x0030: 0x0000000000000000
</span></span><span style=display:flex><span>0x7100038|+0x0038: 0x0000000000000000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── Result ──────────────────────────────────────────────────────
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $eax <span style=color:#f92672>=</span> 0x21bd1f6b
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $ebx <span style=color:#f92672>=</span> 0xccd74eca
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>O<span style=color:#f92672>]</span> $ecx <span style=color:#f92672>=</span> 0x335d3b28
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> CORRECT :<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>──── Your Flag ───────────────────────────────────────────────────
</span></span><span style=display:flex><span>Congrats! You passed all challenges! Here is your flag:  FLAG<span style=color:#f92672>{</span>c0d1Ng_1n_a5s3mB1y_i5_sO_fun!<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>:::</p><p>Flag: <code>FLAG{c0d1Ng_1n_a5s3mB1y_i5_sO_fun!}</code></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#source-code>Source code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li></ul></nav></div></aside></main></body></html>