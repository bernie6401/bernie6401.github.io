<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  Simple Reverse - 0x15(2023 HW - crackme_vectorization)
  #


  Source Code
  #

:::spoiler IDA Main Function
__int64 __fastcall main(int a1, char **a2, char **a3)
{
  // [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-"+" TO EXPAND]

  __isoc99_scanf("%d", &amp;user_input_len);        // 長度為49
  user_input_len_cp = user_input_len;
  sqrt_length = sqrt((double)user_input_len);   // 開根號後是7
  sqrt_length_cp = (int)sqrt_length;
  if ( sqrt_length > (double)(int)sqrt_length )
    ++sqrt_length_cp;
  sqrt_len = _mm_shuffle_epi32(_mm_cvtsi32_si128(sqrt_length_cp), 224).m128i_u64[0];// 原本的shuffle num就是user input length的開根號結果
  space = (struc_1 *)malloc(0x10uLL);
  space->sqrt_len = sqrt_len;
  size = 4 * sqrt_length_cp * (__int64)sqrt_length_cp;// size是196
  shuffle_space = malloc(size);
  space->content_space = (__int64)shuffle_space;
  if ( user_input_len_cp > 0 )
  {
    shuffle_space_cp = shuffle_space;
    len = 0LL;
    do
    {
      __isoc99_scanf("%d", content);
      shuffle_space_cp[len++] = content[0];
    }
    while ( user_input_len > (int)len );        // 要輸入東西49次
  }
  if ( length == sqrt_length_cp
    && (space_1 = (struc_1 *)malloc(0x10uLL),
        space_1->sqrt_len = sqrt_len,
        shuffle_space_1 = malloc(size),
        src = cipher_flag,
        space_1->content_space = (__int64)shuffle_space_1,
        memcpy(shuffle_space_1, src, size),
        result = ugly_matrix_multiplication(
                   (int *)space_1,
                   (__int64)space),             // guess_cipher的大小是196
                                                // 他會把我們輸入的東西和他原本的東西一起送到guess_encrypt的這個function中
        !memcmp((const void *)result[1], verify_key, size)) )
  {
    puts("Correct!");
  }
  else
  {
    puts(":(");
  }
  return 0LL;
}
:::
:::spoiler IDA Ugly Function'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/security/course/ntu-cs/reverse/simple-reverse---0x152023-hw---crackme_vectorization/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Simple Reverse - 0x15(2023 HW - crackme_vectorization)"><meta property="og:description" content='Simple Reverse - 0x15(2023 HW - crackme_vectorization) # Source Code # :::spoiler IDA Main Function
__int64 __fastcall main(int a1, char **a2, char **a3) { // [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-"+" TO EXPAND] __isoc99_scanf("%d", &amp;user_input_len); // 長度為49 user_input_len_cp = user_input_len; sqrt_length = sqrt((double)user_input_len); // 開根號後是7 sqrt_length_cp = (int)sqrt_length; if ( sqrt_length > (double)(int)sqrt_length ) ++sqrt_length_cp; sqrt_len = _mm_shuffle_epi32(_mm_cvtsi32_si128(sqrt_length_cp), 224).m128i_u64[0];// 原本的shuffle num就是user input length的開根號結果 space = (struc_1 *)malloc(0x10uLL); space->sqrt_len = sqrt_len; size = 4 * sqrt_length_cp * (__int64)sqrt_length_cp;// size是196 shuffle_space = malloc(size); space->content_space = (__int64)shuffle_space; if ( user_input_len_cp > 0 ) { shuffle_space_cp = shuffle_space; len = 0LL; do { __isoc99_scanf("%d", content); shuffle_space_cp[len++] = content[0]; } while ( user_input_len > (int)len ); // 要輸入東西49次 } if ( length == sqrt_length_cp && (space_1 = (struc_1 *)malloc(0x10uLL), space_1->sqrt_len = sqrt_len, shuffle_space_1 = malloc(size), src = cipher_flag, space_1->content_space = (__int64)shuffle_space_1, memcpy(shuffle_space_1, src, size), result = ugly_matrix_multiplication( (int *)space_1, (__int64)space), // guess_cipher的大小是196 // 他會把我們輸入的東西和他原本的東西一起送到guess_encrypt的這個function中 !memcmp((const void *)result[1], verify_key, size)) ) { puts("Correct!"); } else { puts(":("); } return 0LL; } ::: :::spoiler IDA Ugly Function'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="security"><meta property="article:tag" content="Eductf"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Reverse"><title>Simple Reverse - 0x15(2023 HW - crackme_vectorization) | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/security/course/ntu-cs/reverse/simple-reverse---0x152023-hw---crackme_vectorization/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Simple Reverse - 0x15(2023 HW - crackme_vectorization)</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#source-code>Source Code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=simple-reverse---0x152023-hw---crackme_vectorization>Simple Reverse - 0x15(2023 HW - crackme_vectorization)
<a class=anchor href=#simple-reverse---0x152023-hw---crackme_vectorization>#</a></h1><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Main Function</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>__int64</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> a1, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>a2, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>a3)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#75715e>// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-&#34;+&#34; TO EXPAND]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  __isoc99_scanf(<span style=color:#e6db74>&#34;%d&#34;</span>, <span style=color:#f92672>&amp;</span>user_input_len);        <span style=color:#75715e>// 長度為49
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  user_input_len_cp <span style=color:#f92672>=</span> user_input_len;
</span></span><span style=display:flex><span>  sqrt_length <span style=color:#f92672>=</span> sqrt((<span style=color:#66d9ef>double</span>)user_input_len);   <span style=color:#75715e>// 開根號後是7
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  sqrt_length_cp <span style=color:#f92672>=</span> (<span style=color:#66d9ef>int</span>)sqrt_length;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( sqrt_length <span style=color:#f92672>&gt;</span> (<span style=color:#66d9ef>double</span>)(<span style=color:#66d9ef>int</span>)sqrt_length )
</span></span><span style=display:flex><span>    <span style=color:#f92672>++</span>sqrt_length_cp;
</span></span><span style=display:flex><span>  sqrt_len <span style=color:#f92672>=</span> _mm_shuffle_epi32(_mm_cvtsi32_si128(sqrt_length_cp), <span style=color:#ae81ff>224</span>).m128i_u64[<span style=color:#ae81ff>0</span>];<span style=color:#75715e>// 原本的shuffle num就是user input length的開根號結果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  space <span style=color:#f92672>=</span> (struc_1 <span style=color:#f92672>*</span>)malloc(<span style=color:#ae81ff>0x10uLL</span>);
</span></span><span style=display:flex><span>  space<span style=color:#f92672>-&gt;</span>sqrt_len <span style=color:#f92672>=</span> sqrt_len;
</span></span><span style=display:flex><span>  size <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> sqrt_length_cp <span style=color:#f92672>*</span> (<span style=color:#66d9ef>__int64</span>)sqrt_length_cp;<span style=color:#75715e>// size是196
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  shuffle_space <span style=color:#f92672>=</span> malloc(size);
</span></span><span style=display:flex><span>  space<span style=color:#f92672>-&gt;</span>content_space <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__int64</span>)shuffle_space;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( user_input_len_cp <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    shuffle_space_cp <span style=color:#f92672>=</span> shuffle_space;
</span></span><span style=display:flex><span>    len <span style=color:#f92672>=</span> <span style=color:#ae81ff>0LL</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      __isoc99_scanf(<span style=color:#e6db74>&#34;%d&#34;</span>, content);
</span></span><span style=display:flex><span>      shuffle_space_cp[len<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> content[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> ( user_input_len <span style=color:#f92672>&gt;</span> (<span style=color:#66d9ef>int</span>)len );        <span style=color:#75715e>// 要輸入東西49次
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( length <span style=color:#f92672>==</span> sqrt_length_cp
</span></span><span style=display:flex><span>    <span style=color:#f92672>&amp;&amp;</span> (space_1 <span style=color:#f92672>=</span> (struc_1 <span style=color:#f92672>*</span>)malloc(<span style=color:#ae81ff>0x10uLL</span>),
</span></span><span style=display:flex><span>        space_1<span style=color:#f92672>-&gt;</span>sqrt_len <span style=color:#f92672>=</span> sqrt_len,
</span></span><span style=display:flex><span>        shuffle_space_1 <span style=color:#f92672>=</span> malloc(size),
</span></span><span style=display:flex><span>        src <span style=color:#f92672>=</span> cipher_flag,
</span></span><span style=display:flex><span>        space_1<span style=color:#f92672>-&gt;</span>content_space <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__int64</span>)shuffle_space_1,
</span></span><span style=display:flex><span>        memcpy(shuffle_space_1, src, size),
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> ugly_matrix_multiplication(
</span></span><span style=display:flex><span>                   (<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>)space_1,
</span></span><span style=display:flex><span>                   (<span style=color:#66d9ef>__int64</span>)space),             <span style=color:#75715e>// guess_cipher的大小是196
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                                <span style=color:#75715e>// 他會把我們輸入的東西和他原本的東西一起送到guess_encrypt的這個function中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>!</span>memcmp((<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>)result[<span style=color:#ae81ff>1</span>], verify_key, size)) )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;Correct!&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;:(&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0LL</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::
:::spoiler IDA Ugly Function</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>_QWORD <span style=color:#f92672>*</span><span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>guess_encrypt</span>(<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>space_1, <span style=color:#66d9ef>__int64</span> space)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#75715e>// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-&#34;+&#34; TO EXPAND]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  _RAX <span style=color:#f92672>=</span> malloc(<span style=color:#ae81ff>0x10uLL</span>);
</span></span><span style=display:flex><span>  _RDI <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>space_1;
</span></span><span style=display:flex><span>  guess_cipher <span style=color:#f92672>=</span> _RAX;
</span></span><span style=display:flex><span>  length_0x4 <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>(<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>)(space <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>__asm</span> { vmovd   xmm5, edi }
</span></span><span style=display:flex><span>  length_0x0 <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>space_1;
</span></span><span style=display:flex><span>  _RBX <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> length_0x4;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>__asm</span> { vpinsrd xmm0, xmm5, r13d, <span style=color:#ae81ff>1</span> }
</span></span><span style=display:flex><span>  length_0x4_cp <span style=color:#f92672>=</span> length_0x4;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>__asm</span> { vmovq   qword ptr [rax], xmm0 }
</span></span><span style=display:flex><span>  space_2 <span style=color:#f92672>=</span> malloc(<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> length_0x4 <span style=color:#f92672>*</span> _RDI);
</span></span><span style=display:flex><span>  guess_cipher[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> space_2;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( length_0x0 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    length_0x4_cp2 <span style=color:#f92672>=</span> length_0x4;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( (<span style=color:#66d9ef>int</span>)length_0x4 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      length_0x0_2 <span style=color:#f92672>=</span> space_1[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>      length_0x0_cp <span style=color:#f92672>=</span> length_0x0;
</span></span><span style=display:flex><span>      guess_cipher_1 <span style=color:#f92672>=</span> guess_cipher;
</span></span><span style=display:flex><span>      length_16_0x4 <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span> <span style=color:#f92672>*</span> length_0x4;
</span></span><span style=display:flex><span>      space_2_cp <span style=color:#f92672>=</span> space_2;
</span></span><span style=display:flex><span>      length_0x0_2_minus_1 <span style=color:#f92672>=</span> length_0x0_2 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      space_1_cp <span style=color:#f92672>=</span> space_1;
</span></span><span style=display:flex><span>      length_0x0_2_x_4 <span style=color:#f92672>=</span> <span style=color:#ae81ff>16LL</span> <span style=color:#f92672>*</span> ((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)length_0x0_2 <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>      v14 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> ( <span style=color:#ae81ff>1</span> )
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        v15 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0LL</span>;
</span></span><span style=display:flex><span>        v16 <span style=color:#f92672>=</span> length_0x0_2 <span style=color:#f92672>*</span> v14;
</span></span><span style=display:flex><span>        v87 <span style=color:#f92672>=</span> <span style=color:#ae81ff>4LL</span> <span style=color:#f92672>*</span> length_0x0_2 <span style=color:#f92672>*</span> v14;
</span></span><span style=display:flex><span>        cmd <span style=color:#f92672>=</span> length_0x4_cp <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>7</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( (length_0x4_cp <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>7</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>goto</span> LABEL_44;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>switch</span> ( cmd )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>1LL</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_42;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>2LL</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_40;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>3LL</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_38;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>4LL</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_36;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>5LL</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_34;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( cmd <span style=color:#f92672>!=</span> <span style=color:#ae81ff>6</span> )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_12;
</span></span><span style=display:flex><span>          v15 <span style=color:#f92672>=</span> <span style=color:#ae81ff>1LL</span>;
</span></span><span style=display:flex><span>          <span style=color:#f92672>*</span>space_2_cp <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>LABEL_12:
</span></span><span style=display:flex><span>        v92 <span style=color:#f92672>=</span> v14;
</span></span><span style=display:flex><span>        v18 <span style=color:#f92672>=</span> v15;
</span></span><span style=display:flex><span>        v19 <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>((_QWORD <span style=color:#f92672>*</span>)space_1_cp <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        v20 <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>(_QWORD <span style=color:#f92672>*</span>)(space <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( length_0x0_2_minus_1 <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>2</span> )
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>goto</span> LABEL_26;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> ( <span style=color:#ae81ff>1</span> )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          _R15 <span style=color:#f92672>=</span> v20 <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> v15;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>__asm</span> { vpxor   xmm0, xmm0, xmm0 }
</span></span><span style=display:flex><span>          v23 <span style=color:#f92672>=</span> v19 <span style=color:#f92672>+</span> v87;
</span></span><span style=display:flex><span>          v24 <span style=color:#f92672>=</span> length_0x0_2_x_4 <span style=color:#f92672>+</span> v19 <span style=color:#f92672>+</span> v87;
</span></span><span style=display:flex><span>          v25 <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int8</span>)((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span>)(length_0x0_2_x_4 <span style=color:#f92672>-</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> ( (((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int8</span>)((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span>)(length_0x0_2_x_4 <span style=color:#f92672>-</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>3</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_51;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> ( v25 <span style=color:#f92672>!=</span> <span style=color:#ae81ff>1</span> )
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> ( v25 <span style=color:#f92672>!=</span> <span style=color:#ae81ff>2</span> )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vmovd   xmm3, dword ptr [r15<span style=color:#f92672>+</span>rbx<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>                vmovd   xmm4, dword ptr [r15]
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              v23 <span style=color:#f92672>+=</span> <span style=color:#ae81ff>16LL</span>;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vpinsrd xmm2, xmm3, dword ptr [r15<span style=color:#f92672>+</span>r8], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                vpinsrd xmm1, xmm4, dword ptr [r15<span style=color:#f92672>+</span>rbx], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              _R15 <span style=color:#f92672>+=</span> length_16_0x4;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vpunpcklqdq xmm6, xmm1, xmm2
</span></span><span style=display:flex><span>                vpmulld xmm0, xmm6, xmmword ptr [rdx<span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>h]
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              vmovd   xmm7, dword ptr [r15<span style=color:#f92672>+</span>rbx<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>              vmovd   xmm9, dword ptr [r15]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            v23 <span style=color:#f92672>+=</span> <span style=color:#ae81ff>16LL</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              vpinsrd xmm8, xmm7, dword ptr [r15<span style=color:#f92672>+</span>r8], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              vpinsrd xmm10, xmm9, dword ptr [r15<span style=color:#f92672>+</span>rbx], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            _R15 <span style=color:#f92672>+=</span> length_16_0x4;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              vpunpcklqdq xmm11, xmm10, xmm8
</span></span><span style=display:flex><span>              vpmulld xmm12, xmm11, xmmword ptr [rdx<span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>h]
</span></span><span style=display:flex><span>              vpaddd  xmm0, xmm0, xmm12
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            vmovd   xmm13, dword ptr [r15<span style=color:#f92672>+</span>rbx<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>            vmovd   xmm15, dword ptr [r15]
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          v23 <span style=color:#f92672>+=</span> <span style=color:#ae81ff>16LL</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            vpinsrd xmm14, xmm13, dword ptr [r15<span style=color:#f92672>+</span>r8], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            vpinsrd xmm5, xmm15, dword ptr [r15<span style=color:#f92672>+</span>rbx], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          _R15 <span style=color:#f92672>+=</span> length_16_0x4;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            vpunpcklqdq xmm3, xmm5, xmm14
</span></span><span style=display:flex><span>            vpmulld xmm2, xmm3, xmmword ptr [rdx<span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>h]
</span></span><span style=display:flex><span>            vpaddd  xmm0, xmm0, xmm2
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> ( v24 <span style=color:#f92672>!=</span> v23 )
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>LABEL_51:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vmovd   xmm4, dword ptr [r15<span style=color:#f92672>+</span>rbx<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>                vmovd   xmm6, dword ptr [r15]
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              v23 <span style=color:#f92672>+=</span> <span style=color:#ae81ff>64LL</span>;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vpinsrd xmm1, xmm4, dword ptr [r15<span style=color:#f92672>+</span>r8], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                vpinsrd xmm7, xmm6, dword ptr [r15<span style=color:#f92672>+</span>rbx], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              _R15 <span style=color:#f92672>=</span> length_16_0x4 <span style=color:#f92672>+</span> _R15;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vmovd   xmm11, dword ptr [r15<span style=color:#f92672>+</span>rbx<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>                vmovd   xmm13, dword ptr [r15]
</span></span><span style=display:flex><span>                vpinsrd xmm12, xmm11, dword ptr [r15<span style=color:#f92672>+</span>r8], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                vpinsrd xmm14, xmm13, dword ptr [r15<span style=color:#f92672>+</span>rbx], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              _R15 <span style=color:#f92672>=</span> length_16_0x4 <span style=color:#f92672>+</span> _R15;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vpunpcklqdq xmm8, xmm7, xmm1
</span></span><span style=display:flex><span>                vmovd   xmm3, dword ptr [r15<span style=color:#f92672>+</span>rbx<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>                vpmulld xmm9, xmm8, xmmword ptr [rdx<span style=color:#f92672>-</span><span style=color:#ae81ff>40</span>h]
</span></span><span style=display:flex><span>                vpinsrd xmm4, xmm3, dword ptr [r15<span style=color:#f92672>+</span>r8], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                vpaddd  xmm10, xmm0, xmm9
</span></span><span style=display:flex><span>                vmovd   xmm2, dword ptr [r15]
</span></span><span style=display:flex><span>                vpinsrd xmm1, xmm2, dword ptr [r15<span style=color:#f92672>+</span>rbx], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              _R15 <span style=color:#f92672>=</span> length_16_0x4 <span style=color:#f92672>+</span> _R15;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vpunpcklqdq xmm15, xmm14, xmm12
</span></span><span style=display:flex><span>                vmovd   xmm9, dword ptr [r15<span style=color:#f92672>+</span>rbx<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>                vmovd   xmm11, dword ptr [r15]
</span></span><span style=display:flex><span>                vpmulld xmm5, xmm15, xmmword ptr [rdx<span style=color:#f92672>-</span><span style=color:#ae81ff>30</span>h]
</span></span><span style=display:flex><span>                vpinsrd xmm12, xmm11, dword ptr [r15<span style=color:#f92672>+</span>rbx], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                vpaddd  xmm0, xmm10, xmm5
</span></span><span style=display:flex><span>                vpunpcklqdq xmm6, xmm1, xmm4
</span></span><span style=display:flex><span>                vpmulld xmm7, xmm6, xmmword ptr [rdx<span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>h]
</span></span><span style=display:flex><span>                vpinsrd xmm10, xmm9, dword ptr [r15<span style=color:#f92672>+</span>r8], <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                vpaddd  xmm8, xmm0, xmm7
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              _R15 <span style=color:#f92672>=</span> length_16_0x4 <span style=color:#f92672>+</span> _R15;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                vpunpcklqdq xmm13, xmm12, xmm10
</span></span><span style=display:flex><span>                vpmulld xmm14, xmm13, xmmword ptr [rdx<span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>h]
</span></span><span style=display:flex><span>                vpaddd  xmm0, xmm8, xmm14
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> ( v24 <span style=color:#f92672>!=</span> v23 );
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            vpsrldq xmm15, xmm0, <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>            vpaddd  xmm5, xmm0, xmm15
</span></span><span style=display:flex><span>            vpsrldq xmm0, xmm5, <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          v75 <span style=color:#f92672>=</span> length_0x0_2 <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFC</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>__asm</span>
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            vpaddd  xmm3, xmm5, xmm0
</span></span><span style=display:flex><span>            vmovd   ecx, xmm3
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>!=</span> (length_0x0_2 <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFC</span>) )
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_21;
</span></span><span style=display:flex><span>LABEL_24:
</span></span><span style=display:flex><span>          space_2_cp[v15<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> _ECX;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> ( length_0x4_cp <span style=color:#f92672>==</span> v15 )
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>          v18 <span style=color:#f92672>=</span> v15;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> ( length_0x0_2_minus_1 <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>2</span> )
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>LABEL_26:
</span></span><span style=display:flex><span>            v75 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            _ECX <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>LABEL_21:
</span></span><span style=display:flex><span>            v78 <span style=color:#f92672>=</span> v75 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            _ECX <span style=color:#f92672>+=</span> <span style=color:#f92672>*</span>(_DWORD <span style=color:#f92672>*</span>)(v20 <span style=color:#f92672>+</span> <span style=color:#ae81ff>4LL</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>int</span>)(v75 <span style=color:#f92672>*</span> length_0x4_cp2 <span style=color:#f92672>+</span> v18))
</span></span><span style=display:flex><span>                  <span style=color:#f92672>*</span> <span style=color:#f92672>*</span>(_DWORD <span style=color:#f92672>*</span>)(v19 <span style=color:#f92672>+</span> <span style=color:#ae81ff>4LL</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>int</span>)(v16 <span style=color:#f92672>+</span> v75));
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> ( (<span style=color:#66d9ef>int</span>)(v75 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&lt;</span> length_0x0_2 )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              v79 <span style=color:#f92672>=</span> length_0x4_cp2 <span style=color:#f92672>+</span> v75 <span style=color:#f92672>*</span> length_0x4_cp2;
</span></span><span style=display:flex><span>              v80 <span style=color:#f92672>=</span> v75 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>              _ECX <span style=color:#f92672>+=</span> <span style=color:#f92672>*</span>(_DWORD <span style=color:#f92672>*</span>)(v20 <span style=color:#f92672>+</span> <span style=color:#ae81ff>4LL</span> <span style=color:#f92672>*</span> (v79 <span style=color:#f92672>+</span> v18)) <span style=color:#f92672>*</span> <span style=color:#f92672>*</span>(_DWORD <span style=color:#f92672>*</span>)(v19 <span style=color:#f92672>+</span> <span style=color:#ae81ff>4LL</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>int</span>)(v16 <span style=color:#f92672>+</span> v78));
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>&gt;</span> v80 )
</span></span><span style=display:flex><span>                _ECX <span style=color:#f92672>+=</span> <span style=color:#f92672>*</span>(_DWORD <span style=color:#f92672>*</span>)(v19 <span style=color:#f92672>+</span> <span style=color:#ae81ff>4LL</span> <span style=color:#f92672>*</span> (v16 <span style=color:#f92672>+</span> v80)) <span style=color:#f92672>*</span> <span style=color:#f92672>*</span>(_DWORD <span style=color:#f92672>*</span>)(v20 <span style=color:#f92672>+</span> <span style=color:#ae81ff>4LL</span> <span style=color:#f92672>*</span> (v18 <span style=color:#f92672>+</span> length_0x4_cp2 <span style=color:#f92672>+</span> v79));
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> LABEL_24;
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        v14 <span style=color:#f92672>=</span> v92;
</span></span><span style=display:flex><span>LABEL_28:
</span></span><span style=display:flex><span>        space_2_cp <span style=color:#f92672>=</span> (_DWORD <span style=color:#f92672>*</span>)((<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)space_2_cp <span style=color:#f92672>+</span> _RBX);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( length_0x0_cp <span style=color:#f92672>==</span> <span style=color:#f92672>++</span>v14 )
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span> guess_cipher_1;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      space_2_cp[v15<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>LABEL_34:
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>goto</span> LABEL_12;
</span></span><span style=display:flex><span>      space_2_cp[v15<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>LABEL_36:
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>goto</span> LABEL_12;
</span></span><span style=display:flex><span>      space_2_cp[v15<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>LABEL_38:
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>goto</span> LABEL_12;
</span></span><span style=display:flex><span>      space_2_cp[v15<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>LABEL_40:
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>goto</span> LABEL_12;
</span></span><span style=display:flex><span>      space_2_cp[v15<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>LABEL_42:
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( length_0x0_2 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>goto</span> LABEL_12;
</span></span><span style=display:flex><span>      space_2_cp[v15<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( length_0x4_cp <span style=color:#f92672>==</span> v15 )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>goto</span> LABEL_28;
</span></span><span style=display:flex><span>LABEL_44:
</span></span><span style=display:flex><span>      v82 <span style=color:#f92672>=</span> v15;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> ( length_0x0_2 <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        space_2_cp[v82] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        v83 <span style=color:#f92672>=</span> v82 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        space_2_cp[v83] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        space_2_cp[v83 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        space_2_cp[v83 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        space_2_cp[v83 <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        space_2_cp[v83 <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        space_2_cp[v83 <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        space_2_cp[v83 <span style=color:#f92672>+</span> <span style=color:#ae81ff>6</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        v82 <span style=color:#f92672>=</span> v83 <span style=color:#f92672>+</span> <span style=color:#ae81ff>7</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( length_0x4_cp <span style=color:#f92672>==</span> v82 )
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>goto</span> LABEL_28;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      v15 <span style=color:#f92672>=</span> v82;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>goto</span> LABEL_12;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> guess_cipher;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>一陣基本操作處理完比較好看的狀態後，首先發現一開始先輸入字串的長度(應該是49)，然後我們要輸入一些東西(就是按照前面輸入，總共也是49次)，接著就會進到很醜沒辦法解析的function(我暫時不理他)，一開始我在猜應該是做encryption之類的事情，接著就比對mem，一樣就噴correct這樣，我認為超級醜的function應該不是這次出題的重點，因為要全部逆完真的很有難度，對於學習也沒必要，此時我開始用動態+通靈的方式猜他在幹嘛，依照題目的標題和後面對比字串長度必須要等於<code>7</code>這兩個東西判斷，他應該是在做矩陣之類的操作，而那個醜不拉基的function應該是類似乘法或是加法之類的功能，有了想法就可以實驗他的操作
如果輸入長度49</p><ol><li>內容都是零，毫不意外經過醜不拉基function後都會是零
:::spoiler Result<pre tabindex=0><code>0x000055aa2b46b4b0│+0x0000: 0x0000000000000000   ← $rdi
0x000055aa2b46b4b8│+0x0008: 0x0000000000000000
0x000055aa2b46b4c0│+0x0010: 0x0000000000000000
0x000055aa2b46b4c8│+0x0018: 0x0000000000000000
0x000055aa2b46b4d0│+0x0020: 0x0000000000000000
0x000055aa2b46b4d8│+0x0028: 0x0000000000000000
0x000055aa2b46b4e0│+0x0030: 0x0000000000000000
0x000055aa2b46b4e8│+0x0038: 0x0000000000000000
0x000055aa2b46b4f0│+0x0040: 0x0000000000000000
0x000055aa2b46b4f8│+0x0048: 0x0000000000000000
0x000055aa2b46b500│+0x0050: 0x0000000000000000
0x000055aa2b46b508│+0x0058: 0x0000000000000000
0x000055aa2b46b510│+0x0060: 0x0000000000000000
0x000055aa2b46b518│+0x0068: 0x0000000000000000
0x000055aa2b46b520│+0x0070: 0x0000000000000000
0x000055aa2b46b528│+0x0078: 0x0000000000000000
0x000055aa2b46b530│+0x0080: 0x0000000000000000
0x000055aa2b46b538│+0x0088: 0x0000000000000000
0x000055aa2b46b540│+0x0090: 0x0000000000000000
0x000055aa2b46b548│+0x0098: 0x0000000000000000
0x000055aa2b46b550│+0x00a0: 0x0000000000000000
0x000055aa2b46b558│+0x00a8: 0x0000000000000000
0x000055aa2b46b560│+0x00b0: 0x0000000000000000
0x000055aa2b46b568│+0x00b8: 0x0000000000000000
0x000055aa2b46b570│+0x00c0: 0x0000000000000000
</code></pre>:::</li><li>內容都是一，經過醜不拉基function後都會每七個都是同一個數字
:::spoiler Result<pre tabindex=0><code>0x000055d2f80754b0│+0x0000: 0x000003d4000003d4   ← $rdi
0x000055d2f80754b8│+0x0008: 0x000003d4000003d4
0x000055d2f80754c0│+0x0010: 0x000003d4000003d4
0x000055d2f80754c8│+0x0018: 0x000002d8000003d4
0x000055d2f80754d0│+0x0020: 0x000002d8000002d8
0x000055d2f80754d8│+0x0028: 0x000002d8000002d8
0x000055d2f80754e0│+0x0030: 0x000002d8000002d8
0x000055d2f80754e8│+0x0038: 0x0000030f0000030f
0x000055d2f80754f0│+0x0040: 0x0000030f0000030f
0x000055d2f80754f8│+0x0048: 0x0000030f0000030f
0x000055d2f8075500│+0x0050: 0x000003000000030f
0x000055d2f8075508│+0x0058: 0x0000030000000300
0x000055d2f8075510│+0x0060: 0x0000030000000300
0x000055d2f8075518│+0x0068: 0x0000030000000300
0x000055d2f8075520│+0x0070: 0x000003b0000003b0
0x000055d2f8075528│+0x0078: 0x000003b0000003b0
0x000055d2f8075530│+0x0080: 0x000003b0000003b0
0x000055d2f8075538│+0x0088: 0x000003c6000003b0
0x000055d2f8075540│+0x0090: 0x000003c6000003c6
0x000055d2f8075548│+0x0098: 0x000003c6000003c6
0x000055d2f8075550│+0x00a0: 0x000003c6000003c6
0x000055d2f8075558│+0x00a8: 0x0000031e0000031e
0x000055d2f8075560│+0x00b0: 0x0000031e0000031e
0x000055d2f8075568│+0x00b8: 0x0000031e0000031e
0x000055d2f8075570│+0x00c0: 0x000000000000031e
</code></pre>:::</li><li>內容都是二，和上面對比全部都會是兩倍
:::spoiler Result<pre tabindex=0><code>0x0000563c09e664b0│+0x0000: 0x000007a8000007a8   ← $rdi
0x0000563c09e664b8│+0x0008: 0x000007a8000007a8
0x0000563c09e664c0│+0x0010: 0x000007a8000007a8
0x0000563c09e664c8│+0x0018: 0x000005b0000007a8
0x0000563c09e664d0│+0x0020: 0x000005b0000005b0
0x0000563c09e664d8│+0x0028: 0x000005b0000005b0
0x0000563c09e664e0│+0x0030: 0x000005b0000005b0
0x0000563c09e664e8│+0x0038: 0x0000061e0000061e
0x0000563c09e664f0│+0x0040: 0x0000061e0000061e
0x0000563c09e664f8│+0x0048: 0x0000061e0000061e
0x0000563c09e66500│+0x0050: 0x000006000000061e
0x0000563c09e66508│+0x0058: 0x0000060000000600
0x0000563c09e66510│+0x0060: 0x0000060000000600
0x0000563c09e66518│+0x0068: 0x0000060000000600
0x0000563c09e66520│+0x0070: 0x0000076000000760
0x0000563c09e66528│+0x0078: 0x0000076000000760
0x0000563c09e66530│+0x0080: 0x0000076000000760
0x0000563c09e66538│+0x0088: 0x0000078c00000760
0x0000563c09e66540│+0x0090: 0x0000078c0000078c
0x0000563c09e66548│+0x0098: 0x0000078c0000078c
0x0000563c09e66550│+0x00a0: 0x0000078c0000078c
0x0000563c09e66558│+0x00a8: 0x0000063c0000063c
0x0000563c09e66560│+0x00b0: 0x0000063c0000063c
0x0000563c09e66568│+0x00b8: 0x0000063c0000063c
0x0000563c09e66570│+0x00c0: 0x000000000000063c
</code></pre>:::</li><li>只有第一個element是1，其他都是零，由結果可知只有七個一數的第一個element會有值，且該值是已經從儲存在原本的執行檔中，比對之後發現一模一樣
:::spoiler Result<pre tabindex=0><code>0x0000563dd53444b0│+0x0000: 0x000000000000003c (&#34;&lt;&#34;?)    ← $rdi
0x0000563dd53444b8│+0x0008: 0x0000000000000000
0x0000563dd53444c0│+0x0010: 0x0000000000000000
0x0000563dd53444c8│+0x0018: 0x0000007300000000
0x0000563dd53444d0│+0x0020: 0x0000000000000000
0x0000563dd53444d8│+0x0028: 0x0000000000000000
0x0000563dd53444e0│+0x0030: 0x0000000000000000
0x0000563dd53444e8│+0x0038: 0x000000000000007a (&#34;z&#34;?)
0x0000563dd53444f0│+0x0040: 0x0000000000000000
0x0000563dd53444f8│+0x0048: 0x0000000000000000
0x0000563dd5344500│+0x0050: 0x0000004100000000
0x0000563dd5344508│+0x0058: 0x0000000000000000
0x0000563dd5344510│+0x0060: 0x0000000000000000
0x0000563dd5344518│+0x0068: 0x0000000000000000
0x0000563dd5344520│+0x0070: 0x0000000000000067 (&#34;g&#34;?)
0x0000563dd5344528│+0x0078: 0x0000000000000000
0x0000563dd5344530│+0x0080: 0x0000000000000000
0x0000563dd5344538│+0x0088: 0x0000007900000000
0x0000563dd5344540│+0x0090: 0x0000000000000000
0x0000563dd5344548│+0x0098: 0x0000000000000000
0x0000563dd5344550│+0x00a0: 0x0000000000000000
0x0000563dd5344558│+0x00a8: 0x00000000000000fa
0x0000563dd5344560│+0x00b0: 0x0000000000000000
0x0000563dd5344568│+0x00b8: 0x0000000000000000
0x0000563dd5344570│+0x00c0: 0x0000000000000000
</code></pre>:::</li></ol><p>由以上實驗可以大致確認醜不拉基function做的事情就是矩陣乘法，而我們知道他比較的乘法結果，也知道和我們輸入的矩陣相乘的乘數，換言之可以反推回我們應該輸入的東西為何</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sage.all <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> process(<span style=color:#e6db74>&#39;./simple-crackme_f5e33c76600e&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flag_len <span style=color:#f92672>=</span> <span style=color:#ae81ff>49</span>
</span></span><span style=display:flex><span>verify_matrix <span style=color:#f92672>=</span> Matrix([[<span style=color:#ae81ff>0x00010ee0</span>, <span style=color:#ae81ff>0x00010814</span>, <span style=color:#ae81ff>0x00014d06</span>, <span style=color:#ae81ff>0x00015a7c</span>, <span style=color:#ae81ff>0x00012de1</span>, <span style=color:#ae81ff>0x00014a5a</span>, <span style=color:#ae81ff>0x0000f883</span>], 
</span></span><span style=display:flex><span>                       [<span style=color:#ae81ff>0x0000df33</span>, <span style=color:#ae81ff>0x0000a7a5</span>, <span style=color:#ae81ff>0x0000e66b</span>, <span style=color:#ae81ff>0x0000e0c8</span>, <span style=color:#ae81ff>0x0000b727</span>, <span style=color:#ae81ff>0x0000eb70</span>, <span style=color:#ae81ff>0x00008d9e</span>], 
</span></span><span style=display:flex><span>                       [<span style=color:#ae81ff>0x0000fe08</span>, <span style=color:#ae81ff>0x0000d725</span>, <span style=color:#ae81ff>0x00010163</span>, <span style=color:#ae81ff>0x000101a0</span>, <span style=color:#ae81ff>0x0000c427</span>, <span style=color:#ae81ff>0x00010365</span>, <span style=color:#ae81ff>0x0000afca</span>], 
</span></span><span style=display:flex><span>                       [<span style=color:#ae81ff>0x0000db6f</span>, <span style=color:#ae81ff>0x0000dbdf</span>, <span style=color:#ae81ff>0x00010dc3</span>, <span style=color:#ae81ff>0x0000fb36</span>, <span style=color:#ae81ff>0x0000d5c3</span>, <span style=color:#ae81ff>0x00011ae8</span>, <span style=color:#ae81ff>0x0000ddc2</span>], 
</span></span><span style=display:flex><span>                       [<span style=color:#ae81ff>0x00011589</span>, <span style=color:#ae81ff>0x0000fbc8</span>, <span style=color:#ae81ff>0x00014000</span>, <span style=color:#ae81ff>0x00011f7f</span>, <span style=color:#ae81ff>0x0001019d</span>, <span style=color:#ae81ff>0x0001567c</span>, <span style=color:#ae81ff>0x0000f435</span>], 
</span></span><span style=display:flex><span>                       [<span style=color:#ae81ff>0x00012c8d</span>, <span style=color:#ae81ff>0x0000ff0b</span>, <span style=color:#ae81ff>0x00012caf</span>, <span style=color:#ae81ff>0x00014592</span>, <span style=color:#ae81ff>0x000112ff</span>, <span style=color:#ae81ff>0x00015e64</span>, <span style=color:#ae81ff>0x00010322</span>], 
</span></span><span style=display:flex><span>                       [<span style=color:#ae81ff>0x000109f9</span>, <span style=color:#ae81ff>0x0000f002</span>, <span style=color:#ae81ff>0x000115ee</span>, <span style=color:#ae81ff>0x0000fe74</span>, <span style=color:#ae81ff>0x0000d58e</span>, <span style=color:#ae81ff>0x00011306</span>, <span style=color:#ae81ff>0x0000c506</span>]])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ct <span style=color:#f92672>=</span> Matrix([[<span style=color:#ae81ff>0x3C</span>, <span style=color:#ae81ff>0xAD</span>, <span style=color:#ae81ff>0xB9</span>, <span style=color:#ae81ff>0xF5</span>, <span style=color:#ae81ff>0x84</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x94</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#ae81ff>0x73</span>, <span style=color:#ae81ff>0xC8</span>, <span style=color:#ae81ff>0x4E</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0xAF</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x9B</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#ae81ff>0x7A</span>, <span style=color:#ae81ff>0xC8</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x6D</span>, <span style=color:#ae81ff>0x0A</span>, <span style=color:#ae81ff>0x7F</span>, <span style=color:#ae81ff>0xA4</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x8E</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0xE1</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x73</span>, <span style=color:#ae81ff>0x37</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#ae81ff>0x67</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0x60</span>, <span style=color:#ae81ff>0x7F</span>, <span style=color:#ae81ff>0xE9</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x6E</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#ae81ff>0x79</span>, <span style=color:#ae81ff>0xBA</span>, <span style=color:#ae81ff>0xEE</span>, <span style=color:#ae81ff>0x09</span>, <span style=color:#ae81ff>0xC1</span>, <span style=color:#ae81ff>0xD0</span>, <span style=color:#ae81ff>0x0B</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#ae81ff>0xFA</span>, <span style=color:#ae81ff>0xAD</span>, <span style=color:#ae81ff>0x46</span>, <span style=color:#ae81ff>0x64</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x59</span>, <span style=color:#ae81ff>0x64</span>]])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># flag = [102, 103, 112, 53, 70, 100, 72, 88, 47, 55, 122, 50, 69, 49, 66, 67, 74, 120, 118, 80, 68, 53, 99, 114, 102, 101, 100, 105, 57, 49, 89, 52, 68, 107, 71, 97, 83, 79, 68, 48, 113, 85, 79, 48, 86, 53, 48, 61, 0]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> (verify_matrix<span style=color:#f92672>.</span>transpose() <span style=color:#f92672>/</span> ct<span style=color:#f92672>.</span>transpose())<span style=color:#f92672>.</span>transpose()<span style=color:#f92672>.</span>coefficients()
</span></span><span style=display:flex><span>print(flag)
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(str(flag_len)<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(flag)):
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendline(str(flag[i])<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;0&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>decode() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Correct!&#34;</span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Password = &#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join([chr(i) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> flag]))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python exp.py
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Starting local process <span style=color:#e6db74>&#39;./simple-crackme_f5e33c76600e&#39;</span>: pid <span style=color:#ae81ff>12091</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>102, 103, 112, 53, 70, 100, 72, 88, 47, 55, 122, 50, 69, 49, 66, 67, 74, 120, 118, 80, 68, 53, 99, 114, 102, 101, 100, 105, 57, 49, 89, 52, 68, 107, 71, 97, 83, 79, 68, 48, 113, 85, 79, 48, 86, 53, 48, 61<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Stopped process <span style=color:#e6db74>&#39;./simple-crackme_f5e33c76600e&#39;</span> <span style=color:#f92672>(</span>pid 12091<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Password <span style=color:#f92672>=</span> fgp5FdHX/7z2E1BCJxvPD5crfedi91Y4DkGaSOD0qUO0V50<span style=color:#f92672>=</span>
</span></span></code></pre></div><p>最後只要把解出來的東西丟回去revguard就可以拿到真正的flag了
<img src=https://hackmd.io/_uploads/Sy6cmC1Xa.png alt=圖片.png></p><p>Flag: <code>FLAG{yOu_kn0w_hOw_to_r3v3r53_4_m47riX!}</code></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#source-code>Source Code</a></li><li><a href=#recon>Recon</a></li><li><a href=#exploit>Exploit</a></li></ul></nav></div></aside></main></body></html>