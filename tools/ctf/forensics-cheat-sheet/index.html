<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  Forensics Cheat Sheet
  #


  Windows
  #


  Where
  #


SOFTWARE: root/Windows/System32/config/SOFTWARE
SYSTEM: root/Windows/System32/config/SYSTEM
NTUSER.DAT: root/Users/{username}/NTUSER.DAT
$MFT: root/$MFT


  SOFTWARE Information
  #


原本電腦OS的基本資訊(Build Number/Product Name/):
SOFTWARE/Microsoft/Windows NT/CurrentVersion
檢查SID:
SOFTWARE/Microsoft/Windows NT/CurrentVersion/ProfileList
查看登入:
SOFTWARE/Microsoft/Windows NT/CurrentVersion/Winlogon
StartUp Run:
SOFTWARE/Microsoft/Windows/CurrentVersion/Run


  NTUSER.DAT(每個使用者都不一樣)
  #


UserAssit:
root/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/UserAssist
Recent Docs:
root/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/RecentDocs


  System Information
  #


電腦名稱:
SYSTEM/ControlSet001/Control/ComputerName/ComputerName
電腦IP/DHCP相關資訊:
SYSTEM/ControlSet001/Services/Tcpip/Parameters/Interfaces/
時區:
SYSTEM/ControlSet001/Control/TimeZoneInformation
USB資訊:
SYSTEM/ControlSet001/Enum/USBSTOR/
CPU架構:
SYSTEM/ControlSet001/Control/Session Manager/Environment/


  Database
  #


Chrome History:
./Users/{username}/AppData/Local/Google/Chrome/User Data/Default/History
Firefox History:
./Users/{username}/AppData/Roaming/Mozilla/Firefox/Profiles/{random}.default-release/places.sqlite
Skype Chat History:
./Users/{username}/AppData/Roaming/Skype/{account name}


  Taskbar
  #


./Users/{username}/AppData/Roaming/Microsoft/Internet Explorer/Quick Launch/User Pinned/TaskBar


  mac-OS
  #


  plist
  #

$ sudo apt install libplist-utils -y
$ plistutil -i {plist file} -o {output file}

System Version:
./root/System/Library/CoreServices/SystemVersion.plist
Browser Bookmark
./root/Users/{username}/Library/Safari/Bookmarks.plist
Password information
./root/private/var/db/dslocal/nodes/Default/users/{username}.plist
The process responsible for connecting iPhones/iPads with MacOS is lockdown
./root/private/var/db/dslocal/nodes/Default/users/_usbmux.plist
Spotlight(這個不需要透過plistutil就可以直接cat)
./root/Users/{username}/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts


  Event Log
  #


短期檔案系統變更儲存在.fseventsd中，必須使用mac_apt這個工具幫忙parse(FSEVENTS)
./root/.fseventsd/
ScreenTime: 一樣要透過mac_apt幫忙parse(SCREENTIME)，記得要把RMAdminStore-Local.sqlite-wal這個檔案和RMAdminStore-Local.sqlite放在一起執行
./root/private/var/folders/bf/{random strings}/0/com.apple.ScreenTimeAgent/Store/RMAdminStore-Local.sqlite


  Database
  #


Note
./root/Users/{username}/Library/Group Containers/group.com.apple.notes
Quarantined Events
./root/Users/{username}/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2
Messages
./root/Users/{username}/Library/Messages/chat.db


  Volatilitys
  #


主要的CheatSheet
ldrmodules: 更進階的dlllist，可以顯示被隱藏的dll，以及dll的狀態
$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} ldrmodules --pid {pid}
如果要dump被injected過的process:
$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} malfind --pid {pid} --dump-dir={output folder}
dump hash
$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} hashdump > ntlm.hash
如果是要找到某個東西的timestamp，可以考慮直接用timeliner這個plubin，主要的功能是就是建立記憶體中的各種痕跡資訊的時間線
$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} timeliner 
查看網路連線紀錄
$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} netscan
在memory中用yarascan去search不同的pattern
$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} yarascan -Y "example strings"
console中的command紀錄
$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} consoles
查看iexplorer的紀錄
$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} iehistory
'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tools/ctf/forensics-cheat-sheet/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Forensics Cheat Sheet"><meta property="og:description" content='Forensics Cheat Sheet # Windows # Where # SOFTWARE: root/Windows/System32/config/SOFTWARE SYSTEM: root/Windows/System32/config/SYSTEM NTUSER.DAT: root/Users/{username}/NTUSER.DAT $MFT: root/$MFT SOFTWARE Information # 原本電腦OS的基本資訊(Build Number/Product Name/): SOFTWARE/Microsoft/Windows NT/CurrentVersion 檢查SID: SOFTWARE/Microsoft/Windows NT/CurrentVersion/ProfileList 查看登入: SOFTWARE/Microsoft/Windows NT/CurrentVersion/Winlogon StartUp Run: SOFTWARE/Microsoft/Windows/CurrentVersion/Run NTUSER.DAT(每個使用者都不一樣) # UserAssit: root/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/UserAssist Recent Docs: root/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/RecentDocs System Information # 電腦名稱: SYSTEM/ControlSet001/Control/ComputerName/ComputerName 電腦IP/DHCP相關資訊: SYSTEM/ControlSet001/Services/Tcpip/Parameters/Interfaces/ 時區: SYSTEM/ControlSet001/Control/TimeZoneInformation USB資訊: SYSTEM/ControlSet001/Enum/USBSTOR/ CPU架構: SYSTEM/ControlSet001/Control/Session Manager/Environment/ Database # Chrome History: ./Users/{username}/AppData/Local/Google/Chrome/User Data/Default/History Firefox History: ./Users/{username}/AppData/Roaming/Mozilla/Firefox/Profiles/{random}.default-release/places.sqlite Skype Chat History: ./Users/{username}/AppData/Roaming/Skype/{account name} Taskbar # ./Users/{username}/AppData/Roaming/Microsoft/Internet Explorer/Quick Launch/User Pinned/TaskBar mac-OS # plist # $ sudo apt install libplist-utils -y $ plistutil -i {plist file} -o {output file} System Version: ./root/System/Library/CoreServices/SystemVersion.plist Browser Bookmark ./root/Users/{username}/Library/Safari/Bookmarks.plist Password information ./root/private/var/db/dslocal/nodes/Default/users/{username}.plist The process responsible for connecting iPhones/iPads with MacOS is lockdown ./root/private/var/db/dslocal/nodes/Default/users/_usbmux.plist Spotlight(這個不需要透過plistutil就可以直接cat) ./root/Users/{username}/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts Event Log # 短期檔案系統變更儲存在.fseventsd中，必須使用mac_apt這個工具幫忙parse(FSEVENTS) ./root/.fseventsd/ ScreenTime: 一樣要透過mac_apt幫忙parse(SCREENTIME)，記得要把RMAdminStore-Local.sqlite-wal這個檔案和RMAdminStore-Local.sqlite放在一起執行 ./root/private/var/folders/bf/{random strings}/0/com.apple.ScreenTimeAgent/Store/RMAdminStore-Local.sqlite Database # Note ./root/Users/{username}/Library/Group Containers/group.com.apple.notes Quarantined Events ./root/Users/{username}/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2 Messages ./root/Users/{username}/Library/Messages/chat.db Volatilitys # 主要的CheatSheet ldrmodules: 更進階的dlllist，可以顯示被隱藏的dll，以及dll的狀態 $ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} ldrmodules --pid {pid} 如果要dump被injected過的process: $ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} malfind --pid {pid} --dump-dir={output folder} dump hash $ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} hashdump > ntlm.hash 如果是要找到某個東西的timestamp，可以考慮直接用timeliner這個plubin，主要的功能是就是建立記憶體中的各種痕跡資訊的時間線 $ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} timeliner 查看網路連線紀錄 $ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} netscan 在memory中用yarascan去search不同的pattern $ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} yarascan -Y "example strings" console中的command紀錄 $ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} consoles 查看iexplorer的紀錄 $ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} iehistory'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="tools"><meta property="article:tag" content="Forensics"><meta property="article:tag" content="Tools"><meta property="article:tag" content="CTF"><title>Forensics Cheat Sheet | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tools/ctf/forensics-cheat-sheet/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Forensics Cheat Sheet</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#windows>Windows</a><ul><li><a href=#where>Where</a></li><li><a href=#software-information>SOFTWARE Information</a></li><li><a href=#system-information>System Information</a></li><li><a href=#database>Database</a></li><li><a href=#taskbar>Taskbar</a></li></ul></li><li><a href=#mac-os>mac-OS</a><ul><li><a href=#plist>plist</a></li><li><a href=#event-log>Event Log</a></li><li><a href=#database-1>Database</a></li></ul></li><li><a href=#volatilitys>Volatilitys</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=forensics-cheat-sheet>Forensics Cheat Sheet
<a class=anchor href=#forensics-cheat-sheet>#</a></h1><h2 id=windows>Windows
<a class=anchor href=#windows>#</a></h2><h3 id=where>Where
<a class=anchor href=#where>#</a></h3><ul><li>SOFTWARE: <code>root/Windows/System32/config/SOFTWARE</code></li><li>SYSTEM: <code>root/Windows/System32/config/SYSTEM</code></li><li>NTUSER.DAT: <code>root/Users/{username}/NTUSER.DAT</code></li><li>$MFT: <code>root/$MFT</code></li></ul><h3 id=software-information>SOFTWARE Information
<a class=anchor href=#software-information>#</a></h3><ul><li>原本電腦OS的基本資訊(Build Number/Product Name/):
<code>SOFTWARE/Microsoft/Windows NT/CurrentVersion</code></li><li>檢查SID:
<code>SOFTWARE/Microsoft/Windows NT/CurrentVersion/ProfileList</code></li><li>查看登入:
<code>SOFTWARE/Microsoft/Windows NT/CurrentVersion/Winlogon</code></li><li>StartUp Run:
<code>SOFTWARE/Microsoft/Windows/CurrentVersion/Run</code></li></ul><h4 id=ntuserdat每個使用者都不一樣>NTUSER.DAT(每個使用者都不一樣)
<a class=anchor href=#ntuserdat%e6%af%8f%e5%80%8b%e4%bd%bf%e7%94%a8%e8%80%85%e9%83%bd%e4%b8%8d%e4%b8%80%e6%a8%a3>#</a></h4><ul><li>UserAssit:
<code>root/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/UserAssist</code></li><li>Recent Docs:
<code>root/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/RecentDocs</code></li></ul><h3 id=system-information>System Information
<a class=anchor href=#system-information>#</a></h3><ul><li>電腦名稱:
<code>SYSTEM/ControlSet001/Control/ComputerName/ComputerName</code></li><li>電腦IP/DHCP相關資訊:
<code>SYSTEM/ControlSet001/Services/Tcpip/Parameters/Interfaces/</code></li><li>時區:
<code>SYSTEM/ControlSet001/Control/TimeZoneInformation</code></li><li>USB資訊:
<code>SYSTEM/ControlSet001/Enum/USBSTOR/</code></li><li>CPU架構:
<code>SYSTEM/ControlSet001/Control/Session Manager/Environment/</code></li></ul><h3 id=database>Database
<a class=anchor href=#database>#</a></h3><ul><li>Chrome History:
<code>./Users/{username}/AppData/Local/Google/Chrome/User Data/Default/History</code></li><li>Firefox History:
<code>./Users/{username}/AppData/Roaming/Mozilla/Firefox/Profiles/{random}.default-release/places.sqlite</code></li><li>Skype Chat History:
<code>./Users/{username}/AppData/Roaming/Skype/{account name}</code></li></ul><h3 id=taskbar>Taskbar
<a class=anchor href=#taskbar>#</a></h3><ul><li><code>./Users/{username}/AppData/Roaming/Microsoft/Internet Explorer/Quick Launch/User Pinned/TaskBar</code></li></ul><h2 id=mac-os>mac-OS
<a class=anchor href=#mac-os>#</a></h2><h3 id=plist>plist
<a class=anchor href=#plist>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install libplist-utils -y
</span></span><span style=display:flex><span>$ plistutil -i <span style=color:#f92672>{</span>plist file<span style=color:#f92672>}</span> -o <span style=color:#f92672>{</span>output file<span style=color:#f92672>}</span>
</span></span></code></pre></div><ul><li>System Version:
<code>./root/System/Library/CoreServices/SystemVersion.plist</code></li><li>Browser Bookmark
<code>./root/Users/{username}/Library/Safari/Bookmarks.plist</code></li><li>Password information
<code>./root/private/var/db/dslocal/nodes/Default/users/{username}.plist</code></li><li>The process responsible for connecting iPhones/iPads with MacOS is lockdown
<code>./root/private/var/db/dslocal/nodes/Default/users/_usbmux.plist</code></li><li>Spotlight(這個不需要透過plistutil就可以直接cat)
<code>./root/Users/{username}/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts</code></li></ul><h3 id=event-log>Event Log
<a class=anchor href=#event-log>#</a></h3><ul><li>短期檔案系統變更儲存在<code>.fseventsd</code>中，必須使用<code>mac_apt</code>這個工具幫忙parse(FSEVENTS)
<code>./root/.fseventsd/</code></li><li>ScreenTime: 一樣要透過<code>mac_apt</code>幫忙parse(SCREENTIME)，記得要把<code>RMAdminStore-Local.sqlite-wal</code>這個檔案和<code>RMAdminStore-Local.sqlite</code>放在一起執行
<code>./root/private/var/folders/bf/{random strings}/0/com.apple.ScreenTimeAgent/Store/RMAdminStore-Local.sqlite</code></li></ul><h3 id=database-1>Database
<a class=anchor href=#database-1>#</a></h3><ul><li>Note
<code>./root/Users/{username}/Library/Group Containers/group.com.apple.notes</code></li><li>Quarantined Events
<code>./root/Users/{username}/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2</code></li><li>Messages
<code>./root/Users/{username}/Library/Messages/chat.db</code></li></ul><h2 id=volatilitys>Volatilitys
<a class=anchor href=#volatilitys>#</a></h2><ul><li><a href=https://hackmd.io/@TuX-/BymMpKd0s>主要的CheatSheet</a></li><li>ldrmodules: 更進階的dlllist，可以顯示被隱藏的dll，以及dll的狀態
<code>$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} ldrmodules --pid {pid}</code></li><li>如果要dump被injected過的process:
<code>$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} malfind --pid {pid} --dump-dir={output folder}</code></li><li>dump hash
<code>$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} hashdump > ntlm.hash</code></li><li>如果是要找到某個東西的timestamp，可以考慮直接用timeliner這個plubin，主要的功能是就是建立記憶體中的各種痕跡資訊的時間線
<code>$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} timeliner</code></li><li>查看網路連線紀錄
<code>$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} netscan</code></li><li>在memory中用yarascan去search不同的pattern
<code>$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} yarascan -Y "example strings"</code></li><li>console中的command紀錄
<code>$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} consoles</code></li><li>查看iexplorer的紀錄
<code>$ ./volatility_2.6_win64_standalone.exe -f {image name} --profile {profile name} iehistory</code></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#windows>Windows</a><ul><li><a href=#where>Where</a></li><li><a href=#software-information>SOFTWARE Information</a></li><li><a href=#system-information>System Information</a></li><li><a href=#database>Database</a></li><li><a href=#taskbar>Taskbar</a></li></ul></li><li><a href=#mac-os>mac-OS</a><ul><li><a href=#plist>plist</a></li><li><a href=#event-log>Event Log</a></li><li><a href=#database-1>Database</a></li></ul></li><li><a href=#volatilitys>Volatilitys</a></li></ul></nav></div></aside></main></body></html>