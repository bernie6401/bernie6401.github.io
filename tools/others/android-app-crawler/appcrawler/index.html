<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  AppCrawler
  #

前面踩了超多坑，所以一切都以底下最新的配置為主

  Infra
  #


Appium - 1.22.3
一定要是2.0.0以下(未包含)，所以不要用default latest version，可以用CLI也可以用Desktop，因為Desktop Version預設已經no longer supported，所以一定是1.22.3，而CLI安裝就需要指定(以下是已經安裝npm為前提)
$ npm install -g appium@1.22.3
$ npm install -g appium-doctor

設定ANDROID_HOME和JAVA_HOME
到Windows環境變數設定

然後去看appium-doctor看necessary的部分是不是都有，一般來說可能會apkanalyzer.bat會沒有，這方面就慢慢到網路上去載android studio下載tools

AppCrawler - latest (2.7.4)
就直接到github release去下載build好的jar file，不需要看其他教學是用2.4.0或是2.3.1去用stb或是maven build原本的專案
Official Link: https://github.com/seveniruby/AppCrawler/releases/tag/2.7.4


  測試前
  #


app activity name
如果已經在手機安裝好，就直接看dumpsys中該package的main activity是哪一個
$ adb shell dumpsys package com.spotify.music | grep -B 2 "android.intent.action.MAIN" -n
279-          Action: "com.google.android.meet.ADDONS_SUPPORT"
280-          Category: "android.intent.category.DEFAULT"
281:      android.intent.action.MAIN:
282-        553d29 com.spotify.music/.SpotifyMainActivity filter 3a3b8ae
283:          Action: "android.intent.action.MAIN"
--
286-          Category: "android.intent.category.APP_MUSIC"
287-        7cd1a0c com.spotify.music/.main.AppIconEmeraldGreen filter 18bef55
288:          Action: "android.intent.action.MAIN"
--
290-          Category: "android.intent.category.DEFAULT"
291-        c3efd6a com.spotify.music/.MainActivity filter 204625b
292:          Action: "android.intent.action.MAIN"
--
307-      android.intent.action.MUSIC_PLAYER:
308-        553d29 com.spotify.music/.SpotifyMainActivity filter 3a3b8ae
309:          Action: "android.intent.action.MAIN"
另外一種方式就是用apktool反編譯後去看AndroidManifest.xml，一樣就是string search ==android.intent.action.MAIN==，但反編譯後會有一大堆files，可能會很佔空間
$ apktool d your_app.apk

app package name
如果已經安裝了，就直接list package
$ adb shell pm list package | grep spotify
package:com.spotify.music
要不然就要用aapt去看
$ aapt d badging Spotify.apk | findstr package
package: name=&#39;com.spotify.music&#39; versionCode=&#39;116658084&#39; versionName=&#39;8.9.58.572&#39; platformBuildVersionName=&#39;14&#39; platformBuildVersionCode=&#39;34&#39; compileSdkVersion=&#39;34&#39; compileSdkVersionCodename=&#39;14&#39;
uses-permission: name=&#39;com.sec.android.app.clockpackage.permission.READ_ALARM&#39;

開啟appium
如何檢視有正確開啟並且有連線到
$ appium
[Appium] Welcome to Appium v1.22.3
[Appium] Appium REST http interface listener started on 0.0.0.0:4723
$ curl http://127.0.0.1:4723/wd/hub/status
{"value":{"build":{"version":"1.22.3"}},"sessionId":null,"status":0}



  實際測試
  #

$ java -jar appcrawler-2.7.4-hogwarts.jar --capability "appPackage=com.spotify.music,appActivity=MainActivity"

  注意事項
  #

:::danger
基本上這個tool還是依照大量截圖的方式判斷有無換頁，所以依照現在android版本的更新，開發商如果設定成無法截圖的方式，就無法做後續的測試
:::
:::danger
根據以上的步驟，還是非常有可能會遇到問題，我自己在用physical device時，最常遇到java.lang.RuntimeException: Error creating extended parser class: Could not determine whether class ‘org.pegdown.Parser$$parboiled’ has already been loaded，在使用emulator的時候，也會遇到Exception in thread “main” java.awt.image.RasterFormatException: (y + height) is outside of Raster'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tools/others/android-app-crawler/appcrawler/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="AppCrawler"><meta property="og:description" content='AppCrawler # 前面踩了超多坑，所以一切都以底下最新的配置為主
Infra # Appium - 1.22.3 一定要是2.0.0以下(未包含)，所以不要用default latest version，可以用CLI也可以用Desktop，因為Desktop Version預設已經no longer supported，所以一定是1.22.3，而CLI安裝就需要指定(以下是已經安裝npm為前提) $ npm install -g appium@1.22.3 $ npm install -g appium-doctor 設定ANDROID_HOME和JAVA_HOME 到Windows環境變數設定 然後去看appium-doctor看necessary的部分是不是都有，一般來說可能會apkanalyzer.bat會沒有，這方面就慢慢到網路上去載android studio下載tools AppCrawler - latest (2.7.4) 就直接到github release去下載build好的jar file，不需要看其他教學是用2.4.0或是2.3.1去用stb或是maven build原本的專案 Official Link: https://github.com/seveniruby/AppCrawler/releases/tag/2.7.4 測試前 # app activity name 如果已經在手機安裝好，就直接看dumpsys中該package的main activity是哪一個 $ adb shell dumpsys package com.spotify.music | grep -B 2 "android.intent.action.MAIN" -n 279- Action: "com.google.android.meet.ADDONS_SUPPORT" 280- Category: "android.intent.category.DEFAULT" 281: android.intent.action.MAIN: 282- 553d29 com.spotify.music/.SpotifyMainActivity filter 3a3b8ae 283: Action: "android.intent.action.MAIN" -- 286- Category: "android.intent.category.APP_MUSIC" 287- 7cd1a0c com.spotify.music/.main.AppIconEmeraldGreen filter 18bef55 288: Action: "android.intent.action.MAIN" -- 290- Category: "android.intent.category.DEFAULT" 291- c3efd6a com.spotify.music/.MainActivity filter 204625b 292: Action: "android.intent.action.MAIN" -- 307- android.intent.action.MUSIC_PLAYER: 308- 553d29 com.spotify.music/.SpotifyMainActivity filter 3a3b8ae 309: Action: "android.intent.action.MAIN" 另外一種方式就是用apktool反編譯後去看AndroidManifest.xml，一樣就是string search ==android.intent.action.MAIN==，但反編譯後會有一大堆files，可能會很佔空間 $ apktool d your_app.apk app package name 如果已經安裝了，就直接list package $ adb shell pm list package | grep spotify package:com.spotify.music 要不然就要用aapt去看 $ aapt d badging Spotify.apk | findstr package package: name=&#39;com.spotify.music&#39; versionCode=&#39;116658084&#39; versionName=&#39;8.9.58.572&#39; platformBuildVersionName=&#39;14&#39; platformBuildVersionCode=&#39;34&#39; compileSdkVersion=&#39;34&#39; compileSdkVersionCodename=&#39;14&#39; uses-permission: name=&#39;com.sec.android.app.clockpackage.permission.READ_ALARM&#39; 開啟appium 如何檢視有正確開啟並且有連線到 $ appium [Appium] Welcome to Appium v1.22.3 [Appium] Appium REST http interface listener started on 0.0.0.0:4723 $ curl http://127.0.0.1:4723/wd/hub/status {"value":{"build":{"version":"1.22.3"}},"sessionId":null,"status":0} 實際測試 # $ java -jar appcrawler-2.7.4-hogwarts.jar --capability "appPackage=com.spotify.music,appActivity=MainActivity" 注意事項 # :::danger 基本上這個tool還是依照大量截圖的方式判斷有無換頁，所以依照現在android版本的更新，開發商如果設定成無法截圖的方式，就無法做後續的測試 ::: :::danger 根據以上的步驟，還是非常有可能會遇到問題，我自己在用physical device時，最常遇到java.lang.RuntimeException: Error creating extended parser class: Could not determine whether class ‘org.pegdown.Parser$$parboiled’ has already been loaded，在使用emulator的時候，也會遇到Exception in thread “main” java.awt.image.RasterFormatException: (y + height) is outside of Raster'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="tools"><meta property="article:tag" content="Tools"><title>AppCrawler | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tools/others/android-app-crawler/appcrawler/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>AppCrawler</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#infra>Infra</a></li><li><a href=#測試前>測試前</a></li><li><a href=#實際測試>實際測試</a></li><li><a href=#注意事項>注意事項</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=appcrawler>AppCrawler
<a class=anchor href=#appcrawler>#</a></h1><p>前面踩了超多坑，所以一切都以底下最新的配置為主</p><h2 id=infra>Infra
<a class=anchor href=#infra>#</a></h2><ol><li>Appium - 1.22.3
一定要是2.0.0以下(未包含)，所以不要用default latest version，可以用CLI也可以用Desktop，因為Desktop Version預設已經no longer supported，所以一定是1.22.3，而CLI安裝就需要指定(以下是已經安裝npm為前提)<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ npm install -g appium@1.22.3
</span></span><span style=display:flex><span>$ npm install -g appium-doctor
</span></span></code></pre></div></li><li>設定ANDROID_HOME和JAVA_HOME
到Windows環境變數設定
<img src=https://hackmd.io/_uploads/BkmODXjqR.png alt=圖片>
然後去看appium-doctor看necessary的部分是不是都有，一般來說可能會apkanalyzer.bat會沒有，這方面就慢慢到網路上去載android studio下載tools
<img src=https://hackmd.io/_uploads/BkZsw7j9R.png alt=圖片></li><li>AppCrawler - latest (2.7.4)
就直接到github release去下載build好的jar file，不需要看其他教學是用2.4.0或是2.3.1去用stb或是maven build原本的專案
Official Link: <a href=https://github.com/seveniruby/AppCrawler/releases/tag/2.7.4>https://github.com/seveniruby/AppCrawler/releases/tag/2.7.4</a></li></ol><h2 id=測試前>測試前
<a class=anchor href=#%e6%b8%ac%e8%a9%a6%e5%89%8d>#</a></h2><ol><li>app activity name
如果已經在手機安裝好，就直接看dumpsys中該package的main activity是哪一個<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ adb shell dumpsys package com.spotify.music | grep -B <span style=color:#ae81ff>2</span> <span style=color:#e6db74>&#34;android.intent.action.MAIN&#34;</span> -n
</span></span><span style=display:flex><span>279-          Action: <span style=color:#e6db74>&#34;com.google.android.meet.ADDONS_SUPPORT&#34;</span>
</span></span><span style=display:flex><span>280-          Category: <span style=color:#e6db74>&#34;android.intent.category.DEFAULT&#34;</span>
</span></span><span style=display:flex><span>281:      android.intent.action.MAIN:
</span></span><span style=display:flex><span>282-        553d29 com.spotify.music/.SpotifyMainActivity filter 3a3b8ae
</span></span><span style=display:flex><span>283:          Action: <span style=color:#e6db74>&#34;android.intent.action.MAIN&#34;</span>
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>286-          Category: <span style=color:#e6db74>&#34;android.intent.category.APP_MUSIC&#34;</span>
</span></span><span style=display:flex><span>287-        7cd1a0c com.spotify.music/.main.AppIconEmeraldGreen filter 18bef55
</span></span><span style=display:flex><span>288:          Action: <span style=color:#e6db74>&#34;android.intent.action.MAIN&#34;</span>
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>290-          Category: <span style=color:#e6db74>&#34;android.intent.category.DEFAULT&#34;</span>
</span></span><span style=display:flex><span>291-        c3efd6a com.spotify.music/.MainActivity filter 204625b
</span></span><span style=display:flex><span>292:          Action: <span style=color:#e6db74>&#34;android.intent.action.MAIN&#34;</span>
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>307-      android.intent.action.MUSIC_PLAYER:
</span></span><span style=display:flex><span>308-        553d29 com.spotify.music/.SpotifyMainActivity filter 3a3b8ae
</span></span><span style=display:flex><span>309:          Action: <span style=color:#e6db74>&#34;android.intent.action.MAIN&#34;</span>
</span></span></code></pre></div>另外一種方式就是用apktool反編譯後去看AndroidManifest.xml，一樣就是string search ==android.intent.action.MAIN==，但反編譯後會有一大堆files，可能會很佔空間<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ apktool d your_app.apk
</span></span></code></pre></div></li><li>app package name
如果已經安裝了，就直接list package<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ adb shell pm list package | grep spotify
</span></span><span style=display:flex><span>package:com.spotify.music
</span></span></code></pre></div>要不然就要用aapt去看<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aapt d badging Spotify.apk | findstr package
</span></span><span style=display:flex><span>package: name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;com.spotify.music&#39;</span> versionCode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;116658084&#39;</span> versionName<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;8.9.58.572&#39;</span> platformBuildVersionName<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;14&#39;</span> platformBuildVersionCode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;34&#39;</span> compileSdkVersion<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;34&#39;</span> compileSdkVersionCodename<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;14&#39;</span>
</span></span><span style=display:flex><span>uses-permission: name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;com.sec.android.app.clockpackage.permission.READ_ALARM&#39;</span>
</span></span></code></pre></div></li><li>開啟appium
如何檢視有正確開啟並且有連線到<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ appium
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Appium<span style=color:#f92672>]</span> Welcome to Appium v1.22.3
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Appium<span style=color:#f92672>]</span> Appium REST http interface listener started on 0.0.0.0:4723
</span></span><span style=display:flex><span>$ curl http://127.0.0.1:4723/wd/hub/status
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;value&#34;</span>:<span style=color:#f92672>{</span><span style=color:#e6db74>&#34;build&#34;</span>:<span style=color:#f92672>{</span><span style=color:#e6db74>&#34;version&#34;</span>:<span style=color:#e6db74>&#34;1.22.3&#34;</span><span style=color:#f92672>}}</span>,<span style=color:#e6db74>&#34;sessionId&#34;</span>:null,<span style=color:#e6db74>&#34;status&#34;</span>:0<span style=color:#f92672>}</span>
</span></span></code></pre></div></li></ol><h2 id=實際測試>實際測試
<a class=anchor href=#%e5%af%a6%e9%9a%9b%e6%b8%ac%e8%a9%a6>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ java -jar appcrawler-2.7.4-hogwarts.jar --capability <span style=color:#e6db74>&#34;appPackage=com.spotify.music,appActivity=MainActivity&#34;</span>
</span></span></code></pre></div><h2 id=注意事項>注意事項
<a class=anchor href=#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a0%85>#</a></h2><p>:::danger
基本上這個tool還是依照大量截圖的方式判斷有無換頁，所以依照現在android版本的更新，開發商如果設定成無法截圖的方式，就無法做後續的測試
:::
:::danger
根據以上的步驟，還是非常有可能會遇到問題，我自己在用physical device時，最常遇到<a href=https://ceshiren.com/t/topic/16293>java.lang.RuntimeException: Error creating extended parser class: Could not determine whether class ‘org.pegdown.Parser$$parboiled’ has already been loaded</a>，在使用emulator的時候，也會遇到<a href=https://ceshiren.com/t/topic/31983>Exception in thread “main” java.awt.image.RasterFormatException: (y + height) is outside of Raster</a></p><p>但通通得不到解決的方式
:::</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#infra>Infra</a></li><li><a href=#測試前>測試前</a></li><li><a href=#實際測試>實際測試</a></li><li><a href=#注意事項>注意事項</a></li></ul></nav></div></aside></main></body></html>