<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  WFuzz
  #

參考網站-1: https://www.ddosi.org/wfuzz-guide/
參考網站-2: https://www.ddosi.org/wfuzz/
參考網站-3: https://www.secpulse.com/archives/78638.html
參考官網-1: https://wfuzz.readthedocs.io/en/latest/user/basicusage.html

  Installation & Basic Guide
  #

$ git pull https://github.com/xmendez/wfuzz.git
下載下來後總共有==4==個executable file: ==wfencode==, ==wfpayload==, ==wfuzz==, ==wxfuzz==，這四個file實際上就是去執行src/內部的python cli file
python src/wfuzz-cli.py &#34;$@&#34;
python src/wxfuzz.py $@
python src/wfencode.py &#34;$@&#34;
python src/wfpayload.py &#34;$@&#34;

  wfencode
  #

這個就是encode/decode的script，很單純
$ wfencode --help
Usage:

        wfencode --help This help
        wfencode -d decoder_name string_to_decode
        wfencode -e encoder_name string_to_encode
        wfencode -e encoder_name -i <<stdin>>
而關於encode/decoder name可以參考wfuzz file的help
$ wfuzz -e encoder
Available encoders:

  Category      | Name              | Summary
------------------------------------------------------------------------------------------------------------------------
  hashes        | base64            | Encodes the given string using base64
  url           | doble_nibble_hex  | Replaces ALL characters in string using the %%dd%dd escape
  url_safe, url | double_urlencode  | Applies a double encode to special characters in string using the %25xx escape.
                |                   | Letters, digits, and the characters '_.-' are never quoted.
  url           | first_nibble_hex  | Replaces ALL characters in string using the %%dd? escape
  default       | hexlify           | Every byte of data is converted into the corresponding 2-digit hex representatio
                |                   | n.
  html          | html_decimal      | Replaces ALL characters in string using the &amp;#dd; escape
  html          | html_escape       | Convert the characters &<>&#34; in string to HTML-safe sequences.
  html          | html_hexadecimal  | Replaces ALL characters in string using the &amp;#xx; escape
  hashes        | md5               | Applies a md5 hash to the given string
  db            | mssql_char        | Converts ALL characters to MsSQL's char(xx)
  db            | mysql_char        | Converts ALL characters to MySQL's char(xx)
  default       | none              | Returns string without changes
  db            | oracle_char       | Converts ALL characters to Oracle's chr(xx)
  default       | random_upper      | Replaces random characters in string with its capitals letters
  url           | second_nibble_hex | Replaces ALL characters in string using the %?%dd escape
  hashes        | sha1              | Applies a sha1 hash to the given string
  hashes        | sha256            | Applies a sha256 hash to the given string
  hashes        | sha512            | Applies a sha512 hash to the given string
  url           | uri_double_hex    | Encodes ALL charachers using the %25xx escape.
  url           | uri_hex           | Encodes ALL charachers using the %xx escape.
  url           | uri_triple_hex    | Encodes ALL charachers using the %25%xx%xx escape.
  url           | uri_unicode       | Replaces ALL characters in string using the %u00xx escape
  url_safe, url | urlencode         | Replace special characters in string using the %xx escape. Letters, digits, and
                |                   | the characters '_.-' are never quoted.
  url           | utf8              | Replaces ALL characters in string using the \u00xx escape
  url           | utf8_binary       | Replaces ALL characters in string using the \uxx escape
如何使用"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tools/others/directory-fuzzing---traversal-tools/wfuzz/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="WFuzz"><meta property="og:description" content="WFuzz # 參考網站-1: https://www.ddosi.org/wfuzz-guide/ 參考網站-2: https://www.ddosi.org/wfuzz/ 參考網站-3: https://www.secpulse.com/archives/78638.html 參考官網-1: https://wfuzz.readthedocs.io/en/latest/user/basicusage.html
Installation & Basic Guide # $ git pull https://github.com/xmendez/wfuzz.git 下載下來後總共有==4==個executable file: ==wfencode==, ==wfpayload==, ==wfuzz==, ==wxfuzz==，這四個file實際上就是去執行src/內部的python cli file
python src/wfuzz-cli.py &#34;$@&#34; python src/wxfuzz.py $@ python src/wfencode.py &#34;$@&#34; python src/wfpayload.py &#34;$@&#34; wfencode # 這個就是encode/decode的script，很單純
$ wfencode --help Usage: wfencode --help This help wfencode -d decoder_name string_to_decode wfencode -e encoder_name string_to_encode wfencode -e encoder_name -i <<stdin>> 而關於encode/decoder name可以參考wfuzz file的help
$ wfuzz -e encoder Available encoders: Category | Name | Summary ------------------------------------------------------------------------------------------------------------------------ hashes | base64 | Encodes the given string using base64 url | doble_nibble_hex | Replaces ALL characters in string using the %%dd%dd escape url_safe, url | double_urlencode | Applies a double encode to special characters in string using the %25xx escape. | | Letters, digits, and the characters '_.-' are never quoted. url | first_nibble_hex | Replaces ALL characters in string using the %%dd? escape default | hexlify | Every byte of data is converted into the corresponding 2-digit hex representatio | | n. html | html_decimal | Replaces ALL characters in string using the &amp;#dd; escape html | html_escape | Convert the characters &<>&#34; in string to HTML-safe sequences. html | html_hexadecimal | Replaces ALL characters in string using the &amp;#xx; escape hashes | md5 | Applies a md5 hash to the given string db | mssql_char | Converts ALL characters to MsSQL's char(xx) db | mysql_char | Converts ALL characters to MySQL's char(xx) default | none | Returns string without changes db | oracle_char | Converts ALL characters to Oracle's chr(xx) default | random_upper | Replaces random characters in string with its capitals letters url | second_nibble_hex | Replaces ALL characters in string using the %?%dd escape hashes | sha1 | Applies a sha1 hash to the given string hashes | sha256 | Applies a sha256 hash to the given string hashes | sha512 | Applies a sha512 hash to the given string url | uri_double_hex | Encodes ALL charachers using the %25xx escape. url | uri_hex | Encodes ALL charachers using the %xx escape. url | uri_triple_hex | Encodes ALL charachers using the %25%xx%xx escape. url | uri_unicode | Replaces ALL characters in string using the %u00xx escape url_safe, url | urlencode | Replace special characters in string using the %xx escape. Letters, digits, and | | the characters '_.-' are never quoted. url | utf8 | Replaces ALL characters in string using the \u00xx escape url | utf8_binary | Replaces ALL characters in string using the \uxx escape 如何使用"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="tools"><meta property="article:tag" content="Tools"><title>WFuzz | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tools/others/directory-fuzzing---traversal-tools/wfuzz/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>WFuzz</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#installation--basic-guide>Installation & Basic Guide</a></li><li><a href=#wfencode>wfencode</a></li><li><a href=#wfpayload>wfpayload</a></li><li><a href=#wfuzz--wxfuzz>wfuzz & wxfuzz</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=wfuzz>WFuzz
<a class=anchor href=#wfuzz>#</a></h1><p>參考網站-1: <a href=https://www.ddosi.org/wfuzz-guide/>https://www.ddosi.org/wfuzz-guide/</a>
參考網站-2: <a href=https://www.ddosi.org/wfuzz/>https://www.ddosi.org/wfuzz/</a>
參考網站-3: <a href=https://www.secpulse.com/archives/78638.html>https://www.secpulse.com/archives/78638.html</a>
參考官網-1: <a href=https://wfuzz.readthedocs.io/en/latest/user/basicusage.html>https://wfuzz.readthedocs.io/en/latest/user/basicusage.html</a></p><h3 id=installation--basic-guide>Installation & Basic Guide
<a class=anchor href=#installation--basic-guide>#</a></h3><pre tabindex=0><code class=language-bash! data-lang=bash!>$ git pull https://github.com/xmendez/wfuzz.git
</code></pre><p>下載下來後總共有==4==個executable file: ==wfencode==, ==wfpayload==, ==wfuzz==, ==wxfuzz==，這四個file實際上就是去執行src/內部的python cli file</p><pre tabindex=0><code class=language-bash! data-lang=bash!>python src/wfuzz-cli.py &#34;$@&#34;
python src/wxfuzz.py $@
python src/wfencode.py &#34;$@&#34;
python src/wfpayload.py &#34;$@&#34;
</code></pre><h3 id=wfencode>wfencode
<a class=anchor href=#wfencode>#</a></h3><p>這個就是encode/decode的script，很單純</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ wfencode --help
Usage:

        wfencode --help This help
        wfencode -d decoder_name string_to_decode
        wfencode -e encoder_name string_to_encode
        wfencode -e encoder_name -i &lt;&lt;stdin&gt;&gt;
</code></pre><p>而關於encode/decoder name可以參考wfuzz file的help</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ wfuzz -e encoder
Available encoders:

  Category      | Name              | Summary
------------------------------------------------------------------------------------------------------------------------
  hashes        | base64            | Encodes the given string using base64
  url           | doble_nibble_hex  | Replaces ALL characters in string using the %%dd%dd escape
  url_safe, url | double_urlencode  | Applies a double encode to special characters in string using the %25xx escape.
                |                   | Letters, digits, and the characters &#39;_.-&#39; are never quoted.
  url           | first_nibble_hex  | Replaces ALL characters in string using the %%dd? escape
  default       | hexlify           | Every byte of data is converted into the corresponding 2-digit hex representatio
                |                   | n.
  html          | html_decimal      | Replaces ALL characters in string using the &amp;#dd; escape
  html          | html_escape       | Convert the characters &amp;&lt;&gt;&#34; in string to HTML-safe sequences.
  html          | html_hexadecimal  | Replaces ALL characters in string using the &amp;#xx; escape
  hashes        | md5               | Applies a md5 hash to the given string
  db            | mssql_char        | Converts ALL characters to MsSQL&#39;s char(xx)
  db            | mysql_char        | Converts ALL characters to MySQL&#39;s char(xx)
  default       | none              | Returns string without changes
  db            | oracle_char       | Converts ALL characters to Oracle&#39;s chr(xx)
  default       | random_upper      | Replaces random characters in string with its capitals letters
  url           | second_nibble_hex | Replaces ALL characters in string using the %?%dd escape
  hashes        | sha1              | Applies a sha1 hash to the given string
  hashes        | sha256            | Applies a sha256 hash to the given string
  hashes        | sha512            | Applies a sha512 hash to the given string
  url           | uri_double_hex    | Encodes ALL charachers using the %25xx escape.
  url           | uri_hex           | Encodes ALL charachers using the %xx escape.
  url           | uri_triple_hex    | Encodes ALL charachers using the %25%xx%xx escape.
  url           | uri_unicode       | Replaces ALL characters in string using the %u00xx escape
  url_safe, url | urlencode         | Replace special characters in string using the %xx escape. Letters, digits, and
                |                   | the characters &#39;_.-&#39; are never quoted.
  url           | utf8              | Replaces ALL characters in string using the \u00xx escape
  url           | utf8_binary       | Replaces ALL characters in string using the \uxx escape
</code></pre><p>如何使用</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ wfencode -e md5 aaa
47bce5c74f589f4867dbd57e9ca9f808
</code></pre><h3 id=wfpayload>wfpayload
<a class=anchor href=#wfpayload>#</a></h3><p>這個file主要是產生payload，不管是數字、iprange或是name，以下列出一些常見的</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ wfpayload -e payloads
Available payloads:

  Name            | Summary
------------------------------------------------------------------------------------------------------
  autorize        | Returns fuzz results&#39; from autorize.
  bing            | Returns URL results of a given bing API search (needs api key).
  buffer_overflow | Returns a string using the following pattern A * given number.
  burpitem        | This payload loads request/response from items saved from Burpsuite.
  burplog         | Returns fuzz results from a Burp log.
  burpstate       | Returns fuzz results from a Burp state.
  dirwalk         | Returns filename&#39;s recursively from a local directory.
  file            | Returns each word from a file.
  guitab          | This payload reads requests from a tab in the GUI
  hexrand         | Returns random hex numbers from the given range.
  hexrange        | Returns each hex number of the given hex range.
  ipnet           | Returns list of IP addresses of a network.
  iprange         | Returns list of IP addresses of a given IP range.
  list            | Returns each element of the given word list separated by -.
  names           | Returns possible usernames by mixing the given words, separated by -, using know
                  | n typical constructions.
  permutation     | Returns permutations of the given charset and length.
  range           | Returns each number of the given range.
  shodanp         | Returns URLs of a given Shodan API search (needs api key).
  stdin           | Returns each item read from stdin.
  wfuzzp          | Returns fuzz results&#39; URL from a previous stored wfuzz session.
</code></pre><p>如何使用
:::info
如果不知道payload的格式或是哪些module需要安裝，可以使用<code>$ wfpayload -z help --slice "&lt;payload you wanna use>"</code>，就可以知道詳細的格式或範例以及一些基本的說明
:::</p><pre tabindex=0><code class=language-bash! data-lang=bash!># number(以下三者皆相通)
$ wfpayload -z range,0-20
$ wfpayload -z range --zP range=0-20
$ wfpayload -z range --zD 0-20

# iprange(以下三者皆相通)
# pip install netaddr
$ wfpayload -z iprange,192.168.1.1-192.168.1.255
$ wfpayload -z iprange --zP iprange=192.168.1.1-192.168.1.255
$ wfpayload -z iprange --zD 192.168.1.1-192.168.1.255

# list(以下三者皆相通)
$ wfpayload -z list,aaa-bbbb-ccc
$ wfpayload -z list --zP values=aaa-bbbb-ccc
$ wfpayload -z list --zD aaa-bbbb-ccc

# dirwalk(以下三者皆相通)
$ wfpayload -z dirwalk,./wordlist
$ wfpayload -z dirwalk --zP dir=./wordlist
$ wfpayload -z dirwalk --zD ./wordlist

# ipnet(以下三者皆相通)
$ wfpayload -z ipnet,127.0.0.1/24
$ wfpayload -z ipnet --zP net=127.0.0.1/24
$ wfpayload -z ipnet --zD 127.0.0.1/24

# name(以下三者皆相通)
$ wfpayload -z name,sbk-ho
$ wfpayload -z name --zP name=sbk-ho
$ wfpayload -z name --zD sbk-ho
</code></pre><h3 id=wfuzz--wxfuzz>wfuzz & wxfuzz
<a class=anchor href=#wfuzz--wxfuzz>#</a></h3><p>基本上wxfuzz是wfuzz的GUI版本，他是利用wxPython進行實作，所以如果會使用CLI就不需要管wxfuzz</p><h4 id=directory-scanning>Directory Scanning
<a class=anchor href=#directory-scanning>#</a></h4><pre tabindex=0><code class=language-bash! data-lang=bash!>$ wfuzz -c -w wordlist/general/common.txt http://localhost:8065/FUZZ
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://localhost:8065/FUZZ
Total requests: 951

=====================================================================
ID           Response   Lines    Word       Chars       Payload
=====================================================================

000000001:   200        34 L     199 W      3471 Ch     &#34;@&#34;
000000003:   200        34 L     199 W      3471 Ch     &#34;01&#34;
...
</code></pre><p>可以看到最一開始有Response Status Code, Lines, Word, Chars等這些index，如果想要過濾/顯示特定的packet，可以使用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>--hc/hl/hw/hh N<span style=color:#f92672>[</span>,N<span style=color:#f92672>]</span>+      : Hide responses with the specified code/lines/words/chars <span style=color:#f92672>(</span>Use BBB <span style=color:#66d9ef>for</span> taking values from baseline<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>--sc/sl/sw/sh N<span style=color:#f92672>[</span>,N<span style=color:#f92672>]</span>+      : Show responses with the specified code/lines/words/chars <span style=color:#f92672>(</span>Use BBB <span style=color:#66d9ef>for</span> taking values from baseline<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>就是對應上述提到的四個index</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 想要過濾status code: 404</span>
</span></span><span style=display:flex><span>$ wfuzz -c -w wordlist/general/common.txt --hc <span style=color:#ae81ff>404</span> http://localhost:8065/FUZZ
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 想要過濾chars是3471的packet，以下三者完全相等</span>
</span></span><span style=display:flex><span>$ wfuzz -c -w wordlist/general/common.txt --hh <span style=color:#ae81ff>3471</span> http://localhost:8065/FUZZ
</span></span><span style=display:flex><span>$ wfuzz -c -z file --zD wordlist<span style=color:#ae81ff>\g</span>eneral<span style=color:#ae81ff>\c</span>ommon.txt --hh <span style=color:#ae81ff>3471</span> http://localhost:8065/FUZZ
</span></span><span style=display:flex><span>$ wfuzz -c -z file,wordlist<span style=color:#ae81ff>\g</span>eneral<span style=color:#ae81ff>\c</span>ommon.txt --hh <span style=color:#ae81ff>3471</span> http://localhost:8065/FUZZ
</span></span></code></pre></div><p>:::info
有一個非常重要的部分是，wfuzz無法自行判斷我給的URL和Fuzz element之間是否只有一個<code>/</code>也就是如果wordlist是<code>/api/v1/about</code>，但我給的testing URL是<code>http://localhost:80/</code>這樣的話拼起來就會是<code>http://localhost:80//api/v1/about</code>，這樣的話就會出錯(web server大機率會無法render)，另外有些web server的backend沒有辦法解析request URL的最後面出現<code>/</code>(例如==Abacus==)，舉例來說: <code>/api/v1/about</code>和<code>/api/v1/about/</code>在backend解析的時候是不一樣的，但明明wordlist上只出現<code>/api/v1/about</code>，會這樣是因為我給的Wfuzz testing URL是<code>http://localhost:80FUZZ</code>，Wfuzz會自動在後面補一個<code>/</code>，因此比較保險的方式是wordlist最一開始不要是<code>/</code>，然後Wfuzz testing URL是<code>http://localhost:80/FUZZ</code>這樣比較保險
:::</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#installation--basic-guide>Installation & Basic Guide</a></li><li><a href=#wfencode>wfencode</a></li><li><a href=#wfpayload>wfpayload</a></li><li><a href=#wfuzz--wxfuzz>wfuzz & wxfuzz</a></li></ul></li></ul></nav></div></aside></main></body></html>