<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/eductf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Eductf"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Eductf | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/eductf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/eductf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Eductf</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x042023-lab---poa/>Simple Crypto - 0x04(2023 Lab - POA)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x042023-lab---poa>Simple Crypto - 0x04(2023 Lab - POA)
<a class=anchor href=#simple-crypto---0x042023-lab---poa>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://youtu.be/dYyNeMeDM20?si=BEvBPBzCsg8oWv_Q&amp;t=8317">Crypto I - Timmy</a></p><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#! /usr/bin/python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> secret <span style=color:#f92672>import</span> FLAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pad</span>(data, block_size):
</span></span><span style=display:flex><span>    data <span style=color:#f92672>+=</span> bytes([<span style=color:#ae81ff>0x80</span>] <span style=color:#f92672>+</span> [<span style=color:#ae81ff>0x00</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>15</span> <span style=color:#f92672>-</span> len(data) <span style=color:#f92672>%</span> block_size))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> data
</span></span><span style=display:flex><span><span style=color:#75715e># padding style: &lt;oooooo[0x80][0x00]...[0x00]&gt; (find first [0x80])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>unpad</span>(data, block_size):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(data) <span style=color:#f92672>%</span> block_size:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    padding_len <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, len(data) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> data[<span style=color:#f92672>-</span>i] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x80</span>:
</span></span><span style=display:flex><span>            padding_len <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> data[<span style=color:#f92672>-</span>i] <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0x00</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> data[:<span style=color:#f92672>-</span>padding_len]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>key <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CBC)
</span></span><span style=display:flex><span>ct <span style=color:#f92672>=</span> cipher<span style=color:#f92672>.</span>encrypt(pad(FLAG, AES<span style=color:#f92672>.</span>block_size))
</span></span><span style=display:flex><span>iv <span style=color:#f92672>=</span> cipher<span style=color:#f92672>.</span>iv
</span></span><span style=display:flex><span>print((iv <span style=color:#f92672>+</span> ct)<span style=color:#f92672>.</span>hex())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># same encryption</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        inp <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(input()<span style=color:#f92672>.</span>strip()) <span style=color:#75715e># hex style input</span>
</span></span><span style=display:flex><span>        iv, ct <span style=color:#f92672>=</span> inp[:<span style=color:#ae81ff>16</span>], inp[<span style=color:#ae81ff>16</span>:] <span style=color:#75715e># get first 16 bytes from input </span>
</span></span><span style=display:flex><span>        cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CBC, iv) 
</span></span><span style=display:flex><span>        pt <span style=color:#f92672>=</span> unpad(cipher<span style=color:#f92672>.</span>decrypt(ct), AES<span style=color:#f92672>.</span>block_size)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Well received :)&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ValueError</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Something went wrong :(&#34;</span>)
</span></span></code></pre></div><p>:::</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x042023-lab---poa/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x052023-lab---lsb/>Simple Crypto - 0x05(2023 Lab - LSB)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x052023-lab---lsb>Simple Crypto - 0x05(2023 Lab - LSB)
<a class=anchor href=#simple-crypto---0x052023-lab---lsb>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://www.youtube.com/live/mqQ2zgK8a0Y?si=GRgtEKGHsCNcKuqU&amp;t=7176">[edu-ctf 2023] week01 - crypto1</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#! /usr/bin/python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long, getPrime
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> secret <span style=color:#f92672>import</span> FLAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> getPrime(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> getPrime(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> p <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>phi <span style=color:#f92672>=</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> pow(e, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, phi)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> bytes_to_long(FLAG <span style=color:#f92672>+</span> os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>256</span> <span style=color:#f92672>-</span> len(FLAG)))
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> m <span style=color:#f92672>&lt;</span> n
</span></span><span style=display:flex><span>enc <span style=color:#f92672>=</span> pow(m, e, n)
</span></span><span style=display:flex><span>print(n)
</span></span><span style=display:flex><span>print(e)
</span></span><span style=display:flex><span>print(enc)
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>    inp <span style=color:#f92672>=</span> int(input()<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span>    pt <span style=color:#f92672>=</span> pow(inp, d, n)
</span></span><span style=display:flex><span>    print(pt <span style=color:#f92672>%</span> <span style=color:#ae81ff>3</span>)
</span></span></code></pre></div><p>:::</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x052023-lab---lsb/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x062023-hw---lfsr/>Simple Crypto - 0x06(2023 HW - LFSR)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x062023-hw---lfsr>Simple Crypto - 0x06(2023 HW - LFSR)
<a class=anchor href=#simple-crypto---0x062023-hw---lfsr>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://www.geeksforgeeks.org/python-list-xor/>Python – List XOR</a><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> funtools <span style=color:#f92672>import</span> reduce
</span></span><span style=display:flex><span>test_list <span style=color:#f92672>=</span> [<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>9</span>]
</span></span><span style=display:flex><span>res <span style=color:#f92672>=</span> reduce(<span style=color:#66d9ef>lambda</span> x, y: x <span style=color:#f92672>^</span> y, test_list) <span style=color:#75715e># The output is 2</span>
</span></span></code></pre></div></blockquote></li><li><a href=https://www.qiniu.com/qfans/qnso-67006518#comments>Numpy矩陣乘法，但不是乘法，而是XOR的元素</a><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span>m1 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]])
</span></span><span style=display:flex><span>m2 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>], [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>]])
</span></span><span style=display:flex><span>mr <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>empty((m2<span style=color:#f92672>.</span>shape[<span style=color:#ae81ff>0</span>], m1<span style=color:#f92672>.</span>shape[<span style=color:#ae81ff>1</span>]), dtype <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>int64)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(mr<span style=color:#f92672>.</span>shape[<span style=color:#ae81ff>0</span>]):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(mr<span style=color:#f92672>.</span>shape[<span style=color:#ae81ff>1</span>]):
</span></span><span style=display:flex><span>        mr[i, j] <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>sum(m1[:, j] <span style=color:#f92672>^</span> m2[i, :])
</span></span><span style=display:flex><span>print(mr)
</span></span></code></pre></div></blockquote></li><li><a href=https://pyradise.com/%e4%bd%bf%e7%94%a8-python-%e4%be%86%e8%aa%8d%e8%ad%98%e7%9f%a9%e9%99%a3-915376207187>使用 Python 來認識矩陣</a></li><li><a href=https://ithelp.ithome.com.tw/articles/10203624>[Day07]Learning Numpy - 建立、合併、分割 - CheetSheet for Numpy</a></li><li>Sage<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install sagemath -y <span style=color:#75715e># wsl/unix base可以直接安裝，如果是windows要下載sage binary，有1.4GB</span>
</span></span><span style=display:flex><span>$ sage -n <span style=color:#75715e># 開起sage notebook，也就是可以用sage kernel運行jupyter</span>
</span></span><span style=display:flex><span>$ sage &lt;.py/.sage file&gt; <span style=color:#75715e># 用sage運行腳本</span>
</span></span><span style=display:flex><span>$ sage <span style=color:#75715e># 直接開啟sage interactive shell</span>
</span></span></code></pre></div></li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題和前面的triLFSR不一樣的地方在於他只有一層的LFSR，但他只會每個70個才會給一個state，換句話說我們只能拿到$S_{71<em>0+70},\ S_{71</em>1+70},\ S_{71<em>2+70},\ S_{71</em>3+70}&mldr;$(從0開始算)，而前面256個拿到的State最後會和flag進行XOR，只有最後70個是最純粹的State</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x062023-hw---lfsr/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x072023-hw---oracle/>Simple Crypto - 0x07(2023 HW - Oracle)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=simple-crypto---0x072023-hw---oracle>Simple Crypto - 0x07(2023 HW - Oracle)
<a class=anchor href=#simple-crypto---0x072023-hw---oracle>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>POA/RSA</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Oracle.py</p><pre tabindex=0><code class="language-python=" data-lang="python=">from Crypto.Util.number import bytes_to_long
from Crypto.Cipher import AES
from random import randbytes
from secret import aes_key, p, q

def pad(m):
    length = 16-len(m) % 16
    return m + chr(length).encode()*length

def unpad(c):
    length = c[-1]
    for char in c[-length:]:
        if char != length:
            raise ValueError
    return c[:-length]

def asymmetric_encryption(message, N, e):
    # encrypt message with RSA
    # message must be 16 bytes
    # padding 100 bytes random value
    padded_message = randbytes(100) + message
    return pow(bytes_to_long(padded_message), e, N)

def symmetric_encryption(message, key):
    # ecrypt message with AES + CBC Mode
    # message can be arbitrary length
    cipher = AES.new(key, AES.MODE_CBC)
    ct = cipher.encrypt(pad(message))
    iv = cipher.iv
    return iv, ct

## Alice: This is my public key.
# p = getPrime(512)
# q = getPrime(512)
N = p * q
e = 65537
print( f&#34;{N = }, {e = }&#34; )
# N = 69214008498642035761243756357619851816607540327248468473247478342523127723748756926949706235406640562827724567100157104972969498385528097714986614165867074449238186426536742677816881849038677123630836686152379963670139334109846133566156815333584764063197379180877984670843831985941733688575703811651087495223
# e = 65537

## Bob: I want to send message to Alice! But my message is too looooooong......
flag = open(&#34;flag.png&#34;, &#34;rb&#34;).read()

## Bob: Oh! I can use symmetric encryption.
iv, ct = symmetric_encryption(flag, aes_key)
encrypted_key = asymmetric_encryption(aes_key, N, e)
encrypted_iv = asymmetric_encryption(iv, N, e)
print( f&#34;{encrypted_key = }&#34; )
print( f&#34;{encrypted_iv = }&#34; )
open(&#34;encrypted_flag.not_png&#34;, &#34;wb&#34;).write(ct)

## Bob: Ha ha! Now no one can decrypt my message except Alice!
# encrypted_key = 65690013242775728459842109842683020587149462096059598501313133592635945234121561534622365974927219223034823754673718159579772056712404749324225325531206903216411508240699572153162745754564955215041783396329242482406426376133687186983187563217156659178000486342335478915053049498619169740534463504372971359692
# encrypted_iv = 35154524936059729204581782839781987236407179504895959653768093617367549802652967862418906182387861924584809825831862791349195432705129622783580000716829283234184762744224095175044663151370869751957952842383581513986293064879608592662677541628813345923397286253057417592725291925603753086190402107943880261658
</code></pre><p>:::
:::spoiler Alice.py</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x072023-hw---oracle/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x082023-lab---dlog/>Simple Crypto - 0x08(2023 Lab - dlog)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x082023-lab---dlog>Simple Crypto - 0x08(2023 Lab - dlog)
<a class=anchor href=#simple-crypto---0x082023-lab---dlog>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://www.youtube.com/live/u4ZVc8PuJC0?si=2wbiGreg_BZQ-dff">[edu-ctf 2023] week03 - crypto2 </a><a href=https://hackmd.io/@SBK6401/SJobiaxQ3#5-Little-Knowledge-Proof>Cryptography and Network Security – Homework 2 - Little Knowledge Proof</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> isPrime, bytes_to_long
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> secret <span style=color:#f92672>import</span> FLAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> int(input(<span style=color:#e6db74>&#34;give me a prime: &#34;</span>)<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> isPrime(p):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Do you know what is primes?&#34;</span>)
</span></span><span style=display:flex><span>    exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> p<span style=color:#f92672>.</span>bit_length() <span style=color:#f92672>!=</span> <span style=color:#ae81ff>1024</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Bit length need to be 1024&#34;</span>)
</span></span><span style=display:flex><span>    exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>g <span style=color:#f92672>=</span> int(input(<span style=color:#e6db74>&#34;give me a number: &#34;</span>)<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> bytes_to_long(FLAG)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;The hint about my secret:&#39;</span>, pow(g, flag, p))
</span></span></code></pre></div><p>:::</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x082023-lab---dlog/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x092023-lab---signature/>Simple Crypto - 0x09(2023 Lab - signature)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x092023-lab---signature>Simple Crypto - 0x09(2023 Lab - signature)
<a class=anchor href=#simple-crypto---0x092023-lab---signature>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://www.youtube.com/live/u4ZVc8PuJC0?si=ychlqdZnGVfFYRAV&amp;t=4075">[edu-ctf 2023] week03 - crypto2 - ECDSA</a></p><blockquote><p><img src=https://hackmd.io/_uploads/ryVbmdMWp.png alt></p><p><img src=https://hackmd.io/_uploads/HkJMXOG-T.png alt></p></blockquote><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python=">from random import randint
from Crypto.Util.number import *
from hashlib import sha256
from ecdsa import SECP256k1
from ecdsa.ecdsa import Public_key, Private_key, Signature
from secret import FLAG

E = SECP256k1
G, n = E.generator, E.order

d = randint(1, n)
k = randint(1, n)
pubkey = Public_key(G, d*G)
prikey = Private_key(pubkey, d)
print(f&#39;P = ({pubkey.point.x()}, {pubkey.point.y()})&#39;)

for _ in range(3):
    print(&#39;&#39;&#39;
1) Request for Signature
2) Check the Permission
3) exit&#39;&#39;&#39;)
    option = input()
    if option == &#39;1&#39;:
        msg = input(&#39;What do you want? &#39;)
        if msg == &#39;Give me the FLAG.&#39;:
                print(&#39;No way!&#39;)
        else:
            h = sha256(msg.encode()).digest()
            # k = k * 1337 % n
            sig = prikey.sign(bytes_to_long(h), k)
            print(f&#39;sig = ({sig.r}, {sig.s})&#39;)

    elif option == &#39;2&#39;:
        msg = &#39;Give me the FLAG.&#39;
        r = input(&#39;r: &#39;)
        s = input(&#39;s: &#39;)
        h = bytes_to_long(sha256(msg.encode()).digest())
        verified = pubkey.verifies(h, Signature(int(r), int(s)))
        if verified:
            print(FLAG)
        else:
            print(&#39;Bad signature&#39;)
    else:
        print(&#34;bye~&#34;)
        break
</code></pre><p>:::</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x092023-lab---signature/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x102023-lab---coppersmith/>Simple Crypto - 0x10(2023 Lab - coppersmith)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x102023-lab---coppersmith>Simple Crypto - 0x10(2023 Lab - coppersmith)
<a class=anchor href=#simple-crypto---0x102023-lab---coppersmith>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_coppersmith_attack/>coppersmith相關攻擊</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python=">from Crypto.Util.number import bytes_to_long, getPrime
from secret import FLAG

assert len(FLAG) &lt;= 30

p = getPrime(1024)
q = getPrime(1024)
n = p * q
e = 3
padding = b&#34;Padding in cryptography is a fundamental concept employed to ensure that data, typically in the form of plaintext, aligns properly with the encryption algorithm&#39;s block size. This process is crucial for symmetric block ciphers like AES and asymmetric encryption algorithms such as RSA. Padding involves adding extra bits to the input data before encryption, making it fit neatly into fixed-size blocks. The primary purpose of padding is to prevent information leakage by ensuring that the last block of plaintext is always complete, even when the original data&#39;s size isn&#39;t a perfect multiple of the block size. Common padding schemes include PKCS#7, PKCS#1 (for RSA), and ANSI X.923, each with its rules for padding and unpadding data. Proper padding ensures data integrity, security, and compatibility within cryptographic protocols.&#34;
pt = padding + FLAG
ct = pow(bytes_to_long(pt), e, n)
print(f&#34;{e = }&#34;)
print(f&#34;{n = }&#34;)
print(f&#34;{ct = }&#34;)
# e = 3
# n = 11548249006448728920152703839381630946834097081458641312395741399152626808167055308830597218237419306363812953570976143239712039037941209800604194908083149885941768218371746741812573578768412807189143962911312361667909189521442378332430658999991458388376075547304981934158525694587528155624390264161508298680598416212224037418377397597560818727159266535257243347737195812548494888452510974912762585150695881388036715559552242157015756455473208463066542053661043988897316002396230791287157322382659981842882278113445574922266102197380093864871418103716702341116793118630092030597784102701252267617442078055768183287429
# ct = 10016669153906644953016660527326048255337800602435656916304698358749910229624738375584073093905785564737742726549033330343901680652357648652891913260149958947299067801907769873568759955053120633017158582128001396334187309835478967775943564724073809481988489791896725867047366927584419210464759674986336704398037888892734158765679221980466827060998749130113847401820986980535379266905587107992796676977541915779320084736207068268591500847603252838325486939367980604888710370629644796971859833251926677637185722683564847418746350226830775205063128441515048529918173084258483536354002888691012853231754416802134513394608
</code></pre><p>:::</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x102023-lab---coppersmith/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto-0x112023-hw---invalid_curve_attack/>Simple Crypto 0x11(2023 HW - invalid_curve_attack)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto-0x112023-hw---invalid_curve_attack>Simple Crypto 0x11(2023 HW - invalid_curve_attack)
<a class=anchor href=#simple-crypto-0x112023-hw---invalid_curve_attack>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://github.com/maple3142/My-CTF-Challenges/blob/7d9141ac7b61fdbb71f29c07d489018d7c0a0aaa/AIS3%20Pre-exam%202022/pekobot/README.md>pekobot - maple</a></p><blockquote><p>這邊我會嘗試用簡單的講法把這個攻擊簡述一遍，詳細還是建議 <a href=https://github.com/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/README.md>Crypton</a> 或是其他地方的說明。</p><p>Invalid Curve Attack 大致上來說利用的是當一個不在原本曲線 $E$ 上的 $P$ 進行 scalar multiplication 的一些特性，使用類似 <a href=https://en.wikipedia.org/wiki/Pohlig%E2%80%93Hellman_algorithm>Pohlig–Hellman algorithm</a> 的辦法在不同的 subgroup 解 <a href=https://en.wikipedia.org/wiki/Discrete_logarithm>DLP</a> 然後用 <a href=https://en.wikipedia.org/wiki/Chinese_remainder_theorem>CRT</a> 解回原本的 private key。</p><p>一個 Short Weierstrass curve 長這樣:</p><p>$$
y^2 = x^3 + ax + b
$$</p><p>而它的 point doubling formula ($R=2P$) 是:</p><p>$$
\begin{aligned}
s &= \frac{3x_P^2+a}{2y_P} \
x_R &= s^2 - 2x_P \
y_R &= y_P + s(x_R - x_P)
\end{aligned}
$$</p><a href=/security/course/ntu-cs/crypto/simple-crypto-0x112023-hw---invalid_curve_attack/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto-0x122023-hw---signature_revenge/>Simple Crypto 0x12(2023 HW - signature_revenge)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=simple-crypto-0x122023-hw---signature_revenge>Simple Crypto 0x12(2023 HW - signature_revenge)
<a class=anchor href=#simple-crypto-0x122023-hw---signature_revenge>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><img src=https://hackmd.io/_uploads/Skf4o1tGp.png alt>
<img src=https://hackmd.io/_uploads/B16No1FzT.png alt></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> hashlib <span style=color:#f92672>import</span> sha256, md5
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> ecdsa <span style=color:#f92672>import</span> SECP256k1
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> ecdsa.ecdsa <span style=color:#f92672>import</span> Public_key, Private_key
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> secret <span style=color:#f92672>import</span> FLAG
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>E <span style=color:#f92672>=</span> SECP256k1
</span></span><span style=display:flex><span>G, n <span style=color:#f92672>=</span> E<span style=color:#f92672>.</span>generator, E<span style=color:#f92672>.</span>order
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> bytes_to_long( os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>32</span> <span style=color:#f92672>-</span> len(FLAG)) <span style=color:#f92672>+</span> FLAG )
</span></span><span style=display:flex><span>pubkey <span style=color:#f92672>=</span> Public_key(G, d<span style=color:#f92672>*</span>G)
</span></span><span style=display:flex><span>prikey <span style=color:#f92672>=</span> Private_key(pubkey, d)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>magic1 <span style=color:#f92672>=</span> md5(d<span style=color:#f92672>.</span>to_bytes(<span style=color:#ae81ff>32</span>, <span style=color:#e6db74>&#34;big&#34;</span>))<span style=color:#f92672>.</span>digest()
</span></span><span style=display:flex><span>magic2 <span style=color:#f92672>=</span> md5(d<span style=color:#f92672>.</span>to_bytes(<span style=color:#ae81ff>32</span>, <span style=color:#e6db74>&#34;big&#34;</span>)[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])<span style=color:#f92672>.</span>digest()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>h1 <span style=color:#f92672>=</span> sha256(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;https://www.youtube.com/watch?v=IBnrn2pnPG8&#34;</span>)<span style=color:#f92672>.</span>digest()
</span></span><span style=display:flex><span>h2 <span style=color:#f92672>=</span> sha256(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;https://www.youtube.com/watch?v=1H2cyhWYXrE&#34;</span>)<span style=color:#f92672>.</span>digest()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>k1 <span style=color:#f92672>=</span> bytes_to_long(magic1 <span style=color:#f92672>+</span> magic2)
</span></span><span style=display:flex><span>k2 <span style=color:#f92672>=</span> bytes_to_long(magic2 <span style=color:#f92672>+</span> magic1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sig1 <span style=color:#f92672>=</span> prikey<span style=color:#f92672>.</span>sign(bytes_to_long(h1), k1)
</span></span><span style=display:flex><span>sig2 <span style=color:#f92672>=</span> prikey<span style=color:#f92672>.</span>sign(bytes_to_long(h2), k2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;P = (</span><span style=color:#e6db74>{</span>pubkey<span style=color:#f92672>.</span>point<span style=color:#f92672>.</span>x()<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>pubkey<span style=color:#f92672>.</span>point<span style=color:#f92672>.</span>y()<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#39;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;sig1 = (</span><span style=color:#e6db74>{</span>sig1<span style=color:#f92672>.</span>r<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>sig1<span style=color:#f92672>.</span>s<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#39;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;sig2 = (</span><span style=color:#e6db74>{</span>sig2<span style=color:#f92672>.</span>r<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>sig2<span style=color:#f92672>.</span>s<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># P = (70427896289635684269185763735464004880272487387417064603929487585697794861713, 83106938517126976838986116917338443942453391221542116900720022828358221631968)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># sig1 = (26150478759659181410183574739595997895638116875172347795980556499925372918857, 50639168022751577246163934860133616960953696675993100806612269138066992704236)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># sig2 = (8256687378196792904669428303872036025324883507048772044875872623403155644190, 90323515158120328162524865800363952831516312527470472160064097576156608261906)</span>
</span></span></code></pre></div><p>:::</p><a href=/security/course/ntu-cs/crypto/simple-crypto-0x122023-hw---signature_revenge/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto-0x132023-hw---power-analysis/>Simple Crypto 0x13(2023 HW - Power Analysis)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=simple-crypto-0x132023-hw---power-analysis>Simple Crypto 0x13(2023 HW - Power Analysis)
<a class=anchor href=#simple-crypto-0x132023-hw---power-analysis>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://www.youtube.com/live/Q-gaGLJpJHc?si=DZgJm62AnoPHWiZF&amp;t=5433">[edu-ctf 2023] week04 - crypto3 [1:30:36]</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>json file recorded by TA</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題全部都是刻出來的，也包含算correlation coefficient，後面才知道numpy有這東西，但反正根據老師上課的作法一步一步跟著做是絕對沒有問題的，包含以下步驟:</p><ol><li>Preprocessing
也就是把pt, ct, pm都按照簡報上的方式排列(各個trace的第一個byte都蒐集在一起，第二個byte都蒐集再一起&mldr;)</li><li>計算和sbox key XOR的結果</li><li>查表sbox</li><li>計算hamming weight model</li><li>計算和trace的correlation coefficient</li><li>看哪一個結果的數值最大，並把index結果記錄下來算它的ascii</li><li>repeat以上操作後共可得16 bytes的flag</li></ol><ul><li>加速的方法:
可以把整個trace的圖片plot出來看看，會發現題目給的json file是把整段加密的過程記錄下來，所以我們可以只取前一兩百個point就可以完成key的還原</li></ul><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><pre tabindex=0><code class="language-python=" data-lang="python=">import json
from tqdm import trange
import numpy as np
import copy
from string import ascii_letters, digits
from numpy import corrcoef

jsonFile = open(&#39;./Crypto/HW3/traces.json&#39;, &#39;r&#39;)
j = json.load(jsonFile)

s_box = [
    [0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76],
    [0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0],
    [0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15],
    [0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75],
    [0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84],
    [0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF],
    [0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8],
    [0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2],
    [0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73],
    [0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB],
    [0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79],
    [0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08],
    [0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A],
    [0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E],
    [0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF],
    [0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16]
]

def data_preprocess(json_data):
    pt_col = []
    ct_col = []
    trace_col = []
    for bytes in range(16):
        tmp_pt_col = []
        tmp_ct_col = []
        for trace_idx in range(len(json_data)):
            tmp_pt_col.append(json_data[trace_idx][&#39;pt&#39;][bytes])
            tmp_ct_col.append(json_data[trace_idx][&#39;ct&#39;][bytes])
        pt_col.append(tmp_pt_col)
        ct_col.append(tmp_ct_col)
    for point in range(len(json_data[0][&#39;pm&#39;])):
        tmp_trace_col = []
        for trace_idx in range(len(json_data)):
            tmp_trace_col.append(json_data[trace_idx][&#39;pm&#39;][point])
        trace_col.append(tmp_trace_col)
    
    return pt_col, ct_col, trace_col

def sbox_preprocess(pt_col):
    sbox_result_tmp = []
    for sbox_key in range(256): # 總共有256個sbox key
        tmp = []
        for trace in range(len(pt_col)): # 有50個trace
            tmp.append(pt_col[trace] ^ sbox_key)
        sbox_result_tmp.append(tmp)
    return sbox_result_tmp

def choose_sbox(sbox_result_tmp):
    sbox_result = copy.deepcopy(sbox_result_tmp)
    for sbox_key in range(256):
        for trace in range(50):
            hex_value = &#39;{0:0&gt;2x}&#39;.format(sbox_result_tmp[sbox_key][trace])
            x, y = hex_value[0], hex_value[1]
            sbox_result[sbox_key][trace] = s_box[int(x, 16)][int(y, 16)]
    
    return sbox_result

def cal_hamming_weight(sbox_result_col):
    hw_model = copy.deepcopy(sbox_result_col)
    for i in range(len(sbox_result_col)):   # 256
        for j in range(len(sbox_result_col[i])):    # 50
            hw_model[i][j] = bin(sbox_result_col[i][j]).count(&#39;1&#39;)
    
    return hw_model

def cal_correlation(hw_model_col_result, trace_col):
    correlation_result = []
    for i in (ascii_letters + digits).encode():#trange(len(hw_model_col_result)): &lt;- 加速的部分
        for j in range(biggest_length):
            correlation_result.append(corrcoef(hw_model_col_result[i], trace_col[j])[0, -1])
    return correlation_result
            
def run_pearson_correlation(x, y):
    mean_x = np.mean(x)
    mean_y = np.mean(y)
    
    covariance = np.sum((x - mean_x) * (y - mean_y))
    
    std_dev_x = np.sqrt(np.sum((x - mean_x)**2))
    std_dev_y = np.sqrt(np.sum((y - mean_y)**2))
    
    correlation = covariance / (std_dev_x * std_dev_y)
    
    return correlation

def display_pt(offset:int, data_offset = (0, len(j[0][&#34;pm&#34;]))):
    plt.plot(range(data_offset[0], data_offset[1]), j[offset][&#34;pm&#34;][data_offset[0]:data_offset[1]])
    plt.savefig(fname=&#34;pt_&#34; + str(offset) + &#34;.jpg&#34;)
    plt.clf()

# display_pt(0, (0, 95))
# display_pt(0)
pt_col, ct_col, trace_col = data_preprocess(j)
flag = &#39;&#39;
biggest_length = 95# len(trace_col)
for idx in trange(16):
    sbox_preprocess_result = sbox_preprocess(pt_col[idx])
    choose_sbox_result = choose_sbox(sbox_preprocess_result)
    hw_model_col_result = cal_hamming_weight(choose_sbox_result)
    correlation_result = cal_correlation(hw_model_col_result, trace_col)
    key_idx = correlation_result.index(max(correlation_result))
    flag += (ascii_letters + digits)[key_idx // biggest_length]
    # from Crypto.Util.number import long_to_bytes
    # flag += long_to_bytes(key_idx // biggest_length).decode(&#34;cp437&#34;)

print(&#39;The key of AES is: FLAG{&#39; + flag + &#39;}&#39;)
</code></pre><p>有嘗試過只選擇常見可使用的字元也就是<code>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</code>，以及trace只選擇前95個data，也可以正常解析出AES key並且算的更快(大約快77倍左右)</p><a href=/security/course/ntu-cs/crypto/simple-crypto-0x132023-hw---power-analysis/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/eductf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/eductf/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/eductf/ aria-label="Page 1" class=page-link role=button>1</a></li><li class="page-item active"><a aria-current=page aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/tags/eductf/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/eductf/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/tags/eductf/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/tags/eductf/page/3/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/eductf/page/9/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>