<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/misc/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Misc"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Misc | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/misc/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/misc/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Misc</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/adworld/misc/adworld---3-1/>Adworld - 3-1</a></h2><div class=text-small><a href=/tags/adworld/>Adworld</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=adworld---3-1>Adworld - 3-1
<a class=anchor href=#adworld---3-1>#</a></h1><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題很簡單，和之前幾題有點像</p><ol><li>用file看一下給的檔案是一個<code>.rar</code>壓縮檔，改個副檔名後解壓縮出現另外一個檔案</li><li>再用file看一下是一個pcapng檔案，用wireshark分析</li><li>用一些基本的技巧(Follow TCP Stream/Extract Object&mldr;)看tcp stream，會發現一個bash的command紀錄，有一個python enc/dec flow，和一串base64的string，除此之外還可以用extract object把一些file dump下來，發現是另外一個加密的flag.rar檔案，我們的任務就是要從這個pcapng檔案中把加密的密碼找出來
<img src=https://hackmd.io/_uploads/H1iy1vf5h.png alt></li><li>用python腳本解密base64 string，會輸出<code>b'passwd={No_One_Can_Decrypt_Me}\x00\x00'</code></li><li>解密壓縮檔flag就出來了</li></ol><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><p>Write Byte Data</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64decode
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;./basezip.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;,&#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>f1 <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;./cipher.zip&#39;</span>, <span style=color:#e6db74>&#39;wb&#39;</span>)
</span></span><span style=display:flex><span>f1<span style=color:#f92672>.</span>write(b64decode(f))
</span></span><span style=display:flex><span>print(bytes<span style=color:#f92672>.</span>fromhex(b64decode(f)<span style=color:#f92672>.</span>hex())<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;cp437&#39;</span>))
</span></span><span style=display:flex><span>f1<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><p>Decrypt Part</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>IV <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;QWERTYUIOPASDFGH&#39;</span>
</span></span><span style=display:flex><span>str1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;19aaFYsQQKr+hVX6hl2smAUQ5a767TsULEUebWSajEo=&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt</span>(encrypted):
</span></span><span style=display:flex><span>  aes <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(IV, AES<span style=color:#f92672>.</span>MODE_CBC, IV)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> aes<span style=color:#f92672>.</span>decrypt(encrypted)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encrypt</span>(message):
</span></span><span style=display:flex><span>  length <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>  count <span style=color:#f92672>=</span> len(message)
</span></span><span style=display:flex><span>  padding <span style=color:#f92672>=</span> length <span style=color:#f92672>-</span> (count <span style=color:#f92672>%</span> length)
</span></span><span style=display:flex><span>  message <span style=color:#f92672>=</span> message <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\0</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>*</span> padding
</span></span><span style=display:flex><span>  aes <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(IV, AES<span style=color:#f92672>.</span>MODE_CBC, IV)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> aes<span style=color:#f92672>.</span>encrypt(message)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;this is a test&#39;</span>
</span></span><span style=display:flex><span>example <span style=color:#f92672>=</span> decrypt(base64<span style=color:#f92672>.</span>b64decode(str1))
</span></span><span style=display:flex><span>print(example)
</span></span></code></pre></div><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://blog.csdn.net/yoyoko_chan/article/details/117660494>【攻防世界AD】Misc进阶区：3-1</a></p><a href=/security/practice/adworld/misc/adworld---3-1/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/adworld/misc/adworld---miao~/>Adworld - miao~</a></h2><div class=text-small><a href=/tags/adworld/>Adworld</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=adworld---miao>Adworld - miao~
<a class=anchor href=#adworld---miao>#</a></h1><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這題也是看了別人的WP<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>和官解</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ol><li><p>用foremost搜索或救援檔案(神奇的解法，一開始完全想不到)</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ foremost -v miao\~.jpg
Foremost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick Mikus
Audit File

Foremost started at Sat Jul 15 15:21:29 2023
Invocation: foremost -v miao~.jpg
Output directory: /home/sbk6401/CTF/Adworld/Misc/miao~/output
Configuration file: /etc/foremost.conf
Processing: miao~.jpg
|------------------------------------------------------------------
File: miao~.jpg
Start: Sat Jul 15 15:21:29 2023
Length: 1 MB (1242752 bytes)

Num      Name (bs=512)         Size      File Offset     Comment

0:      00000000.jpg          55 KB               0
1:      00000111.wav           1 MB           57212
*|
Finish: Sat Jul 15 15:21:29 2023

2 FILES EXTRACTED

jpg:= 1
rif:= 1
------------------------------------------------------------------

Foremost finished at Sat Jul 15 15:21:29 2023
</code></pre><p>可以看到抓到其中有一個<code>.wav</code>檔案</p><a href=/security/practice/adworld/misc/adworld---miao~/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/adworld/misc/adworld---misc%E6%96%87%E4%BB%B6%E9%A1%9E%E5%9E%8B/>Adworld - Misc文件類型</a></h2><div class=text-small><a href=/tags/adworld/>Adworld</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=adworld---misc文件類型>Adworld - Misc文件類型
<a class=anchor href=#adworld---misc%e6%96%87%e4%bb%b6%e9%a1%9e%e5%9e%8b>#</a></h1><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><pre tabindex=0><code>3436455341425F554573444242514141
41414941416C64434658714F7737634B
4141414143594141414149414141415A
6D78685A7935306548524C79306C4D72
7A5A49536B303253457778546B6B304D
6A5130546A593353445531534573784E
544D3054374A494E552B7A7241554155
45734241685141464141414141674143
56304956656F374474776F414141414A
674141414167414A4141414141414141
414167414141414141414141475A7359
57637564486830436741674141414141
41414241426741477845666B39697132
41456245522B54324B725941514A462B
34725971746742554573464267414141
41414241414541576741414145344141
4141414141
</code></pre><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題有一點通靈，沒有很喜歡</p><ol><li>首先給的cipher很明顯是ascii的hex</li><li>轉換過後也很明顯是base64</li><li>在轉換過後，只有底線後面的部分要轉換成hex</li><li>如果把東西print出來的話會看到flag.txt的字樣，感覺上是一個file的byte code，到file signature去看會發現magic header是一個zip file，uncompress之後就會發現flag.txt
<img src=https://hackmd.io/_uploads/H10OlHGch.png alt></li></ol><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;3436455341425F55457344424251414141414941416C64434658714F7737634B4141414143594141414149414141415A6D78685A7935306548524C79306C4D727A5A49536B303253457778546B6B304D6A5130546A593353445531534573784E544D3054374A494E552B7A72415541554573424168514146414141414167414356304956656F374474776F414141414A674141414167414A4141414141414141414167414141414141414141475A73595763756448683043674167414141414141414241426741477845666B3969713241456245522B54324B725941514A462B34725971746742554573464267414141414142414145415767414141453441414141414141&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(cipher)<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;_&#34;</span>)[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64decode(cipher <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;==&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;./cipher.zip&#34;</span>, <span style=color:#e6db74>&#34;wb&#34;</span>)
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>write(cipher)
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> zipfile<span style=color:#f92672>.</span>ZipFile(<span style=color:#e6db74>&#39;./cipher.zip&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> zip_ref:
</span></span><span style=display:flex><span>    zip_ref<span style=color:#f92672>.</span>extractall(<span style=color:#e6db74>&#39;./&#39;</span>)
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;./flag.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>print(f)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python exp.py
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>0bec0ad3da2113c70e50fd5617b8e7f9<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://juejin.cn/post/7166166845395828772>XCTF-MISC-Misc文件類型</a></p><a href=/security/practice/adworld/misc/adworld---misc%E6%96%87%E4%BB%B6%E9%A1%9E%E5%9E%8B/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/adworld/misc/adworld---pure_color/>Adworld - pure_color</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a>,
<a href=/tags/adworld/>Adworld</a></div><p><h1 id=adworld---pure_color>Adworld - pure_color
<a class=anchor href=#adworld---pure_color>#</a></h1><h6 id=tags-adworld-ctf-misc>tags: <code>Adworld</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-adworld-ctf-misc>#</a></h6><p>Challenge: <a href="https://adworld.xctf.org.cn/challenges/details?hash=f216ffab-e01d-46b8-9d4d-d91ab5229eed_2&amp;task_category_id=1">https://adworld.xctf.org.cn/challenges/details?hash=f216ffab-e01d-46b8-9d4d-d91ab5229eed_2&task_category_id=1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://ithelp.ithome.com.tw/articles/10278407>【Day21】隱寫技術 Steganography</a>
<a href=https://blog.csdn.net/dyw_666666/article/details/88650738>图片隐写查看神器stegsolve使用方法</a>
<a href=https://github.com/zardus/ctf-tools/blob/master/stegsolve/install>zardus/ctf-tools - stegsolve</a></p><h2 id=exploit---basic-steganography>Exploit - Basic Steganography
<a class=anchor href=#exploit---basic-steganography>#</a></h2><p><img src=https://i.imgur.com/YnqxcmS.png alt></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/adworld/misc/adworld---%E5%BF%83%E5%84%80%E7%9A%84%E5%85%AC%E5%8F%B8/>Adworld - 心儀的公司</a></h2><div class=text-small><a href=/tags/adworld/>Adworld</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=adworld---心儀的公司>Adworld - 心儀的公司
<a class=anchor href=#adworld---%e5%bf%83%e5%84%80%e7%9a%84%e5%85%ac%e5%8f%b8>#</a></h1><h6 id=tags-adworld-ctf-misc>tags: <code>Adworld</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-adworld-ctf-misc>#</a></h6><p>Challenge: <a href="https://adworld.xctf.org.cn/challenges/details?hash=ed5d10bf-be47-4e61-b04e-3a9ccb73ff95_2&amp;task_category_id=1">https://adworld.xctf.org.cn/challenges/details?hash=ed5d10bf-be47-4e61-b04e-3a9ccb73ff95_2&task_category_id=1</a></p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><pre tabindex=0><code class=language-bash! data-lang=bash!>$ strings webshell.pcapng | grep &#34;{&#34;
...
fl4g:{ftop_Is_Waiting_4_y}
</code></pre><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://www.cnblogs.com/Flat-White/p/13526539.html>心仪的公司writeup</a>
<a href="https://www.bilibili.com/video/BV1r5411h7aw/?p=2&amp;share_source=copy_web&amp;vd_source=31529c2d248aba29c9cc1e3cbd720cb6&amp;t=294">【CTF视频合辑】MISC-流量分析题大集合(第一辑)</a></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/adworld/misc/adworld---%E9%81%A9%E5%90%88%E4%BD%9C%E7%82%BA%E6%A1%8C%E9%9D%A2/>Adworld - 適合作為桌面</a></h2><div class=text-small><a href=/tags/adworld/>Adworld</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=adworld---適合作為桌面>Adworld - 適合作為桌面
<a class=anchor href=#adworld---%e9%81%a9%e5%90%88%e4%bd%9c%e7%82%ba%e6%a1%8c%e9%9d%a2>#</a></h1><h6 id=tags-adworld-ctf-misc>tags: <code>Adworld</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-adworld-ctf-misc>#</a></h6><p>Challenge: <a href="https://adworld.xctf.org.cn/challenges/details?hash=7a4e06c0-811c-4493-a628-886dc5bd59b4_2&amp;task_category_id=1">適合作為桌面</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://ithelp.ithome.com.tw/articles/10185442>Day8 Python基礎-pyc是什麼</a></p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ol><li><p>Analyze Steganography
<img src=https://i.imgur.com/AwAHrxC.png alt></p></li><li><p><a href=https://products.aspose.app/barcode/recognize/qr#/recognized>QR Code Reader</a></p><pre tabindex=0><code class=language-! data-lang=!>03F30D0A79CB05586300000000000000000100000040000000730D0000006400008400005A000064010053280200000063000000000300000016000000430000007378000000640100640200640300640400640500640600640700640300640800640900640A00640600640B00640A00640700640800640C00640C00640D00640E00640900640F006716007D00006410007D0100781E007C0000445D16007D02007C01007400007C0200830100377D0100715500577C010047486400005328110000004E6966000000696C00000069610000006967000000697B000000693300000069380000006935000000693700000069300000006932000000693400000069310000006965000000697D000000740000000028010000007403000000636872280300000074030000007374727404000000666C6167740100000069280000000028000000007304000000312E7079520300000001000000730A0000000001480106010D0114014E280100000052030000002800000000280000000028000000007304000000312E707974080000003C6D6F64756C653E010000007300000000
</code></pre><p>It seems a byte code of a file.</p></li><li><p>HxD
<img src=https://i.imgur.com/ntC6hJ3.png alt>
It can be disassembled by pyc tools.</p></li><li><p><a href=https://tool.lu/pyc/><code>pyc</code> disassemble</a>
:::spoiler</p><pre tabindex=0><code class="language-python=" data-lang="python=">def flag():
    str = [
        102,
        108,
        97,
        103,
        123,
        51,
        56,
        97,
        53,
        55,
        48,
        51,
        50,
        48,
        56,
        53,
        52,
        52,
        49,
        101,
        55,
        125,
    ]
    flag = &#34;&#34;
    for i in str:
        flag += chr(i)
    print flag
</code></pre><p>:::</p><a href=/security/practice/adworld/misc/adworld---%E9%81%A9%E5%90%88%E4%BD%9C%E7%82%BA%E6%A1%8C%E9%9D%A2/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/nisra/misc/nisra---%E7%9C%8B%E4%B8%8D%E8%A6%8B%E7%9A%84%E5%9C%B0%E6%96%B9/>Background</a></h2><div class=text-small><a href=/tags/nisra/>NISRA</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=nisra---看不見的地方>NISRA - 看不見的地方
<a class=anchor href=#nisra---%e7%9c%8b%e4%b8%8d%e8%a6%8b%e7%9a%84%e5%9c%b0%e6%96%b9>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=/uwox6r5hQ6St_8G-4mv1_g>advanced-potion-making:two::+1:</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這題出的不錯，我用了所有方法都沒看到甚麼奇怪的東西，除了pngcheck</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ pngcheck flag.png
flag.png  CRC error in chunk IHDR (computed 68ff0ded, expected 8c5880da)
ERROR: flag.png 
</code></pre><p>代表檔案可能有一些問題
原圖：
<img src=https://hackmd.io/_uploads/SkwQ2IPu3.png alt></p><h2 id=exploit---recover-png-file>Exploit - Recover PNG File
<a class=anchor href=#exploit---recover-png-file>#</a></h2><ol><li><p>參考<a href=https://zhuanlan.zhihu.com/p/599657891>UP主的腳本</a>，可以直接寫出長寬</p><pre tabindex=0><code class=language-python! data-lang=python!>import zlib
import struct
import sys

filename = sys.argv[1]
with open(filename, &#39;rb&#39;) as f:
    all_b = f.read()
    crc32key = int(all_b[29:33].hex(),16)
    data = bytearray(all_b[12:29])
    n = 4095
    for w in range(n): 
        width = bytearray(struct.pack(&#39;&gt;i&#39;, w))
        for h in range(n):
            height = bytearray(struct.pack(&#39;&gt;i&#39;, h))
            for x in range(4):
                data[x+4] = width[x]
                data[x+8] = height[x]
            crc32result = zlib.crc32(data)
            if crc32result == crc32key:
                print(&#34;寬為：{}(hex), {}(int)&#34;.format(width.hex(), int(width.hex(), 16)))
                print(&#34;高為：{}(hex), {}(int)&#34;.format(height.hex(), int(height.hex(), 16)))
                exit(0)
</code></pre><pre tabindex=0><code class=language-bash! data-lang=bash!>$ python exp.py flag.png
寬為：00000258(hex), 600(int)
高為：00000148(hex), 328(int)
</code></pre><p><img src=https://hackmd.io/_uploads/rkLuiLwuh.png alt>
可以看得出來高的數值不一樣</p><a href=/security/practice/nisra/misc/nisra---%E7%9C%8B%E4%B8%8D%E8%A6%8B%E7%9A%84%E5%9C%B0%E6%96%B9/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/misc/crewctf---attaaaaack-1-13/>CrewCTF - Attaaaaack 1-13</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=crewctf---attaaaaack-1-13>CrewCTF - Attaaaaack 1-13
<a class=anchor href=#crewctf---attaaaaack-1-13>#</a></h1><p>:::spoiler TOC
[TOC]
:::</p><p>One of our employees at the company complained about suspicious behavior on the machine, our IR team took a memory dump from the machine and we need to investigate it.</p><h2 id=attaaaaack-1>==Attaaaaack 1==
<a class=anchor href=#attaaaaack-1>#</a></h2><blockquote><p>Q1. What is the best profile for the the machine?</p></blockquote><h3 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw imageinfo
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>INFO    : volatility.debug    : Determining profile based on KDBG search...
</span></span><span style=display:flex><span>          Suggested Profile<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86
</span></span><span style=display:flex><span>                     AS Layer1 : IA32PagedMemoryPae <span style=color:#f92672>(</span>Kernel AS<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                     AS Layer2 : FileAddressSpace <span style=color:#f92672>(</span>D:<span style=color:#ae81ff>\N</span>TU<span style=color:#ae81ff>\C</span>TF<span style=color:#ae81ff>\C</span>rewCTF<span style=color:#ae81ff>\M</span>isc<span style=color:#ae81ff>\A</span>ttaaaaack<span style=color:#ae81ff>\m</span>emdump.raw<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                      PAE type : PAE
</span></span><span style=display:flex><span>                           DTB : 0x185000L
</span></span><span style=display:flex><span>                          KDBG : 0x82b7ab78L
</span></span><span style=display:flex><span>          Number of Processors : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>     Image Type <span style=color:#f92672>(</span>Service Pack<span style=color:#f92672>)</span> : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                KPCR <span style=color:#66d9ef>for</span> CPU <span style=color:#ae81ff>0</span> : 0x80b96000L
</span></span><span style=display:flex><span>             KUSER_SHARED_DATA : 0xffdf0000L
</span></span><span style=display:flex><span>           Image date and time : 2023-02-20 19:10:54 UTC+0000
</span></span><span style=display:flex><span>     Image local date and time : 2023-02-20 21:10:54 +0200
</span></span></code></pre></div><p>Flag: <code>crew{Win7SP1x86_23418}</code></p><a href=/security/practice/crewctf/misc/crewctf---attaaaaack-1-13/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/misc/crewctf---encrypt10npart-1/>CrewCTF - Encrypt10n(Part 1)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=crewctf---encrypt10npart-1>CrewCTF - Encrypt10n(Part 1)
<a class=anchor href=#crewctf---encrypt10npart-1>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://github.com/volatilityfoundation/volatility3>Volatility 3</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ul><li>Description: We made a memory dump on the criminal machine after entering the crime scene. Our investigator thought he was using encryption software to hide the secret. can you help me to detect it?</li><li>Q1 : crew{password}
這種類型之前沒碰過，所以看了別人的WP學一下<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>
首先他有提到他有用加密的技術隱藏secret，所以我們的目的就是要找到password</li></ul><h2 id=exploit---memory-forensics>Exploit - Memory Forensics
<a class=anchor href=#exploit---memory-forensics>#</a></h2><ol><li>先找到運行的OS version或其他軟硬體資訊<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw imageinfo
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6.1
</span></span><span style=display:flex><span>INFO    : volatility.debug    : Determining profile based on KDBG search...
</span></span><span style=display:flex><span>          Suggested Profile<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86
</span></span><span style=display:flex><span>                     AS Layer1 : IA32PagedMemoryPae <span style=color:#f92672>(</span>Kernel AS<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                     AS Layer2 : FileAddressSpace <span style=color:#f92672>(</span>/mnt/d/Download/Trash/dump.raw<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                      PAE type : PAE
</span></span><span style=display:flex><span>                           DTB : 0x185000L
</span></span><span style=display:flex><span>                          KDBG : 0x82b3db78L
</span></span><span style=display:flex><span>          Number of Processors : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>     Image Type <span style=color:#f92672>(</span>Service Pack<span style=color:#f92672>)</span> : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                KPCR <span style=color:#66d9ef>for</span> CPU <span style=color:#ae81ff>0</span> : 0x839a5000L
</span></span><span style=display:flex><span>             KUSER_SHARED_DATA : 0xffdf0000L
</span></span><span style=display:flex><span>           Image date and time : 2023-02-16 12:03:16 UTC+0000
</span></span><span style=display:flex><span>     Image local date and time : 2023-02-16 14:03:16 +0200
</span></span></code></pre></div>重點: <code>Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86</code></li><li>列出當時系統正在運行的process<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw pslist --profile<span style=color:#f92672>=</span>Win7SP0x86
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6.1
</span></span><span style=display:flex><span>Offset<span style=color:#f92672>(</span>V<span style=color:#f92672>)</span>  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit
</span></span><span style=display:flex><span>---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
</span></span><span style=display:flex><span>0x8413a938 System                    <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>88</span>      <span style=color:#ae81ff>520</span> ------      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:48 UTC+0000
</span></span><span style=display:flex><span>0x84e481c8 smss.exe                <span style=color:#ae81ff>252</span>      <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>29</span> ------      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:49 UTC+0000
</span></span><span style=display:flex><span>0x84cae358 csrss.exe               <span style=color:#ae81ff>340</span>    <span style=color:#ae81ff>324</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>550</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:53 UTC+0000
</span></span><span style=display:flex><span>0x844ea030 wininit.exe             <span style=color:#ae81ff>392</span>    <span style=color:#ae81ff>324</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>77</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x84ef5030 csrss.exe               <span style=color:#ae81ff>400</span>    <span style=color:#ae81ff>384</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>223</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x8573dd20 winlogon.exe            <span style=color:#ae81ff>456</span>    <span style=color:#ae81ff>384</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>114</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x85749868 services.exe            <span style=color:#ae81ff>496</span>    <span style=color:#ae81ff>392</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>228</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x85763030 lsass.exe               <span style=color:#ae81ff>508</span>    <span style=color:#ae81ff>392</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>578</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:55 UTC+0000
</span></span><span style=display:flex><span>0x85764030 lsm.exe                 <span style=color:#ae81ff>516</span>    <span style=color:#ae81ff>392</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>149</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:55 UTC+0000
</span></span><span style=display:flex><span>0x857bd510 svchost.exe             <span style=color:#ae81ff>624</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>362</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x85809510 svchost.exe             <span style=color:#ae81ff>704</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>298</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x85859920 svchost.exe             <span style=color:#ae81ff>784</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>23</span>      <span style=color:#ae81ff>510</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x8586da80 svchost.exe             <span style=color:#ae81ff>832</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>265</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x85872bb0 svchost.exe             <span style=color:#ae81ff>856</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>22</span>      <span style=color:#ae81ff>731</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x85875460 svchost.exe             <span style=color:#ae81ff>880</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>47</span>     <span style=color:#ae81ff>1013</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x8588f370 audiodg.exe             <span style=color:#ae81ff>960</span>    <span style=color:#ae81ff>784</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>132</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x858c2420 svchost.exe            <span style=color:#ae81ff>1092</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>389</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:58 UTC+0000
</span></span><span style=display:flex><span>0x857d6030 spoolsv.exe            <span style=color:#ae81ff>1288</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>270</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857d1030 dwm.exe                <span style=color:#ae81ff>1296</span>    <span style=color:#ae81ff>832</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>114</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857c7030 svchost.exe            <span style=color:#ae81ff>1324</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>21</span>      <span style=color:#ae81ff>310</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857a5d20 explorer.exe           <span style=color:#ae81ff>1384</span>   <span style=color:#ae81ff>1276</span>     <span style=color:#ae81ff>33</span>      <span style=color:#ae81ff>923</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857c4d20 taskhost.exe           <span style=color:#ae81ff>1400</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>197</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x85837898 svchost.exe            <span style=color:#ae81ff>1560</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>146</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:00 UTC+0000
</span></span><span style=display:flex><span>0x841d1030 VGAuthService.         <span style=color:#ae81ff>1720</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>85</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:01 UTC+0000
</span></span><span style=display:flex><span>0x841d7118 vmtoolsd.exe           <span style=color:#ae81ff>1736</span>   <span style=color:#ae81ff>1384</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>181</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:02 UTC+0000
</span></span><span style=display:flex><span>0x85856030 vm3dservice.ex         <span style=color:#ae81ff>1836</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>5</span>       <span style=color:#ae81ff>60</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x85857d20 vmtoolsd.exe           <span style=color:#ae81ff>1856</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>291</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x841e5678 vm3dservice.ex         <span style=color:#ae81ff>1880</span>   <span style=color:#ae81ff>1836</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>44</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x85a26030 svchost.exe             <span style=color:#ae81ff>384</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>8</span>       <span style=color:#ae81ff>93</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85a6e5d0 dllhost.exe             <span style=color:#ae81ff>876</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>21</span>      <span style=color:#ae81ff>191</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85941c28 dllhost.exe            <span style=color:#ae81ff>1744</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>200</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85ab6260 msdtc.exe              <span style=color:#ae81ff>1128</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>154</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:06 UTC+0000
</span></span><span style=display:flex><span>0x85ac8b00 WmiPrvSE.exe            <span style=color:#ae81ff>232</span>    <span style=color:#ae81ff>624</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>193</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:06 UTC+0000
</span></span><span style=display:flex><span>0x841f4470 SearchIndexer.         <span style=color:#ae81ff>2148</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>604</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:08 UTC+0000
</span></span><span style=display:flex><span>0x85b2a030 VSSVC.exe              <span style=color:#ae81ff>2276</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>118</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:11 UTC+0000
</span></span><span style=display:flex><span>0x85b80cb8 SearchProtocol         <span style=color:#ae81ff>2372</span>   <span style=color:#ae81ff>2148</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>284</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:13 UTC+0000
</span></span><span style=display:flex><span>0x85b855f8 SearchFilterHo         <span style=color:#ae81ff>2392</span>   <span style=color:#ae81ff>2148</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>104</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:13 UTC+0000
</span></span><span style=display:flex><span>0x85b97d20 svchost.exe            <span style=color:#ae81ff>2480</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>232</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:15 UTC+0000
</span></span><span style=display:flex><span>0x85bc5398 wmpnetwk.exe           <span style=color:#ae81ff>2632</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>212</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:16 UTC+0000
</span></span><span style=display:flex><span>0x85bba030 WmiPrvSE.exe           <span style=color:#ae81ff>2860</span>    <span style=color:#ae81ff>624</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>319</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:25 UTC+0000
</span></span><span style=display:flex><span>0x85c53030 WmiApSrv.exe           <span style=color:#ae81ff>3004</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>112</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:30 UTC+0000
</span></span><span style=display:flex><span>0x85c596c0 TrueCrypt.exe          <span style=color:#ae81ff>3196</span>   <span style=color:#ae81ff>1384</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>67</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:02:07 UTC+0000
</span></span><span style=display:flex><span>0x84d54d20 sppsvc.exe             <span style=color:#ae81ff>3736</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>154</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:05 UTC+0000
</span></span><span style=display:flex><span>0x84d567f0 svchost.exe            <span style=color:#ae81ff>3776</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>353</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:05 UTC+0000
</span></span><span style=display:flex><span>0x844fcd20 DumpIt.exe             <span style=color:#ae81ff>4072</span>   <span style=color:#ae81ff>1384</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>38</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:14 UTC+0000
</span></span><span style=display:flex><span>0x844ba6e0 conhost.exe            <span style=color:#ae81ff>4080</span>    <span style=color:#ae81ff>400</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>51</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:14 UTC+0000
</span></span></code></pre></div>重點：<code>0x85c596c0 TrueCrypt.exe 3196 1384 2 67 1 0 2023-02-16 12:02:07 UTC+0000</code>
<a href=https://zh.wikipedia.org/zh-tw/TrueCrypt>TrueCrypt - Wiki</a><blockquote><p>TrueCrypt是一款已停止開發的動態（On-the-fly）磁碟加密軟體，支援Windows、macOS和Linux作業系統。它可在單個檔案和磁碟分割區中建立加密區，也可以加密整個作業系統，解密後使用者即可像普通分割區一樣使用其中的檔案。TrueCrypt支援使用密碼、金鑰檔案作為解密憑據。</p><a href=/security/practice/crewctf/misc/crewctf---encrypt10npart-1/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/misc/crewctf---encrypt10npart-2/>CrewCTF - Encrypt10n(Part 2)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=crewctf---encrypt10npart-2>CrewCTF - Encrypt10n(Part 2)
<a class=anchor href=#crewctf---encrypt10npart-2>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://kenfavors.com/code/how-to-open-a-truecrypt-container-using-cryptsetup/>How To Open A TrueCrypt Container Using cryptsetup</a></p><blockquote><p><code>$ sudo cryptsetup --type tcrypt open container-to-mount container-name</code></p></blockquote><p><a href=https://blog.51cto.com/majesty/991565>什麽是塊設備，什麽是字符設備？有什麽區別？</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題應該是沿用part 1得到的密碼進行解密</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ol><li><p>用<code>cryptsetup</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>先進行解密</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo cryptsetup --type tcrypt open flag flag_decrypt
</span></span><span style=display:flex><span>Enter passphrase <span style=color:#66d9ef>for</span> flag:
</span></span></code></pre></div><p>則輸出的結果就是一個container儲存在<code>/dev/mapper</code>，可以看到它是一個block device</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ll /dev/mapper
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>2</span> root root       <span style=color:#ae81ff>80</span> Jul <span style=color:#ae81ff>12</span> 21:44 .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>11</span> root root     <span style=color:#ae81ff>3140</span> Jul <span style=color:#ae81ff>12</span> 21:44 ..
</span></span><span style=display:flex><span>crw-------  <span style=color:#ae81ff>1</span> root root  10, <span style=color:#ae81ff>236</span> Jul <span style=color:#ae81ff>11</span> 23:06 control
</span></span><span style=display:flex><span>brw-rw----  <span style=color:#ae81ff>1</span> root disk 252,   <span style=color:#ae81ff>3</span> Jul <span style=color:#ae81ff>12</span> 21:44 flag_dec
</span></span></code></pre></div></li><li><p>再來就要把這個container掛起來，要掛起來才能讀取裡面的資料</p><a href=/security/practice/crewctf/misc/crewctf---encrypt10npart-2/>...</a></p></article><ul class="pagination pagination-default"><li class="page-item disabled"><a aria-disabled=true aria-label=First class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Previous class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a aria-current=page aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/tags/misc/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/tags/misc/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/misc/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/tags/misc/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/tags/misc/page/2/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/misc/page/5/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>