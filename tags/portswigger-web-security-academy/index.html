<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/portswigger-web-security-academy/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Portswigger Web Security Academy"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Portswigger Web Security Academy | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/portswigger-web-security-academy/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/portswigger-web-security-academy/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Portswigger Web Security Academy</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/csrf/csrf---apprentice/>CSRF - APPRENTICE</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=csrf---apprentice>CSRF - APPRENTICE
<a class=anchor href=#csrf---apprentice>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><p>[TOC]</p><h2 id=lab-csrf-vulnerability-with-no-defenses>Lab: CSRF vulnerability with no defenses
<a class=anchor href=#lab-csrf-vulnerability-with-no-defenses>#</a></h2><ul><li>Description: This lab&rsquo;s email change functionality is vulnerable to CSRF.</li><li>Goal: To solve the lab, craft some HTML that uses a CSRF attack to change the viewer&rsquo;s email address and upload it to your exploit server.
You can log in to your own account using the following credentials: <code>wiener:peter</code></li><li>Hint: You cannot register an email address that is already taken by another user. If you change your own email address while testing your exploit, make sure you use a different email address for the final exploit you deliver to the victim.</li></ul><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>:::spoiler
<a href=https://medium.com/@Tommmmm/csrf-%e6%94%bb%e6%93%8a%e5%8e%9f%e7%90%86-d0f2a51810ca>CSRF 攻擊原理</a>
<a href=https://ithelp.ithome.com.tw/articles/10251769>[Day25]- 新手的Web系列CSRF</a></p><a href=/security/practice/portswigger-web-security-academy/csrf/csrf---apprentice/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/deserialization/deserialization---apprentice/>Deserialization - APPRENTICE</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=deserialization---apprentice>Deserialization - APPRENTICE
<a class=anchor href=#deserialization---apprentice>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><h2 id=lab-modifying-serialized-objects>Lab: Modifying serialized objects
<a class=anchor href=#lab-modifying-serialized-objects>#</a></h2><ul><li>Description: This lab uses a serialization-based session mechanism and is vulnerable to privilege escalation as a result.</li><li>Goal: To solve the lab, edit the serialized object in the session cookie to exploit this vulnerability and gain administrative privileges. Then, delete Carlos&rsquo;s account.
You can log in to your own account using the following credentials: wiener:peter</li></ul><h3 id=recon>Recon
<a class=anchor href=#recon>#</a></h3><ol><li>Login First & Recon the package
According to the description, we know that the user verification has insecure deserialization. Therefore, we can recon the package first as below.
<img src=https://i.imgur.com/zuKHXRF.png alt>
You can notice the session is a base64-encoded string and we use the built-in feature in burp suite to decode it.
Session: <code>Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czo1OiJhZG1pbiI7YjowO30%3d</code>
Decoded String: <code>O:4:"User":2:{s:8:"username";s:6:"wiener";s:5:"admin";b:0;}</code></li><li>How about Modify the session directly
<img src=https://i.imgur.com/Ent5yuu.png alt></li></ol><h3 id=exp---change-directly>Exp - Change Directly
<a class=anchor href=#exp---change-directly>#</a></h3><ol><li>We can use the built-in feature to change our session to <code>admin=1</code> directly to then send it forward.
:::info
Each package may contain the session that should be modified. So, pay attention to before sending it forward
:::</li><li>Delete Carlos
<img src=https://i.imgur.com/9KGxgZD.png alt></li></ol><p>:::spoiler Success Screenshot
<img src=https://i.imgur.com/eQEfiaw.png alt>
:::</p><a href=/security/practice/portswigger-web-security-academy/deserialization/deserialization---apprentice/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/deserialization/lab_-arbitrary-object-injection-in-php/>Lab: Arbitrary object injection in PHP</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=lab-arbitrary-object-injection-in-php>Lab: Arbitrary object injection in PHP
<a class=anchor href=#lab-arbitrary-object-injection-in-php>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li>Description: This lab uses a serialization-based session mechanism and is vulnerable to arbitrary object injection as a result.</li><li>Goal: To solve the lab, create and inject a malicious serialized object to delete the morale.txt file from Carlos&rsquo;s home directory. You will need to obtain source code access to solve this lab.
You can log in to your own account using the following credentials: wiener:peter</li><li>Hint: You can sometimes read source code by appending a tilde (~) to a filename to retrieve an editor-generated backup file.</li></ul><h2 id=constructor--deconstructor>Constructor & Deconstructor
<a class=anchor href=#constructor--deconstructor>#</a></h2><p><a href=https://tw511.com/a/01/26451.html>Python建構函式與解構函式（<strong>init</strong>()和__del__()）</a>
其實概念就是Python的<code>__init()__</code> function，在instanciate一個class的時候扮演初始化的功能而已
而deconstructor就是Python中的<code>__del__()</code> function用來回收不需要的class，以達到降低記憶體的使用量</p><a href=/security/practice/portswigger-web-security-academy/deserialization/lab_-arbitrary-object-injection-in-php/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction/>Lab: Blind XXE with out-of-band interaction</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=lab-blind-xxe-with-out-of-band-interaction>Lab: Blind XXE with out-of-band interaction
<a class=anchor href=#lab-blind-xxe-with-out-of-band-interaction>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li>Description: This lab has a &ldquo;Check stock&rdquo; feature that parses XML input but does not display the result.
You can detect the blind XXE vulnerability by triggering out-of-band interactions with an external domain.</li><li>Goal: To solve the lab, use an external entity to make the XML parser issue a DNS lookup and HTTP request to Burp Collaborator.</li><li>Hint:</li></ul><h2 id=background><a href=https://portswigger.net/web-security/xxe/blind>Background</a>
<a class=anchor href=#background>#</a></h2><blockquote><p>有兩種廣泛的方法可以找到和利用Blind XXE 漏洞：</p><a href=/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities/>Lab: Blind XXE with out-of-band interaction via XML parameter entities</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=lab-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities>Lab: Blind XXE with out-of-band interaction via XML parameter entities
<a class=anchor href=#lab-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li>Description: This lab has a &ldquo;Check stock&rdquo; feature that parses XML input, but does not display any unexpected values, and blocks requests containing regular external entities.</li><li>Goal: To solve the lab, use a parameter entity to make the XML parser issue a DNS lookup and HTTP request to Burp Collaborator.</li><li>Hint: To prevent the Academy platform being used to attack third parties, our firewall blocks interactions between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator&rsquo;s default public server.</li></ul><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>這一題會用到Parameter Entity，也就是當server端擋掉外部的entity輸入時，可以直接在<code>DOCTYPE</code>中直接Reference，也就是利用<code>%</code>這個字元達到這個效果</p><a href=/security/practice/portswigger-web-security-academy/xxe/blind-xxe/lab_-blind-xxe-with-out-of-band-interaction-via-xml-parameter-entities/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-is-not-tied-to-user-session/>Lab: CSRF where token is not tied to user session</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=lab-csrf-where-token-is-not-tied-to-user-session>Lab: CSRF where token is not tied to user session
<a class=anchor href=#lab-csrf-where-token-is-not-tied-to-user-session>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li>Description: This lab&rsquo;s email change functionality is vulnerable to CSRF. It uses tokens to try to prevent CSRF attacks, but they aren&rsquo;t integrated into the site&rsquo;s session handling system.</li><li>Goal: To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer&rsquo;s email address.
You have two accounts on the application that you can use to help design your attack. The credentials are as follows:
<code>wiener:peter</code>
<code>carlos:montoya</code></li></ul><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>CSRF token should tied to user session otherwise, it&rsquo;ll exploited by attacker.</p><a href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-is-not-tied-to-user-session/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/csrf/not-complete/lab_-csrf-where-token-is-tied-to-non-session-cookie/>Lab: CSRF where token is tied to non-session cookie</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=lab-csrf-where-token-is-tied-to-non-session-cookie>Lab: CSRF where token is tied to non-session cookie
<a class=anchor href=#lab-csrf-where-token-is-tied-to-non-session-cookie>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li><p>Description: This lab&rsquo;s email change functionality is vulnerable to CSRF. It uses tokens to try to prevent CSRF attacks, but they aren&rsquo;t fully integrated into the site&rsquo;s session handling system.</p></li><li><p>Goal: To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer&rsquo;s email address.
You have two accounts on the application that you can use to help design your attack. The credentials are as follows:
<code>wiener:peter</code>
<code>carlos:montoya</code></p><a href=/security/practice/portswigger-web-security-academy/csrf/not-complete/lab_-csrf-where-token-is-tied-to-non-session-cookie/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-validation-depends-on-request-method/>Lab: CSRF where token validation depends on request method</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=lab-csrf-where-token-validation-depends-on-request-method>Lab: CSRF where token validation depends on request method
<a class=anchor href=#lab-csrf-where-token-validation-depends-on-request-method>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li>Description: This lab&rsquo;s email change functionality is vulnerable to CSRF. It attempts to block CSRF attacks, but only applies defenses to certain types of requests.</li><li>Goal: To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer&rsquo;s email address.
You can log in to your own account using the following credentials: <code>wiener:peter</code></li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ol><li><p>Login and update email to trace the package
Like the previous lab, we first login to the website and update the email. At the same time, we can trace update email package shown below:
<img src=https://i.imgur.com/ju0fDUQ.png alt>
We can notice that the carried data including <code>csrf_token</code></p><a href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-validation-depends-on-request-method/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-validation-depends-on-token-being-present/>Lab: CSRF where token validation depends on token being present</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=lab-csrf-where-token-validation-depends-on-token-being-present>Lab: CSRF where token validation depends on token being present
<a class=anchor href=#lab-csrf-where-token-validation-depends-on-token-being-present>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li>Description: This lab&rsquo;s email change functionality is vulnerable to CSRF.</li><li>Goal: To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer&rsquo;s email address.
You can log in to your own account using the following credentials: <code>wiener:peter</code></li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ol><li><p>Login and update email to trace the package
It&rsquo;s very similar with previous lab $\to$ it contained <code>CSRF_token</code> as its carried data:
<img src=https://i.imgur.com/69FaW1R.png alt></p><a href=/security/practice/portswigger-web-security-academy/csrf/%E9%87%9D%E5%B0%8Dcsrf-token%E8%88%87%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96%E7%9A%84%E7%B9%9E%E9%81%8E%E6%89%8B%E6%AE%B5/lab_-csrf-where-token-validation-depends-on-token-being-present/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/portswigger-web-security-academy/xss/lab_-dom-xss-in-document.write-sink-using-source-location.search-inside-a-select-element/>Lab: DOM XSS in `document.write` sink using source `location.search` inside a select element</a></h2><div class=text-small><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=lab-dom-xss-in-documentwrite-sink-using-source-locationsearch-inside-a-select-element>Lab: DOM XSS in <code>document.write</code> sink using source <code>location.search</code> inside a select element
<a class=anchor href=#lab-dom-xss-in-documentwrite-sink-using-source-locationsearch-inside-a-select-element>#</a></h1><h6 id=tags-portswigger-web-security-academy-web>tags: <code>Portswigger Web Security Academy</code> <code>Web</code>
<a class=anchor href=#tags-portswigger-web-security-academy-web>#</a></h6><ul><li>Description: This lab contains a DOM-based cross-site scripting vulnerability in the stock checker functionality. It uses the JavaScript <code>document.write</code> function, which writes data out to the page. The <code>document.write</code> function is called with data from <code>location.search</code> which you can control using the website URL. The data is enclosed within a select element.</li><li>Goal: To solve this lab, perform a cross-site scripting attack that breaks out of the select element and calls the <code>alert</code> function.</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ol><li>Find the injection place
I used string search to find <code>location.search</code> in each sub-page source.
Here is the interesting code:
:::spoiler Source Code<pre tabindex=0><code class=language-javascript! data-lang=javascript!>...
&lt;script&gt;
    var stores = [&#34;London&#34;,&#34;Paris&#34;,&#34;Milan&#34;];
    var store = (new URLSearchParams(window.location.search)).get(&#39;storeId&#39;);
    document.write(&#39;&lt;select name=&#34;storeId&#34;&gt;&#39;);
    if(store) {
        document.write(&#39;&lt;option selected&gt;&#39;+store+&#39;&lt;/option&gt;&#39;);
    }
    for(var i=0;i&lt;stores.length;i++) {
        if(stores[i] === store) {
            continue;
        }
        document.write(&#39;&lt;option&gt;&#39;+stores[i]+&#39;&lt;/option&gt;&#39;);
    }
    document.write(&#39;&lt;/select&gt;&#39;);
&lt;/script&gt;
...
</code></pre>:::</li><li>Try type something about <code>storeID</code> as URL GET parameter
Payload: <code>/product?productId=1&amp;storeId=abc</code>
<img src=https://i.imgur.com/KKbTF8f.png alt>
You can see that this is a perfect injection place</li></ol><h2 id=exp>Exp
<a class=anchor href=#exp>#</a></h2><p>Payload: <code>/product?productId=1&amp;storeId=&lt;script>alert(123);&lt;/script></code>
:::spoiler Success Screenshot
<img src=https://i.imgur.com/bjEoUzh.png alt>
:::</p><a href=/security/practice/portswigger-web-security-academy/xss/lab_-dom-xss-in-document.write-sink-using-source-location.search-inside-a-select-element/>...</a></p></article><ul class="pagination pagination-default"><li class="page-item disabled"><a aria-disabled=true aria-label=First class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Previous class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a aria-current=page aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/tags/portswigger-web-security-academy/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/tags/portswigger-web-security-academy/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/portswigger-web-security-academy/page/2/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/portswigger-web-security-academy/page/3/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>