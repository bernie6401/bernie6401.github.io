<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ctf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CTF"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>CTF | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ctf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ctf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CTF</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/competition/balsnctf-2023/>BalsnCTF 2023</a></h2><div class=text-small><a href=/tags/balsnctf/>BalsnCTF</a>,
<a href=/tags/ctf/>CTF</a></div><p><h1 id=balsnctf-2023>BalsnCTF 2023
<a class=anchor href=#balsnctf-2023>#</a></h1><h2 id=reverse>Reverse
<a class=anchor href=#reverse>#</a></h2><h3 id=lucky>Lucky
<a class=anchor href=#lucky>#</a></h3><h4 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h4><p>:::spoiler IDA Main Function</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp=">__int64 main_fn()
{
  __int64 idx; // r15
  int v1; // ebp
  __int64 v2; // rbx
  unsigned __int64 v3; // r14
  int v4; // r9d
  int v5; // r9d
  char v6; // al
  __int64 v7; // rdx
  unsigned int v9; // [rsp+Ch] [rbp-9Ch] BYREF
  char v10[32]; // [rsp+10h] [rbp-98h] BYREF
  __int128 user_input[2]; // [rsp+30h] [rbp-78h] BYREF
  __int64 v12; // [rsp+50h] [rbp-58h]
  char v13; // [rsp+58h] [rbp-50h]
  unsigned __int64 v14; // [rsp+68h] [rbp-40h]

  idx = 10000000000000000LL;
  v1 = 0;
  v14 = __readfsqword(0x28u);
  v2 = sub_40C2B0(&#34;/dev/urandom&#34;, &amp;unk_498004);
  do
  {
    sub_40C3B0(&amp;v9, 4uLL, 1LL, v2);
    v3 = v9 % 100000000uLL;
    sub_40C3B0(&amp;v9, 4uLL, 1LL, v2);
    v1 -= (v3 * v3 + v9 % 100000000uLL * (v9 % 100000000uLL) &gt; 9999999999999999LL) - 1;
    --idx;
  }
  while ( idx );
  sub_44A050(v10, 1u, 30LL, &#34;%lu&#34;, 4 * v1 - 0x4F430000, v4);
  v13 = 0;
  v6 = 0x73;
  v12 = 0LL;
  memset(user_input, 0, sizeof(user_input));
  while ( 1 )
  {
    v7 = idx &amp; 0xF;
    *(user_input + idx++) = v10[v7] ^ v6;
    if ( idx == 40 )
      break;
    v6 = byte_498040[idx];
  }
  if ( LOBYTE(user_input[0]) == &#39;B&#39; &amp;&amp; *(user_input + 1) == &#39;NSLA&#39; &amp;&amp; BYTE5(user_input[0]) == &#39;{&#39; &amp;&amp; HIBYTE(v12) == &#39;}&#39; )
    sub_44A130(1, &#34;Lucky! flag is %s\n&#34;, user_input, byte_498040, user_input, v5);
  else
    (sub_40C4B0)(&#34;Not so lucky ...&#34;, 1LL, v7, byte_498040, user_input);
  if ( v14 != __readfsqword(0x28u) )
    (sub_44A220)();
  return 0LL;
}
</code></pre><p>:::</p><a href=/security/competition/balsnctf-2023/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/competition/cggc-2023-%E5%88%9D%E8%B3%BD/>CGGC 2023 初賽</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/cggc/>CGGC</a></div><p><h1 id=cggc-2023-初賽>CGGC 2023 初賽
<a class=anchor href=#cggc-2023-%e5%88%9d%e8%b3%bd>#</a></h1><ul><li>隊名: 王凡補習班</li><li>名次
<img src=https://hackmd.io/_uploads/ryb_H_FrT.png alt=圖片>
這一次參賽雖然打出來的不多，但重點還是有學到很多東西，感謝@davidchen學長帶我飛，我覺得互相交流之後的這種隱形的貢獻也是很重要的</li></ul><h2 id=gaoyi>GaoYi
<a class=anchor href=#gaoyi>#</a></h2><h3 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h3><p>:::spoiler IDA main function</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#66d9ef>__cdecl</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>envp)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#75715e>// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-&#34;+&#34; TO EXPAND]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  setvbuf(stdout, <span style=color:#ae81ff>0LL</span>, <span style=color:#ae81ff>2LL</span>, <span style=color:#ae81ff>0LL</span>);
</span></span><span style=display:flex><span>  puts(TITLE);
</span></span><span style=display:flex><span>  puts(<span style=color:#e6db74>&#34;Welcome to the Charitable Lag Vegas!&#34;</span>);
</span></span><span style=display:flex><span>  puts(<span style=color:#e6db74>&#34;Anyone can participate with three million US dollars.&#34;</span>);
</span></span><span style=display:flex><span>  puts(<span style=color:#e6db74>&#34;You play with 52 cards with (S)pades, (C)lub, (H)earts, (D)iamond.&#34;</span>);
</span></span><span style=display:flex><span>  puts(<span style=color:#e6db74>&#34;[+] Game 1: Predict the first 8 cards I draw in exact order.&#34;</span>);
</span></span><span style=display:flex><span>  puts(<span style=color:#e6db74>&#34;[+] Input example: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>C8</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>.&#34;</span>);
</span></span><span style=display:flex><span>  v47 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> ( i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>7</span>; <span style=color:#f92672>++</span>i )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    printf((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)<span style=color:#e6db74>&#34;Card %c: &#34;</span>, i <span style=color:#f92672>+</span> <span style=color:#ae81ff>49</span>, v3, v4, v5, v6, flag[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    fgets(<span style=color:#f92672>&amp;</span>input[<span style=color:#ae81ff>32</span> <span style=color:#f92672>*</span> i], <span style=color:#ae81ff>32LL</span>, stdin);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>!</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)isACard((<span style=color:#66d9ef>__int64</span>)<span style=color:#f92672>&amp;</span>input[<span style=color:#ae81ff>32</span> <span style=color:#f92672>*</span> i]) )
</span></span><span style=display:flex><span>      <span style=color:#f92672>--</span>v47;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> ( j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>7</span>; <span style=color:#f92672>++</span>j )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span>)j_strlen_ifunc(<span style=color:#f92672>&amp;</span>input[<span style=color:#ae81ff>32</span> <span style=color:#f92672>*</span> j]) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      v7 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>224</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;H&#39;</span>;
</span></span><span style=display:flex><span>      v8 <span style=color:#f92672>=</span> <span style=color:#f92672>!</span>j <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;0&#39;</span>;
</span></span><span style=display:flex><span>      v9 <span style=color:#f92672>=</span> v8 <span style=color:#f92672>+</span> v7;
</span></span><span style=display:flex><span>      v10 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>32</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;S&#39;</span>;
</span></span><span style=display:flex><span>      v11 <span style=color:#f92672>=</span> v10 <span style=color:#f92672>+</span> v9;
</span></span><span style=display:flex><span>      v12 <span style=color:#f92672>=</span> <span style=color:#f92672>!</span>j <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;H&#39;</span>;
</span></span><span style=display:flex><span>      v13 <span style=color:#f92672>=</span> v12 <span style=color:#f92672>+</span> v11;
</span></span><span style=display:flex><span>      v14 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>33</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;2&#39;</span>;
</span></span><span style=display:flex><span>      v15 <span style=color:#f92672>=</span> v14 <span style=color:#f92672>+</span> v13;
</span></span><span style=display:flex><span>      v16 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>129</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;7&#39;</span>;
</span></span><span style=display:flex><span>      v17 <span style=color:#f92672>=</span> v16 <span style=color:#f92672>+</span> v15;
</span></span><span style=display:flex><span>      v18 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;C&#39;</span>;
</span></span><span style=display:flex><span>      v19 <span style=color:#f92672>=</span> v18 <span style=color:#f92672>+</span> v17;
</span></span><span style=display:flex><span>      v20 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>96</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;S&#39;</span>;
</span></span><span style=display:flex><span>      v21 <span style=color:#f92672>=</span> v20 <span style=color:#f92672>+</span> v19;
</span></span><span style=display:flex><span>      v22 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>6</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>192</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;H&#39;</span>;
</span></span><span style=display:flex><span>      v23 <span style=color:#f92672>=</span> v22 <span style=color:#f92672>+</span> v21;
</span></span><span style=display:flex><span>      v24 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>65</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;8&#39;</span>;
</span></span><span style=display:flex><span>      v25 <span style=color:#f92672>=</span> v24 <span style=color:#f92672>+</span> v23;
</span></span><span style=display:flex><span>      v26 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>97</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;5&#39;</span>;
</span></span><span style=display:flex><span>      v27 <span style=color:#f92672>=</span> v26 <span style=color:#f92672>+</span> v25;
</span></span><span style=display:flex><span>      v28 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>160</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;S&#39;</span>;
</span></span><span style=display:flex><span>      v29 <span style=color:#f92672>=</span> v28 <span style=color:#f92672>+</span> v27;
</span></span><span style=display:flex><span>      v30 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>128</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;S&#39;</span>;
</span></span><span style=display:flex><span>      v31 <span style=color:#f92672>=</span> v30 <span style=color:#f92672>+</span> v29;
</span></span><span style=display:flex><span>      v32 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>161</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;A&#39;</span>;
</span></span><span style=display:flex><span>      v33 <span style=color:#f92672>=</span> v32 <span style=color:#f92672>+</span> v31;
</span></span><span style=display:flex><span>      v34 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>6</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>193</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;2&#39;</span>;
</span></span><span style=display:flex><span>      v35 <span style=color:#f92672>=</span> v34 <span style=color:#f92672>+</span> v33;
</span></span><span style=display:flex><span>      v36 <span style=color:#f92672>=</span> j <span style=color:#f92672>==</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>&amp;&amp;</span> input[<span style=color:#ae81ff>225</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;A&#39;</span>;
</span></span><span style=display:flex><span>      v44 <span style=color:#f92672>=</span> v35 <span style=color:#f92672>+</span> v36;
</span></span><span style=display:flex><span>      v47 <span style=color:#f92672>+=</span> v35 <span style=color:#f92672>+</span> v36;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>--</span>v47;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( v47 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>15</span> )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;[+] Stage 2: Predict the final card I draw.&#34;</span>);
</span></span><span style=display:flex><span>    fgets(flag, <span style=color:#ae81ff>32LL</span>, stdin);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)isACard((<span style=color:#66d9ef>__int64</span>)flag)
</span></span><span style=display:flex><span>      <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span>)j_strlen_ifunc(flag) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&amp;&amp;</span> flag[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;H&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&amp;&amp;</span> flag[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;2&#39;</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      printf((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)<span style=color:#e6db74>&#34;Congrats! Here is your flag: &#34;</span>, <span style=color:#ae81ff>32</span>, v38, v39, v40, v41, flag[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>      readFlag();
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      puts(<span style=color:#e6db74>&#34;You failed.&#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;You failed.&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><a href=/security/competition/cggc-2023-%E5%88%9D%E8%B3%BD/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/bad/crewctf---_-1_-questions/>CrewCTF - :-1: Questions</a></h2><div class=text-small><a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/ctf/>CTF</a></div><p><h1 id=challenge-findme>Challenge: findme
<a class=anchor href=#challenge-findme>#</a></h1><h2 id=source>Source
<a class=anchor href=#source>#</a></h2><p>:::spoiler
<img src=https://hackmd.io/_uploads/HkL1AbiKn.png alt>
:::</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題就只是找一張照片的經緯度，不二法門就是慢慢找，真TM累</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><p>Flag: <code>crew{35.6682,138.5699}</code></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/misc/crewctf---attaaaaack-1-13/>CrewCTF - Attaaaaack 1-13</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=crewctf---attaaaaack-1-13>CrewCTF - Attaaaaack 1-13
<a class=anchor href=#crewctf---attaaaaack-1-13>#</a></h1><p>:::spoiler TOC
[TOC]
:::</p><p>One of our employees at the company complained about suspicious behavior on the machine, our IR team took a memory dump from the machine and we need to investigate it.</p><h2 id=attaaaaack-1>==Attaaaaack 1==
<a class=anchor href=#attaaaaack-1>#</a></h2><blockquote><p>Q1. What is the best profile for the the machine?</p></blockquote><h3 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ volatility_2.6_win64_standalone.exe -f memdump.raw imageinfo
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style=display:flex><span>INFO    : volatility.debug    : Determining profile based on KDBG search...
</span></span><span style=display:flex><span>          Suggested Profile<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86
</span></span><span style=display:flex><span>                     AS Layer1 : IA32PagedMemoryPae <span style=color:#f92672>(</span>Kernel AS<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                     AS Layer2 : FileAddressSpace <span style=color:#f92672>(</span>D:<span style=color:#ae81ff>\N</span>TU<span style=color:#ae81ff>\C</span>TF<span style=color:#ae81ff>\C</span>rewCTF<span style=color:#ae81ff>\M</span>isc<span style=color:#ae81ff>\A</span>ttaaaaack<span style=color:#ae81ff>\m</span>emdump.raw<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                      PAE type : PAE
</span></span><span style=display:flex><span>                           DTB : 0x185000L
</span></span><span style=display:flex><span>                          KDBG : 0x82b7ab78L
</span></span><span style=display:flex><span>          Number of Processors : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>     Image Type <span style=color:#f92672>(</span>Service Pack<span style=color:#f92672>)</span> : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                KPCR <span style=color:#66d9ef>for</span> CPU <span style=color:#ae81ff>0</span> : 0x80b96000L
</span></span><span style=display:flex><span>             KUSER_SHARED_DATA : 0xffdf0000L
</span></span><span style=display:flex><span>           Image date and time : 2023-02-20 19:10:54 UTC+0000
</span></span><span style=display:flex><span>     Image local date and time : 2023-02-20 21:10:54 +0200
</span></span></code></pre></div><p>Flag: <code>crew{Win7SP1x86_23418}</code></p><a href=/security/practice/crewctf/misc/crewctf---attaaaaack-1-13/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/misc/crewctf---encrypt10npart-1/>CrewCTF - Encrypt10n(Part 1)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=crewctf---encrypt10npart-1>CrewCTF - Encrypt10n(Part 1)
<a class=anchor href=#crewctf---encrypt10npart-1>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://github.com/volatilityfoundation/volatility3>Volatility 3</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ul><li>Description: We made a memory dump on the criminal machine after entering the crime scene. Our investigator thought he was using encryption software to hide the secret. can you help me to detect it?</li><li>Q1 : crew{password}
這種類型之前沒碰過，所以看了別人的WP學一下<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>
首先他有提到他有用加密的技術隱藏secret，所以我們的目的就是要找到password</li></ul><h2 id=exploit---memory-forensics>Exploit - Memory Forensics
<a class=anchor href=#exploit---memory-forensics>#</a></h2><ol><li>先找到運行的OS version或其他軟硬體資訊<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw imageinfo
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6.1
</span></span><span style=display:flex><span>INFO    : volatility.debug    : Determining profile based on KDBG search...
</span></span><span style=display:flex><span>          Suggested Profile<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86
</span></span><span style=display:flex><span>                     AS Layer1 : IA32PagedMemoryPae <span style=color:#f92672>(</span>Kernel AS<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                     AS Layer2 : FileAddressSpace <span style=color:#f92672>(</span>/mnt/d/Download/Trash/dump.raw<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                      PAE type : PAE
</span></span><span style=display:flex><span>                           DTB : 0x185000L
</span></span><span style=display:flex><span>                          KDBG : 0x82b3db78L
</span></span><span style=display:flex><span>          Number of Processors : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>     Image Type <span style=color:#f92672>(</span>Service Pack<span style=color:#f92672>)</span> : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                KPCR <span style=color:#66d9ef>for</span> CPU <span style=color:#ae81ff>0</span> : 0x839a5000L
</span></span><span style=display:flex><span>             KUSER_SHARED_DATA : 0xffdf0000L
</span></span><span style=display:flex><span>           Image date and time : 2023-02-16 12:03:16 UTC+0000
</span></span><span style=display:flex><span>     Image local date and time : 2023-02-16 14:03:16 +0200
</span></span></code></pre></div>重點: <code>Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86</code></li><li>列出當時系統正在運行的process<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python ../../Software/CTF/Misc/volatility/vol.py -f dump.raw pslist --profile<span style=color:#f92672>=</span>Win7SP0x86
</span></span><span style=display:flex><span>Volatility Foundation Volatility Framework 2.6.1
</span></span><span style=display:flex><span>Offset<span style=color:#f92672>(</span>V<span style=color:#f92672>)</span>  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit
</span></span><span style=display:flex><span>---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
</span></span><span style=display:flex><span>0x8413a938 System                    <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>88</span>      <span style=color:#ae81ff>520</span> ------      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:48 UTC+0000
</span></span><span style=display:flex><span>0x84e481c8 smss.exe                <span style=color:#ae81ff>252</span>      <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>29</span> ------      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:49 UTC+0000
</span></span><span style=display:flex><span>0x84cae358 csrss.exe               <span style=color:#ae81ff>340</span>    <span style=color:#ae81ff>324</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>550</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:53 UTC+0000
</span></span><span style=display:flex><span>0x844ea030 wininit.exe             <span style=color:#ae81ff>392</span>    <span style=color:#ae81ff>324</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>77</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x84ef5030 csrss.exe               <span style=color:#ae81ff>400</span>    <span style=color:#ae81ff>384</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>223</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x8573dd20 winlogon.exe            <span style=color:#ae81ff>456</span>    <span style=color:#ae81ff>384</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>114</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x85749868 services.exe            <span style=color:#ae81ff>496</span>    <span style=color:#ae81ff>392</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>228</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:54 UTC+0000
</span></span><span style=display:flex><span>0x85763030 lsass.exe               <span style=color:#ae81ff>508</span>    <span style=color:#ae81ff>392</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>578</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:55 UTC+0000
</span></span><span style=display:flex><span>0x85764030 lsm.exe                 <span style=color:#ae81ff>516</span>    <span style=color:#ae81ff>392</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>149</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:55 UTC+0000
</span></span><span style=display:flex><span>0x857bd510 svchost.exe             <span style=color:#ae81ff>624</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>362</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x85809510 svchost.exe             <span style=color:#ae81ff>704</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>298</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x85859920 svchost.exe             <span style=color:#ae81ff>784</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>23</span>      <span style=color:#ae81ff>510</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:56 UTC+0000
</span></span><span style=display:flex><span>0x8586da80 svchost.exe             <span style=color:#ae81ff>832</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>265</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x85872bb0 svchost.exe             <span style=color:#ae81ff>856</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>22</span>      <span style=color:#ae81ff>731</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x85875460 svchost.exe             <span style=color:#ae81ff>880</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>47</span>     <span style=color:#ae81ff>1013</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x8588f370 audiodg.exe             <span style=color:#ae81ff>960</span>    <span style=color:#ae81ff>784</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>132</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:57 UTC+0000
</span></span><span style=display:flex><span>0x858c2420 svchost.exe            <span style=color:#ae81ff>1092</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>389</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:58 UTC+0000
</span></span><span style=display:flex><span>0x857d6030 spoolsv.exe            <span style=color:#ae81ff>1288</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>270</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857d1030 dwm.exe                <span style=color:#ae81ff>1296</span>    <span style=color:#ae81ff>832</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>114</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857c7030 svchost.exe            <span style=color:#ae81ff>1324</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>21</span>      <span style=color:#ae81ff>310</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857a5d20 explorer.exe           <span style=color:#ae81ff>1384</span>   <span style=color:#ae81ff>1276</span>     <span style=color:#ae81ff>33</span>      <span style=color:#ae81ff>923</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x857c4d20 taskhost.exe           <span style=color:#ae81ff>1400</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>197</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:00:59 UTC+0000
</span></span><span style=display:flex><span>0x85837898 svchost.exe            <span style=color:#ae81ff>1560</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>146</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:00 UTC+0000
</span></span><span style=display:flex><span>0x841d1030 VGAuthService.         <span style=color:#ae81ff>1720</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>85</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:01 UTC+0000
</span></span><span style=display:flex><span>0x841d7118 vmtoolsd.exe           <span style=color:#ae81ff>1736</span>   <span style=color:#ae81ff>1384</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>181</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:02 UTC+0000
</span></span><span style=display:flex><span>0x85856030 vm3dservice.ex         <span style=color:#ae81ff>1836</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>5</span>       <span style=color:#ae81ff>60</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x85857d20 vmtoolsd.exe           <span style=color:#ae81ff>1856</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>291</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x841e5678 vm3dservice.ex         <span style=color:#ae81ff>1880</span>   <span style=color:#ae81ff>1836</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>44</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:03 UTC+0000
</span></span><span style=display:flex><span>0x85a26030 svchost.exe             <span style=color:#ae81ff>384</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>8</span>       <span style=color:#ae81ff>93</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85a6e5d0 dllhost.exe             <span style=color:#ae81ff>876</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>21</span>      <span style=color:#ae81ff>191</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85941c28 dllhost.exe            <span style=color:#ae81ff>1744</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>200</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:05 UTC+0000
</span></span><span style=display:flex><span>0x85ab6260 msdtc.exe              <span style=color:#ae81ff>1128</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>154</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:06 UTC+0000
</span></span><span style=display:flex><span>0x85ac8b00 WmiPrvSE.exe            <span style=color:#ae81ff>232</span>    <span style=color:#ae81ff>624</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>193</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:06 UTC+0000
</span></span><span style=display:flex><span>0x841f4470 SearchIndexer.         <span style=color:#ae81ff>2148</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>604</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:08 UTC+0000
</span></span><span style=display:flex><span>0x85b2a030 VSSVC.exe              <span style=color:#ae81ff>2276</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>118</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:11 UTC+0000
</span></span><span style=display:flex><span>0x85b80cb8 SearchProtocol         <span style=color:#ae81ff>2372</span>   <span style=color:#ae81ff>2148</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>284</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:13 UTC+0000
</span></span><span style=display:flex><span>0x85b855f8 SearchFilterHo         <span style=color:#ae81ff>2392</span>   <span style=color:#ae81ff>2148</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>104</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:13 UTC+0000
</span></span><span style=display:flex><span>0x85b97d20 svchost.exe            <span style=color:#ae81ff>2480</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>232</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:15 UTC+0000
</span></span><span style=display:flex><span>0x85bc5398 wmpnetwk.exe           <span style=color:#ae81ff>2632</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>11</span>      <span style=color:#ae81ff>212</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:16 UTC+0000
</span></span><span style=display:flex><span>0x85bba030 WmiPrvSE.exe           <span style=color:#ae81ff>2860</span>    <span style=color:#ae81ff>624</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>319</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:25 UTC+0000
</span></span><span style=display:flex><span>0x85c53030 WmiApSrv.exe           <span style=color:#ae81ff>3004</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>112</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:01:30 UTC+0000
</span></span><span style=display:flex><span>0x85c596c0 TrueCrypt.exe          <span style=color:#ae81ff>3196</span>   <span style=color:#ae81ff>1384</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>67</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:02:07 UTC+0000
</span></span><span style=display:flex><span>0x84d54d20 sppsvc.exe             <span style=color:#ae81ff>3736</span>    <span style=color:#ae81ff>496</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>154</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:05 UTC+0000
</span></span><span style=display:flex><span>0x84d567f0 svchost.exe            <span style=color:#ae81ff>3776</span>    <span style=color:#ae81ff>496</span>     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>353</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:05 UTC+0000
</span></span><span style=display:flex><span>0x844fcd20 DumpIt.exe             <span style=color:#ae81ff>4072</span>   <span style=color:#ae81ff>1384</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>38</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:14 UTC+0000
</span></span><span style=display:flex><span>0x844ba6e0 conhost.exe            <span style=color:#ae81ff>4080</span>    <span style=color:#ae81ff>400</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>51</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2023-02-16 12:03:14 UTC+0000
</span></span></code></pre></div>重點：<code>0x85c596c0 TrueCrypt.exe 3196 1384 2 67 1 0 2023-02-16 12:02:07 UTC+0000</code>
<a href=https://zh.wikipedia.org/zh-tw/TrueCrypt>TrueCrypt - Wiki</a><blockquote><p>TrueCrypt是一款已停止開發的動態（On-the-fly）磁碟加密軟體，支援Windows、macOS和Linux作業系統。它可在單個檔案和磁碟分割區中建立加密區，也可以加密整個作業系統，解密後使用者即可像普通分割區一樣使用其中的檔案。TrueCrypt支援使用密碼、金鑰檔案作為解密憑據。</p><a href=/security/practice/crewctf/misc/crewctf---encrypt10npart-1/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/misc/crewctf---encrypt10npart-2/>CrewCTF - Encrypt10n(Part 2)</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=crewctf---encrypt10npart-2>CrewCTF - Encrypt10n(Part 2)
<a class=anchor href=#crewctf---encrypt10npart-2>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://kenfavors.com/code/how-to-open-a-truecrypt-container-using-cryptsetup/>How To Open A TrueCrypt Container Using cryptsetup</a></p><blockquote><p><code>$ sudo cryptsetup --type tcrypt open container-to-mount container-name</code></p></blockquote><p><a href=https://blog.51cto.com/majesty/991565>什麽是塊設備，什麽是字符設備？有什麽區別？</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題應該是沿用part 1得到的密碼進行解密</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ol><li><p>用<code>cryptsetup</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>先進行解密</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo cryptsetup --type tcrypt open flag flag_decrypt
</span></span><span style=display:flex><span>Enter passphrase <span style=color:#66d9ef>for</span> flag:
</span></span></code></pre></div><p>則輸出的結果就是一個container儲存在<code>/dev/mapper</code>，可以看到它是一個block device</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ll /dev/mapper
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>2</span> root root       <span style=color:#ae81ff>80</span> Jul <span style=color:#ae81ff>12</span> 21:44 .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>11</span> root root     <span style=color:#ae81ff>3140</span> Jul <span style=color:#ae81ff>12</span> 21:44 ..
</span></span><span style=display:flex><span>crw-------  <span style=color:#ae81ff>1</span> root root  10, <span style=color:#ae81ff>236</span> Jul <span style=color:#ae81ff>11</span> 23:06 control
</span></span><span style=display:flex><span>brw-rw----  <span style=color:#ae81ff>1</span> root disk 252,   <span style=color:#ae81ff>3</span> Jul <span style=color:#ae81ff>12</span> 21:44 flag_dec
</span></span></code></pre></div></li><li><p>再來就要把這個container掛起來，要掛起來才能讀取裡面的資料</p><a href=/security/practice/crewctf/misc/crewctf---encrypt10npart-2/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/reverse/crewctf---ez-rev/>CrewCTF - ez rev</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=crewctf---ez-rev>CrewCTF - ez rev
<a class=anchor href=#crewctf---ez-rev>#</a></h1><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Fake Main Function</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#66d9ef>__fastcall</span> __noreturn <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> a1, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>a2, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>a3)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> i; <span style=color:#75715e>// [rsp+Ch] [rbp-4h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  puts(<span style=color:#e6db74>&#34;[+] Another flag checker...&#34;</span>);
</span></span><span style=display:flex><span>  fgets(byte_4200E0, <span style=color:#ae81ff>256</span>, stdin);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( byte_4200E0[strlen(byte_4200E0) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>10</span> )
</span></span><span style=display:flex><span>    byte_4200E0[strlen(byte_4200E0) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> ( i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>73</span>; <span style=color:#f92672>++</span>i )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( byte_4200E0[i] <span style=color:#f92672>!=</span> (byte_420060[i] <span style=color:#f92672>^</span> <span style=color:#ae81ff>0x70</span>) )
</span></span><span style=display:flex><span>      sub_401220();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  sub_401202();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>首先這一題真的太難了，超出我的守備範圍，所以我先寫一些當作紀錄，之後可以更快銜接繼續解</p><ol><li><p>首先可以執行一下，如果是在Ubuntu 20.04(預設Libc版本是2.31)的版本和其他版本會有不一樣的output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ldd --version
</span></span><span style=display:flex><span>ldd <span style=color:#f92672>(</span>Ubuntu GLIBC 2.31-0ubuntu9.9<span style=color:#f92672>)</span> 2.31
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> <span style=color:#ae81ff>2020</span> Free Software Foundation, Inc.
</span></span><span style=display:flex><span>This is free software; see the source <span style=color:#66d9ef>for</span> copying conditions.  There is NO
</span></span><span style=display:flex><span>warranty; not even <span style=color:#66d9ef>for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</span></span><span style=display:flex><span>Written by Roland McGrath and Ulrich Drepper.
</span></span><span style=display:flex><span>$ ./a.out
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Another flag checker...
</span></span><span style=display:flex><span><span style=color:#ae81ff>123456</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> No :<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>$ ldd --version
</span></span><span style=display:flex><span>ldd <span style=color:#f92672>(</span>Ubuntu GLIBC 2.35-0ubuntu3<span style=color:#f92672>)</span> 2.35
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> <span style=color:#ae81ff>2022</span> Free Software Foundation, Inc.
</span></span><span style=display:flex><span>This is free software; see the source <span style=color:#66d9ef>for</span> copying conditions.  There is NO
</span></span><span style=display:flex><span>warranty; not even <span style=color:#66d9ef>for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</span></span><span style=display:flex><span>Written by Roland McGrath and Ulrich Drepper.
</span></span><span style=display:flex><span>./a.out
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Another flag checker...
</span></span><span style=display:flex><span><span style=color:#ae81ff>123456</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> Why you still here
</span></span></code></pre></div><p>這是因為他和這隻程式執行的過程有關係</p><a href=/security/practice/crewctf/reverse/crewctf---ez-rev/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/crewctf/web/crewctf---sequence_gallery/>CrewCTF - sequence_gallery</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/crewctf/>CrewCTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=crewctf---sequence_gallery>CrewCTF - sequence_gallery
<a class=anchor href=#crewctf---sequence_gallery>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://lab.feifei.tw/practice/ci/l1.php>Command Injection</a>
<a href=https://www.geeksforgeeks.org/dc-command-in-linux-with-examples/>dc command in Linux with examples</a>
<a href=https://deepinout.com/linux-cmd/linux-numerical-computation-cmd/linux-cmd-dc.html>Linux dc命令</a></p><blockquote><p>dc -h
Usage: dc [OPTION] [file &mldr;]
-e, &ndash;expression=EXPR evaluate expression
-f, &ndash;file=FILE evaluate contents of file
-h, &ndash;help display this help and exit
-V, &ndash;version output version information and exit</p><p>Email bug reports to: <a href=mailto:bug-dc@gnu.org>bug-dc@gnu.org</a> .</p></blockquote><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class=language-python! data-lang=python!>import os
import sqlite3
import subprocess

from flask import Flask, request, render_template

app = Flask(__name__)

@app.get(&#39;/&#39;)
def index():
	sequence = request.args.get(&#39;sequence&#39;, None)
	if sequence is None:
		return render_template(&#39;index.html&#39;)

	script_file = os.path.basename(sequence + &#39;.dc&#39;)
	if &#39; &#39; in script_file or &#39;flag&#39; in script_file:
		return &#39;:(&#39;

	proc = subprocess.run(
		[&#39;dc&#39;, script_file], 
		capture_output=True,
		text=True,
		timeout=1,
	)
	output = proc.stdout

	return render_template(&#39;index.html&#39;, output=output)

if __name__ == &#39;__main__&#39;:
	app.run(host=&#39;0.0.0.0&#39;, port=8080)
</code></pre><p>:::</p><a href=/security/practice/crewctf/web/crewctf---sequence_gallery/>...</a></p></article><article class="markdown book-post"><h2><a href=/tools/ctf/crypto-cheat-sheet/>Crypto Cheat Sheet</a></h2><div class=text-small><a href=/tags/tools/>Tools</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=crypto-cheat-sheet>Crypto Cheat Sheet
<a class=anchor href=#crypto-cheat-sheet>#</a></h1><h2 id=online-tools---classic-crypto>Online Tools - Classic Crypto
<a class=anchor href=#online-tools---classic-crypto>#</a></h2><table><thead><tr><th>Complex</th><th>Substitution Cipher</th><th>Vigenère Cipher</th></tr></thead><tbody><tr><td><a href=https://gchq.github.io/CyberChef/>CyberChef</a></td><td><a href=https://www.boxentriq.com/code-breaking/cryptogram>Substitution Cipher Solver Tool</a></td><td>Known Key</br>Python - <code>pycipher</code> library</br><a href=https://planetcalc.com/2468/>online - Vigenère cipher</a></br>CAP4</td></tr><tr><td><a href=https://quipqiup.com/>quipqiup</a></td><td></td><td>Unknown Key</br><a href=https://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx>Vigenère Cipher Codebreaker</a></br><a href=https://www.guballa.de/vigenere-solver>Vigenere Solver</a></td></tr></tbody></table><h2 id=rsa相關攻擊>RSA相關攻擊
<a class=anchor href=#rsa%e7%9b%b8%e9%97%9c%e6%94%bb%e6%93%8a>#</a></h2><p>其實整裡的文章內容都差不多</p><ul><li><a href=https://www.anquanke.com/post/id/84632>【技術分享】CTF中RSA的常見攻擊方法</a></li><li><a href=https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_module_attack/>Mod相關攻擊</a></li><li><a href=https://zhuanlan.zhihu.com/p/76228394>CTF RSA</a></li></ul><h2 id=coding-tools>Coding Tools
<a class=anchor href=#coding-tools>#</a></h2><ul><li>大數運算: <a href=https://blog.csdn.net/m0_52842062/article/details/117852175>gmpy2</a>/<a href=https://cocalc.com/features/sage>sage math online - cocalc</a>/<a href=https://sagecell.sagemath.org/>sage math online - sagecell</a>/<a href=https://www.wolframalpha.com/>WolframAlpha</a>:這是一個線上的搜索引擎，但凡和數學相關的都能進行運算，使用解說可以看<a href="https://youtu.be/9JD3EzbAjH4?si=fmL7rOXK0u__Mf3u">這裡</a><pre tabindex=0><code class=language-bash! data-lang=bash!>$ sudo apt install sagemath
# or
$ conda create --name sageenv sage=10.0 -c conda-forge -y # just only for wsl
---
# 想要在sage中安裝python library
$ sage -pip install {library name}
</code></pre>:::spoiler To address Discrete Log Problem<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>p <span style=color:#f92672>=</span> <span style=color:#ae81ff>117635180960139721127318189832610714114593440637486157582828661167364276581210599344857316369131977790468647533227778603367761815400416396281259234299247850289710613080530669849409358755399675041263469367135430665518150110493389671646158566214130516002949975036799297119111385228596853422400303735447298026283</span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> <span style=color:#ae81ff>163800729847029979711295941089800020300275211671661376396219775666688832353701752860857691086339595920419175562271802936423756228938551439950541873798393442729921516031775531740506399414675546114663346731428381174638773512946351966471041847661507898143967764453261943807056370639171597924004988320983393199599</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x8788542cefd7490c9282c06b8d24280d56c6706b996bdf580290cdf2cb90e45efd2ce185fc07d2b916c24b0512d38ca14de0ee608a9d6003f258859bbbed97dad15c1d07410a34fd55cd8305eb43418d38f1ca6e024725b97fd9da701a39c23fe55a13d43b4bf9a3d9ebb44d7fe67bd60beffc29ec27bb4baf05ec5b250bfa68360df0d1379c066297a7878e59d27e68cf6a0da90755450827623e54e4f3d9f280fef53c7620d58decfbd10dd64e9d1d5507b5460603c58f5be70c82e2a8e613d730a950caea4c4389c5fc0521f8207ead5fb26c04eb6d0486fd6fe8d015fdabbda00139b42163acc86ffb30c12988058c6247344c42b8f3cdc984c06f4276f8</span>
</span></span><span style=display:flex><span>g <span style=color:#f92672>=</span> Mod(<span style=color:#ae81ff>3</span>,p)
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> discrete_log(c,g)
</span></span><span style=display:flex><span>print(hex(m))
</span></span><span style=display:flex><span>g2 <span style=color:#f92672>=</span> Mod(<span style=color:#ae81ff>3</span>,q)
</span></span><span style=display:flex><span>m2 <span style=color:#f92672>=</span> discrete_log(c,g2)
</span></span><span style=display:flex><span>print(m2)
</span></span><span style=display:flex><span>print(hex(m2)[<span style=color:#ae81ff>2</span>:])
</span></span></code></pre></div>:::</li><li>Crypto常用library: pycryptodom
<code>$ pip install pycryptodome</code>
:::spoiler pycryptodome generate PEM file<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>&gt;&gt;&gt; from Crypto.PublicKey import RSA
</span></span><span style=display:flex><span>&gt;&gt;&gt; n <span style=color:#f92672>=</span> 0xb4f98200f1309e8a486824051051ac80790f8e66dac4744e2ce5134fb432121f41c5471e3459d01e56e64befd2034c65eb300ebf0045342221bff206b6cdda7f3349c17b08563a576731f95a64e2f00af70b5cbb2f4f388d49ce82da76ca609a6ec1529f29b0fa0bedc5764b86472e2c5ac5198cedb6f5e1e8e0ca950ea11bc4cf5e5a0497db3ad96f5a745cf902d56be394a259068fe198bc9de8fe8d034a71013f46c2ac72451211eb1127286c19467eaf3a10049942d46b0f49f3c51c01c06a2f8c94416cc1aadaeb191de959f0241ce8f32575c848bd2f4f8f84dab46e2aa7ad45de1c6060fbbee9668f8e9cb6d366b8cd6ce99f78bbef145f2b7b7e5222f762ccb95f17b1538260c2ea45571061b0d873fbe60d61dd87aa4833ac71b802f2b91d30f38e30ae9da39fbd1c53e80496f511521285b3bb1da3dc79931463d278d1fe28a77880a9f2368029c4cefffebbbd6904f85291b3606d0b5ed3efd8c1ee14538dc051274665f4b0f55d6c6e12d2cb728ac15f7a6572b71a5bd6fa01bddb0af211091bff4c8ec7e93efae4654b2abae09e35be29afbfc3f4df8e4348c525b9d8662a1ac344dadb15b953905f639b48fec7cfcfdf27cc0ad82b936d5efe7c0d891bf9752d3fb0857d38337df033e4b681d19ec8603535504d05a421036c077694482eee919a44b3296e2a4c272cbf7bbf14b6d62eb194e4ee83ba227fed
</span></span><span style=display:flex><span>&gt;&gt;&gt; e <span style=color:#f92672>=</span> 0x10001
</span></span><span style=display:flex><span>&gt;&gt;&gt; d <span style=color:#f92672>=</span> 0x737efcd1df1b7942a53d1927c62769a0c022066e6bd58ea8498c948b7c63ac1f18996f6ebe584732e5a0a9fbce9ade49f913bd857605b464c80738cdc22293fc33de314574a79b2a26a8c50b447174627b115c47f5c46841fb45794b351ea91245f6c8e4dcf59e4eb89b1988cf9463ca58cf8b23de9db2444f9c0e8d9c3d837c521f53f1b47c6c0d523c7720d2a655503a78a4378eb18a773080d2ae898dfd172b8597822c0ded38c008b5f4b89e6c6f09f0886caa92a90ce99a6346d897ac2281620124a8b060d4ca4bd9c6b622f8d8033f43d5b75a6fd994f50091f805c87d1e6fbdb42785f6bf1332df8a64a86d21736023720b9303b964b62a9a9480a4a7ab5fac794f583109d5663998ccc893590ebe26ae076e17c2b93c2238106612094fd4c6a56ec84ca5fa6ee3608ba3422f931828772e6732c337fcd6d4e6cb4a907d2e978227423d783c112f7a7d3e6d7c91ac7c540f0095d39842a6be534321a67d7a3fcb1c62c0f9e8a6d6e10281e10ff957449770d19f939153692c73f940450eab03f58ef55d2adf98c3f8479d05bb02997667381d3583c8f0eba6ea91bce512b001a27788309a4aa15952c73572a329b2f3acd6a11f43e3ae00532ccfbe9f157702162b534d26ca1e668d4cdbfd0116b7cb724603ea99e8aa08c90410534dd681b59350542c59523cb1259428e05e1fe0aab479c4b5af2a44d18ef713cd61
</span></span><span style=display:flex><span>&gt;&gt;&gt; p <span style=color:#f92672>=</span> 0xd73e2ef8f2e4f1de44ee80070beef39943d4fa89a7a7ab4b0061e851aca7deb4f717f2baf4a0c018f3dcdab92148596bc50800fd6eb2f2e7757e0343534aea2241f0a2d34795a08f8e5ccc7959184b9cf8e3007a8ad63acd7d4b350dbf2d4caf04f4bc98d74a3b01d3b1aced745133186fd8460a2dff536a74ee4d041c988d5743cc9355144f48fe5f52db0449a46ba7c15c04001a5cb141796b5b42d9d72c36cca6d6bb8f177aee1699a47ba5d87c7ee886467af18403dbd84e102a952ebee03cc70bcf072c26b1b1f0f5094be08470c6c1769b417feffd5c89a0c373f75a350d177309618bfeb16316c660c6b2a341a984c8845081ede7c42e22cc9272aa15
</span></span><span style=display:flex><span>&gt;&gt;&gt; q <span style=color:#f92672>=</span> 0xd73e2ef8f2e4f1de44ee80070beef39943d4fa89a7a7ab4b0061e851aca7deb4f717f2baf4a0c018f3dcdab92148596bc50800fd6eb2f2e7757e0343534aea2241f0a2d34795a08f8e5ccc7959184b9cf8e3007a8ad63acd7d4b350dbf2d4caf04f4bc98d74a3b01d3b1aced745133186fd8460a2dff536a74ee4d041c988d5743cc9355144f48fe5f52db0449a46ba7c15c04001a5cb141796b5b42d9d72c36cca6d6bb8f177aee1699a47ba5d87c7ee886467af18403dbd84e102a952ebee03cc70bcf072c26b1b1f0f5094be08470c6c1769b417feffd5c89a0c373f75a350d177309618bfeb16316c660c6b2a341a984c8845081eded2ff580f9f582ac79
</span></span><span style=display:flex><span>&gt;&gt;&gt; key_params <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>n, e, d, p, q<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt;&gt;&gt; key <span style=color:#f92672>=</span> RSA.construct<span style=color:#f92672>(</span>key_params<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt;&gt;&gt; f <span style=color:#f92672>=</span> open<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;./rsaprivatekey.pem&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt;&gt;&gt; f.write<span style=color:#f92672>(</span>key.exportKey<span style=color:#f92672>()</span>.decode<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>&gt;&gt;&gt; f.close<span style=color:#f92672>()</span>
</span></span></code></pre></div>:::</li><li><a href=https://www.mkssoftware.com/docs/man1/openssl_rsa.1.asp>openssl - RSA(很清楚)</a>
:::spoiler Cheat Sheet<pre tabindex=0><code class=language-bash! data-lang=bash!>&#39;&#39;&#39;AES / DES&#39;&#39;&#39;
$ openssl des-ecb –e –in xxx.txt –out yyy.out –k password (DES encrypt)
$ openssl des-ecb –d –in yyy.out –out xxx.txt –k password (DES decrypt)
$ openssl des-ede3 –d –in yyy.out –out xxx.txt –k password (TDES encrypt)
$ openssl aes-128-ecb –d –in yyy.out –out xxx.txt –k password (AES decrypt)

&#39;&#39;&#39;RSA&#39;&#39;&#39;
$ openssl genrsa –out rsa_privatekey.pem –passout pass:password –des3 1024
# (generate RSA private key)
$ openssl rsa –in rsa_privatekey.pem –passin pass:password –pubout –out
rsa_publickey.pem (generate RSA public key)
$ openssl rsautl –encrypt –pubin –inkey rsa_publickey.pem –in xxx.txt –out yyy.txt
# (use public key to encrpt)
$ openssl rsaut –decrypt –ik i k n ey rsa_privatekey.pem –in yyy.txt –out xxx.txt

#  To print out the components of a private key to standard output
$ openssl rsa -in key.pem -text -noout

# 把certificate轉成pem file
$ openssl openssl x509 -in cert -pubkey -noout
-----BEGIN PUBLIC KEY-----
MCIwDQYJKoZIhvcNAQEBBQADEQAwDgIHEaTUUhKxfwIDAQAB
-----END PUBLIC KEY-----

# 把單純public key的內容(n, e)(就是上面的東西)印出來
$ openssl rsa -pubin -in public.pem -text
RSA Public-Key: (53 bit)
Modulus: 4966306421059967 (0x11a4d45212b17f)
Exponent: 65537 (0x10001)
writing RSA key
-----BEGIN PUBLIC KEY-----
MCIwDQYJKoZIhvcNAQEBBQADEQAwDgIHEaTUUhKxfwIDAQAB
-----END PUBLIC KEY-----

// 產出私鑰
openssl genrsa -out key.pem 2048

// 用同一把私鑰，產出兩組不同的憑證
openssl req -x509 -new -key key.pem -sha256 -nodes -keyout key.pem -out cert1.pem -days 30
openssl req -x509 -new -key key.pem -sha256 -nodes -keyout key.pem -out cert2.pem -days 30

// 顯示公鑰是一樣
openssl x509 -pubkey -noout -in cert1.pem
openssl x509 -pubkey -noout -in cert2.pem

// 顯示憑證內容是不一樣
openssl x509 -inform pem -in cert2.pem
openssl x509 -inform pem -in cert1.pem
</code></pre>:::</li></ul><h2 id=factoring-tools>Factoring Tools
<a class=anchor href=#factoring-tools>#</a></h2><ul><li><a href=http://factordb.com/index.php>Factor DB</a></li><li><a href=https://github.com/DarkenCode/yafu>Yafu</a></li><li><a href=https://www.alpertron.com/ECM.HTM>Prime Factorization Online</a></li></ul></p></article><article class="markdown book-post"><h2><a href=/security/competition/csc-2023-%E6%B1%BA%E8%B3%BD/>CSC 2023 決賽</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/csc/>CSC</a></div><p><h1 id=csc-ctf-2023-決賽>CSC CTF 2023 決賽
<a class=anchor href=#csc-ctf-2023-%e6%b1%ba%e8%b3%bd>#</a></h1><p>隊伍名稱: 名字好難想RRRRRRRRRRRRRRR</p><h2 id=教學題>教學題
<a class=anchor href=#%e6%95%99%e5%ad%b8%e9%a1%8c>#</a></h2><h3 id=q4>Q4
<a class=anchor href=#q4>#</a></h3><h4 id=題目敘述>題目敘述
<a class=anchor href=#%e9%a1%8c%e7%9b%ae%e6%95%98%e8%bf%b0>#</a></h4><blockquote><p>成為「admin」並取得Flag</p><p>[連線IP/連結資訊]
http://192.168.100.71</p><p>[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}</p></blockquote><h4 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h4><p>這一題太難了，看了教學檔案還是沒辦法在有效時間內解出來，所以放棄
學長自述:</p><h3 id=q5>Q5
<a class=anchor href=#q5>#</a></h3><h4 id=題目敘述-1>題目敘述
<a class=anchor href=#%e9%a1%8c%e7%9b%ae%e6%95%98%e8%bf%b0-1>#</a></h4><blockquote><p>壞壞恐怖組織要對這邊進行恐攻，丟了一顆定時炸彈，拆彈專家4你???拆彈成功領取豐沛的獎勵吧!</p><p>[備註]
答題系統Flag輸入格式：CSC{FLAG_最多長度25可包含數字、英文大小寫、特殊字元及底線}</p></blockquote><h4 id=exploit-1>Exploit
<a class=anchor href=#exploit-1>#</a></h4><p>測驗智商用的，直接pwntools就可以了</p><pre tabindex=0><code class=language-python! data-lang=python!>from pwn import *

r = process(&#39;./Bomb.exe&#39;)
r.recvuntil(b&#39;P1ease count A(&#39;)
A = r.recvuntil(b&#39;)&#39;)[:-1].decode()
sign = r.recv(3).decode()
B = r.recvline()[2:-2].decode()

log.info(f&#39;A({A}) {sign} B({B}) = {eval(A + sign + B)}&#39;)
r.sendlineafter(b&#39;Enter your answer: &#39;, str(eval(A + sign + B)).encode())

r.interactive()
</code></pre><pre tabindex=0><code class=language-bash! data-lang=bash!>$ python exp.py
[+] Starting local process &#39;./Bomb.exe&#39;: pid 8143
[*] A(1507886)  +  B(7372399) = 8880285
[*] Switching to interactive mode

Good job!\(^^)/
CSC{FLAG_54v3th3d4y7777777}Time&#39;s up! (っ•O•)╮ =͟͟͞͞●~*
[*] Got EOF while reading in interactive
</code></pre><p>Flag: <code>CSC{FLAG_54v3th3d4y7777777}</code></p><a href=/security/competition/csc-2023-%E6%B1%BA%E8%B3%BD/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/ctf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/ctf/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/ctf/ aria-label="Page 1" class=page-link role=button>1</a></li><li class="page-item active"><a aria-current=page aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/tags/ctf/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/ctf/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/tags/ctf/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/tags/ctf/page/3/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/ctf/page/27/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>