<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ctf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CTF"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>CTF | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ctf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ctf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CTF</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/audio/picoctf---surfing-the-waves/>PicoCTF - Surfing the Waves</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---surfing-the-waves>PicoCTF - Surfing the Waves
<a class=anchor href=#picoctf---surfing-the-waves>#</a></h1><h6 id=tags-picoctf-ctf-misc>tags: <code>PicoCTF</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-picoctf-ctf-misc>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/117?category=4&amp;page=3">Surfing the Waves</a></p><h2 id=description--hint>Description & Hint
<a class=anchor href=#description--hint>#</a></h2><p>While you&rsquo;re going through the FBI&rsquo;s servers, you stumble across their incredible taste in music. One <a href=https://mercury.picoctf.net/static/cf917a179937f814d966e53bb1fd4b90/main.wav>main.wav</a> you found is particularly interesting, see if you can find the flag!
Hint:</p><ul><li>Music is cool, but what other kinds of waves are there?</li><li>Look deep below the surface</li></ul><h2 id=exploit---通靈>Exploit - <font color=FF0000>通靈</font>
<a class=anchor href=#exploit---%e9%80%9a%e9%9d%88>#</a></h2><ol><li>Audacity to Analyze
The sound seems quite normal but when you zoom in the audio track, it looks like something encode.
<img src=https://i.imgur.com/D1H1jpU.png alt></li><li>Read it - <code>scipy.io</code>
Use <code>scipy.io</code> library to read it and print the data out.<pre tabindex=0><code class=language-python! data-lang=python!>&gt;&gt;&gt; from scipy.io.wavfile import read
&gt;&gt;&gt; rate, data = read(&#34;./main.wav&#34;)
&gt;&gt;&gt; print(data)
[2007 2503 2005 ... 4503 4501 7501]
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; print(np.unique(data))
[1000 1001 1002 1003 1004 1005 1006 1007 1008 1009 1500 1501 1502 1503
 1504 1505 1506 1507 1508 1509 2000 2001 2002 2003 2004 2005 2006 2007
 2008 2009 2500 2501 2502 2503 2504 2505 2506 2507 2508 2509 3000 3001
 3002 3003 3004 3005 3006 3007 3008 3009 3500 3501 3502 3503 3504 3505
 3506 3507 3508 3509 4000 4001 4002 4003 4004 4005 4006 4007 4008 4009
 4500 4501 4502 4503 4504 4505 4506 4507 4508 4509 5000 5001 5002 5003
 5004 5005 5006 5007 5008 5009 5500 5501 5502 5503 5504 5505 5506 5507
 5508 5509 6000 6001 6002 6003 6004 6005 6006 6007 6008 6009 6500 6501
 6502 6503 6504 6505 6506 6507 6508 6509 7000 7001 7002 7003 7004 7005
 7006 7007 7008 7009 7500 7501 7502 7503 7504 7505 7506 7507 7508 7509
 8000 8001 8002 8003 8004 8005 8006 8007 8008 8009 8500 8501 8502 8503
 8504 8505 8506 8507 8508 8509]
</code></pre>Seems it has some rule $\to$
<code>1000 ~ 1009</code>
<code>1500 ~ 1509</code>
<code>2000 ~ 2009</code>
&mldr;
<code>8500 ~ 8509</code>
It has exactly 16 intervals $\to$ hex value</li><li>Let&rsquo;s try to exploit it</li></ol><ul><li>Whole exploit
:::spoiler exploit<pre tabindex=0><code class=language-python! data-lang=python!>from scipy.io.wavfile import read
from tqdm import trange

path = &#39;.&#39;
rate, data = read(path + &#34;/main.wav&#34;)

decode_dic = {
    10 : &#34;0&#34;,
    15 : &#34;1&#34;,
    20 : &#34;2&#34;,
    25 : &#34;3&#34;,
    30 : &#34;4&#34;,
    35 : &#34;5&#34;,
    40 : &#34;6&#34;,
    45 : &#34;7&#34;,
    50 : &#34;8&#34;,
    55 : &#34;9&#34;,
    60 : &#34;A&#34;,
    65 : &#34;B&#34;,
    70 : &#34;C&#34;,
    75 : &#34;D&#34;,
    80 : &#34;E&#34;,
    85 : &#34;F&#34;,
}

message = &#39;&#39;
for i in trange(len(data)):
    message += decode_dic[data[i] // 100]

print(bytes.fromhex(message).decode())
</code></pre>:::
Then you can get the source code and flag&mldr;</li></ul><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://youtu.be/tDPetapjm74>picoCTF 2021 Surfing the Waves</a></p><a href=/security/practice/picoctf/misc/audio/picoctf---surfing-the-waves/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---tic-tac/>PicoCTF - tic-tac</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---tic-tac>PicoCTF - tic-tac
<a class=anchor href=#picoctf---tic-tac>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://myapollo.com.tw/blog/interview-question-race-condition/>後端工程師面試考什麼 - Race Condition 篇</a>
<a href=https://ithelp.ithome.com.tw/articles/10208763>[Day24]攻擊篇</a></p><blockquote><p>TOCTTOU</p><p>Time of check to time of use
在檢查和使用之間影響資源狀態的攻擊</p><p>這種攻擊可能發生在共享資源中。
可能導致程式在資源處於意外狀態時執行無效操作。</p></blockquote><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source code</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp=">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/stat.h&gt;

int main(int argc, char *argv[]) {
  if (argc != 2) {
    std::cerr &lt;&lt; &#34;Usage: &#34; &lt;&lt; argv[0] &lt;&lt; &#34; &lt;filename&gt;&#34; &lt;&lt; std::endl;
    return 1;
  }

  std::string filename = argv[1];
  std::ifstream file(filename);
  struct stat statbuf;

  // Check the file&#39;s status information.
  if (stat(filename.c_str(), &amp;statbuf) == -1) {
    std::cerr &lt;&lt; &#34;Error: Could not retrieve file information&#34; &lt;&lt; std::endl;
    return 1;
  }

  // Check the file&#39;s owner.
  if (statbuf.st_uid != getuid()) {
    std::cerr &lt;&lt; &#34;Error: you don&#39;t own this file&#34; &lt;&lt; std::endl;
    return 1;
  }

  // Read the contents of the file.
  if (file.is_open()) {
    std::string line;
    while (getline(file, line)) {
      std::cout &lt;&lt; line &lt;&lt; std::endl;
    }
  } else {
    std::cerr &lt;&lt; &#34;Error: Could not open file&#34; &lt;&lt; std::endl;
    return 1;
  }

  return 0;
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/pwn/picoctf---tic-tac/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/flow/picoctf---torrent-analyze/>PicoCTF - Torrent Analyze</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---torrent-analyze>PicoCTF - Torrent Analyze
<a class=anchor href=#picoctf---torrent-analyze>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://www.techworm.net/2017/03/seeds-peers-leechers-torrents-language.html>What are seeds, peers and leechers in Torrents’ language?</a>
<a href="https://www.mobile01.com/topicdetail.php?f=507&amp;t=1365797">慎選peer，是加速BT下載的王道！</a></p><blockquote><ol><li>seed個數：seed（即一般所說的「種子」）意指擁有完整檔案的BT參與者，是主要的檔案提供者。seed越多，可用的BT分享頻寬就越多，速度當然就快。</li><li>seed與peer的比例：雖然peer（指尚未取得完整檔案的BT參與者）可同時自seed與其他peer下載檔案，但peer間會彼此競爭，以爭取有限的BT下載頻寬。因此，peer個數越多，分配後的BT分享頻寬就越少，速度自然就受影響。</li></ol></blockquote><p><a href=http://zfly9.blogspot.com/2014/10/hashmethod.html>教你該如何使用bt的info hash特徵碼，下載BT之torrent種子檔</a></p><h2 id=description--hint>Description & Hint
<a class=anchor href=#description--hint>#</a></h2><blockquote><p>SOS, someone is torrenting on our network. One of your colleagues has been using torrent to download some files on the company’s network. Can you identify the file(s) that were downloaded? The file name will be the flag, like picoCTF{filename}.
Hint 1: Download and open the file with a packet analyzer like <a href=https://www.wireshark.org/>Wireshark</a>.
Hint 2: You may want to enable BitTorrent protocol (BT-DHT, etc.) on Wireshark. Analyze -> Enabled Protocols
Hint 3: Try to understand peers, leechers and seeds. <a href=https://www.techworm.net/2017/03/seeds-peers-leechers-torrents-language.html>Article</a>
Hint 4: The file name ends with <code>.iso</code></p><a href=/security/practice/picoctf/misc/flow/picoctf---torrent-analyze/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---transformation/>PicoCTF - Transformation</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---transformation>PicoCTF - Transformation
<a class=anchor href=#picoctf---transformation>#</a></h1><h6 id=tags-picoctf-ctf-reverse>tags: <code>PicoCTF</code> <code>CTF</code> <code>Reverse</code>
<a class=anchor href=#tags-picoctf-ctf-reverse>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/104?category=3&amp;page=1">Transformation</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>enc file content: <code>灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸彥㜰㍢㐸㙽</code>
Transformation Code</p><pre tabindex=0><code class=language-python! data-lang=python!>&#39;&#39;.join([chr((ord(flag[i]) &lt;&lt; 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)])
</code></pre><p>Seems it shift the first character with 8 bits and concatenate the 2nd character then go through <code>len(flag)</code></p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><p>My perspective is just recover the strings
:::spoiler</p><pre tabindex=0><code class="language-python=" data-lang="python=">flag = &#39;灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸彥㜰㍢㐸㙽&#39;
enc = &#39;&#39;

def decimalToBinary(n):
    return bin(n).replace(&#34;0b&#34;, &#34;&#34;)

def binToHexa(n):
    bnum = int(n)
    temp = 0
    mul = 1
    count = 1
    hexaDeciNum = [&#39;0&#39;] * 100
    i = 0
    while bnum != 0:
        rem = bnum % 10
        temp = temp + (rem*mul)
        if count % 4 == 0:
            if temp &lt; 10:
                hexaDeciNum[i] = chr(temp+48)
            else:
                hexaDeciNum[i] = chr(temp+55)
            mul = 1
            temp = 0
            count = 1
            i = i+1
        else:
            mul = mul*2
            count = count+1
        bnum = int(bnum/10)
    if count != 1:
        hexaDeciNum[i] = chr(temp+48)
    if count == 1:
        i = i-1
    hex_string = &#39;&#39;
    while i &gt;= 0:
        hex_string += hexaDeciNum[i]
        i = i-1
    return hex_string


for i in range(0, len(flag)):
    plaintext1 = decimalToBinary(ord(flag[i]))
    while(len(plaintext1) != 16):
        plaintext1 = &#39;0&#39; + plaintext1
    plaintext2 = plaintext1[-8:]
    plaintext1 = plaintext1[0:8]
    enc += binToHexa(plaintext1)
    enc += binToHexa(plaintext2)
print(bytes.fromhex(enc).decode(&#39;utf-8&#39;))
</code></pre><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---transformation/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/flow/picoctf---trivial-flag-transfer-protocol/>PicoCTF - Trivial Flag Transfer Protocol</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---trivial-flag-transfer-protocol>PicoCTF - Trivial Flag Transfer Protocol
<a class=anchor href=#picoctf---trivial-flag-transfer-protocol>#</a></h1><h6 id=tags-picoctf-ctf-misc>tags: <code>PicoCTF</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-picoctf-ctf-misc>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/103?bookmarked=0&amp;category=4&amp;page=1&amp;search=&amp;solved=0">Trivial Flag Transfer Protocol</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><p><a href=https://tw511.com/a/01/2927.html>TFTP協定是什麼？</a></p></li><li><p><a href="https://www.mobile01.com/topicdetail.php?f=110&amp;t=921577">Wireless router中的UPnP是做什麼用的?</a></p><blockquote><p>UPnP 是一種通訊協定，其主要功能是供家中的設備可以輕易的且自動的連結到網路並完成網路相關設定。
不需要您本人手動去設定就可以使用的意思。
所以你的 router 有支援並打開這項功能後，您家中的視訊設備（大部分都是支援UPnP）接上網路、打開電源。
接著你的 作業系統也支援的話，以winodws 為例，「我的電腦」中就會看到您新增的設備，如無線router、media server等等。</p></blockquote></li><li><p><a href=https://ithelp.ithome.com.tw/questions/10002825>SSDP - 通訊協定 ?</a></p><blockquote><p>SSDP的全寫是「Simple Service Discovery Protocol」，使用在Universal Plug and Play (UPnP)網絡環境中。SSDP使用UDP1900連接埠搜尋互聯網上的數據。當SSDP開啟時，其他設置會曝露自己到所有UPnP的用戶端中。</p></blockquote></li><li><p><a href=https://ithelp.ithome.com.tw/articles/10278964><code>steghide</code> instruction</a></p></li></ul><h2 id=exploit---tftp--steghide>Exploit - TFTP + steghide
<a class=anchor href=#exploit---tftp--steghide>#</a></h2><ol><li><p>Save files
According to the article: <a href=https://tw511.com/a/01/2927.html>TFTP協定是什麼？</a>, we can aware that this protocol is aim to transfer the data without authentication. So, we can download the files using wireshark.
<img src=https://i.imgur.com/rETlGmm.png alt></p><a href=/security/practice/picoctf/misc/flow/picoctf---trivial-flag-transfer-protocol/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---two-sum/>PicoCTF - two-sum</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---two-sum>PicoCTF - two-sum
<a class=anchor href=#picoctf---two-sum>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>BoF</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler</p><pre tabindex=0><code class=language-cpp! data-lang=cpp!>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

static int addIntOvf(int result, int a, int b) {
    result = a + b;
    if(a &gt; 0 &amp;&amp; b &gt; 0 &amp;&amp; result &lt; 0)
        return -1;
    if(a &lt; 0 &amp;&amp; b &lt; 0 &amp;&amp; result &gt; 0)
        return -1;
    return 0;
}

int main() {
    int num1, num2, sum;
    FILE *flag;
    char c;

    printf(&#34;n1 &gt; n1 + n2 OR n2 &gt; n1 + n2 \n&#34;);
    fflush(stdout);
    printf(&#34;What two positive numbers can make this possible: \n&#34;);
    fflush(stdout);
    
    if (scanf(&#34;%d&#34;, &amp;num1) &amp;&amp; scanf(&#34;%d&#34;, &amp;num2)) {
        printf(&#34;You entered %d and %d\n&#34;, num1, num2);
        fflush(stdout);
        sum = num1 + num2;
        if (addIntOvf(sum, num1, num2) == 0) {
            printf(&#34;No overflow\n&#34;);
            fflush(stdout);
            exit(0);
        } else if (addIntOvf(sum, num1, num2) == -1) {
            printf(&#34;You have an integer overflow\n&#34;);
            fflush(stdout);
        }

        if (num1 &gt; 0 || num2 &gt; 0) {
            flag = fopen(&#34;flag.txt&#34;,&#34;r&#34;);
            if(flag == NULL){
                printf(&#34;flag not found: please run this on the server\n&#34;);
                fflush(stdout);
                exit(0);
            }
            char buf[60];
            fgets(buf, 59, flag);
            printf(&#34;YOUR FLAG IS: %s\n&#34;, buf);
            fflush(stdout);
            exit(0);
        }
    }
    return 0;
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/pwn/picoctf---two-sum/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---unsubscriptions-are-free/>PicoCTF - Unsubscriptions Are Free</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---unsubscriptions-are-free>PicoCTF - Unsubscriptions Are Free
<a class=anchor href=#picoctf---unsubscriptions-are-free>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Heap Exploitation / Used After Free</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdint.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;fcntl.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ctype.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define FLAG_BUFFER 200
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define LINE_BUFFER_SIZE 20
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	uintptr_t (<span style=color:#f92672>*</span>whatToDo)();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>username;
</span></span><span style=display:flex><span>} cmd;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> choice;
</span></span><span style=display:flex><span>cmd <span style=color:#f92672>*</span>user;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>hahaexploitgobrrr</span>(){
</span></span><span style=display:flex><span> 	<span style=color:#66d9ef>char</span> buf[FLAG_BUFFER];
</span></span><span style=display:flex><span> 	FILE <span style=color:#f92672>*</span>f <span style=color:#f92672>=</span> fopen(<span style=color:#e6db74>&#34;flag.txt&#34;</span>,<span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span> 	fgets(buf,FLAG_BUFFER,f);
</span></span><span style=display:flex><span> 	fprintf(stdout,<span style=color:#e6db74>&#34;%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,buf);
</span></span><span style=display:flex><span> 	fflush(stdout);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>getsline</span>(<span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>	getchar();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> line <span style=color:#f92672>=</span> malloc(<span style=color:#ae81ff>100</span>), <span style=color:#f92672>*</span> linep <span style=color:#f92672>=</span> line;
</span></span><span style=display:flex><span>	size_t lenmax <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>, len <span style=color:#f92672>=</span> lenmax;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>int</span> c;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(line <span style=color:#f92672>==</span> NULL)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> NULL;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span>(;;) {
</span></span><span style=display:flex><span>		c <span style=color:#f92672>=</span> fgetc(stdin);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>(c <span style=color:#f92672>==</span> EOF)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>(<span style=color:#f92672>--</span>len <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>			len <span style=color:#f92672>=</span> lenmax;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> linen <span style=color:#f92672>=</span> realloc(linep, lenmax <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span>(linen <span style=color:#f92672>==</span> NULL) {
</span></span><span style=display:flex><span>				free(linep);
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>return</span> NULL;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			line <span style=color:#f92672>=</span> linen <span style=color:#f92672>+</span> (line <span style=color:#f92672>-</span> linep);
</span></span><span style=display:flex><span>			linep <span style=color:#f92672>=</span> linen;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>((<span style=color:#f92672>*</span>line<span style=color:#f92672>++</span> <span style=color:#f92672>=</span> c) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;\n&#39;</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#f92672>*</span>line <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\0&#39;</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> linep;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>doProcess</span>(cmd<span style=color:#f92672>*</span> obj) {
</span></span><span style=display:flex><span>	(<span style=color:#f92672>*</span>obj<span style=color:#f92672>-&gt;</span>whatToDo)();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>s</span>(){
</span></span><span style=display:flex><span> 	printf(<span style=color:#e6db74>&#34;OOP! Memory leak...%p</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,hahaexploitgobrrr);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;Thanks for subsribing! I really recommend becoming a premium member!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>p</span>(){
</span></span><span style=display:flex><span>  	puts(<span style=color:#e6db74>&#34;Membership pending... (There&#39;s also a super-subscription you can also get for twice the price!)&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m</span>(){
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;Account created.&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>leaveMessage</span>(){
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;I only read premium member messages but you can &#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;try anyways:&#34;</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> msg <span style=color:#f92672>=</span> (<span style=color:#66d9ef>char</span><span style=color:#f92672>*</span>)malloc(<span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>	read(<span style=color:#ae81ff>0</span>, msg, <span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>i</span>(){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span> response;
</span></span><span style=display:flex><span>  	puts(<span style=color:#e6db74>&#34;You&#39;re leaving already(Y/N)?&#34;</span>);
</span></span><span style=display:flex><span>	scanf(<span style=color:#e6db74>&#34; %c&#34;</span>, <span style=color:#f92672>&amp;</span>response);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(toupper(response)<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;Y&#39;</span>){
</span></span><span style=display:flex><span>		puts(<span style=color:#e6db74>&#34;Bye!&#34;</span>);
</span></span><span style=display:flex><span>		free(user);
</span></span><span style=display:flex><span>	}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>		puts(<span style=color:#e6db74>&#34;Ok. Get premium membership please!&#34;</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>printMenu</span>(){
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;Welcome to my stream! ^W^&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;==========================&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;(S)ubscribe to my channel&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;(I)nquire about account deletion&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;(M)ake an Twixer account&#34;</span>);
</span></span><span style=display:flex><span> 	puts(<span style=color:#e6db74>&#34;(P)ay for premium membership&#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;(l)eave a message(with or without logging in)&#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;(e)xit&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>processInput</span>(){
</span></span><span style=display:flex><span>  scanf(<span style=color:#e6db74>&#34; %c&#34;</span>, <span style=color:#f92672>&amp;</span>choice);
</span></span><span style=display:flex><span>  choice <span style=color:#f92672>=</span> toupper(choice);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>switch</span>(choice){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;S&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(user){
</span></span><span style=display:flex><span> 		user<span style=color:#f92672>-&gt;</span>whatToDo <span style=color:#f92672>=</span> (<span style=color:#66d9ef>void</span><span style=color:#f92672>*</span>)s;
</span></span><span style=display:flex><span>	}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>		puts(<span style=color:#e6db74>&#34;Not logged in!&#34;</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;P&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	user<span style=color:#f92672>-&gt;</span>whatToDo <span style=color:#f92672>=</span> (<span style=color:#66d9ef>void</span><span style=color:#f92672>*</span>)p;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;I&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span> 	user<span style=color:#f92672>-&gt;</span>whatToDo <span style=color:#f92672>=</span> (<span style=color:#66d9ef>void</span><span style=color:#f92672>*</span>)i;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;M&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span> 	user<span style=color:#f92672>-&gt;</span>whatToDo <span style=color:#f92672>=</span> (<span style=color:#66d9ef>void</span><span style=color:#f92672>*</span>)m;
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;===========================&#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;Registration: Welcome to Twixer!&#34;</span>);
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;Enter your username: &#34;</span>);
</span></span><span style=display:flex><span>	user<span style=color:#f92672>-&gt;</span>username <span style=color:#f92672>=</span> getsline();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;L&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	leaveMessage();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;E&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	exit(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>	puts(<span style=color:#e6db74>&#34;Invalid option!&#34;</span>);
</span></span><span style=display:flex><span>	exit(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>	  <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(){
</span></span><span style=display:flex><span>	setbuf(stdout, NULL);
</span></span><span style=display:flex><span>	user <span style=color:#f92672>=</span> (cmd <span style=color:#f92672>*</span>)malloc(<span style=color:#66d9ef>sizeof</span>(user));
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>while</span>(<span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>		printMenu();
</span></span><span style=display:flex><span>		processInput();
</span></span><span style=display:flex><span>		<span style=color:#75715e>//if(user){
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			doProcess(user);
</span></span><span style=display:flex><span>		<span style=color:#75715e>//}
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><a href=/security/practice/picoctf/pwn/picoctf---unsubscriptions-are-free/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/crypto/rsa/picoctf---very-smooth/>PicoCTF - Very Smooth</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=picoctf---very-smooth>PicoCTF - Very Smooth
<a class=anchor href=#picoctf---very-smooth>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_module_attack/#p-1>$p-1$ Smooth</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python=">#!/usr/bin/python

from binascii import hexlify
from gmpy2 import *
import math
import os
import sys

if sys.version_info &lt; (3, 9):
    math.gcd = gcd
    math.lcm = lcm

_DEBUG = False

FLAG  = open(&#39;flag.txt&#39;).read().strip()
FLAG  = mpz(hexlify(FLAG.encode()), 16)
SEED  = mpz(hexlify(os.urandom(32)).decode(), 16)
STATE = random_state(SEED)

def get_prime(state, bits):
    return next_prime(mpz_urandomb(state, bits) | (1 &lt;&lt; (bits - 1)))

def get_smooth_prime(state, bits, smoothness=16):
    p = mpz(2)
    p_factors = [p]
    while p.bit_length() &lt; bits - 2 * smoothness:
        factor = get_prime(state, smoothness)
        p_factors.append(factor)
        p *= factor

    bitcnt = (bits - p.bit_length()) // 2

    while True:
        prime1 = get_prime(state, bitcnt)
        prime2 = get_prime(state, bitcnt)
        tmpp = p * prime1 * prime2
        if tmpp.bit_length() &lt; bits:
            bitcnt += 1
            continue
        if tmpp.bit_length() &gt; bits:
            bitcnt -= 1
            continue
        if is_prime(tmpp + 1):
            p_factors.append(prime1)
            p_factors.append(prime2)
            p = tmpp + 1
            break

    p_factors.sort()

    return (p, p_factors)

e = 0x10001

while True:
    p, p_factors = get_smooth_prime(STATE, 1024, 16)
    if len(p_factors) != len(set(p_factors)):
        continue
    # Smoothness should be different or some might encounter issues.
    q, q_factors = get_smooth_prime(STATE, 1024, 17)
    if len(q_factors) != len(set(q_factors)):
        continue
    factors = p_factors + q_factors
    if e not in factors:
        break

if _DEBUG:
    import sys
    sys.stderr.write(f&#39;p = {p.digits(16)}\n\n&#39;)
    sys.stderr.write(f&#39;p_factors = [\n&#39;)
    for factor in p_factors:
        sys.stderr.write(f&#39;    {factor.digits(16)},\n&#39;)
    sys.stderr.write(f&#39;]\n\n&#39;)

    sys.stderr.write(f&#39;q = {q.digits(16)}\n\n&#39;)
    sys.stderr.write(f&#39;q_factors = [\n&#39;)
    for factor in q_factors:
        sys.stderr.write(f&#39;    {factor.digits(16)},\n&#39;)
    sys.stderr.write(f&#39;]\n\n&#39;)

n = p * q

m = math.lcm(p - 1, q - 1)
d = pow(e, -1, m)

c = pow(FLAG, e, n)

print(f&#39;n = {n.digits(10)}&#39;)
print(f&#39;c = {c.digits(10)}&#39;)
</code></pre><p>:::</p><a href=/security/practice/picoctf/crypto/rsa/picoctf---very-smooth/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---vne/>PicoCTF - VNE</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/pwn/>PWN</a>,
<a href=/tags/ctf/>CTF</a></div><p><h1 id=picoctf---vne>PicoCTF - VNE
<a class=anchor href=#picoctf---vne>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>System Environment
Command Injection</p><h2 id=description--hint>Description & Hint
<a class=anchor href=#description--hint>#</a></h2><p>We&rsquo;ve got a binary that can list directories as root, try it out !! ssh to saturn.picoctf.net:53176, and run the binary named &ldquo;bin&rdquo; once connected. Login as ctf-player with the password, d137d16e</p><ul><li>Hint 1: Have you checked the content of the /root folder</li><li>Hint 2: Find a way to add more instructions to the ls</li></ul><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Main Function</p><a href=/security/practice/picoctf/pwn/picoctf---vne/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/flow/picoctf---webnet0/>PicoCTF - WebNet0</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---webnet0>PicoCTF - WebNet0
<a class=anchor href=#picoctf---webnet0>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://blog.csdn.net/walleva96/article/details/106844033>解密TLS協議全記錄之利用wireshark解密</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題其實就只是利用wireshark把訊息解密就這樣，所以看了一些文章後就按圖施工就好，解密完後就直接string search就找到了</p><h2 id=exploit---tls-decrypt>Exploit - TLS Decrypt
<a class=anchor href=#exploit---tls-decrypt>#</a></h2><ol><li>在<code>Edit/Preferences/RSA Keys/</code>中<code>Add new keyfile</code>
<img src=https://hackmd.io/_uploads/ByMdwwSe6.png alt></li><li>加入題目給的private key file後記得要重新開啟該pcap file
<img src=https://hackmd.io/_uploads/S1PMPDSx6.png alt></li></ol></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/ctf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/13/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/12/ aria-label="Page 12" class=page-link role=button>12</a></li><li class=page-item><a href=/tags/ctf/page/13/ aria-label="Page 13" class=page-link role=button>13</a></li><li class="page-item active"><a aria-current=page aria-label="Page 14" class=page-link role=button>14</a></li><li class=page-item><a href=/tags/ctf/page/15/ aria-label="Page 15" class=page-link role=button>15</a></li><li class=page-item><a href=/tags/ctf/page/16/ aria-label="Page 16" class=page-link role=button>16</a></li><li class=page-item><a href=/tags/ctf/page/15/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/ctf/page/27/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>