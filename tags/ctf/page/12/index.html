<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ctf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CTF"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>CTF | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ctf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ctf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CTF</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---saas/>PicoCTF - SaaS</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---saas>PicoCTF - SaaS
<a class=anchor href=#picoctf---saas>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>seccomp-tool</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp=">#include &lt;errno.h&gt;
#include &lt;error.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;seccomp.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/syscall.h&gt;
#include &lt;unistd.h&gt;

#define SIZE 0x100

// http://shell-storm.org/online/Online-Assembler-and-Disassembler/?inst=xor+rax%2C+rax%0D%0Amov+rdi%2C+rsp%0D%0Aand+rdi%2C+0xfffffffffffff000%0D%0Asub+rdi%2C+0x2000%0D%0Amov+rcx%2C+0x600%0D%0Arep+stosq%0D%0Axor+rbx%2C+rbx%0D%0Axor+rcx%2C+rcx%0D%0Axor+rdx%2C+rdx%0D%0Axor+rsp%2C+rsp%0D%0Axor+rbp%2C+rbp%0D%0Axor+rsi%2C+rsi%0D%0Axor+rdi%2C+rdi%0D%0Axor+r8%2C+r8%0D%0Axor+r9%2C+r9%0D%0Axor+r10%2C+r10%0D%0Axor+r11%2C+r11%0D%0Axor+r12%2C+r12%0D%0Axor+r13%2C+r13%0D%0Axor+r14%2C+r14%0D%0Axor+r15%2C+r15%0D%0A&amp;arch=x86-64&amp;as_format=inline#assembly
#define HEADER &#34;\x48\x31\xc0\x48\x89\xe7\x48\x81\xe7\x00\xf0\xff\xff\x48\x81\xef\x00\x20\x00\x00\x48\xc7\xc1\x00\x06\x00\x00\xf3\x48\xab\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2\x48\x31\xe4\x48\x31\xed\x48\x31\xf6\x48\x31\xff\x4d\x31\xc0\x4d\x31\xc9\x4d\x31\xd2\x4d\x31\xdb\x4d\x31\xe4\x4d\x31\xed\x4d\x31\xf6\x4d\x31\xff&#34;

#define FLAG_SIZE 64

char flag[FLAG_SIZE];

void load_flag() {
  int fd;
  if ((fd = open(&#34;flag.txt&#34;, O_RDONLY)) == -1)
    error(EXIT_FAILURE, errno, &#34;open flag&#34;);
  if (read(fd, flag, FLAG_SIZE) == -1)
    error(EXIT_FAILURE, errno, &#34;read flag&#34;);
  if (close(fd) == -1)
    error(EXIT_FAILURE, errno, &#34;close flag&#34;);
}

void setup() {
  scmp_filter_ctx ctx;
  ctx = seccomp_init(SCMP_ACT_KILL);
  int ret = 0;
  if (ctx != NULL) {
    ret |= seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(write), 1,
      SCMP_A0(SCMP_CMP_EQ, STDOUT_FILENO));
    ret |= seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(exit), 0);
    ret |= seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(exit_group), 0);
    ret |= seccomp_load(ctx);
  }
  seccomp_release(ctx);
  if (ctx == NULL || ret)
    error(EXIT_FAILURE, 0, &#34;seccomp&#34;);
}

int main()
{
  setbuf(stdout, NULL);
  setbuf(stdin, NULL);
  setbuf(stderr, NULL);

  load_flag();
  puts(&#34;Welcome to Shellcode as a Service!&#34;);

  void* addr = mmap(NULL, 0x1000, PROT_EXEC | PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANON, -1, 0);
  memcpy(addr, HEADER, sizeof(HEADER));
  read(0, addr + sizeof(HEADER) - 1, SIZE);

  setup();
  goto *addr;
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/pwn/picoctf---saas/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---scavenger-hunt/>PicoCTF - Scavenger Hunt</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---scavenger-hunt>PicoCTF - Scavenger Hunt
<a class=anchor href=#picoctf---scavenger-hunt>#</a></h1><h6 id=tags-picoctf-ctf-web>tags: <code>PicoCTF</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-picoctf-ctf-web>#</a></h6><p>Challenge: <a href=http://mercury.picoctf.net:55079/>Scavenger Hunt</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://icodding.blogspot.com/2015/10/htaccess.html>.htaccess 使用技巧彙整</a></p><blockquote><p>.htaccess文件(或者」分佈式配置文件」）提供了針對目錄改變配置的方法， 即，在一個特定的文件目錄中放置一個包含一個或多個指令的文件， 以作用於此目錄及其所有子目錄。作為用戶，所能使用的命令受到限制。管理員可以通過Apache的AllowOverride指令來設置。
概述來說，htaccess文件是Apache伺服器中的一個配置文件，它負責相關目錄下的網頁配置。通過htaccess文件，可以幫我們實現：網頁301重定向、自定義404錯誤頁面、改變文件擴展名、允許/阻止特定的用戶或者目錄的訪問、禁止目錄列表、配置預設文件等功能。
.htaccess 詳解</p></blockquote><h2 id=exploit---insp3ct0r--htaccess--ds_store>Exploit - <a href=/gYsHjI-rSD6Lce-7eF6DyA>Insp3ct0r</a> + <code>htaccess</code> + <code>DS_Store</code>
<a class=anchor href=#exploit---insp3ct0r--htaccess--ds_store>#</a></h2><ol><li><p>HTML + CSS +JS
These files keeps one fragment flag each. Especially <code>js</code> file&rsquo;s hint: <code>/* How can I keep Google from indexing my website? */</code>
<img src=https://i.imgur.com/wuX9KLT.png alt></p></li><li><p>Apache server $\to$ <code>.htaccess</code> file
<img src=https://i.imgur.com/li2z8l4.png alt></p></li><li><p>Mac computer $\to$ <code>.DS_Store</code> file
<img src=https://i.imgur.com/iZfLWZ3.png alt></p><a href=/security/practice/picoctf/web/picoctf---scavenger-hunt/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/flow/picoctf---scrambled-bytes/>PicoCTF - scrambled-bytes</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---scrambled-bytes>PicoCTF - scrambled-bytes
<a class=anchor href=#picoctf---scrambled-bytes>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://www.readfog.com/a/1635090435931213824>盤點一款 Python 發包收包利器 - scapy</a></p><blockquote><h3 id=只發不收>只發不收
<a class=anchor href=#%e5%8f%aa%e7%99%bc%e4%b8%8d%e6%94%b6>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>send(pkt, inter<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>, loop<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>, count<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, iface<span style=color:#f92672>=</span>N) 
</span></span><span style=display:flex><span>pkt:數據包
</span></span><span style=display:flex><span>inter<span style=color:#960050;background-color:#1e0010>：</span>發包間隔時間
</span></span><span style=display:flex><span>count<span style=color:#960050;background-color:#1e0010>：</span>發包數量
</span></span><span style=display:flex><span>iface<span style=color:#960050;background-color:#1e0010>：</span>網卡接口名稱
</span></span><span style=display:flex><span>send()<span style=color:#960050;background-color:#1e0010>，</span>在第三層發包<span style=color:#960050;background-color:#1e0010>，</span>沒有接收功能<span style=color:#960050;background-color:#1e0010>；</span>send(IP(dst<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;www.baidu.com&#34;</span>,ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>/</span>ICMP())
</span></span><span style=display:flex><span>sendp()<span style=color:#960050;background-color:#1e0010>，</span>在第二層發包<span style=color:#960050;background-color:#1e0010>，</span>沒有接收功能<span style=color:#960050;background-color:#1e0010>。</span>sr(Ether()<span style=color:#f92672>/</span>IP(dst<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;www.baidu.com&#34;</span>))
</span></span></code></pre></div></blockquote><p><a href=https://docs.python.org/zh-tw/3/library/time.html#time.time>time-時間的訪問和轉換</a>
<a href=https://zhuanlan.zhihu.com/p/602431298>python 的pyshark庫如何使用</a>
<a href=https://segmentfault.com/a/1190000006064442>PyShark入門(2)：FileCapture和LiveCapture模塊</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python=">#!/usr/bin/env python3

import argparse
from progress.bar import IncrementalBar

from scapy.all import *
import ipaddress

import random
from time import time

def check_ip(ip):
  try:
    return ipaddress.ip_address(ip)
  except:
    raise argparse.ArgumentTypeError(f&#39;{ip} is an invalid address&#39;)

def check_port(port):
  try:
    port = int(port)
    if port &lt; 1 or port &gt; 65535:
      raise ValueError
    return port
  except:
    raise argparse.ArgumentTypeError(f&#39;{port} is an invalid port&#39;)

def main(args):
  with open(args.input, &#39;rb&#39;) as f:
    payload = bytearray(f.read())
  random.seed(int(time()))
  random.shuffle(payload)
  with IncrementalBar(&#39;Sending&#39;, max=len(payload)) as bar:
    for b in payload:
      send(
        IP(dst=str(args.destination)) /
        UDP(sport=random.randrange(65536), dport=args.port) /
        Raw(load=bytes([b^random.randrange(256)])),
      verbose=False)
      bar.next()

if __name__==&#39;__main__&#39;:
  parser = argparse.ArgumentParser()
  parser.add_argument(&#39;destination&#39;, help=&#39;destination IP address&#39;, type=check_ip)
  parser.add_argument(&#39;port&#39;, help=&#39;destination port number&#39;, type=check_port)
  parser.add_argument(&#39;input&#39;, help=&#39;input file&#39;)
  main(parser.parse_args())
</code></pre><p>:::</p><a href=/security/practice/picoctf/misc/flow/picoctf---scrambled-bytes/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/crypto/rsa/picoctf---scrambled_-rsa/>PicoCTF - Scrambled: RSA</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=picoctf---scrambled-rsa>PicoCTF - Scrambled: RSA
<a class=anchor href=#picoctf---scrambled-rsa>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><h2 id=hint>Hint
<a class=anchor href=#hint>#</a></h2><ul><li>Look at the ciphertext, anything fishy, maybe a little bit long?</li><li>What happens if you encrypt the same input multiple times?</li><li>Is RSA deterministic, why would outputs vary?</li></ul><h2 id=recon---通靈>Recon - <font color=FF0000>通靈</font>
<a class=anchor href=#recon---%e9%80%9a%e9%9d%88>#</a></h2><p>這一題也是頗有趣但要通靈，可以先亂Try</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ nc mercury.picoctf.net 61477
flag = ...
I will encrypt whatever you give me: b
Here you go: 26990049735578409030682378965549085676344091481060419655306695078226500400679435180914414853843456517959269938025436462371813167477339887511293320498195667717320879617653974074204687042294887795784122711621510485951142842770951325298677811102706200275406899117894241145575602912451443892687252208402011904237
I will encrypt whatever you give me: ba
Here you go: 2699004973557840903068237896554908567634409148106041965530669507822650040067943518091441485384345651795926993802543646237181316747733988751129332049819566771732087961765397407420468704229488779578412271162151048595114284277095132529867781110270620027540689911789424114557560291245144389268725220840201190423748281433709412944662646587136176334777506529508638551296181668932027523016538393747587852449462326357575277427356480410273494280971757044562513629423400967407332448126388859817313684399195291279961899276921240210270110225654310423792352532266414306766344869066386142998118001891330035563388790707576505068944
I will encrypt whatever you give me: bac
Here you go: 482814337094129446626465871361763347775065295086385512961816689320275230165383937475878524494623263575752774273564804102734942809717570445625136294234009674073324481263888598173136843991952912799618992769212402102701102256543104237923525322664143067663448690663861429981180018913300355633887907075765050689449619429085627210113794723864117161956939961066630142420889676674025917593454737310140819887001206562193281145515990410131903949359211712425034234736366286462137700473579439657314154736719868903719111785858132034797052503447042089004862886989401543635700329455353580959453911569277021402998961166474045310601826990049735578409030682378965549085676344091481060419655306695078226500400679435180914414853843456517959269938025436462371813167477339887511293320498195667717320879617653974074204687042294887795784122711621510485951142842770951325298677811102706200275406899117894241145575602912451443892687252208402011904237
...
</code></pre><p>一開始加密的<code>b</code>是<code>269900...904237</code>，第二個加密的<code>ba</code>是<code>26990...5068944</code>，但如果仔細看其實第一個加密的密文其實也存在其中，他其實是<code>269900...904237+482814...5068944</code>，可以加密第三個<code>bac</code>試看看，也會發現是<code>482814...5068944+961942...3106018+269900...904237</code>
所以我們可以再往這個方向測試一下，我們知道一開始的flag一定是<code>picoCTF{</code>，我們加密<code>p</code>會發現密文其實存在原始的flag密文當中，因此我們可以寫一個腳本，像上一題一樣暴力破解，如果加密的密文有存在原本的flag ciphertext中的話，就代表我們猜對了，反之就繼續找</p><a href=/security/practice/picoctf/crypto/rsa/picoctf---scrambled_-rsa/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---secrets/>PicoCTF - Secrets</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---secrets>PicoCTF - Secrets
<a class=anchor href=#picoctf---secrets>#</a></h1><h6 id=tags-picoctf-ctf-web>tags: <code>PicoCTF</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-picoctf-ctf-web>#</a></h6><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><ul><li>Description: We have several pages hidden. Can you find the one with the flag?</li><li>Hint: folders folders folders</li></ul><p>這一題也是蠻有趣的</p><h2 id=exploit---通靈>Exploit - <font color=FF0000>通靈</font>
<a class=anchor href=#exploit---%e9%80%9a%e9%9d%88>#</a></h2><ol><li><p>首先看一下網頁的source code，沒什麼特別的地方，但有看到<code>secret/assets/index.css</code>，所以有一個route是secrets，試看看有甚麼東西
<img src=https://hackmd.io/_uploads/HywRa08_n.png alt></p></li><li><p>發現這樣的想法是對的，陸續看一下source code有甚麼其他route，就繼續加在URL就對了
<img src=https://hackmd.io/_uploads/HyumC0U_2.png alt></p></li></ol><p>Payload: <code>view-source:http://saturn.picoctf.net:65352/secret/hidden/superhidden/</code>
Flag: <code>picoCTF{succ3ss_@h3n1c@10n_790d2615}</code></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://youtu.be/40DYCMInk5E>secrets | picoCTF 2022</a></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---seed-spring/>PicoCTF - seed-sPRiNG</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---seed-spring>PicoCTF - seed-sPRiNG
<a class=anchor href=#picoctf---seed-spring>#</a></h1><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Main Function</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp=">int __cdecl main(int argc, const char **argv, const char **envp)
{
  int guess_height; // [esp+0h] [ebp-18h] BYREF
  int ans; // [esp+4h] [ebp-14h]
  unsigned int seed; // [esp+8h] [ebp-10h]
  int i; // [esp+Ch] [ebp-Ch]
  int *p_argc; // [esp+10h] [ebp-8h]

  p_argc = &amp;argc;
  puts(&amp;unk_A50);
  puts(&amp;unk_A50);
  puts(&#34;                                                                             &#34;);
  puts(&#34;                          #                mmmmm  mmmmm    \&#34;    mm   m   mmm &#34;);
  puts(&#34;  mmm    mmm    mmm    mmm#          mmm   #   \&#34;# #   \&#34;# mmm    #\&#34;m  # m\&#34;   \&#34;&#34;);
  puts(&#34; #   \&#34;  #\&#34;  #  #\&#34;  #  #\&#34; \&#34;#         #   \&#34;  #mmm#\&#34; #mmmm\&#34;   #    # #m # #   mm&#34;);
  puts(&#34;  \&#34;\&#34;\&#34;m  #\&#34;\&#34;\&#34;\&#34;  #\&#34;\&#34;\&#34;\&#34;  #   #          \&#34;\&#34;\&#34;m  #      #   \&#34;m   #    #  # # #    #&#34;);
  puts(&#34; \&#34;mmm\&#34;  \&#34;#mm\&#34;  \&#34;#mm\&#34;  \&#34;#m##         \&#34;mmm\&#34;  #      #    \&#34; mm#mm  #   ##  \&#34;mmm\&#34;&#34;);
  puts(&#34;                                                                             &#34;);
  puts(&amp;unk_A50);
  puts(&amp;unk_A50);
  puts(&#34;Welcome! The game is easy: you jump on a sPRiNG.&#34;);
  puts(&#34;How high will you fly?&#34;);
  puts(&amp;unk_A50);
  fflush(stdout);
  seed = time(0);
  srand(seed);
  for ( i = 1; i &lt;= 30; ++i )
  {
    printf(&#34;LEVEL (%d/30)\n&#34;, i);
    puts(&amp;unk_A50);
    LOBYTE(ans) = rand() &amp; 0xF;
    ans = ans;
    printf(&#34;Guess the height: &#34;);
    fflush(stdout);
    __isoc99_scanf(&#34;%d&#34;, &amp;guess_height);
    fflush(stdin);
    if ( ans != guess_height )
    {
      puts(&#34;WRONG! Sorry, better luck next time!&#34;);
      fflush(stdout);
      exit(-1);
    }
  }
  puts(&#34;Congratulation! You&#39;ve won! Here is your flag:\n&#34;);
  fflush(stdout);
  get_flag();
  fflush(stdout);
  return 0;
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/pwn/picoctf---seed-spring/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/crypto/classic/picoctf---sequences/>PicoCTF - Sequences</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=picoctf---sequences>PicoCTF - Sequences
<a class=anchor href=#picoctf---sequences>#</a></h1><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python=">import math
import hashlib
import sys
from tqdm import tqdm
import functools

ITERS = int(2e7)
VERIF_KEY = &#34;96cc5f3b460732b442814fd33cf8537c&#34;
ENCRYPTED_FLAG = bytes.fromhex(&#34;42cbbce1487b443de1acf4834baed794f4bbd0dfe2d6046e248ff7962b&#34;)

# This will overflow the stack, it will need to be significantly optimized in order to get the answer :)
@functools.cache
def m_func(i):
    if i == 0: return 1
    if i == 1: return 2
    if i == 2: return 3
    if i == 3: return 4

    return 55692*m_func(i-4) - 9549*m_func(i-3) + 301*m_func(i-2) + 21*m_func(i-1)


# Decrypt the flag
def decrypt_flag(sol):
    sol = sol % (10**10000)
    sol = str(sol)
    sol_md5 = hashlib.md5(sol.encode()).hexdigest()

    if sol_md5 != VERIF_KEY:
        print(&#34;Incorrect solution&#34;)
        sys.exit(1)

    key = hashlib.sha256(sol.encode()).digest()
    flag = bytearray([char ^ key[i] for i, char in enumerate(ENCRYPTED_FLAG)]).decode()

    print(flag)

if __name__ == &#34;__main__&#34;:
    sol = m_func(ITERS)
    decrypt_flag(sol)
</code></pre><p>:::</p><a href=/security/practice/picoctf/crypto/classic/picoctf---sequences/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/flow/picoctf---shark-on-wire-1/>PicoCTF - shark on wire 1</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---shark-on-wire-1>PicoCTF - shark on wire 1
<a class=anchor href=#picoctf---shark-on-wire-1>#</a></h1><h6 id=tags-picoctf-ctf-misc>tags: <code>PicoCTF</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-picoctf-ctf-misc>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/30?category=4&amp;page=2">shark on wire 1</a></p><h2 id=exploit---analyze-udp-stream>Exploit - Analyze UDP stream
<a class=anchor href=#exploit---analyze-udp-stream>#</a></h2><p>It transfer the single character by UDP protocol.
<img src=https://i.imgur.com/ff5CsGr.png alt>
Follow the UDP stream and you&rsquo;ll get the flag
<img src=https://i.imgur.com/EfK83gj.png alt></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/flow/picoctf---shark-on-wire-2/>PicoCTF - shark on wire 2</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---shark-on-wire-2>PicoCTF - shark on wire 2
<a class=anchor href=#picoctf---shark-on-wire-2>#</a></h1><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一提出的很硬要，誰知道會把flag藏在這種地方，也沒有任何的提示，如果不是看<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>根本不知道這題要表達甚麼，也可能是我太蔡</p><ol><li>Simple Recon
首先做一些基本的recon，諸如dump files/string search/follow tcp or udp之類的，會發現UDP packets會有一些訊息出現，其中出現Start和一些a/b最後接著end
<img src=https://hackmd.io/_uploads/rkASlUD02.png alt>
<img src=https://hackmd.io/_uploads/BkxFgLPRn.png alt></li><li>Set filter as <code>udp.port==22</code>
會發現其中所有的len都一樣，就只有source port不一樣，同樣都是5xxx開頭，而後三位數就是flag
<img src=https://hackmd.io/_uploads/BJq71UvC2.png alt></li><li>Extract Flag
所以只要把所有的port擷取出來拚在一起，就可以拿到flag了</li></ol><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><pre tabindex=0><code class=language-python! data-lang=python!>import pyshark

capture = pyshark.FileCapture(&#39;./PicoCTF/Misc/shark on wire 2/capture.pcap&#39;, display_filter=&#39;udp.port == 22&#39;)

data = []
for pkt in capture:
    if pkt.udp.port != &#39;5000&#39;:
        data.append(chr(int(pkt.udp.port[1:])))
print(&#34;&#34;.join(data))
</code></pre><p>Flag: <code>picoCTF{p1LLf3r3d_data_v1a_st3g0}</code></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://zomry1.github.io/shark-on-wire-2/>PicoCTF 2019 - shark on wire 2:-1:</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p><a href=/security/practice/picoctf/misc/flow/picoctf---shark-on-wire-2/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/general/picoctf---sidechannel/>PicoCTF - SideChannel</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---sidechannel>PicoCTF - SideChannel
<a class=anchor href=#picoctf---sidechannel>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>There&rsquo;s something fishy about this PIN-code checker, can you figure out the PIN and get the flag? Download the PIN checker program here pin_checker Once you&rsquo;ve figured out the PIN (and gotten the checker program to accept it), connect to the master server using nc saturn.picoctf.net 50364 and provide it the PIN to get your flag.</p><p>Hint 1: Read about &ldquo;timing-based side-channel attacks.&rdquo;
Hint 2: Attempting to reverse-engineer or exploit the binary won&rsquo;t help you, you can figure out the PIN just by interacting with it and measuring certain properties about it.
Hint 3: Don&rsquo;t run your attacks against the master server, it is secured against them. The PIN code you get from the pin_checker binary is the same as the one for the master server.</p><a href=/security/practice/picoctf/misc/general/picoctf---sidechannel/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/ctf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/11/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/10/ aria-label="Page 10" class=page-link role=button>10</a></li><li class=page-item><a href=/tags/ctf/page/11/ aria-label="Page 11" class=page-link role=button>11</a></li><li class="page-item active"><a aria-current=page aria-label="Page 12" class=page-link role=button>12</a></li><li class=page-item><a href=/tags/ctf/page/13/ aria-label="Page 13" class=page-link role=button>13</a></li><li class=page-item><a href=/tags/ctf/page/14/ aria-label="Page 14" class=page-link role=button>14</a></li><li class=page-item><a href=/tags/ctf/page/13/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/ctf/page/27/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>