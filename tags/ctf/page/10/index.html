<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ctf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CTF"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>CTF | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ctf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ctf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CTF</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/picoctf/crypto/rsa/picoctf---mini-rsa/>PicoCTF - Mini RSA</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=picoctf---mini-rsa>PicoCTF - Mini RSA
<a class=anchor href=#picoctf---mini-rsa>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/188?category=2&amp;page=1">Mini RSA</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>N: <span style=color:#ae81ff>1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287</span>
</span></span><span style=display:flex><span>e: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ciphertext <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>: <span style=color:#ae81ff>1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808147130204332030239454609548193370732857240300019596815816006860639254992255194738107991811397196500685989396810773222940007523267032630601449381770324467476670441511297695830038371195786166055669921467988355155696963689199852044947912413082022187178952733134865103084455914904057821890898745653261258346107276390058792338949223415878232277034434046142510780902482500716765933896331360282637705554071922268580430157241598567522324772752885039646885713317810775113741411461898837845999905524246804112266440620557624165618470709586812253893125417659761396612984740891016230905299327084673080946823376058367658665796414168107502482827882764000030048859751949099453053128663379477059252309685864790106</span>
</span></span></code></pre></div><h2 id=exploit---small-e-attack>Exploit - Small <code>e</code> attack
<a class=anchor href=#exploit---small-e-attack>#</a></h2><pre tabindex=0><code class="language-python=" data-lang="python=">import gmpy2
from Crypto.Util.number import long_to_bytes


N = 1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287
e = 3
c = 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808147130204332030239454609548193370732857240300019596815816006860639254992255194738107991811397196500685989396810773222940007523267032630601449381770324467476670441511297695830038371195786166055669921467988355155696963689199852044947912413082022187178952733134865103084455914904057821890898745653261258346107276390058792338949223415878232277034434046142510780902482500716765933896331360282637705554071922268580430157241598567522324772752885039646885713317810775113741411461898837845999905524246804112266440620557624165618470709586812253893125417659761396612984740891016230905299327084673080946823376058367658665796414168107502482827882764000030048859751949099453053128663379477059252309685864790106

k = 1
while True:
    if gmpy2.iroot(c + N * k, 3)[1]==1:
        res=gmpy2.iroot(c + N * k, 3)[0]    
        print(k, res)
        print(long_to_bytes(res))
        break
    k += 1
</code></pre><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://zhuanlan.zhihu.com/p/76228394>CTF_RSA解密学习指南(三) - e=3 小明文攻击</a></p><a href=/security/practice/picoctf/crypto/rsa/picoctf---mini-rsa/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---more-sqli/>PicoCTF - More SQLi</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---more-sqli>PicoCTF - More SQLi
<a class=anchor href=#picoctf---more-sqli>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://lab.feifei.tw/practice/sqli/sql4.php>Feifei Lab</a></li><li>Hint SQLiLite</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>先隨便輸入發現他很貼心有給完整的payload，發現他是先檢查password，在沒有任何防護的情況下，直接用最經典的payload就可了
Account: Any
Password: <code>' or '1'='1' -- #</code>
<img src=https://hackmd.io/_uploads/rJXd-oLd3.png alt></p><hr><p><img src=https://hackmd.io/_uploads/Bki0WoLd3.png alt></p><h2 id=exploit---sqliunion-selection>Exploit - SQLi(Union Selection)
<a class=anchor href=#exploit---sqliunion-selection>#</a></h2><p>現在的目標是flag應該是藏在別的table，所以先找甚麼table</p><ol><li><p>找table
透過<a href=https://github.com/w181496/Web-CTF-Cheatsheet#sqlite>Kaibro的cheat sheet</a>，SQLite的爆破payload是<code>SELECT name FROM sqlite_master WHERE type='table'</code>，而目前我們可以用union based的方式搜尋，先觀察搜尋<code>Algiers</code>的搜尋column有三個，第一個column是chr，第二個column是chr，第三個是int，所以在用union select的時候要遵守<font color=FF0000><strong>查詢數量一樣、每個欄位的型態一樣</strong></font>
Payload: <code>Algiers' union SELECT sql,sql,1 FROM sqlite_master WHERE type='table'; --</code>
:::spoiler Screenshot
<img src=https://hackmd.io/_uploads/rk9G4oLO2.png alt>
:::</p></li><li><p>Find Flag - Union based
目前發現有兩個table比較可疑</p><ul><li>CREATE TABLE hints (id INTEGER NOT NULL PRIMARY KEY, info TEXT)</li><li>CREATE TABLE more_table (id INTEGER NOT NULL PRIMARY KEY, flag TEXT)</li></ul><p>可以直接用前面同樣的方式找flag，觀察這個table只有兩個column，且一個column的type是int，另外一個是text，而第三個column就隨便填
Payload: <code>Algiers' union SELECT id,flag,1 FROM more_table; --</code>
:::spoiler Screenshot
<img src=https://hackmd.io/_uploads/ryonEoIdn.png alt>
:::
Flag: <code>picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_98236ce6}</code></p><a href=/security/practice/picoctf/web/picoctf---more-sqli/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---most-cookies/>PicoCTF - Most Cookies</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---most-cookies>PicoCTF - Most Cookies
<a class=anchor href=#picoctf---most-cookies>#</a></h1><h6 id=tags-picoctf-ctf-web>tags: <code>PicoCTF</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-picoctf-ctf-web>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://vocus.cc/article/634c1c7efd89780001237de9>Python Flask session 學習心得</a></p><blockquote><p>在Flask將資料儲存在session這個object裡面時，可看成是儲存在client端，因為資料其實是存在web server，每次新增內容到session就會新增一個新的cookie(cryptographically-signed cookies)，並透過secret_key做簽章。需注意的是這所謂的「secret_key」並不是用於加密(切勿儲存機密資料)，而是用來做數位簽章確認資料的完整性，簡單說是每個人都可以知道cookie裡面的資料，但只有server知道cookie是否被串改，如果被串改就無法登入該帳戶。</p></blockquote><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python=">from flask import Flask, render_template, request, url_for, redirect, make_response, flash, session
import random
app = Flask(__name__)
flag_value = open(&#34;./flag&#34;).read().rstrip()
title = &#34;Most Cookies&#34;
cookie_names = [&#34;snickerdoodle&#34;, &#34;chocolate chip&#34;, &#34;oatmeal raisin&#34;, &#34;gingersnap&#34;, &#34;shortbread&#34;, &#34;peanut butter&#34;, &#34;whoopie pie&#34;, &#34;sugar&#34;, &#34;molasses&#34;, &#34;kiss&#34;, &#34;biscotti&#34;, &#34;butter&#34;, &#34;spritz&#34;, &#34;snowball&#34;, &#34;drop&#34;, &#34;thumbprint&#34;, &#34;pinwheel&#34;, &#34;wafer&#34;, &#34;macaroon&#34;, &#34;fortune&#34;, &#34;crinkle&#34;, &#34;icebox&#34;, &#34;gingerbread&#34;, &#34;tassie&#34;, &#34;lebkuchen&#34;, &#34;macaron&#34;, &#34;black and white&#34;, &#34;white chocolate macadamia&#34;]
app.secret_key = random.choice(cookie_names)

@app.route(&#34;/&#34;)
def main():
	if session.get(&#34;very_auth&#34;):
		check = session[&#34;very_auth&#34;]
		if check == &#34;blank&#34;:
			return render_template(&#34;index.html&#34;, title=title)
		else:
			return make_response(redirect(&#34;/display&#34;))
	else:
		resp = make_response(redirect(&#34;/&#34;))
		session[&#34;very_auth&#34;] = &#34;blank&#34;
		return resp

@app.route(&#34;/search&#34;, methods=[&#34;GET&#34;, &#34;POST&#34;])
def search():
	if &#34;name&#34; in request.form and request.form[&#34;name&#34;] in cookie_names:
		resp = make_response(redirect(&#34;/display&#34;))
		session[&#34;very_auth&#34;] = request.form[&#34;name&#34;]
		return resp
	else:
		message = &#34;That doesn&#39;t appear to be a valid cookie.&#34;
		category = &#34;danger&#34;
		flash(message, category)
		resp = make_response(redirect(&#34;/&#34;))
		session[&#34;very_auth&#34;] = &#34;blank&#34;
		return resp

@app.route(&#34;/reset&#34;)
def reset():
	resp = make_response(redirect(&#34;/&#34;))
	session.pop(&#34;very_auth&#34;, None)
	return resp

@app.route(&#34;/display&#34;, methods=[&#34;GET&#34;])
def flag():
	if session.get(&#34;very_auth&#34;):
		check = session[&#34;very_auth&#34;]
		if check == &#34;admin&#34;:
			resp = make_response(render_template(&#34;flag.html&#34;, value=flag_value, title=title))
			return resp
		flash(&#34;That is a cookie! Not very special though...&#34;, &#34;success&#34;)
		return render_template(&#34;not-flag.html&#34;, title=title, cookie_name=session[&#34;very_auth&#34;])
	else:
		resp = make_response(redirect(&#34;/&#34;))
		session[&#34;very_auth&#34;] = &#34;blank&#34;
		return resp

if __name__ == &#34;__main__&#34;:
	app.run()
</code></pre><p>:::</p><a href=/security/practice/picoctf/web/picoctf---most-cookies/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/general-skills/picoctf---mus1c/>PicoCTF - mus1c</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/general-skill/>General Skill</a></div><p><h1 id=picoctf---mus1c>PicoCTF - mus1c
<a class=anchor href=#picoctf---mus1c>#</a></h1><h6 id=tags-picoctf-ctf-general-skill>tags: <code>PicoCTF</code> <code>CTF</code> <code>General Skill</code>
<a class=anchor href=#tags-picoctf-ctf-general-skill>#</a></h6><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Lyrics</p><pre tabindex=0><code>Pico&#39;s a CTFFFFFFF
my mind is waitin
It&#39;s waitin

Put my mind of Pico into This
my flag is not found
put This into my flag
put my flag into Pico


shout Pico
shout Pico
shout Pico

My song&#39;s something
put Pico into This

Knock This down, down, down
put This into CTF

shout CTF
my lyric is nothing
Put This without my song into my lyric
Knock my lyric down, down, down

shout my lyric

Put my lyric into This
Put my song with This into my lyric
Knock my lyric down

shout my lyric

Build my lyric up, up ,up

shout my lyric
shout Pico
shout It

Pico CTF is fun
security is important
Fun is fun
Put security with fun into Pico CTF
Build Fun up
shout fun times Pico CTF
put fun times Pico CTF into my song

build it up

shout it
shout it

build it up, up
shout it
shout Pico
</code></pre><p>:::</p><a href=/security/practice/picoctf/general-skills/picoctf---mus1c/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/crypto/classic/picoctf---new-caesar/>PicoCTF - New Caesar</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=picoctf---new-caesar>PicoCTF - New Caesar
<a class=anchor href=#picoctf---new-caesar>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/158?category=2&amp;page=1">New Caesar</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>::: spoiler source code</p><pre tabindex=0><code class="language-python=" data-lang="python=">import string

LOWERCASE_OFFSET = ord(&#34;a&#34;)
ALPHABET = string.ascii_lowercase[:16]

def b16_encode(plain):
	enc = &#34;&#34;
	for c in plain:
		binary = &#34;{0:08b}&#34;.format(ord(c))
		enc += ALPHABET[int(binary[:4], 2)]
		enc += ALPHABET[int(binary[4:], 2)]
	return enc

def shift(c, k):
	t1 = ord(c) - LOWERCASE_OFFSET
	t2 = ord(k) - LOWERCASE_OFFSET
	return ALPHABET[(t1 + t2) % len(ALPHABET)]

flag = &#34;redacted&#34;
key = &#34;redacted&#34;
assert all([k in ALPHABET for k in key])
assert len(key) == 1

b16 = b16_encode(flag)
enc = &#34;&#34;
for i, c in enumerate(b16):
	enc += shift(c, key[i % len(key)])
print(enc)
</code></pre><p>:::</p><a href=/security/practice/picoctf/crypto/classic/picoctf---new-caesar/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/crypto/rsa/picoctf---no-padding-no-problem/>PicoCTF - No Padding, No Problem</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=picoctf---no-padding-no-problem>PicoCTF - No Padding, No Problem
<a class=anchor href=#picoctf---no-padding-no-problem>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><p>Oracles can be your best friend, they will decrypt anything, except the flag&rsquo;s ciphertext. How will you break it? Connect with nc mercury.picoctf.net 10333.</p><h2 id=hint>Hint
<a class=anchor href=#hint>#</a></h2><p>What can you do with a different pair of ciphertext and plaintext? What if it is not so different after all&mldr;</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>We can try to decrypt ciphertext directly.</p><a href=/security/practice/picoctf/crypto/rsa/picoctf---no-padding-no-problem/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---no-way-out/>PicoCTF - No way out</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---no-way-out>PicoCTF - No way out
<a class=anchor href=#picoctf---no-way-out>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>C Sharp / dn.spy / cheat engine</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>大概有三種解法，其中兩種是改變.dll中的內容，有點利用binary exploitation的方式顯示flag，另外一種就是利用cheat engine的方式找到儲存座標的memory然後手動改寫數值，就拿到flag</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><h3 id=method-1---change-dll>Method 1 - Change .dll
<a class=anchor href=#method-1---change-dll>#</a></h3><ol><li><p>可以看到<code>No way out/pico_Data/Managed/Assembly-CSharp.dll</code>可能是一個可以用dn.spy decompile的文件，先看看有沒有甚麼可以更改的</p></li><li><p>在APTX class中，一個Mysterious的member，而且當<code>collision.gameObject == this.player</code>是true的時候，<code>this.Mysterious.SetActive(true);</code>就會被trigger，所以這就有點像是我們在遊戲中，如果要碰到白色旗子的時候會觸發的statement，那如果我在初始化的階段就直接把<code>this.Mysterious.SetActive(true);</code>設定成true，是不是就可以直接拿直到flag?
<img src=https://hackmd.io/_uploads/rylVM-rah.png alt></p></li><li><p>Implementation
直接右鍵edit class變成多加一個Start() method，然後不用任何的條件就達到剛剛說的效果，切記一定要是Start，因為Start是有被實際呼叫的method，如果取個aaa這種名字，他本來就不會被呼叫，那改成這樣也沒意義，當然，也可以取其他會被呼叫到的method name，例如Update, Awake之類的
<img src=https://hackmd.io/_uploads/rJ-UNZBp3.png alt></p><p><img src=https://hackmd.io/_uploads/Hy_pE-HT2.png alt></p></li></ol><h3 id=method-2---change-dll>Method 2 - Change .dll
<a class=anchor href=#method-2---change-dll>#</a></h3><p>當然記得能改動.dll的method，我們也可以改變遊戲角色跳不過圍牆的問題，最直觀的作法是我可以直接無限制的往上跳，超過圍牆就抵達flag，不會只有跳一小段這個問題，可以查看一下<code>EvolveGames/PlayerController/Update()</code>這個method，其中的第51行</p><pre tabindex=0><code class=language-csharp! data-lang=csharp!>if (Input.GetButton(&#34;Jump&#34;) &amp;&amp; this.canMove &amp;&amp; this.characterController.isGrounded &amp;&amp; !this.isClimbing)
{
    this.moveDirection.y = this.jumpSpeed;
}
</code></pre><p>如果改成</p><a href=/security/practice/picoctf/reverse/picoctf---no-way-out/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---not-crypto/>PicoCTF - not crypto</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---not-crypto>PicoCTF - not crypto
<a class=anchor href=#picoctf---not-crypto>#</a></h1><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Pseudo Source COde</p><pre tabindex=0><code class=language-clike! data-lang=clike!>__int64 __fastcall main(int a1, char **a2, char **a3)
{
  __int128 *v4; // rax
  unsigned __int8 v5; // di
  unsigned __int8 v6; // si
  unsigned __int8 v7; // cl
  unsigned __int8 v8; // dl
  unsigned int v9; // r8d
  unsigned __int8 v10; // r11
  int v16; // eax
  __int64 v17; // rdx
  unsigned int v18; // r12d
  char *v20; // r15
  unsigned __int8 v25; // r8
  int v30; // esi
  unsigned __int8 v32; // r12
  unsigned __int8 v36; // r14
  unsigned __int8 v38; // dl
  unsigned __int8 v40; // cl
  char v42; // r12
  char v43; // r14
  char v44; // al
  __int64 v45; // r13
  unsigned __int8 v46; // r10
  unsigned __int8 v47; // bp
  unsigned __int8 v48; // bl
  unsigned __int8 v49; // r8
  unsigned __int8 v50; // r11
  char v51; // dl
  char v54; // r10
  __int64 v63; // rdx
  char v72; // al
  unsigned __int8 v84; // [rsp+Ah] [rbp-1FEh]
  unsigned __int8 v85; // [rsp+Bh] [rbp-1FDh]
  int v86; // [rsp+Ch] [rbp-1FCh]
  int v87; // [rsp+10h] [rbp-1F8h]
  unsigned __int8 v88; // [rsp+14h] [rbp-1F4h]
  unsigned __int8 v89; // [rsp+15h] [rbp-1F3h]
  unsigned __int8 v90; // [rsp+16h] [rbp-1F2h]
  unsigned __int8 v91; // [rsp+17h] [rbp-1F1h]
  unsigned __int8 v92; // [rsp+18h] [rbp-1F0h]
  unsigned __int8 v93; // [rsp+19h] [rbp-1EFh]
  unsigned __int8 v94; // [rsp+1Ah] [rbp-1EEh]
  unsigned __int8 v95; // [rsp+1Bh] [rbp-1EDh]
  unsigned __int8 v96; // [rsp+1Ch] [rbp-1ECh]
  char v97; // [rsp+1Dh] [rbp-1EBh]
  char *v98; // [rsp+20h] [rbp-1E8h]
  unsigned __int8 v99; // [rsp+2Ah] [rbp-1DEh]
  char v100; // [rsp+50h] [rbp-1B8h]
  char v101; // [rsp+52h] [rbp-1B6h]
  char v102; // [rsp+54h] [rbp-1B4h]
  char v103; // [rsp+56h] [rbp-1B2h]
  char v104; // [rsp+58h] [rbp-1B0h]
  char v105; // [rsp+5Ah] [rbp-1AEh]
  char v106; // [rsp+5Ch] [rbp-1ACh]
  char v107; // [rsp+5Eh] [rbp-1AAh]
  __int128 v108; // [rsp+60h] [rbp-1A8h]
  char ptr[64]; // [rsp+70h] [rbp-198h] BYREF
  __int128 v110; // [rsp+B0h] [rbp-158h] BYREF
  char v111; // [rsp+C0h] [rbp-148h] BYREF
  char v112[15]; // [rsp+150h] [rbp-B8h] BYREF
  __int128 v113; // [rsp+160h] [rbp-A8h]
  __int128 v115[4]; // [rsp+180h] [rbp-88h] BYREF
  char v116; // [rsp+1C0h] [rbp-48h] BYREF
  unsigned __int64 v117; // [rsp+1C8h] [rbp-40h]

  v117 = __readfsqword(0x28u);
  puts(&#34;I heard you wanted to bargain for a flag... whatcha got?&#34;);
  __asm { vmovdqa xmm0, cs:xmmword_21A0 }
  v4 = &amp;v110;
  v5 = -104;
  v6 = 50;
  v7 = 108;
  v8 = 28;
  __asm { vmovdqa [rsp+208h+var_158], xmm0 }
  v9 = 4;
  do
  {
    if ( (v9 &amp; 3) == 0 )
    {
      v10 = byte_20A0[v6];
      v6 = byte_20A0[v7];
      v7 = byte_20A0[v8];
      v8 = byte_20A0[v5];
      v5 = byte_2080[v9 &gt;&gt; 2] ^ v10;
    }
    v5 ^= *v4;
    ++v9;
    v4 = (v4 + 4);
    v6 ^= *(v4 - 3);
    v7 ^= *(v4 - 2);
    v8 ^= *(v4 - 1);
    *(v4 + 12) = v5;
    *(v4 + 13) = v6;
    *(v4 + 14) = v7;
    *(v4 + 15) = v8;
  }
  while ( v9 != 44 );
  __asm
  {
    vmovdqa xmm0, cs:xmmword_21B0
    vmovdqa [rsp+208h+var_A8], xmm0
  }
  fread(ptr, 1uLL, 0x40uLL, stdin);
  __asm
  {
    vmovdqa xmm0, cs:xmmword_21C0
    vmovdqa [rsp+208h+var_88], xmm0
    vmovdqa xmm0, cs:xmmword_21D0
  }
  v108 = v110;
  __asm
  {
    vmovdqa [rsp+208h+var_78], xmm0
    vmovdqa xmm0, cs:xmmword_21E0
    vmovdqa [rsp+208h+var_68], xmm0
    vmovdqa xmm0, cs:xmmword_21F0
    vmovdqa [rsp+208h+var_58], xmm0
  }
  v100 = v112[0];
  v101 = v112[2];
  v102 = v112[4];
  v103 = v112[6];
  v104 = v112[8];
  v105 = v112[10];
  v106 = v112[12];
  v107 = v112[14];
  v98 = v115;
  v16 = 16;
  do
  {
    if ( v16 == 16 )
    {
      v20 = &amp;v111;
      __asm { vmovdqa xmm4, [rsp+208h+var_A8] }
      LOBYTE(v87) = byte_20A0[(v113 ^ v108)];
      __asm { vpextrb rax, xmm4, 4 }
      LOBYTE(v86) = byte_20A0[(BYTE4(v108) ^ _RAX)];
      v94 = byte_20A0[BYTE8(v113) ^ BYTE8(v108)];
      __asm { vpextrb rax, xmm4, 0Ch }
      v93 = byte_20A0[(BYTE12(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 1 }
      v25 = byte_20A0[(BYTE1(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 5 }
      v85 = byte_20A0[(BYTE5(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 9 }
      v84 = byte_20A0[(BYTE9(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Dh }
      v92 = byte_20A0[(BYTE13(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 2 }
      LOBYTE(v30) = byte_20A0[(BYTE2(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 6 }
      v32 = byte_20A0[(BYTE6(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Ah }
      v91 = byte_20A0[(BYTE10(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Eh }
      v96 = v32;
      v88 = v25;
      v90 = byte_20A0[(BYTE14(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 3 }
      v36 = byte_20A0[(BYTE3(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 7 }
      v95 = v36;
      v38 = byte_20A0[(BYTE7(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Bh }
      v40 = byte_20A0[(BYTE11(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Fh }
      v89 = byte_20A0[(HIBYTE(v108) ^ _RAX)];
      do
      {
        v42 = v91 ^ v89 ^ v87 ^ v85;
        v99 = v87 ^ v89;
        v43 = v90 ^ v95 ^ v86 ^ v84;
        v97 = v30 ^ v38 ^ v94 ^ v92;
        v44 = v40 ^ v96 ^ v93 ^ v88;
        v45 = ((2 * (v86 ^ v95)) ^ (27 * ((v86 ^ v95) &gt;&gt; 7)) ^ v95 ^ v43 ^ v20[7]);
        v46 = v20[10] ^ v97 ^ v30 ^ (27 * ((v30 ^ v38) &gt;&gt; 7)) ^ (2 * (v30 ^ v38));
        v47 = v20[11] ^ v97 ^ v38 ^ (2 * (v38 ^ v94)) ^ (27 * ((v38 ^ v94) &gt;&gt; 7));
        v48 = v88 ^ v44 ^ v20[13] ^ (2 * (v88 ^ v96)) ^ (27 * ((v88 ^ v96) &gt;&gt; 7));
        v49 = v96 ^ v44 ^ v20[14] ^ (27 * ((v40 ^ v96) &gt;&gt; 7)) ^ (2 * (v40 ^ v96));
        v50 = v44 ^ v20[15] ^ v40 ^ (2 * (v40 ^ v93)) ^ (27 * ((v40 ^ v93) &gt;&gt; 7));
        LOBYTE(v87) = byte_20A0[((2 * (v87 ^ v85)) ^ (27 * ((v87 ^ v85) &gt;&gt; 7)) ^ v42 ^ *v20 ^ v87)];
        LOBYTE(v86) = byte_20A0[((2 * (v86 ^ v84)) ^ (27 * ((v86 ^ v84) &gt;&gt; 7)) ^ v86 ^ v43 ^ v20[4])];
        v94 = byte_20A0[((2 * (v94 ^ v92)) ^ (27 * ((v94 ^ v92) &gt;&gt; 7)) ^ v94 ^ v97 ^ v20[8])];
        v93 = byte_20A0[((27 * ((v93 ^ v88) &gt;&gt; 7)) ^ (2 * (v93 ^ v88)) ^ v93 ^ v20[12] ^ v44)];
        v88 = byte_20A0[((2 * (v85 ^ v91)) ^ (27 * ((v85 ^ v91) &gt;&gt; 7)) ^ v85 ^ v42 ^ v20[1])];
        v85 = byte_20A0[((27 * ((v84 ^ v90) &gt;&gt; 7)) ^ (2 * (v84 ^ v90)) ^ v84 ^ v43 ^ v20[5])];
        v84 = byte_20A0[((27 * ((v30 ^ v92) &gt;&gt; 7)) ^ (2 * (v30 ^ v92)) ^ v20[9] ^ v97 ^ v92)];
        v92 = byte_20A0[v48];
        v51 = v91 ^ v42 ^ v20[2];
        v20 += 16;
        v30 = byte_20A0[((2 * (v91 ^ v89)) ^ (27 * ((v91 ^ v89) &gt;&gt; 7)) ^ v51)];
        v96 = byte_20A0[((27 * ((v90 ^ v95) &gt;&gt; 7)) ^ (2 * (v90 ^ v95)) ^ v43 ^ *(v20 - 10) ^ v90)];
        v91 = byte_20A0[v46];
        v90 = byte_20A0[v49];
        v40 = byte_20A0[v47];
        v38 = byte_20A0[v45];
        v95 = byte_20A0[((27 * (v99 &gt;&gt; 7)) ^ (2 * v99) ^ v89 ^ v42 ^ *(v20 - 13))];
        v89 = byte_20A0[v50];
      }
      while ( v112 != v20 );
      LOBYTE(v30) = v105 ^ v30;
      LOBYTE(v87) = v100 ^ v87;
      _R15D = v30;
      __asm { vmovd   xmm5, r15d }
      v54 = v86;
      LOBYTE(v86) = v103 ^ v90;
      _R9D = (v101 ^ v91);
      _R10D = (v102 ^ v54);
      _EDX = (v107 ^ v96);
      _R13D = (v104 ^ v94);
      __asm
      {
        vmovd   xmm4, edx
        vmovd   xmm7, r9d
        vpinsrb xmm5, xmm5, ebx, 1
        vmovd   xmm3, r10d
      }
      v63 = 15LL;
      _ESI = (v106 ^ v93);
      __asm
      {
        vmovd   xmm1, r13d
        vmovd   xmm0, [rsp+208h+var_1F8]
        vmovd   xmm6, [rsp+208h+var_1FC]
        vpinsrb xmm7, xmm7, [rsp+208h+var_1FD], 1
        vpinsrb xmm0, xmm0, eax, 1
        vpinsrb xmm1, xmm1, r11d, 1
        vpunpcklwd xmm0, xmm0, xmm7
      }
      v72 = HIBYTE(v113);
      __asm
      {
        vpinsrb xmm3, xmm3, [rsp+208h+var_1FE], 1
        vpinsrb xmm6, xmm6, [rsp+208h+var_1F4], 1
        vpunpcklwd xmm1, xmm1, xmm5
        vpunpcklwd xmm3, xmm3, xmm6
        vmovd   xmm2, esi
        vpunpckldq xmm0, xmm0, xmm3
        vpinsrb xmm2, xmm2, r8d, 1
        vpinsrb xmm4, xmm4, ecx, 1
        vpunpcklwd xmm2, xmm2, xmm4
        vpunpckldq xmm1, xmm1, xmm2
        vpunpcklqdq xmm0, xmm0, xmm1
        vmovdqa [rsp+208h+var_98], xmm0
      }
      if ( HIBYTE(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE14(v113);
      HIBYTE(v113) = 0;
      v63 = 14LL;
      if ( BYTE14(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE13(v113);
      BYTE14(v113) = 0;
      v63 = 13LL;
      if ( BYTE13(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE12(v113);
      BYTE13(v113) = 0;
      v63 = 12LL;
      if ( BYTE12(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE11(v113);
      BYTE12(v113) = 0;
      v63 = 11LL;
      if ( BYTE11(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE10(v113);
      BYTE11(v113) = 0;
      v63 = 10LL;
      if ( BYTE10(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE9(v113);
      BYTE10(v113) = 0;
      v63 = 9LL;
      if ( BYTE9(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE8(v113);
      BYTE9(v113) = 0;
      v63 = 8LL;
      if ( BYTE8(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE7(v113);
      BYTE8(v113) = 0;
      v63 = 7LL;
      if ( BYTE7(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE6(v113);
      BYTE7(v113) = 0;
      v63 = 6LL;
      if ( BYTE6(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE5(v113);
      BYTE6(v113) = 0;
      v63 = 5LL;
      if ( BYTE5(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE4(v113);
      BYTE5(v113) = 0;
      v63 = 4LL;
      if ( BYTE4(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE3(v113);
      BYTE4(v113) = 0;
      v63 = 3LL;
      if ( BYTE3(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE2(v113);
      BYTE3(v113) = 0;
      v63 = 2LL;
      if ( BYTE2(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE1(v113);
      BYTE2(v113) = 0;
      v63 = 1LL;
      if ( BYTE1(v113) == 0xFF &amp;&amp; (v72 = v113, BYTE1(v113) = 0, v63 = 0LL, v113 == 0xFF) )
      {
        LOBYTE(v113) = 0;
        v16 = 0;
      }
      else
      {
LABEL_14:
        *(&amp;v113 + v63) = v72 + 1;
        v16 = 0;
      }
    }
    v17 = v16++;
    *v98++ ^= *(&amp;v115[-1] + v17);
  }
  while ( &amp;v116 != v98 );
  v18 = memcmp(v115, ptr, 0x40uLL);
  if ( v18 )
  {
    v18 = 1;
    puts(&#34;Nope, come back later&#34;);
  }
  else
  {
    puts(&#34;Yep, that&#39;s it!&#34;);
  }
  return v18;
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---not-crypto/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---notepad/>PicoCTF - notepad</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---notepad>PicoCTF - notepad
<a class=anchor href=#picoctf---notepad>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://hackmd.io/@shaoeChen/BkApyHhgf?type=view">Flask實作_基礎_03_簡述url_for與route</a>
<a href=https://tedboy.github.io/flask/generated/werkzeug.url_fix.html>werkzeug.url_fix</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/crypto/rsa/picoctf---nsa-backdoor/>PicoCTF - NSA Backdoor</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=picoctf---nsa-backdoor>PicoCTF - NSA Backdoor
<a class=anchor href=#picoctf---nsa-backdoor>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://blog.csdn.net/ACdreamers/article/details/8579511>Baby Step Giant Step - BSGS</a></p><blockquote><p>用来解决如下方程最小正整數解的
$A^x\equiv B(mod\ C)$，其中$0\le x\lt C$
如果$A\ge C, B\ge C$，那麼我們可以先取模，即$A% = C, B% = C$，所以在這裡我們只討論$0\le A, B\lt C$的情況。
普通的BSGS的步驟是這樣的：</p><ol><li>首先確定$x$的下限是$0$，上限是$C$，我們令$M=\lceil C\rceil$</li><li>把$A^0~A^M\ mod\ C$的值存到一个Hash表裡面</li><li>把$(A^M)^0~(A^M)^M\ mod\ C$的值一一枚舉出來，每枚舉一個就在Hash表裡面尋找是否有一個$val$值滿足$val \cdot (A^M)^i\ mod\ C=B$，如果有則找到答案，否則繼續</li><li>最終答案就是$i\cdot M+val$的值對應的原來$A$的冪
上面是普通Baby Step Giant Step的步驟，比較簡單，只適用為素數的情況。如果為合數呢？</li></ol></blockquote><p>拓展的過程詳見全文</p><hr><p><a href=https://blog.csdn.net/oampamp1/article/details/104061969>離散對數問題 - pohlig-hellman算法講解</a></p><blockquote><ol><li><p>需要注意的是，pohlig-hellman算法的覆雜度在一般情況下比BSGS高！
因此，使用pohlig-hellman的場合只能是較為特殊的情況，即:$p$是質數，且$p-1$包含的質因子較少&較小。</p></li><li><p>和BSGS算法一樣，pohlig-hellman算法也是用於解決離散對數問題（也有很多文獻提到是解決橢圓曲線之類的）。即給定$a,b,p$,求 $a^x \equiv b(mod\ p)$。</p><a href=/security/practice/picoctf/crypto/rsa/picoctf---nsa-backdoor/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/ctf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/9/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/8/ aria-label="Page 8" class=page-link role=button>8</a></li><li class=page-item><a href=/tags/ctf/page/9/ aria-label="Page 9" class=page-link role=button>9</a></li><li class="page-item active"><a aria-current=page aria-label="Page 10" class=page-link role=button>10</a></li><li class=page-item><a href=/tags/ctf/page/11/ aria-label="Page 11" class=page-link role=button>11</a></li><li class=page-item><a href=/tags/ctf/page/12/ aria-label="Page 12" class=page-link role=button>12</a></li><li class=page-item><a href=/tags/ctf/page/11/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/ctf/page/27/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>