<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ctf/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="CTF"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>CTF | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ctf/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ctf/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>CTF</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/picoctf/misc/disk/picoctf---sleuthkit-intro/>PicoCTF - Sleuthkit Intro</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=picoctf---sleuthkit-intro>PicoCTF - Sleuthkit Intro
<a class=anchor href=#picoctf---sleuthkit-intro>#</a></h1><h6 id=tags-picoctf-ctf-misc>tags: <code>PicoCTF</code> <code>CTF</code> <code>Misc</code>
<a class=anchor href=#tags-picoctf-ctf-misc>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/301?category=4&amp;page=2">Sleuthkit Intro</a></p><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><blockquote><p>Download the disk image and use <font color=FF0000>mmls</font> on it to find the size of the Linux partition. Connect to the remote checker service to check your answer and get the flag. Note: if you are using the webshell, download and extract the disk image into /tmp not your home directory.</p></blockquote><pre><code>Download disk image
Access checker program: nc saturn.picoctf.net 52279
</code></pre><p><a href="https://blog.csdn.net/qq_40399982/article/details/114882879?spm=1001.2014.3001.5506">最新kali之mmls</a></p><a href=/security/practice/picoctf/misc/disk/picoctf---sleuthkit-intro/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---some-assembly-required-1/>PicoCTF - Some Assembly Required 1</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---some-assembly-required-1>PicoCTF - Some Assembly Required 1
<a class=anchor href=#picoctf---some-assembly-required-1>#</a></h1><h6 id=tags-picoctf-ctf-web>tags: <code>PicoCTF</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-picoctf-ctf-web>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/152?category=1&amp;page=1">Some Assembly Required 1</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://blog.techbridge.cc/2017/06/17/webassembly-js-future/>了解 WebAssembly 的基礎使用方法</a></p><h2 id=source-code---after-beautify>Source code - After <a href=https://beautifier.io/>Beautify</a>
<a class=anchor href=#source-code---after-beautify>#</a></h2><p>:::spoiler source code</p><pre tabindex=0><code class="language-javascript=" data-lang="javascript=">const strings = [&#39;value&#39;, &#39;2wfTpTR&#39;, &#39;instantiate&#39;, &#39;275341bEPcme&#39;, &#39;innerHTML&#39;, &#39;1195047NznhZg&#39;, &#39;1qfevql&#39;, &#39;input&#39;, &#39;1699808QuoWhA&#39;, &#39;Correct!&#39;, &#39;check_flag&#39;, &#39;Incorrect!&#39;, &#39;./JIFxzHyW8W&#39;, &#39;23SMpAuA&#39;, &#39;802698XOMSrr&#39;, &#39;charCodeAt&#39;, &#39;474547vVoGDO&#39;, &#39;getElementById&#39;, &#39;instance&#39;, &#39;copy_char&#39;, &#39;43591XxcWUl&#39;, &#39;504454llVtzW&#39;, &#39;arrayBuffer&#39;, &#39;2NIQmVj&#39;, &#39;result&#39;];

const search_string1 = function(id1, _0x53c021) {
    id1 = id1 - 470;
    let strings6f = strings[id1];
    return strings6f;
};

(function(id1, id2) {
    const search_string = search_string1;
    while (!![]) {
        try {
            const secret_key = -parseInt(search_string(0x1eb)) + parseInt(search_string(0x1ed)) + -parseInt(search_string(0x1db)) * -parseInt(search_string(0x1d9)) + -parseInt(search_string(0x1e2)) * -parseInt(search_string(0x1e3)) + -parseInt(search_string(0x1de)) * parseInt(search_string(0x1e0)) + parseInt(search_string(0x1d8)) * parseInt(search_string(0x1ea)) + -parseInt(search_string(0x1e5));
            if (secret_key === id2) break;
            else id1[&#39;push&#39;](id1[&#39;shift&#39;]());
        } catch (_0x41d31a) {
            id1[&#39;push&#39;](id1[&#39;shift&#39;]());
        }
    }
}(strings, 627907));
let exports;
(async () =&gt; {
    const search_string = search_string1;
    let _0x5f0229 = await fetch(search_string(489)),
        _0x1d99e9 = await WebAssembly[search_string(479)](await _0x5f0229[search_string(474)]()),
        _0x1f8628 = _0x1d99e9[search_string(470)];
    exports = _0x1f8628[&#39;exports&#39;];
})();

function onButtonPress() {
    const search_string = search_string1;
    let input_value = document[&#39;getElementById&#39;](search_string(484))[search_string(477)]; // document[&#39;getElementById&#39;](input)[value]
    for (let i = 0; i &lt; input_value[&#39;length&#39;]; i++) {
        exports[search_string(471)](input_value[search_string(492)](i), i);
    }
    exports[&#39;copy_char&#39;](0, input_value[&#39;length&#39;]), exports[search_string(487)]() == 1 ? document[search_string(494)](search_string(0x1dc))[search_string(0x1e1)] = search_string(0x1e6) : document[search_string(0x1ee)](search_string(0x1dc))[search_string(0x1e1)] = search_string(0x1e8);
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/web/picoctf---some-assembly-required-1/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---some-assembly-required-2/>PicoCTF - Some Assembly Required 2</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---some-assembly-required-2>PicoCTF - Some Assembly Required 2
<a class=anchor href=#picoctf---some-assembly-required-2>#</a></h1><h6 id=tags-picoctf-ctf-web>tags: <code>PicoCTF</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-picoctf-ctf-web>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler source</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>list_str</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;copy_char&#39;</span>, <span style=color:#e6db74>&#39;value&#39;</span>, <span style=color:#e6db74>&#39;207aLjBod&#39;</span>, <span style=color:#e6db74>&#39;1301420SaUSqf&#39;</span>, <span style=color:#e6db74>&#39;233ZRpipt&#39;</span>, <span style=color:#e6db74>&#39;2224QffgXU&#39;</span>, <span style=color:#e6db74>&#39;check_flag&#39;</span>, <span style=color:#e6db74>&#39;408533hsoVYx&#39;</span>, <span style=color:#e6db74>&#39;instance&#39;</span>, <span style=color:#e6db74>&#39;278338GVFUrH&#39;</span>, <span style=color:#e6db74>&#39;Correct!&#39;</span>, <span style=color:#e6db74>&#39;549933ZVjkwI&#39;</span>, <span style=color:#e6db74>&#39;innerHTML&#39;</span>, <span style=color:#e6db74>&#39;charCodeAt&#39;</span>, <span style=color:#e6db74>&#39;./aD8SvhyVkb&#39;</span>, <span style=color:#e6db74>&#39;result&#39;</span>, <span style=color:#e6db74>&#39;977AzKzwq&#39;</span>, <span style=color:#e6db74>&#39;Incorrect!&#39;</span>, <span style=color:#e6db74>&#39;exports&#39;</span>, <span style=color:#e6db74>&#39;length&#39;</span>, <span style=color:#e6db74>&#39;getElementById&#39;</span>, <span style=color:#e6db74>&#39;1jIrMBu&#39;</span>, <span style=color:#e6db74>&#39;input&#39;</span>, <span style=color:#e6db74>&#39;615361geljRK&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>func1_cal</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>var_a</span>, <span style=color:#a6e22e>var_b</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>var_a</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>var_a</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>195</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>list_strc4</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>list_str</span>[<span style=color:#a6e22e>var_a</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>list_strc4</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>var_a</span>, <span style=color:#a6e22e>var_b</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>func1_cal</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>func1_cal</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#f92672>!!</span>[]) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>var_c</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>200</span>)) <span style=color:#f92672>*</span> <span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>201</span>)) <span style=color:#f92672>+</span> <span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>205</span>)) <span style=color:#f92672>+</span> parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>207</span>)) <span style=color:#f92672>+</span> parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>195</span>)) <span style=color:#f92672>+</span> <span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>198</span>)) <span style=color:#f92672>*</span> parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>212</span>)) <span style=color:#f92672>+</span> parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>203</span>)) <span style=color:#f92672>+</span> <span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>217</span>)) <span style=color:#f92672>*</span> parseInt(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>199</span>));
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>var_c</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>var_b</span>) <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>var_a</span>[<span style=color:#e6db74>&#39;push&#39;</span>](<span style=color:#a6e22e>var_a</span>[<span style=color:#e6db74>&#39;shift&#39;</span>]());
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>_0x4f8a</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>var_a</span>[<span style=color:#e6db74>&#39;push&#39;</span>](<span style=color:#a6e22e>var_a</span>[<span style=color:#e6db74>&#39;shift&#39;</span>]());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}(<span style=color:#a6e22e>list_str</span>, <span style=color:#ae81ff>310022</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>exports</span>;
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>func1_cal</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>func1_cal</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>res_1</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>210</span>)),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>res_2</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>WebAssembly</span>[<span style=color:#e6db74>&#39;instantiate&#39;</span>](<span style=color:#66d9ef>await</span> <span style=color:#a6e22e>res_1</span>[<span style=color:#e6db74>&#39;arrayBuffer&#39;</span>]()),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>res_3</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res_2</span>[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>204</span>)];
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res_3</span>[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>214</span>)];
</span></span><span style=display:flex><span>})();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>onButtonPress</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>func1_cal</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>func1_cal</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>res_1</span> <span style=color:#f92672>=</span> document[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>216</span>)](<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>218</span>))[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>197</span>)];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>idx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>idx</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>res_1</span>[<span style=color:#e6db74>&#39;length&#39;</span>]; <span style=color:#a6e22e>idx</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>exports</span>[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>196</span>)](<span style=color:#a6e22e>res_1</span>[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>209</span>)](<span style=color:#a6e22e>idx</span>), <span style=color:#a6e22e>idx</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>exports</span>[<span style=color:#e6db74>&#39;copy_char&#39;</span>](<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>res_1</span>[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>215</span>)]), <span style=color:#a6e22e>exports</span>[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>202</span>)]() <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> document[<span style=color:#e6db74>&#39;getElementById&#39;</span>](<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>211</span>))[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>208</span>)] <span style=color:#f92672>=</span> <span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>206</span>) <span style=color:#f92672>:</span> document[<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>216</span>)](<span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>211</span>))[<span style=color:#e6db74>&#39;innerHTML&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>func1_cal</span>(<span style=color:#ae81ff>213</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><a href=/security/practice/picoctf/web/picoctf---some-assembly-required-2/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---some-assembly-required-3/>PicoCTF - Some Assembly Required 3</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---some-assembly-required-3>PicoCTF - Some Assembly Required 3
<a class=anchor href=#picoctf---some-assembly-required-3>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://github.com/WebAssembly/wabt>WebAssembly/wabt</a></p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ ./build/wasm2c qCCYI0ajpD.wasm -o dump.c
</code></pre><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler rTEuOmSfG3.js</p><pre tabindex=0><code class="language-javascript=" data-lang="javascript=">&#39;use strict&#39;;
const str_list = [&#34;exports&#34;, &#34;270328ewawLo&#34;, &#34;instantiate&#34;, &#34;1OsuamQ&#34;, &#34;Incorrect!&#34;, &#34;length&#34;, &#34;copy_char&#34;, &#34;value&#34;, &#34;1512517ESezaM&#34;, &#34;innerHTML&#34;, &#34;check_flag&#34;, &#34;result&#34;, &#34;1383842SQRPPf&#34;, &#34;924408cukzgO&#34;, &#34;getElementById&#34;, &#34;418508cLDohp&#34;, &#34;input&#34;, &#34;Correct!&#34;, &#34;573XsMMHp&#34;, &#34;arrayBuffer&#34;, &#34;183RUQBDE&#34;, &#34;38934oMACea&#34;];
const tranfer_fn = function(url, whensCollection) {
  /** @type {number} */
  url = url - 285;
  let _0x143f7d = str_list[url];
  return _0x143f7d;
};
(function(data, oldPassword) {
  const tranfer_fn = tranfer_fn;
  for (; !![];) {
    try {
      const userPsd = -parseInt(&#34;length&#34;) + -parseInt(&#34;573XsMMHp&#34;) + -parseInt(&#34;innerHTML&#34;) * -parseInt(&#34;getElementById&#34;) + -parseInt(&#34;38934oMACea&#34;) + parseInt(&#34;value&#34;) + -parseInt(&#34;Incorrect!&#34;) * -parseInt(&#34;instantiate&#34;) + parseInt(&#34;arrayBuffer&#34;);
      if (userPsd === oldPassword) {
        break;
      } else {
        data[&#34;push&#34;](data[&#34;shift&#34;]());
      }
    } catch (_0x289152) {
      data[&#34;push&#34;](data[&#34;shift&#34;]());
    }
  }
})(str_list, 970828);
let exports;
(async() =&gt; {
  const tranfer_fn = tranfer_fn;
  let rpm_traffic = await fetch(&#34;./qCCYI0ajpD&#34;);
  let m = await WebAssembly[&#34;1512517ESezaM&#34;](await rpm_traffic[&#34;1OsuamQ&#34;]());
  let updatedEdgesById = m[&#34;instance&#34;];
  exports = updatedEdgesById[&#34;copy_char&#34;];
})();
/**
 * @return {undefined}
 */
function onButtonPress() {
  const tranfer_fn = tranfer_fn;
  let data = document[&#34;183RUQBDE&#34;](&#34;exports&#34;)[&#34;924408cukzgO&#34;];
  for (let i = 0; i &lt; data[&#34;result&#34;]; i++) {
    exports[&#34;1383842SQRPPf&#34;](data[&#34;charCodeAt&#34;](i), i);
  }
  exports[&#34;1383842SQRPPf&#34;](0, data[&#34;result&#34;]);
  if (exports[&#34;input&#34;]() == 1) {
    document[&#34;183RUQBDE&#34;](&#34;Correct!&#34;)[&#34;418508cLDohp&#34;] = &#34;270328ewawLo&#34;;
  } else {
    document[&#34;183RUQBDE&#34;](&#34;Correct!&#34;)[&#34;innerHTML&#34;] = &#34;check_flag&#34;;
  }
}
;
</code></pre><p>:::</p><a href=/security/practice/picoctf/web/picoctf---some-assembly-required-3/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/general-skills/picoctf---special--specialer/>PicoCTF - Special & Specialer</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/general-skill/>General Skill</a></div><p><h1 id=picoctf---special--specialer>PicoCTF - Special & Specialer
<a class=anchor href=#picoctf---special--specialer>#</a></h1><h6 id=tags-picoctf-ctf-general-skill>tags: <code>PicoCTF</code> <code>CTF</code> <code>General Skill</code>
<a class=anchor href=#tags-picoctf-ctf-general-skill>#</a></h6><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這兩題都蠻有趣的，感覺打提權應該會用到，所以一起紀錄，第一題是要get shell，關於這一題我是直接看學長之前解題的WP，payload是<code>${0}</code>就直接拿到shell了，詳細的原理我也不清楚，第二題比較簡單，就直接用網路的資源替換一下<code>ls, cat</code>這兩個指令就拿到flag了</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><ul><li><p>代替<code>cat</code>的方法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Method 1</span>
</span></span><span style=display:flex><span>$ <span style=color:#66d9ef>while</span> read line; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span>&gt; echo $line;
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span>&gt; <span style=color:#66d9ef>done</span> &lt;<span style=color:#f92672>{</span>filename<span style=color:#f92672>}}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 2</span>
</span></span><span style=display:flex><span>$ exec 3&lt;<span style=color:#f92672>{</span>filename<span style=color:#f92672>}}</span> <span style=color:#75715e># Assign file descriptor 3 for reading</span>
</span></span><span style=display:flex><span>$ <span style=color:#66d9ef>while</span> read -u <span style=color:#ae81ff>3</span> line; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span>&gt; echo $line
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span>&gt; <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 3</span>
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>&lt;<span style=color:#f92672>{</span>filename<span style=color:#f92672>}</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div></li><li><p>代替<code>ls</code>的方法</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Method 1</span>
</span></span><span style=display:flex><span>$ echo *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 2</span>
</span></span><span style=display:flex><span>$ echo */*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 3</span>
</span></span><span style=display:flex><span>$ echo * .*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 4</span>
</span></span><span style=display:flex><span>$ dir
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 5</span>
</span></span><span style=display:flex><span>$ printf <span style=color:#e6db74>&#39;%s\n&#39;</span> *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 6</span>
</span></span><span style=display:flex><span>$ grep -l <span style=color:#e6db74>&#39;.*&#39;</span> ./*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 7</span>
</span></span><span style=display:flex><span>$ find .
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 8</span>
</span></span><span style=display:flex><span>$ stat -c <span style=color:#e6db74>&#39;%s %A %n&#39;</span> *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 9</span>
</span></span><span style=display:flex><span>$ lsattr ./*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Method 10</span>
</span></span><span style=display:flex><span>$ vim .
</span></span></code></pre></div></li></ul><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://jarv.org/posts/cat-without-cat/>Cat without cat on the commandline</a>
<a href=https://ubunlog.com/en/alternativas-al-comando-ls/>Alternatives to the &rsquo;ls&rsquo; command to list the contents of a directory</a></p><a href=/security/practice/picoctf/general-skills/picoctf---special--specialer/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---sqlilite/>PicoCTF - SQLiLite</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---sqlilite>PicoCTF - SQLiLite
<a class=anchor href=#picoctf---sqlilite>#</a></h1><h6 id=tags-picoctf-ctf-web>tags: <code>PicoCTF</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-picoctf-ctf-web>#</a></h6><p>Challenge: <a href=http://saturn.picoctf.net:55837/>http://saturn.picoctf.net:55837/</a></p><h2 id=exploit---sqli>Exploit - sqli
<a class=anchor href=#exploit---sqli>#</a></h2><p>Payload:
<code>admin' or '1'='1' -- #</code>
<img src=https://i.imgur.com/yNgpTiY.png alt></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/crypto/rsa/picoctf---sra/>PicoCTF - SRA</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/crypto/>Crypto</a></div><p><h1 id=picoctf---sra>PicoCTF - SRA
<a class=anchor href=#picoctf---sra>#</a></h1><h6 id=tags-picoctf-ctf-crypto>tags: <code>PicoCTF</code> <code>CTF</code> <code>Crypto</code>
<a class=anchor href=#tags-picoctf-ctf-crypto>#</a></h6><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-python=" data-lang="python=">from Crypto.Util.number import getPrime, inverse, bytes_to_long
from string import ascii_letters, digits
from random import choice

pride = &#34;&#34;.join(choice(ascii_letters + digits) for _ in range(16))
gluttony = getPrime(128)
greed = getPrime(128)
lust = gluttony * greed
sloth = 65537
envy = inverse(sloth, (gluttony - 1) * (greed - 1))

anger = pow(bytes_to_long(pride.encode()), sloth, lust)

print(f&#34;{anger = }&#34;)
print(f&#34;{envy = }&#34;)

print(&#34;vainglory?&#34;)
vainglory = input(&#34;&gt; &#34;).strip()

if vainglory == pride:
    print(&#34;Conquered!&#34;)
    with open(&#34;/challenge/flag.txt&#34;) as f:
        print(f.read())
else:
    print(&#34;Hubris!&#34;)
</code></pre><p>:::</p><a href=/security/practice/picoctf/crypto/rsa/picoctf---sra/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---stack-cache/>PicoCTF - stack cache</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---stack-cache>PicoCTF - stack cache
<a class=anchor href=#picoctf---stack-cache>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>BoF</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler</p><pre tabindex=0><code class=language-cpp! data-lang=cpp!>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;wchar.h&gt;
#include &lt;locale.h&gt;

#define BUFSIZE 16
#define FLAGSIZE 64
#define INPSIZE 10

/*
This program is compiled statically with clang-12
without any optimisations.
*/

void win() {
  char buf[FLAGSIZE];
  char filler[BUFSIZE];
  FILE *f = fopen(&#34;flag.txt&#34;,&#34;r&#34;);
  if (f == NULL) {
    printf(&#34;%s %s&#34;, &#34;Please create &#39;flag.txt&#39; in this directory with your&#34;,
                    &#34;own debugging flag.\n&#34;);
    exit(0);
  }

  fgets(buf,FLAGSIZE,f); // size bound read
}

void UnderConstruction() {
        // this function is under construction
        char consideration[BUFSIZE];
        char *demographic, *location, *identification, *session, *votes, *dependents;
	char *p,*q, *r;
	// *p = &#34;Enter names&#34;;
	// *q = &#34;Name 1&#34;;
	// *r = &#34;Name 2&#34;;
        unsigned long *age;
	printf(&#34;User information : %p %p %p %p %p %p\n&#34;,demographic, location, identification, session, votes, dependents);
	printf(&#34;Names of user: %p %p %p\n&#34;, p,q,r);
        printf(&#34;Age of user: %p\n&#34;,age);
        fflush(stdout);
}

void vuln(){
   char buf[INPSIZE];
   printf(&#34;Give me a string that gets you the flag\n&#34;);
   gets(buf);
   printf(&#34;%s\n&#34;,buf);
   return;
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  vuln();
  printf(&#34;Bye!&#34;);
  return 0;
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/pwn/picoctf---stack-cache/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/pwn/picoctf---stonk-market/>PicoCTF - Stonk Market</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/pwn/>PWN</a></div><p><h1 id=picoctf---stonk-market>PicoCTF - Stonk Market
<a class=anchor href=#picoctf---stonk-market>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>FMT</p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp=">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;time.h&gt;

#define FLAG_BUFFER 128
#define MAX_SYM_LEN 4

typedef struct Stonks {
	int shares;
	char symbol[MAX_SYM_LEN + 1];
	struct Stonks *next;
} Stonk;

typedef struct Portfolios {
	int money;
	Stonk *head;
} Portfolio;

int view_portfolio(Portfolio *p) {
	if (!p) {
		return 1;
	}
	printf(&#34;\nPortfolio as of &#34;);
	fflush(stdout);
	system(&#34;date&#34;); // TODO: implement this in C
	fflush(stdout);

	printf(&#34;\n\n&#34;);
	Stonk *head = p-&gt;head;
	if (!head) {
		printf(&#34;You don&#39;t own any stonks!\n&#34;);
	}
	while (head) {
		printf(&#34;%d shares of %s\n&#34;, head-&gt;shares, head-&gt;symbol);
		head = head-&gt;next;
	}
	return 0;
}

Stonk *pick_symbol_with_AI(int shares) {
	if (shares &lt; 1) {
		return NULL;
	}
	Stonk *stonk = malloc(sizeof(Stonk));
	stonk-&gt;shares = shares;

	int AI_symbol_len = (rand() % MAX_SYM_LEN) + 1;
	for (int i = 0; i &lt;= MAX_SYM_LEN; i++) {
		if (i &lt; AI_symbol_len) {
			stonk-&gt;symbol[i] = &#39;A&#39; + (rand() % 26);
		} else {
			stonk-&gt;symbol[i] = &#39;\0&#39;;
		}
	}

	stonk-&gt;next = NULL;

	return stonk;
}

int buy_stonks(Portfolio *p) {
	if (!p) {
		return 1;
	}
	/*
	char api_buf[FLAG_BUFFER];
	FILE *f = fopen(&#34;api&#34;,&#34;r&#34;);
	if (!f) {
		printf(&#34;Flag file not found\n&#34;);
		exit(1);
	}
	fgets(api_buf, FLAG_BUFFER, f);
	*/
	int money = p-&gt;money;
	int shares = 0;
	Stonk *temp = NULL;
	printf(&#34;Using patented AI algorithms to buy stonks\n&#34;);
	while (money &gt; 0) {
		shares = (rand() % money) + 1;
		temp = pick_symbol_with_AI(shares);
		temp-&gt;next = p-&gt;head;
		p-&gt;head = temp;
		money -= shares;
	}
	printf(&#34;Stonks chosen\n&#34;);

	char *user_buf = malloc(300 + 1);
	printf(&#34;What is your API token?\n&#34;);
	scanf(&#34;%300s&#34;, user_buf);
	printf(&#34;Buying stonks with token:\n&#34;);
	printf(user_buf);

	// TODO: Actually use key to interact with API

	view_portfolio(p);

	return 0;
}

Portfolio *initialize_portfolio() {
	Portfolio *p = malloc(sizeof(Portfolio));
	p-&gt;money = (rand() % 2018) + 1;
	p-&gt;head = NULL;
	return p;
}

void free_portfolio(Portfolio *p) {
	Stonk *current = p-&gt;head;
	Stonk *next = NULL;
	while (current) {
		next = current-&gt;next;
		free(current);
		current = next;
	}
	free(p);
}

int main(int argc, char *argv[])
{
	setbuf(stdout, NULL);
	srand(time(NULL));
	Portfolio *p = initialize_portfolio();
	if (!p) {
		printf(&#34;Memory failure\n&#34;);
		exit(1);
	}

	int resp = 0;

	printf(&#34;Welcome back to the trading app!\n\n&#34;);
	printf(&#34;What would you like to do?\n&#34;);
	printf(&#34;1) Buy some stonks!\n&#34;);
	printf(&#34;2) View my portfolio\n&#34;);
	scanf(&#34;%d&#34;, &amp;resp);

	if (resp == 1) {
		buy_stonks(p);
	} else if (resp == 2) {
		view_portfolio(p);
	}

	free_portfolio(p);
	printf(&#34;Goodbye!\n&#34;);

	exit(0);
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/pwn/picoctf---stonk-market/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/web/picoctf---super-serial/>PicoCTF - Super Serial</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=picoctf---super-serial>PicoCTF - Super Serial
<a class=anchor href=#picoctf---super-serial>#</a></h1><h6 id=tags-picoctf-ctf-web>tags: <code>PicoCTF</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-picoctf-ctf-web>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://hackmd.io/@SBK6401/B1I5n1pns>php unserialization</a></p><h2 id=hint>Hint
<a class=anchor href=#hint>#</a></h2><ul><li>The flag is at ../flag</li></ul><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題設了太多套路了，但從題目的Title可以猜到應該要用不安全的反序列化</p><ol><li><p>robot.txt
一開始會從這邊開始著手就是因為假的source code啥都沒有，本來也以為是<code>sqli</code>，但也沒收穫，看了WP才知道要從這邊開始，可以看到以下訊息，但副檔名居然不是一般的php而是phps(而且<code>/admin.phps</code>沒有任何東西)，可見php是個幌子，則前面的source code就要重新分析
<img src=https://hackmd.io/_uploads/BkcThh0Pn.png alt></p></li><li><p>index.phps
用index.phps查看source code發現有一些其他怪東西，包括<code>authentication.phps</code>和<code>cookie.php</code>
:::spoiler Real Source Code</p><pre tabindex=0><code class="language-php=" data-lang="php=">&lt;?php
require_once(&#34;cookie.php&#34;);

if(isset($_POST[&#34;user&#34;]) &amp;&amp; isset($_POST[&#34;pass&#34;])){
    $con = new SQLite3(&#34;../users.db&#34;);
    $username = $_POST[&#34;user&#34;];
    $password = $_POST[&#34;pass&#34;];
    $perm_res = new permissions($username, $password);
    if ($perm_res-&gt;is_guest() || $perm_res-&gt;is_admin()) {
        setcookie(&#34;login&#34;, urlencode(base64_encode(serialize($perm_res))), time() + (86400 * 30), &#34;/&#34;);
        header(&#34;Location: authentication.php&#34;);
        die();
    } else {
        $msg = &#39;&lt;h6 class=&#34;text-center&#34; style=&#34;color:red&#34;&gt;Invalid Login.&lt;/h6&gt;&#39;;
    }
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;link href=&#34;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css&#34; rel=&#34;stylesheet&#34; integrity=&#34;sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T&#34; crossorigin=&#34;anonymous&#34;&gt;
&lt;link href=&#34;style.css&#34; rel=&#34;stylesheet&#34;&gt;
&lt;script src=&#34;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js&#34; integrity=&#34;sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM&#34; crossorigin=&#34;anonymous&#34;&gt;&lt;/script&gt;
&lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&#34;container&#34;&gt;
            &lt;div class=&#34;row&#34;&gt;
                &lt;div class=&#34;col-sm-9 col-md-7 col-lg-5 mx-auto&#34;&gt;
                    &lt;div class=&#34;card card-signin my-5&#34;&gt;
                        &lt;div class=&#34;card-body&#34;&gt;
                            &lt;h5 class=&#34;card-title text-center&#34;&gt;Sign In&lt;/h5&gt;
                            &lt;?php if (isset($msg)) echo $msg; ?&gt;
                            &lt;form class=&#34;form-signin&#34; action=&#34;index.php&#34; method=&#34;post&#34;&gt;
                                &lt;div class=&#34;form-label-group&#34;&gt;
                                    &lt;input type=&#34;text&#34; id=&#34;user&#34; name=&#34;user&#34; class=&#34;form-control&#34; placeholder=&#34;Username&#34; required autofocus&gt;
                                    &lt;label for=&#34;user&#34;&gt;Username&lt;/label&gt;
                                &lt;/div&gt;

                                &lt;div class=&#34;form-label-group&#34;&gt;
                                    &lt;input type=&#34;password&#34; id=&#34;pass&#34; name=&#34;pass&#34; class=&#34;form-control&#34; placeholder=&#34;Password&#34; required&gt;
                                    &lt;label for=&#34;pass&#34;&gt;Password&lt;/label&gt;
                                &lt;/div&gt;

                                &lt;button class=&#34;btn btn-lg btn-primary btn-block text-uppercase&#34; type=&#34;submit&#34;&gt;Sign in&lt;/button&gt;
                            &lt;/form&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>:::</p><a href=/security/practice/picoctf/web/picoctf---super-serial/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/ctf/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/12/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/ctf/page/11/ aria-label="Page 11" class=page-link role=button>11</a></li><li class=page-item><a href=/tags/ctf/page/12/ aria-label="Page 12" class=page-link role=button>12</a></li><li class="page-item active"><a aria-current=page aria-label="Page 13" class=page-link role=button>13</a></li><li class=page-item><a href=/tags/ctf/page/14/ aria-label="Page 14" class=page-link role=button>14</a></li><li class=page-item><a href=/tags/ctf/page/15/ aria-label="Page 15" class=page-link role=button>15</a></li><li class=page-item><a href=/tags/ctf/page/14/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/ctf/page/27/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>