<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Incident Response on SBK Site</title><link>https://bernie6401.github.io/tags/incident-response/</link><description>Recent content in Incident Response on SBK Site</description><generator>Hugo</generator><language>en-us</language><atom:link href="https://bernie6401.github.io/tags/incident-response/index.xml" rel="self" type="application/rss+xml"/><item><title>BTLO - Bruteforce</title><link>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---bruteforce/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---bruteforce/</guid><description>&lt;h1 id="btlo---bruteforce">
 BTLO - Bruteforce
 &lt;a class="anchor" href="#btlo---bruteforce">#&lt;/a>
&lt;/h1>
&lt;p>Challenge: &lt;a href="https://blueteamlabs.online/home/challenge/bruteforce-16629bf9a2">https://blueteamlabs.online/home/challenge/bruteforce-16629bf9a2&lt;/a>&lt;/p>
&lt;p>:::spoiler TOC
[TOC]
:::&lt;/p>
&lt;h2 id="scenario">
 Scenario
 &lt;a class="anchor" href="#scenario">#&lt;/a>
&lt;/h2>
&lt;blockquote>
&lt;p>Can you analyze logs from an attempted RDP bruteforce attack?&lt;/p>
&lt;p>One of our system administrators identified a large number of Audit Failure events in the Windows Security Event log.&lt;/p>
&lt;p>There are a number of different ways to approach the analysis of these logs! Consider the suggested tools, but there are many others out there!&lt;/p>&lt;/blockquote>
&lt;h2 id="q1">
 ==Q1==
 &lt;a class="anchor" href="#q1">#&lt;/a>
&lt;/h2>
&lt;blockquote>
&lt;p>How many Audit Failure events are there? (Format: Count of Events)&lt;/p></description></item><item><title>BTLO - Follina</title><link>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---follina/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---follina/</guid><description>&lt;h1 id="btlo---follina">
 BTLO - Follina
 &lt;a class="anchor" href="#btlo---follina">#&lt;/a>
&lt;/h1>
&lt;p>Challenge: &lt;a href="https://blueteamlabs.online/home/challenge/follina-f1a3452f34">https://blueteamlabs.online/home/challenge/follina-f1a3452f34&lt;/a>&lt;/p>
&lt;p>:::spoiler TOC
[TOC]
:::
:::danger
因為給予的題目是真實的樣本，所以盡量在乾淨的環境或是reliable的sandbox進行測試
:::&lt;/p>
&lt;h2 id="scenario">
 Scenario
 &lt;a class="anchor" href="#scenario">#&lt;/a>
&lt;/h2>
&lt;blockquote>
&lt;p>On a Friday evening when you were in a mood to celebrate your weekend, your team was alerted with a new RCE vulnerability actively being exploited in the wild. You have been tasked with analyzing and researching the sample to collect information for the weekend team.&lt;/p>&lt;/blockquote>
&lt;h2 id="tools">
 Tools
 &lt;a class="anchor" href="#tools">#&lt;/a>
&lt;/h2>
&lt;p>VirusTotal
Any.Run
OSINT&lt;/p>
&lt;h2 id="q1">
 ==Q1==
 &lt;a class="anchor" href="#q1">#&lt;/a>
&lt;/h2>
&lt;blockquote>
&lt;p>What is the SHA1 hash value of the sample? (Format: SHA1Hash)&lt;/p></description></item><item><title>BTLO - Log Analysis -Compromised WordPress</title><link>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---log-analysis--compromised-wordpress/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---log-analysis--compromised-wordpress/</guid><description>&lt;h1 id="btlo---log-analysis--compromised-wordpress">
 BTLO - Log Analysis -Compromised WordPress
 &lt;a class="anchor" href="#btlo---log-analysis--compromised-wordpress">#&lt;/a>
&lt;/h1>
&lt;p>Challenge: &lt;a href="https://blueteamlabs.online/home/challenge/log-analysis-compromised-wordpress-ce000f5b59">https://blueteamlabs.online/home/challenge/log-analysis-compromised-wordpress-ce000f5b59&lt;/a>&lt;/p>
&lt;p>:::spoiler TOC
[TOC]
:::&lt;/p>
&lt;h2 id="scenario">
 Scenario
 &lt;a class="anchor" href="#scenario">#&lt;/a>
&lt;/h2>
&lt;blockquote>
&lt;p>One of our WordPress sites has been compromised but we&amp;rsquo;re currently unsure how. The primary hypothesis is that an installed plugin was vulnerable to a remote code execution vulnerability which gave an attacker access to the underlying operating system of the server.&lt;/p>&lt;/blockquote>
&lt;h2 id="tools">
 Tools
 &lt;a class="anchor" href="#tools">#&lt;/a>
&lt;/h2>
&lt;p>Grep
Sort
Uniq
Apache Log Analyzer&lt;/p>
&lt;h2 id="q1">
 ==Q1==
 &lt;a class="anchor" href="#q1">#&lt;/a>
&lt;/h2>
&lt;blockquote>
&lt;p>Identify the URI of the admin login panel that the attacker gained access to (include the token)&lt;/p></description></item><item><title>BTLO - Paranoid</title><link>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---paranoid/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---paranoid/</guid><description>&lt;h1 id="btlo---paranoid">
 BTLO - Paranoid
 &lt;a class="anchor" href="#btlo---paranoid">#&lt;/a>
&lt;/h1>
&lt;p>Challenge: &lt;a href="https://blueteamlabs.online/home/challenge/paranoid-e5e164befb">https://blueteamlabs.online/home/challenge/paranoid-e5e164befb&lt;/a>&lt;/p>
&lt;p>:::spoiler TOC
[TOC]
:::
:::info
此lab大部分是參考&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>的說明，因為本身第一次接觸aureport，所以不太清楚指令或者是注意的地方
:::&lt;/p>
&lt;h2 id="tool">
 Tool
 &lt;a class="anchor" href="#tool">#&lt;/a>
&lt;/h2>
&lt;p>AUReport: &lt;code>$ sudo apt install auditd&lt;/code>
Linux CLI&lt;/p>
&lt;h2 id="background">
 Background
 &lt;a class="anchor" href="#background">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>aureport --help
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>usage: aureport &lt;span style="color:#f92672">[&lt;/span>options&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -a,--avc Avc report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -au,--auth Authentication report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --comm Commands run report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -c,--config Config change report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -cr,--crypto Crypto report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --debug Write malformed events that are skipped to stderr
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --eoe-timeout secs End of Event Timeout
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -e,--event Event report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --escape option Escape output
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -f,--file File name report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --failed only failed events in report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -h,--host Remote Host name report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --help help
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -i,--interpret Interpretive mode
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -if,--input &amp;lt;Input File name&amp;gt; use this file as input
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --input-logs Use the logs even &lt;span style="color:#66d9ef">if&lt;/span> stdin is a pipe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --integrity Integrity event report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -k,--key Key report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -l,--login Login report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -m,--mods Modification to accounts report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -ma,--mac Mandatory Access Control &lt;span style="color:#f92672">(&lt;/span>MAC&lt;span style="color:#f92672">)&lt;/span> report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -n,--anomaly aNomaly report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -nc,--no-config Don&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>t include config events
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --node &amp;lt;node name&amp;gt; Only events from a specific node
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -p,--pid Pid report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -r,--response Response to anomaly report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -s,--syscall Syscall report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --success only success events in report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --summary sorted totals &lt;span style="color:#66d9ef">for&lt;/span> main object in report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -t,--log Log time range report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -te,--end &lt;span style="color:#f92672">[&lt;/span>end date&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">[&lt;/span>end time&lt;span style="color:#f92672">]&lt;/span> ending date &amp;amp; time &lt;span style="color:#66d9ef">for&lt;/span> reports
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -tm,--terminal TerMinal name report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -ts,--start &lt;span style="color:#f92672">[&lt;/span>start date&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">[&lt;/span>start time&lt;span style="color:#f92672">]&lt;/span> starting data &amp;amp; time &lt;span style="color:#66d9ef">for&lt;/span> reports
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --tty Report about tty keystrokes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -u,--user User name report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -v,--version Version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --virt Virtualization report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -x,--executable eXecutable name report
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> If no report is given, the summary report will be displayed
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://hackmd.io/_uploads/B17xQgJOa.png" alt="圖片" />&lt;/p></description></item><item><title>BTLO - Secrets</title><link>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---secrets/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://bernie6401.github.io/docs/security/practice/btlo/incident-response/btlo---secrets/</guid><description>&lt;h1 id="btlo---secrets">
 BTLO - Secrets
 &lt;a class="anchor" href="#btlo---secrets">#&lt;/a>
&lt;/h1>
&lt;p>Challenge: &lt;a href="https://blueteamlabs.online/home/challenge/secrets-85aa2bb3a9">https://blueteamlabs.online/home/challenge/secrets-85aa2bb3a9&lt;/a>&lt;/p>
&lt;p>:::spoiler TOC
[TOC]
:::&lt;/p>
&lt;h2 id="scenario">
 Scenario
 &lt;a class="anchor" href="#scenario">#&lt;/a>
&lt;/h2>
&lt;blockquote>
&lt;p>You’re a senior cyber security engineer and during your shift, we have intercepted/noticed a high privilege actions from unknown source that could be identified as malicious. We have got you the ticket that made these actions.
You are the one who created the secret for these tickets. Please fix this and submit the low privilege ticket so we can make sure that you deserve this position.
Here is the ticket:&lt;/p></description></item></channel></rss>