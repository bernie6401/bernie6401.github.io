<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/reverse/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="Reverse"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Reverse | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/reverse/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/reverse/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Reverse</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---lets-get-dynamic/>PicoCTF - Let's get dynamic</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---lets-get-dynamic>PicoCTF - Let&rsquo;s get dynamic
<a class=anchor href=#picoctf---lets-get-dynamic>#</a></h1><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Main Function</p><pre tabindex=0><code class="language-cpp=" data-lang="cpp=">int __cdecl main(int argc, const char **argv, const char **envp)
{
  int i; // [rsp+1Ch] [rbp-114h]
  char s2[64]; // [rsp+20h] [rbp-110h] BYREF
  char s[64]; // [rsp+60h] [rbp-D0h] BYREF
  char v7[8]; // [rsp+A0h] [rbp-90h] BYREF
  __int64 v8; // [rsp+A8h] [rbp-88h]
  __int64 v9; // [rsp+B0h] [rbp-80h]
  __int64 v10; // [rsp+B8h] [rbp-78h]
  __int64 v11; // [rsp+C0h] [rbp-70h]
  __int64 v12; // [rsp+C8h] [rbp-68h]
  __int16 v13; // [rsp+D0h] [rbp-60h]
  __int64 v14[6]; // [rsp+E0h] [rbp-50h]
  __int16 v15; // [rsp+110h] [rbp-20h]
  unsigned __int64 v16; // [rsp+118h] [rbp-18h]

  v16 = __readfsqword(0x28u);
  *v7 = 0xFD872AC7CA737102LL;
  v8 = 0x4915F12BF9F82DCBLL;
  v9 = 0xA7EF0D4C54003C10LL;
  v10 = 0x9399CCF74D02A843LL;
  v11 = 0x2AC6F818989688D7LL;
  v12 = 0x9F51EBCA33584C85LL;
  v13 = 231;
  v14[0] = 0x92D46893B5010A61LL;
  v14[1] = 0xA6BDE59D58F4EB4LL;
  v14[2] = 0xFC993A3238355027LL;
  v14[3] = 0xEDA7B28D7054D179LL;
  v14[4] = 0x419FBB499BD4CFBBLL;
  v14[5] = 0x935AE3903F554688LL;
  v15 = 185;
  fgets(s, 49, _bss_start);
  for ( i = 0; i &lt; strlen(v7); ++i )
    s2[i] = *(v14 + i) ^ v7[i] ^ i ^ 0x13;
  if ( !memcmp(s, s2, 49uLL) )
  {
    puts(&#34;No, that&#39;s not right.&#34;);
    return 1;
  }
  else
  {
    puts(&#34;Correct! You entered the flag.&#34;);
    return 0;
  }
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---lets-get-dynamic/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---no-way-out/>PicoCTF - No way out</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---no-way-out>PicoCTF - No way out
<a class=anchor href=#picoctf---no-way-out>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>C Sharp / dn.spy / cheat engine</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>大概有三種解法，其中兩種是改變.dll中的內容，有點利用binary exploitation的方式顯示flag，另外一種就是利用cheat engine的方式找到儲存座標的memory然後手動改寫數值，就拿到flag</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><h3 id=method-1---change-dll>Method 1 - Change .dll
<a class=anchor href=#method-1---change-dll>#</a></h3><ol><li><p>可以看到<code>No way out/pico_Data/Managed/Assembly-CSharp.dll</code>可能是一個可以用dn.spy decompile的文件，先看看有沒有甚麼可以更改的</p></li><li><p>在APTX class中，一個Mysterious的member，而且當<code>collision.gameObject == this.player</code>是true的時候，<code>this.Mysterious.SetActive(true);</code>就會被trigger，所以這就有點像是我們在遊戲中，如果要碰到白色旗子的時候會觸發的statement，那如果我在初始化的階段就直接把<code>this.Mysterious.SetActive(true);</code>設定成true，是不是就可以直接拿直到flag?
<img src=https://hackmd.io/_uploads/rylVM-rah.png alt></p></li><li><p>Implementation
直接右鍵edit class變成多加一個Start() method，然後不用任何的條件就達到剛剛說的效果，切記一定要是Start，因為Start是有被實際呼叫的method，如果取個aaa這種名字，他本來就不會被呼叫，那改成這樣也沒意義，當然，也可以取其他會被呼叫到的method name，例如Update, Awake之類的
<img src=https://hackmd.io/_uploads/rJ-UNZBp3.png alt></p><p><img src=https://hackmd.io/_uploads/Hy_pE-HT2.png alt></p></li></ol><h3 id=method-2---change-dll>Method 2 - Change .dll
<a class=anchor href=#method-2---change-dll>#</a></h3><p>當然記得能改動.dll的method，我們也可以改變遊戲角色跳不過圍牆的問題，最直觀的作法是我可以直接無限制的往上跳，超過圍牆就抵達flag，不會只有跳一小段這個問題，可以查看一下<code>EvolveGames/PlayerController/Update()</code>這個method，其中的第51行</p><pre tabindex=0><code class=language-csharp! data-lang=csharp!>if (Input.GetButton(&#34;Jump&#34;) &amp;&amp; this.canMove &amp;&amp; this.characterController.isGrounded &amp;&amp; !this.isClimbing)
{
    this.moveDirection.y = this.jumpSpeed;
}
</code></pre><p>如果改成</p><a href=/security/practice/picoctf/reverse/picoctf---no-way-out/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---not-crypto/>PicoCTF - not crypto</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---not-crypto>PicoCTF - not crypto
<a class=anchor href=#picoctf---not-crypto>#</a></h1><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Pseudo Source COde</p><pre tabindex=0><code class=language-clike! data-lang=clike!>__int64 __fastcall main(int a1, char **a2, char **a3)
{
  __int128 *v4; // rax
  unsigned __int8 v5; // di
  unsigned __int8 v6; // si
  unsigned __int8 v7; // cl
  unsigned __int8 v8; // dl
  unsigned int v9; // r8d
  unsigned __int8 v10; // r11
  int v16; // eax
  __int64 v17; // rdx
  unsigned int v18; // r12d
  char *v20; // r15
  unsigned __int8 v25; // r8
  int v30; // esi
  unsigned __int8 v32; // r12
  unsigned __int8 v36; // r14
  unsigned __int8 v38; // dl
  unsigned __int8 v40; // cl
  char v42; // r12
  char v43; // r14
  char v44; // al
  __int64 v45; // r13
  unsigned __int8 v46; // r10
  unsigned __int8 v47; // bp
  unsigned __int8 v48; // bl
  unsigned __int8 v49; // r8
  unsigned __int8 v50; // r11
  char v51; // dl
  char v54; // r10
  __int64 v63; // rdx
  char v72; // al
  unsigned __int8 v84; // [rsp+Ah] [rbp-1FEh]
  unsigned __int8 v85; // [rsp+Bh] [rbp-1FDh]
  int v86; // [rsp+Ch] [rbp-1FCh]
  int v87; // [rsp+10h] [rbp-1F8h]
  unsigned __int8 v88; // [rsp+14h] [rbp-1F4h]
  unsigned __int8 v89; // [rsp+15h] [rbp-1F3h]
  unsigned __int8 v90; // [rsp+16h] [rbp-1F2h]
  unsigned __int8 v91; // [rsp+17h] [rbp-1F1h]
  unsigned __int8 v92; // [rsp+18h] [rbp-1F0h]
  unsigned __int8 v93; // [rsp+19h] [rbp-1EFh]
  unsigned __int8 v94; // [rsp+1Ah] [rbp-1EEh]
  unsigned __int8 v95; // [rsp+1Bh] [rbp-1EDh]
  unsigned __int8 v96; // [rsp+1Ch] [rbp-1ECh]
  char v97; // [rsp+1Dh] [rbp-1EBh]
  char *v98; // [rsp+20h] [rbp-1E8h]
  unsigned __int8 v99; // [rsp+2Ah] [rbp-1DEh]
  char v100; // [rsp+50h] [rbp-1B8h]
  char v101; // [rsp+52h] [rbp-1B6h]
  char v102; // [rsp+54h] [rbp-1B4h]
  char v103; // [rsp+56h] [rbp-1B2h]
  char v104; // [rsp+58h] [rbp-1B0h]
  char v105; // [rsp+5Ah] [rbp-1AEh]
  char v106; // [rsp+5Ch] [rbp-1ACh]
  char v107; // [rsp+5Eh] [rbp-1AAh]
  __int128 v108; // [rsp+60h] [rbp-1A8h]
  char ptr[64]; // [rsp+70h] [rbp-198h] BYREF
  __int128 v110; // [rsp+B0h] [rbp-158h] BYREF
  char v111; // [rsp+C0h] [rbp-148h] BYREF
  char v112[15]; // [rsp+150h] [rbp-B8h] BYREF
  __int128 v113; // [rsp+160h] [rbp-A8h]
  __int128 v115[4]; // [rsp+180h] [rbp-88h] BYREF
  char v116; // [rsp+1C0h] [rbp-48h] BYREF
  unsigned __int64 v117; // [rsp+1C8h] [rbp-40h]

  v117 = __readfsqword(0x28u);
  puts(&#34;I heard you wanted to bargain for a flag... whatcha got?&#34;);
  __asm { vmovdqa xmm0, cs:xmmword_21A0 }
  v4 = &amp;v110;
  v5 = -104;
  v6 = 50;
  v7 = 108;
  v8 = 28;
  __asm { vmovdqa [rsp+208h+var_158], xmm0 }
  v9 = 4;
  do
  {
    if ( (v9 &amp; 3) == 0 )
    {
      v10 = byte_20A0[v6];
      v6 = byte_20A0[v7];
      v7 = byte_20A0[v8];
      v8 = byte_20A0[v5];
      v5 = byte_2080[v9 &gt;&gt; 2] ^ v10;
    }
    v5 ^= *v4;
    ++v9;
    v4 = (v4 + 4);
    v6 ^= *(v4 - 3);
    v7 ^= *(v4 - 2);
    v8 ^= *(v4 - 1);
    *(v4 + 12) = v5;
    *(v4 + 13) = v6;
    *(v4 + 14) = v7;
    *(v4 + 15) = v8;
  }
  while ( v9 != 44 );
  __asm
  {
    vmovdqa xmm0, cs:xmmword_21B0
    vmovdqa [rsp+208h+var_A8], xmm0
  }
  fread(ptr, 1uLL, 0x40uLL, stdin);
  __asm
  {
    vmovdqa xmm0, cs:xmmword_21C0
    vmovdqa [rsp+208h+var_88], xmm0
    vmovdqa xmm0, cs:xmmword_21D0
  }
  v108 = v110;
  __asm
  {
    vmovdqa [rsp+208h+var_78], xmm0
    vmovdqa xmm0, cs:xmmword_21E0
    vmovdqa [rsp+208h+var_68], xmm0
    vmovdqa xmm0, cs:xmmword_21F0
    vmovdqa [rsp+208h+var_58], xmm0
  }
  v100 = v112[0];
  v101 = v112[2];
  v102 = v112[4];
  v103 = v112[6];
  v104 = v112[8];
  v105 = v112[10];
  v106 = v112[12];
  v107 = v112[14];
  v98 = v115;
  v16 = 16;
  do
  {
    if ( v16 == 16 )
    {
      v20 = &amp;v111;
      __asm { vmovdqa xmm4, [rsp+208h+var_A8] }
      LOBYTE(v87) = byte_20A0[(v113 ^ v108)];
      __asm { vpextrb rax, xmm4, 4 }
      LOBYTE(v86) = byte_20A0[(BYTE4(v108) ^ _RAX)];
      v94 = byte_20A0[BYTE8(v113) ^ BYTE8(v108)];
      __asm { vpextrb rax, xmm4, 0Ch }
      v93 = byte_20A0[(BYTE12(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 1 }
      v25 = byte_20A0[(BYTE1(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 5 }
      v85 = byte_20A0[(BYTE5(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 9 }
      v84 = byte_20A0[(BYTE9(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Dh }
      v92 = byte_20A0[(BYTE13(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 2 }
      LOBYTE(v30) = byte_20A0[(BYTE2(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 6 }
      v32 = byte_20A0[(BYTE6(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Ah }
      v91 = byte_20A0[(BYTE10(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Eh }
      v96 = v32;
      v88 = v25;
      v90 = byte_20A0[(BYTE14(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 3 }
      v36 = byte_20A0[(BYTE3(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 7 }
      v95 = v36;
      v38 = byte_20A0[(BYTE7(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Bh }
      v40 = byte_20A0[(BYTE11(v108) ^ _RAX)];
      __asm { vpextrb rax, xmm4, 0Fh }
      v89 = byte_20A0[(HIBYTE(v108) ^ _RAX)];
      do
      {
        v42 = v91 ^ v89 ^ v87 ^ v85;
        v99 = v87 ^ v89;
        v43 = v90 ^ v95 ^ v86 ^ v84;
        v97 = v30 ^ v38 ^ v94 ^ v92;
        v44 = v40 ^ v96 ^ v93 ^ v88;
        v45 = ((2 * (v86 ^ v95)) ^ (27 * ((v86 ^ v95) &gt;&gt; 7)) ^ v95 ^ v43 ^ v20[7]);
        v46 = v20[10] ^ v97 ^ v30 ^ (27 * ((v30 ^ v38) &gt;&gt; 7)) ^ (2 * (v30 ^ v38));
        v47 = v20[11] ^ v97 ^ v38 ^ (2 * (v38 ^ v94)) ^ (27 * ((v38 ^ v94) &gt;&gt; 7));
        v48 = v88 ^ v44 ^ v20[13] ^ (2 * (v88 ^ v96)) ^ (27 * ((v88 ^ v96) &gt;&gt; 7));
        v49 = v96 ^ v44 ^ v20[14] ^ (27 * ((v40 ^ v96) &gt;&gt; 7)) ^ (2 * (v40 ^ v96));
        v50 = v44 ^ v20[15] ^ v40 ^ (2 * (v40 ^ v93)) ^ (27 * ((v40 ^ v93) &gt;&gt; 7));
        LOBYTE(v87) = byte_20A0[((2 * (v87 ^ v85)) ^ (27 * ((v87 ^ v85) &gt;&gt; 7)) ^ v42 ^ *v20 ^ v87)];
        LOBYTE(v86) = byte_20A0[((2 * (v86 ^ v84)) ^ (27 * ((v86 ^ v84) &gt;&gt; 7)) ^ v86 ^ v43 ^ v20[4])];
        v94 = byte_20A0[((2 * (v94 ^ v92)) ^ (27 * ((v94 ^ v92) &gt;&gt; 7)) ^ v94 ^ v97 ^ v20[8])];
        v93 = byte_20A0[((27 * ((v93 ^ v88) &gt;&gt; 7)) ^ (2 * (v93 ^ v88)) ^ v93 ^ v20[12] ^ v44)];
        v88 = byte_20A0[((2 * (v85 ^ v91)) ^ (27 * ((v85 ^ v91) &gt;&gt; 7)) ^ v85 ^ v42 ^ v20[1])];
        v85 = byte_20A0[((27 * ((v84 ^ v90) &gt;&gt; 7)) ^ (2 * (v84 ^ v90)) ^ v84 ^ v43 ^ v20[5])];
        v84 = byte_20A0[((27 * ((v30 ^ v92) &gt;&gt; 7)) ^ (2 * (v30 ^ v92)) ^ v20[9] ^ v97 ^ v92)];
        v92 = byte_20A0[v48];
        v51 = v91 ^ v42 ^ v20[2];
        v20 += 16;
        v30 = byte_20A0[((2 * (v91 ^ v89)) ^ (27 * ((v91 ^ v89) &gt;&gt; 7)) ^ v51)];
        v96 = byte_20A0[((27 * ((v90 ^ v95) &gt;&gt; 7)) ^ (2 * (v90 ^ v95)) ^ v43 ^ *(v20 - 10) ^ v90)];
        v91 = byte_20A0[v46];
        v90 = byte_20A0[v49];
        v40 = byte_20A0[v47];
        v38 = byte_20A0[v45];
        v95 = byte_20A0[((27 * (v99 &gt;&gt; 7)) ^ (2 * v99) ^ v89 ^ v42 ^ *(v20 - 13))];
        v89 = byte_20A0[v50];
      }
      while ( v112 != v20 );
      LOBYTE(v30) = v105 ^ v30;
      LOBYTE(v87) = v100 ^ v87;
      _R15D = v30;
      __asm { vmovd   xmm5, r15d }
      v54 = v86;
      LOBYTE(v86) = v103 ^ v90;
      _R9D = (v101 ^ v91);
      _R10D = (v102 ^ v54);
      _EDX = (v107 ^ v96);
      _R13D = (v104 ^ v94);
      __asm
      {
        vmovd   xmm4, edx
        vmovd   xmm7, r9d
        vpinsrb xmm5, xmm5, ebx, 1
        vmovd   xmm3, r10d
      }
      v63 = 15LL;
      _ESI = (v106 ^ v93);
      __asm
      {
        vmovd   xmm1, r13d
        vmovd   xmm0, [rsp+208h+var_1F8]
        vmovd   xmm6, [rsp+208h+var_1FC]
        vpinsrb xmm7, xmm7, [rsp+208h+var_1FD], 1
        vpinsrb xmm0, xmm0, eax, 1
        vpinsrb xmm1, xmm1, r11d, 1
        vpunpcklwd xmm0, xmm0, xmm7
      }
      v72 = HIBYTE(v113);
      __asm
      {
        vpinsrb xmm3, xmm3, [rsp+208h+var_1FE], 1
        vpinsrb xmm6, xmm6, [rsp+208h+var_1F4], 1
        vpunpcklwd xmm1, xmm1, xmm5
        vpunpcklwd xmm3, xmm3, xmm6
        vmovd   xmm2, esi
        vpunpckldq xmm0, xmm0, xmm3
        vpinsrb xmm2, xmm2, r8d, 1
        vpinsrb xmm4, xmm4, ecx, 1
        vpunpcklwd xmm2, xmm2, xmm4
        vpunpckldq xmm1, xmm1, xmm2
        vpunpcklqdq xmm0, xmm0, xmm1
        vmovdqa [rsp+208h+var_98], xmm0
      }
      if ( HIBYTE(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE14(v113);
      HIBYTE(v113) = 0;
      v63 = 14LL;
      if ( BYTE14(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE13(v113);
      BYTE14(v113) = 0;
      v63 = 13LL;
      if ( BYTE13(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE12(v113);
      BYTE13(v113) = 0;
      v63 = 12LL;
      if ( BYTE12(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE11(v113);
      BYTE12(v113) = 0;
      v63 = 11LL;
      if ( BYTE11(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE10(v113);
      BYTE11(v113) = 0;
      v63 = 10LL;
      if ( BYTE10(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE9(v113);
      BYTE10(v113) = 0;
      v63 = 9LL;
      if ( BYTE9(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE8(v113);
      BYTE9(v113) = 0;
      v63 = 8LL;
      if ( BYTE8(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE7(v113);
      BYTE8(v113) = 0;
      v63 = 7LL;
      if ( BYTE7(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE6(v113);
      BYTE7(v113) = 0;
      v63 = 6LL;
      if ( BYTE6(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE5(v113);
      BYTE6(v113) = 0;
      v63 = 5LL;
      if ( BYTE5(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE4(v113);
      BYTE5(v113) = 0;
      v63 = 4LL;
      if ( BYTE4(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE3(v113);
      BYTE4(v113) = 0;
      v63 = 3LL;
      if ( BYTE3(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE2(v113);
      BYTE3(v113) = 0;
      v63 = 2LL;
      if ( BYTE2(v113) != 0xFF )
        goto LABEL_14;
      v72 = BYTE1(v113);
      BYTE2(v113) = 0;
      v63 = 1LL;
      if ( BYTE1(v113) == 0xFF &amp;&amp; (v72 = v113, BYTE1(v113) = 0, v63 = 0LL, v113 == 0xFF) )
      {
        LOBYTE(v113) = 0;
        v16 = 0;
      }
      else
      {
LABEL_14:
        *(&amp;v113 + v63) = v72 + 1;
        v16 = 0;
      }
    }
    v17 = v16++;
    *v98++ ^= *(&amp;v115[-1] + v17);
  }
  while ( &amp;v116 != v98 );
  v18 = memcmp(v115, ptr, 0x40uLL);
  if ( v18 )
  {
    v18 = 1;
    puts(&#34;Nope, come back later&#34;);
  }
  else
  {
    puts(&#34;Yep, that&#39;s it!&#34;);
  }
  return v18;
}
</code></pre><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---not-crypto/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---otp-implementation/>PicoCTF - OTP Implementation</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---otp-implementation>PicoCTF - OTP Implementation
<a class=anchor href=#picoctf---otp-implementation>#</a></h1><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Main Function</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#66d9ef>__cdecl</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>envp)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> v4; <span style=color:#75715e>// al
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> v5; <span style=color:#75715e>// dl
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> v6; <span style=color:#75715e>// eax
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> i; <span style=color:#75715e>// [rsp+18h] [rbp-E8h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> j; <span style=color:#75715e>// [rsp+1Ch] [rbp-E4h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> input_key[<span style=color:#ae81ff>112</span>]; <span style=color:#75715e>// [rsp+20h] [rbp-E0h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>char</span> tmp_key[<span style=color:#ae81ff>104</span>]; <span style=color:#75715e>// [rsp+90h] [rbp-70h] BYREF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int64</span> v11; <span style=color:#75715e>// [rsp+F8h] [rbp-8h]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  v11 <span style=color:#f92672>=</span> __readfsqword(<span style=color:#ae81ff>0x28u</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ( argc <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span> )
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    strncpy(input_key, argv[<span style=color:#ae81ff>1</span>], <span style=color:#ae81ff>0x64uLL</span>);
</span></span><span style=display:flex><span>    input_key[<span style=color:#ae81ff>100</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ( i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; valid_char(input_key[i]); <span style=color:#f92672>++</span>i )<span style=color:#75715e>// 確認字元是否在[0-9|a-f]之間
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( i )
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        v4 <span style=color:#f92672>=</span> jumble(input_key[i]);
</span></span><span style=display:flex><span>        v5 <span style=color:#f92672>=</span> tmp_key[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> v4;
</span></span><span style=display:flex><span>        v6 <span style=color:#f92672>=</span> ((tmp_key[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> v4) <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>31</span>) <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>28</span>;
</span></span><span style=display:flex><span>        tmp_key[i] <span style=color:#f92672>=</span> ((v6 <span style=color:#f92672>+</span> v5) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xF</span>) <span style=color:#f92672>-</span> v6;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        tmp_key[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> jumble(input_key[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>16</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ( j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> i; <span style=color:#f92672>++</span>j )
</span></span><span style=display:flex><span>      tmp_key[j] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0x61</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( i <span style=color:#f92672>==</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>strncmp(
</span></span><span style=display:flex><span>            tmp_key,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;bajbgfapbcclgoejgpakmdilalpomfdlkngkhaljlcpkjgndlgmpdgmnmepfikanepopbapfkdgleilhkfgilgabldofbcaedgfe&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>100uLL</span>) )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      puts(<span style=color:#e6db74>&#34;You got the key, congrats! Now xor it with the flag!&#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      puts(<span style=color:#e6db74>&#34;Invalid key!&#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    printf(<span style=color:#e6db74>&#34;USAGE: %s [KEY]</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#f92672>*</span>argv);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---otp-implementation/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---picker-iii/>PicoCTF - Picker III</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---picker-iii>PicoCTF - Picker III
<a class=anchor href=#picoctf---picker-iii>#</a></h1><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class=language-python! data-lang=python!>
import re



USER_ALIVE = True
FUNC_TABLE_SIZE = 4
FUNC_TABLE_ENTRY_SIZE = 32
CORRUPT_MESSAGE = &#39;Table corrupted. Try entering \&#39;reset\&#39; to fix it&#39;

func_table = &#39;&#39;

def reset_table():
  global func_table

  # This table is formatted for easier viewing, but it is really one line
  func_table = \
&#39;&#39;&#39;\
print_table                     \
read_variable                   \
write_variable                  \
getRandomNumber                 \
&#39;&#39;&#39;

def check_table():
  global func_table

  if( len(func_table) != FUNC_TABLE_ENTRY_SIZE * FUNC_TABLE_SIZE):
    return False

  return True


def get_func(n):
  global func_table

  # Check table for viability
  if( not check_table() ):
    print(CORRUPT_MESSAGE)
    return

  # Get function name from table
  func_name = &#39;&#39;
  func_name_offset = n * FUNC_TABLE_ENTRY_SIZE
  for i in range(func_name_offset, func_name_offset+FUNC_TABLE_ENTRY_SIZE):
    if( func_table[i] == &#39; &#39;):
      func_name = func_table[func_name_offset:i]
      break

  if( func_name == &#39;&#39; ):
    func_name = func_table[func_name_offset:func_name_offset+FUNC_TABLE_ENTRY_SIZE]
  
  return func_name


def print_table():
  # Check table for viability
  if( not check_table() ):
    print(CORRUPT_MESSAGE)
    return

  for i in range(0, FUNC_TABLE_SIZE):
    j = i + 1
    print(str(j)+&#39;: &#39; + get_func(i))


def filter_var_name(var_name):
  r = re.search(&#39;^[a-zA-Z_][a-zA-Z_0-9]*$&#39;, var_name)
  if r:
    return True
  else:
    return False


def read_variable():
  var_name = input(&#39;Please enter variable name to read: &#39;)
  if( filter_var_name(var_name) ):
    eval(&#39;print(&#39;+var_name+&#39;)&#39;)
  else:
    print(&#39;Illegal variable name&#39;)


def filter_value(value):
  if &#39;;&#39; in value or &#39;(&#39; in value or &#39;)&#39; in value:
    return False
  else:
    return True


def write_variable():
  var_name = input(&#39;Please enter variable name to write: &#39;)
  if( filter_var_name(var_name) ):
    value = input(&#39;Please enter new value of variable: &#39;)
    if( filter_value(value) ):
      exec(&#39;global &#39;+var_name+&#39;; &#39;+var_name+&#39; = &#39;+value)
    else:
      print(&#39;Illegal value&#39;)
  else:
    print(&#39;Illegal variable name&#39;)


def call_func(n):
  &#34;&#34;&#34;
  Calls the nth function in the function table.
  Arguments:
    n: The function to call. The first function is 0.
  &#34;&#34;&#34;

  # Check table for viability
  if( not check_table() ):
    print(CORRUPT_MESSAGE)
    return

  # Check n
  if( n &lt; 0 ):
    print(&#39;n cannot be less than 0. Aborting...&#39;)
    return
  elif( n &gt;= FUNC_TABLE_SIZE ):
    print(&#39;n cannot be greater than or equal to the function table size of &#39;+FUNC_TABLE_SIZE)
    return

  # Get function name from table
  func_name = get_func(n)

  # Run the function
  eval(func_name+&#39;()&#39;)


def dummy_func1():
  print(&#39;in dummy_func1&#39;)

def dummy_func2():
  print(&#39;in dummy_func2&#39;)

def dummy_func3():
  print(&#39;in dummy_func3&#39;)

def dummy_func4():
  print(&#39;in dummy_func4&#39;)

def getRandomNumber():
  print(4)  # Chosen by fair die roll.
            # Guaranteed to be random.
            # (See XKCD)

def win():
  # This line will not work locally unless you create your own &#39;flag.txt&#39; in
  #   the same directory as this script
  flag = open(&#39;flag.txt&#39;, &#39;r&#39;).read()
  #flag = flag[:-1]
  flag = flag.strip()
  str_flag = &#39;&#39;
  for c in flag:
    str_flag += str(hex(ord(c))) + &#39; &#39;
  print(str_flag)

def help_text():
  print(
  &#39;&#39;&#39;
This program fixes vulnerabilities in its predecessor by limiting what
functions can be called to a table of predefined functions. This still puts
the user in charge, but prevents them from calling undesirable subroutines.

* Enter &#39;quit&#39; to quit the program.
* Enter &#39;help&#39; for this text.
* Enter &#39;reset&#39; to reset the table.
* Enter &#39;1&#39; to execute the first function in the table.
* Enter &#39;2&#39; to execute the second function in the table.
* Enter &#39;3&#39; to execute the third function in the table.
* Enter &#39;4&#39; to execute the fourth function in the table.

Here&#39;s the current table:
  &#39;&#39;&#39;
  )
  print_table()



reset_table()

while(USER_ALIVE):
  choice = input(&#39;==&gt; &#39;)
  if( choice == &#39;quit&#39; or choice == &#39;exit&#39; or choice == &#39;q&#39; ):
    USER_ALIVE = False
  elif( choice == &#39;help&#39; or choice == &#39;?&#39; ):
    help_text()
  elif( choice == &#39;reset&#39; ):
    reset_table()
  elif( choice == &#39;1&#39; ):
    call_func(0)
  elif( choice == &#39;2&#39; ):
    call_func(1)
  elif( choice == &#39;3&#39; ):
    call_func(2)
  elif( choice == &#39;4&#39; ):
    call_func(3)
  else:
    print(&#39;Did not understand &#34;&#39;+choice+&#39;&#34; Have you tried &#34;help&#34;?&#39;)
</code></pre><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---picker-iii/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---powershelly/>PicoCTF - Powershelly</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---powershelly>PicoCTF - Powershelly
<a class=anchor href=#picoctf---powershelly>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://zh.wikipedia.org/zh-tw/PowerShell#%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E5%AD%97%E5%85%83%E6%AF%94%E8%BE%83>Powershell 命令提示字元比較</a>
<a href=https://stackoverflow.com/questions/56965510/what-is-meaning-in-powershell>What is &lsquo;@{}&rsquo; meaning in PowerShell</a>
<a href=https://stackoverflow.com/questions/28732025/what-does-mean-in-powershell>What does @() mean in Powershell?</a>
<a href=https://wenyuangg.github.io/posts/python3/python-set.html>[Python] 學習使用集合 (Set)</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler Source Code</p><pre tabindex=0><code class="language-bash=" data-lang="bash=">$input = &#34;.\input.txt&#34;

$out = Get-Content -Path $input
$enc = [System.IO.File]::ReadAllBytes(&#34;$input&#34;)
$encoding = [system.Text.Encoding]::UTF8
$total = 264
$t = ($total + 1) * 5 #1325
$numLength = ($total * 30 ) + $t # 9245
if ($out.Length -gt 5 -or $enc.count -ne $numLength)
{
  Write-Output &#34;Wrong format 5&#34;
  Exit
}

else
{
  for($i=0; $i -lt $enc.count ; $i++)
  {
    if (($enc[$i] -ne 49) -and ($enc[$i] -ne 48) -and ($enc[$i] -ne 10) -and ($enc[$i] -ne 13) -and ($enc[$i] -ne 32))
    {
      Write-Output &#34;Wrong format 1/0/&#34;
      Exit
    }
  }
}

$blocks = @{}
for ($i=0; $i -lt $out.Length ; $i++)
{
  $r = $out[$i].Split(&#34; &#34;)
  if ($i -gt 0)
  {
    for ($j=0; $j -lt $r.Length ; $j++)
    {
      if ($r[$j].Length -ne 6)
      {
        Write-Output &#34;Wrong Format 6&#34; $r[$j].Length
        Exit
      }
      $blocks[$j] += $r[$j]
    }
  }
  else
  {
    for ($j=0; $j -lt $r.Length ; $j++)
    {
      if ($r[$j].Length -ne 6)
      {
        Write-Output &#34;Wrong Format 6&#34; $r[$j].Length
        Exit
      }
      $blocks[$j] = @()
      $blocks[$j] += $r[$j]
    }
  }

}


function Exit  {
  exit
}


function Random-Gen {
  $list1 = @()
  for ($i=1; $i -lt ($blocks.count + 1); $i++)
  {
    $y = ((($i * 327) % 681 ) + 344) % 313
    $list1 += $y
  }
  return $list1
}


function Scramble {
    param (
        $block,
        $seed
    )
    $raw = [system.String]::Join(&#34;&#34;, $block)
    $bm = &#34;10 &#34; * $raw.Length
    $bm = $bm.Split(&#34; &#34;)
    for ($i=0; $i -lt $raw.Length ; $i++)
    {

      $y = ($i * $seed) % $raw.Length
      $n = $bm[$y]
      while ($n -ne &#34;10&#34;)
      {
        $y = ($y + 1) % $raw.Length
        $n = $bm[$y]
      }
      if ($raw[$i] -eq &#34;1&#34; )
      {
        $n = &#34;11&#34;
      }
      else
      {
        $n = &#34;00&#34;
      }
      $bm[$y] = $n
    }
    $raw2 = [system.String]::Join(&#34;&#34;, $bm)
    $b = [convert]::ToInt64($raw2,2)
    return $b
}


$result = 0
$seeds = @()
for ($i=1; $i -lt ($blocks.count +1); $i++)
{
  $seeds += ($i * 127) % 500
}

$randoms = Random-Gen
$output_file = @()
for ($i=0; $i -lt $blocks.count ; $i++)
{

  $fun = Scramble -block $blocks[$i] -seed $seeds[$i]
  if($i -eq 263)
  {
    Write-Output $seeds[$i]
    Write-Output $randoms[$i]
    Write-Output $fun
  }
  $result = $fun -bxor $result -bxor $randoms[$i]
  $output_file += $result
}
Add-Content -Path output_test.txt -Value $output_file
</code></pre><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---powershelly/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---transformation/>PicoCTF - Transformation</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---transformation>PicoCTF - Transformation
<a class=anchor href=#picoctf---transformation>#</a></h1><h6 id=tags-picoctf-ctf-reverse>tags: <code>PicoCTF</code> <code>CTF</code> <code>Reverse</code>
<a class=anchor href=#tags-picoctf-ctf-reverse>#</a></h6><p>Challenge: <a href="https://play.picoctf.org/practice/challenge/104?category=3&amp;page=1">Transformation</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><p>enc file content: <code>灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸彥㜰㍢㐸㙽</code>
Transformation Code</p><pre tabindex=0><code class=language-python! data-lang=python!>&#39;&#39;.join([chr((ord(flag[i]) &lt;&lt; 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)])
</code></pre><p>Seems it shift the first character with 8 bits and concatenate the 2nd character then go through <code>len(flag)</code></p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><p>My perspective is just recover the strings
:::spoiler</p><pre tabindex=0><code class="language-python=" data-lang="python=">flag = &#39;灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸彥㜰㍢㐸㙽&#39;
enc = &#39;&#39;

def decimalToBinary(n):
    return bin(n).replace(&#34;0b&#34;, &#34;&#34;)

def binToHexa(n):
    bnum = int(n)
    temp = 0
    mul = 1
    count = 1
    hexaDeciNum = [&#39;0&#39;] * 100
    i = 0
    while bnum != 0:
        rem = bnum % 10
        temp = temp + (rem*mul)
        if count % 4 == 0:
            if temp &lt; 10:
                hexaDeciNum[i] = chr(temp+48)
            else:
                hexaDeciNum[i] = chr(temp+55)
            mul = 1
            temp = 0
            count = 1
            i = i+1
        else:
            mul = mul*2
            count = count+1
        bnum = int(bnum/10)
    if count != 1:
        hexaDeciNum[i] = chr(temp+48)
    if count == 1:
        i = i-1
    hex_string = &#39;&#39;
    while i &gt;= 0:
        hex_string += hexaDeciNum[i]
        i = i-1
    return hex_string


for i in range(0, len(flag)):
    plaintext1 = decimalToBinary(ord(flag[i]))
    while(len(plaintext1) != 16):
        plaintext1 = &#39;0&#39; + plaintext1
    plaintext2 = plaintext1[-8:]
    plaintext1 = plaintext1[0:8]
    enc += binToHexa(plaintext1)
    enc += binToHexa(plaintext2)
print(bytes.fromhex(enc).decode(&#39;utf-8&#39;))
</code></pre><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---transformation/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/picoctf/reverse/picoctf---wizardlike/>PicoCTF - Wizardlike</a></h2><div class=text-small><a href=/tags/picoctf/>PicoCTF</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a></div><p><h1 id=picoctf---wizardlike>PicoCTF - Wizardlike
<a class=anchor href=#picoctf---wizardlike>#</a></h1><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題蠻有趣的，如果只是單純執行程式碼，會發現是一個迷宮的遊戲，不過走越多會發現兩個現象</p><ol><li>遊戲本身根本無法破關</li><li>有一些"道路"回隨著角色本身的移動慢慢浮現出來</li></ol><p>我也不知道是哪來的想法直覺想要看他的地圖，因為看IDA翻出來的code，貌似有十個關卡，而如果把地圖翻出來會發現每一個關卡總共會有10000個字元，然後每一列都是100個字元呈現，然後就發現他其實是用地圖的方式呈現他的flag，則我們可以先把10個關卡的所有字元另存一個檔案(純手工)，再寫一點點script就可以把flag還原</p><h2 id=exploit---通靈>Exploit - 通靈
<a class=anchor href=#exploit---%e9%80%9a%e9%9d%88>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;./cipher.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>pt <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;./flag.txt&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>join([f[<span style=color:#ae81ff>100</span> <span style=color:#f92672>*</span> i : <span style=color:#ae81ff>100</span> <span style=color:#f92672>*</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>100</span>] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(f) <span style=color:#f92672>//</span> <span style=color:#ae81ff>100</span>)])
</span></span><span style=display:flex><span>pt<span style=color:#f92672>.</span>write(flag)
</span></span></code></pre></div><p>:::spoiler flag</p><pre tabindex=0><code>#########                                                                                           
#.......#  ......#...................................                                               
#.......#  ....................####.#####.#####..###.                                               
#........  .####.#..###..###..#.......#...#......#...                                               
#.......#  .#  #.#.#....#   #.#.......#...###...#....                                               
#.......#  .####.#.#....#   #.#.......#...#......#...                                               
#.......#  .#....#..###..###...####...#...#......###.                                               
#.......#  .#........................................                                               
#.......#  ..........................................                                               
#.......#                                                                                           
#.......#                                                                                           
#.......#                                                                                           
#.......#                                                                                           
#.......#                                                                                           
#......&gt;#                                                                                           
#########                                                                                           
#####. .............................................................                                
#.&lt;.#. ...............#..#.............##.......#..#........#.......                                
#...#. .#..#.###......#..#.......#...#..#.####..#..#.###....#.......                                
#...#. .#..#.#........####.......#.#.#..#...#...####.#...####.......                                
#...#. .####.#...####....#.#####..#.#..###.####....#.#...####.#####.                                
  .    .............................................................                                
  .    .............................................................                                
  .    .............................................................                                
#....                                                                                               
#...#                                                                                               
#...#                                                                                               
#...#                                                                                               
#...#                                                                                               
#...#                                                                                               
#.&gt;.#                                                                                               
#####                                                                                               
#################   .......                                                                         
#&lt;..............#.  ..###..                                                                         
#...............#.. .#...#.                                                                         
#..............#......###..                                                                         
#...#.......#...#.. .#...#.                                                                         
#..###.....###..#.  ..###..                                                                         
#...#...#...#...#   .......                                                                         
#......#&gt;#......#   .......                                                                         
#...............#                                                                                   
#...#.......#...#                                                                                   
#..###.....###..#                                                                                   
#...#.......#...#                                                                                   
#...............#                                                                                   
#...............#                                                                                   
#...............#                                                                                   
#################                                                                                   
...             ..  .......                                                                         
.&lt;.          ####.  .#####.                                                                         
...          ...#.. .#.....                                                                         
...          ...#....###...                                                                         
             ..&gt;#.. .#.....                                                                         
             ####.  .#.....                                                                         
                ..  .......                                                                         
                    .......                                                                         
                    
########################                                                                            
#&lt;.............#.......#                                                                            
#..............#.#...#.#                                                                            
#..............#.#...#.#                                                                            
#..............#.#####.#                                                                            
#..............#.....#.#                                                                            
#..............#.....#.#                                                                            
#..............#.......#                                                                            
#..............#.......#                                                                            
########################                                                                            
.......                                                                                             
.&lt;.....                                                                                             
.......                                                                                             
.......                                                                                             
.......                                                                                             
.......                                                                                             
.......                                                                                             
.......                                                                                             
.......                                                                                             
.......                                                                                             
.......                                                                                             
.....&gt;.                                                                                             
.......                                                                                             
#######                                                                                             
.......                                                                                             
.####..                                                                                             
.#...#.                                                                                             
.####..                                                                                             
.#...#.                                                                                             
.####..                                                                                             
.......                                                                                             
.......                                                                                             
...                                                                                                 
.&lt;.........                                                                                         
...........                                                                                         
...      ..                                                                                         
         ..                                                                                         
         ..                                                                                         
         ..                                                                                         
         ..                                                                                         
         ..                                                                                         
         ..                                                                                         
   ..............                                                                                   
   ..##########..                                                                                   
   .#          #.                                                                                   
   .#  ....... #.                                                                                   
   .#  ..###.. #.                                                                                   
   .#  .#...#. #.                                                                                   
   .#  .#...#. #.                                                                                   
   .#  .#...#. #.                                                                                   
   .#  ..###.. #.                                                                                   
   .#  ....... #.                                                                                   
   .#  ....... #.                                                                                   
   .#          #.                                                                                   
   ..##########..                                                                                   
   .............&gt;                                                                                   
#########################                                                                           
#&lt;#......#.#.......###..#                                                                           
#.#.###..#.#.......##..##                                                                           
#.#.#.#..#.#.......#..###                                                                           
#.#.#.#..#.#.......#...##                                                                           
#...#....#..#......#....#                                                                           
#.######.##..###.###....#                                                                           
#.#.....................#                                                                           
#.###.#################.#                                                                           
#.......................#                                                                           
#########.###.#########.#                                                                           
#.......#.#.#.#.........#                                                                           
#.#...#.#.#...#.#########                                                                           
#.#...#.#.#.#.#.........#                                                                           
#.#####.#.#.#.#########.#                                                                           
#.....#.#.#.#.#.........#                                                                           
#.....#.#.#.#.#.#########                                                                           
#.......#.#.#.#.........#                                                                           
#.......#.#.#.#########.#                                                                           
#########.#.#.#...#...#.#                                                                           
#...........#.#.#.#.#.#.#                                                                           
#########...#.#.#.#.#.#.#                                                                           
#.......#...#.#.#.#.#.#.#                                                                           
####.####...#.#.#.#.#.#.#                                                                           
##..........#.#.#.#.#.#.#                                                                           
#.#..####...#.#.#.#.#.#.#                                                                           
#..#....#####.#.#.#.#.#.#                                                                           
#...#...#...#.#.#...#...#                                                                           
#....#........#.#########                                                                           
#...........#.#........&gt;#                                                                           
########################.                                                                           
...                                                                                          .......
.&lt;.                                                                                          ..###..
...                                                                                          .#...#.
...                                                                                          .#####.
                                                                                             .#...#.
                                                                                             .#...#.
                                                                                             .......
                                                                                             .......
                                                                                             
#####################################################################################..............#
#####################################################################################.#####.###....#
#####################################################################################.#.......#....#
#####################################################################################.###......#...#
#####################################################################################.#.......#....#
#####################################################################################.#####.###....#
#####################################################################################..............#
#####################################################################################..............#
</code></pre><p>:::</p><a href=/security/practice/picoctf/reverse/picoctf---wizardlike/>...</a></p></article><article class="markdown book-post"><h2><a href=/tools/ctf/reverse-overview/>Reverse Overview</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/reverse/>Reverse</a>,
<a href=/tags/tools/>Tools</a></div><p><h1 id=reverse-overview>Reverse Overview
<a class=anchor href=#reverse-overview>#</a></h1><h2 id=tools>Tools
<a class=anchor href=#tools>#</a></h2><table><thead><tr><th>Type</th><th>App</th><th>.NET</th><th>x86/x64</th><th>Packer</th><th>Python</th><th>C</th><th>General</th></tr></thead><tbody><tr><td>Description</td><td><li>MobSF: Must run in python <code>3.8</code></li><li>ApkTool: Just follow the step in <a href=https://apktool.org/docs/install/>install guide</a></li></td><td>To decompile C#(.NET)</td><td></td><td>指令：<code>$ upx -d {filename}</code></td><td></td><td>一個可以把組語轉換成c pseudo code的線上工具</td><td>一個線上的decompiler，結合多種工具，只要上傳檔案(小於2MB)就可以呈現多種decompiler tools的結果</td></tr><tr><td>Link</td><td><a href=https://ithelp.ithome.com.tw/articles/10215522>MobSF</a></br><a href=https://apktool.org/>ApkTools</a></td><td><a href=https://github.com/dnSpy/dnSpy/releases>dnSpy</a></td><td><a href=https://carlosrafaelgn.com.br/Asm86/>x86模擬器</a></br><a href=https://defuse.ca/online-x86-assembler.htm#disassembly>x86/x64 assembler/disassembler</a></td><td><a href=https://github.com/upx/upx/releases/tag/v4.0.2>UPX Packer</a></td><td><a href=https://tool.lu/pyc/>Pyc disassemble</a></td><td><a href=https://godbolt.org/>Compiler Explorer</a></td><td><a href=https://dogbolt.org/>Decompiler Explorer</a></td></tr></tbody></table><h2 id=ida-常用快捷鍵>IDA 常用快捷鍵
<a class=anchor href=#ida-%e5%b8%b8%e7%94%a8%e5%bf%ab%e6%8d%b7%e9%8d%b5>#</a></h2><ul><li><a href=https://blog.30cm.tw/2018/01/ida.html>IDA Interface</a></li><li>型別<ul><li>char(1 byte)</li><li>WORD(2 bytes)</li><li>DWORD(4 bytes)</li><li>PDWORD(pointer of DWORD = DWORD *)</li><li>若是DWORD *name，代表name這個變數是一個pointer而且指向的地方是一個DWORD</li></ul></li><li>Space: 在 Text View / Graph View 切換</li><li>Tab: 在視窗之間切換</li><li>;/Insert: 註解</li><li>x: 秀出 Xrefs</li><li>n: 改名</li><li>y: 改型別</li><li>h: 改表示方式 (dec / hex)</li><li>u: 取消定義</li><li>a: 當成字串</li><li>c: 當成code</li><li>p: 當成function</li><li>t: set sizeof(XXX)；如果已經確定目前的constant就是某個變數的length，那可以直接按t讓他變成sizeof(那個變數)
舉例：如果已經確定目前的<code>0x238</code>就是<code>PROCESSENTRY32W</code>的size，就可以直接這樣用，會變得比較清楚
:::spoiler 結果
<img src=https://hackmd.io/_uploads/S1nruHTza.png alt>
<img src=https://hackmd.io/_uploads/rkjwuBTza.png alt>
:::</li><li>Shift+F1: show出Local Type視窗
:::spoiler Local Types Screenshot
<img src=https://hackmd.io/_uploads/S1ikDa5_n.png alt>
:::</li><li>Shift+F12: 開啟Strings視窗
:::spoiler Strings Screenshot
<img src=https://hackmd.io/_uploads/HybvLzo_2.png alt>
:::</li><li>對某一個數值按m: ENUM這個功能就是在替換一些常見的windows API參數，讓原本的純數字可以用文字表示，這樣比較好懂API的操作，逆向會更順暢(補充說明：IDA有收錄很多MSDN上的一些API，他每一個參數表示的文字，例如<a href=https://learn.microsoft.com/en-us/windows/win32/Memory/memory-protection-constants>這一篇</a>底下有顯示很多Constant/value的對應，而正常情況下IDA會顯示的是value，如果要把它換成Constant文字的表達式就可以用到ENUM這個功能)，又例如:
目前已經知道<code>CreateToolhelp32Snapshot(2, 0);</code>中的2的意義是<code>TH32CS_SNAPPROCESS</code>(可以參考<a href=https://learn.microsoft.com/zh-tw/windows/win32/api/tlhelp32/nf-tlhelp32-createtoolhelp32snapshot#parameters>MSDN</a>)，此時就可以直接按m之後再選擇<code>TH32CS_SNAPPROCESS</code>
:::spoiler
<img src=https://hackmd.io/_uploads/B1Rn5Q6G6.png alt>
:::</li><li>\: 不顯示/顯示資料型別</li><li>Alt+M/Ctrl+M: 前者是註冊書籤，後者是察看並選擇標籤，可以快速跑到標示的地址</li><li>Ctrl+E: 如果是分析DLL file，可能會有很多不同的entry point，利用這個shortcut可以顯示目前有幾個entry point，很方便
:::spoiler
<img src=https://hackmd.io/_uploads/ryJw-C6Ga.png alt>
:::</li><li>如何把bytes變成字串:<ul><li>可以直接Alt+A
:::spoiler</li></ul><ol><li>可以先把bytes的型別定義好(單獨的bytes變成array)，變成array有兩種方法，第一種是直接用<code>Y</code>定義他的型別成<code>int dword_2008[32]</code>，前面的int就看每一個字元是來決定，後面<code>[32]</code>就代表有多少字元變成array；第二種方法就是直接按<code>d</code>改變一個字元的型態變成int，然後在<code>edit/Array</code>的地方可以叫出<code>Convert to array</code>的視窗(如果前面沒有先用<code>d</code>改變型態的話，他會以為所有字元都是一個byte，然後總共有128個字元這樣換算，但其實我們是總共32個字元，每一個字元是4個bytes，也就是int，這一點要特別注意)
<img src=https://hackmd.io/_uploads/HJ3yvI-Ga.png alt>
<img src=https://hackmd.io/_uploads/r1A_8LWMa.png alt></li><li>接著就是在<code>Option/String literals</code>視窗中設定用哪一個型態表示字串，這邊因為每一個字元都是4 bytes，也就是32 bits，所以選擇C-style
<img src=https://hackmd.io/_uploads/SyQBP8Zfp.png alt>
:::
:::spoiler 完整流程</li></ol><pre tabindex=0><code>.rodata:0000000000002008 unk_2008 db  46h ; F                    ; DATA XREF: main+8↑o
.rodata:0000000000002009 db    0
.rodata:000000000000200A db    0
.rodata:000000000000200B db    0
.rodata:000000000000200C db  4Ch ; L
.rodata:000000000000200D db    0
.rodata:000000000000200E db    0
.rodata:000000000000200F db    0
.rodata:0000000000002010 db  41h ; A
.rodata:0000000000002011 db    0
.rodata:0000000000002012 db    0
.rodata:0000000000002013 db    0
.rodata:0000000000002014 db  47h ; G
.rodata:0000000000002015 db    0
.rodata:0000000000002016 db    0
.rodata:0000000000002017 db    0
.rodata:0000000000002018 db  7Bh ; {
.rodata:0000000000002019 db    0
.rodata:000000000000201A db    0
.rodata:000000000000201B db    0
.rodata:000000000000201C db  68h ; h
.rodata:000000000000201D db    0
.rodata:000000000000201E db    0
.rodata:000000000000201F db    0
.rodata:0000000000002020 db  33h ; 3
.rodata:0000000000002021 db    0
.rodata:0000000000002022 db    0
.rodata:0000000000002023 db    0
.rodata:0000000000002024 db  31h ; 1
.rodata:0000000000002025 db    0
.rodata:0000000000002026 db    0
.rodata:0000000000002027 db    0
.rodata:0000000000002028 db  31h ; 1
.rodata:0000000000002029 db    0
.rodata:000000000000202A db    0
.rodata:000000000000202B db    0
.rodata:000000000000202C db  4Fh ; O
.rodata:000000000000202D db    0
.rodata:000000000000202E db    0
.rodata:000000000000202F db    0
.rodata:0000000000002030 db  5Fh ; _
.rodata:0000000000002031 db    0
.rodata:0000000000002032 db    0
.rodata:0000000000002033 db    0
.rodata:0000000000002034 db  72h ; r
.rodata:0000000000002035 db    0
.rodata:0000000000002036 db    0
.rodata:0000000000002037 db    0
.rodata:0000000000002038 db  65h ; e
.rodata:0000000000002039 db    0
.rodata:000000000000203A db    0
.rodata:000000000000203B db    0
.rodata:000000000000203C db  76h ; v
.rodata:000000000000203D db    0
.rodata:000000000000203E db    0
.rodata:000000000000203F db    0
.rodata:0000000000002040 db  65h ; e
.rodata:0000000000002041 db    0
.rodata:0000000000002042 db    0
.rodata:0000000000002043 db    0
.rodata:0000000000002044 db  72h ; r
.rodata:0000000000002045 db    0
.rodata:0000000000002046 db    0
.rodata:0000000000002047 db    0
.rodata:0000000000002048 db  73h ; s
.rodata:0000000000002049 db    0
.rodata:000000000000204A db    0
.rodata:000000000000204B db    0
.rodata:000000000000204C db  31h ; 1
.rodata:000000000000204D db    0
.rodata:000000000000204E db    0
.rodata:000000000000204F db    0
.rodata:0000000000002050 db  6Eh ; n
.rodata:0000000000002051 db    0
.rodata:0000000000002052 db    0
.rodata:0000000000002053 db    0
.rodata:0000000000002054 db  67h ; g
.rodata:0000000000002055 db    0
.rodata:0000000000002056 db    0
.rodata:0000000000002057 db    0
.rodata:0000000000002058 db  5Fh ; _
.rodata:0000000000002059 db    0
.rodata:000000000000205A db    0
.rodata:000000000000205B db    0
.rodata:000000000000205C db  33h ; 3
.rodata:000000000000205D db    0
.rodata:000000000000205E db    0
.rodata:000000000000205F db    0
.rodata:0000000000002060 db  6Eh ; n
.rodata:0000000000002061 db    0
.rodata:0000000000002062 db    0
.rodata:0000000000002063 db    0
.rodata:0000000000002064 db  67h ; g
.rodata:0000000000002065 db    0
.rodata:0000000000002066 db    0
.rodata:0000000000002067 db    0
.rodata:0000000000002068 db  69h ; i
.rodata:0000000000002069 db    0
.rodata:000000000000206A db    0
.rodata:000000000000206B db    0
.rodata:000000000000206C db  6Eh ; n
.rodata:000000000000206D db    0
.rodata:000000000000206E db    0
.rodata:000000000000206F db    0
.rodata:0000000000002070 db  65h ; e
.rodata:0000000000002071 db    0
.rodata:0000000000002072 db    0
.rodata:0000000000002073 db    0
.rodata:0000000000002074 db  65h ; e
.rodata:0000000000002075 db    0
.rodata:0000000000002076 db    0
.rodata:0000000000002077 db    0
.rodata:0000000000002078 db  72h ; r
.rodata:0000000000002079 db    0
.rodata:000000000000207A db    0
.rodata:000000000000207B db    0
.rodata:000000000000207C db  35h ; 5
.rodata:000000000000207D db    0
.rodata:000000000000207E db    0
.rodata:000000000000207F db    0
.rodata:0000000000002080 db  7Dh ; }
.rodata:0000000000002081 db    0
.rodata:0000000000002082 db    0
.rodata:0000000000002083 db    0
.rodata:0000000000002084 db    0
.rodata:0000000000002085 db    0
.rodata:0000000000002086 db    0
.rodata:0000000000002087 db    0
</code></pre>$\downarrow$<pre tabindex=0><code>.rodata:0000000000002008 dword_2008 dd 46h, 4Ch, 41h, 47h, 7Bh, 68h, 33h, 2 dup(31h), 4Fh, 5Fh, 72h, 65h, 76h, 65h, 72h, 73h, 31h, 6Eh, 67h
.rodata:0000000000002008                                         ; DATA XREF: main+8↑o
.rodata:0000000000002008 dd 5Fh, 33h, 6Eh, 67h, 69h, 6Eh, 2 dup(65h), 72h, 35h, 7Dh, 0
</code></pre>$\downarrow$<pre tabindex=0><code>.rodata:0000000000002008 text &#34;UTF-32LE&#34;, &#39;FLAG{h311O_revers1ng_3ngineer5}&#39;,0
</code></pre>:::</li><li>如何快速把bytes dump出來
:::spoiler<ol><li>選擇要輸出的bytes
<img src=https://hackmd.io/_uploads/Syc9UkTM6.png alt></li><li>按Shift+E，跳出的視窗選擇想要的格式，再直接複製即可
<img src=https://hackmd.io/_uploads/SJ7a8ypfT.png alt>
:::</li></ol></li><li>如果函式沒有return東西的話，可以右鍵該函示，選擇<code>Remove return value</code>或是Shift+Del
:::spoiler
<img src=https://hackmd.io/_uploads/HkRk3JpG6.png alt>
:::</li><li>如果function中的宣告很多，可以右鍵選擇<code>Collapse declarations</code>
:::spoiler
<img src=https://hackmd.io/_uploads/SkOXU4AMa.png alt>
:::</li></ul><h2 id=x64dbg-常用快捷鍵>x64dbg 常用快捷鍵
<a class=anchor href=#x64dbg-%e5%b8%b8%e7%94%a8%e5%bf%ab%e6%8d%b7%e9%8d%b5>#</a></h2><ul><li>F2: 設定中斷點</li><li>F9: 繼續執行</li><li>F8: 步過</li><li>F7: 步入</li><li>Ctrl+F9: 執行到 ret</li><li>==Ctrl+G==: goto</li><li>==Space==: 修改組譯</li></ul><h3 id=靜態分析>靜態分析
<a class=anchor href=#%e9%9d%9c%e6%85%8b%e5%88%86%e6%9e%90>#</a></h3><ul><li>PEview</li><li>PEViewer</li><li>PE-bear</li></ul><h3 id=動態分析>動態分析
<a class=anchor href=#%e5%8b%95%e6%85%8b%e5%88%86%e6%9e%90>#</a></h3><ul><li>OllyDbg</li><li>x64dbg</li><li>IDA</li><li>Ghidra</li><li>Windbg</li><li>PEtool</li></ul><h3 id=process相關的操作與資訊>Process相關的操作與資訊
<a class=anchor href=#process%e7%9b%b8%e9%97%9c%e7%9a%84%e6%93%8d%e4%bd%9c%e8%88%87%e8%b3%87%e8%a8%8a>#</a></h3><ul><li>Procexp & Process Hacker
好看版的工作管理員</li><li>Procmon
監控程序行為
Registry
File system
Network
Process/Thread</li></ul><h3 id=好用的解題工具>好用的解題工具
<a class=anchor href=#%e5%a5%bd%e7%94%a8%e7%9a%84%e8%a7%a3%e9%a1%8c%e5%b7%a5%e5%85%b7>#</a></h3><ul><li><a href=https://docs.angr.io/en/latest/appendix/cheatsheet.html>angr - cheatsheet</a>: <code>$ pip install angr claripy</code></li><li>z3: <code>$ pip install z3-solver</code></li></ul></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-cs/reverse/simple-reverse---0x01lab---sacred-arts/>Simple Reverse - 0x01(Lab - Sacred Arts)</a></h2><div class=text-small><a href=/tags/reverse/>Reverse</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/eductf/>Eductf</a></div><p><h1 id=simple-reverse---0x01lab---sacred-arts>Simple Reverse - 0x01(Lab - Sacred Arts)
<a class=anchor href=#simple-reverse---0x01lab---sacred-arts>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li><a href=https://zh.wikibooks.org/wiki/X86%E7%B5%84%E5%90%88%E8%AA%9E%E8%A8%80/%E5%9F%BA%E6%9C%AC%E6%8C%87%E4%BB%A4%E9%9B%86>X86組合語言/基本指令集</a></li><li><a href="https://www.ibm.com/docs/en/aix/7.1?topic=set-neg-negate-instruction">neg (Negate) instruction</a>
實作：先在執行<code>neg rax</code>之前把<code>$rax</code>設定成2，執行指令之後剛好是2的補數<pre tabindex=0><code class=language-! data-lang=!>gef➤  set $rax=2
gef➤  info r $rax
rax            0x2                 0x2
gef➤  ni
0x00000000004010e0 in ?? ()
gef➤  info r $rax
rax            0xfffffffffffffffe  0xfffffffffffffffe
</code></pre></li><li><a href=https://zh.wikibooks.org/zh/X86%E7%B5%84%E5%90%88%E8%AA%9E%E8%A8%80/%E5%9F%BA%E6%9C%AC%E6%8C%87%E4%BB%A4%E9%9B%86/IA32%E6%8C%87%E4%BB%A4:xchg>X86組合語言/基本指令集/IA32指令:xchg</a>
實作：執行<code>xchg ah, al</code>之前先看一下<code>$rax</code>的狀態<pre tabindex=0><code class=language-! data-lang=!>gef➤  info r $rax
rax            0xfffffffffffffffe  0xfffffffffffffffe
gef➤  ni
0x00000000004010e2 in ?? ()
gef➤  info r $rax
rax            0xfffffffffffffeff  0xfffffffffffffeff
</code></pre></li></ul><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p>:::spoiler IDA Pro Disassembler Code</p><a href=/security/course/ntu-cs/reverse/simple-reverse---0x01lab---sacred-arts/>...</a></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/tags/reverse/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/tags/reverse/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/tags/reverse/ aria-label="Page 1" class=page-link role=button>1</a></li><li class="page-item active"><a aria-current=page aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/tags/reverse/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/reverse/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/tags/reverse/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/tags/reverse/page/3/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/reverse/page/5/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>