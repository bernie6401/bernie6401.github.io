<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ntu/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="NTU"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>NTU | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ntu/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ntu/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>NTU</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/survey-papers/android-+-security/a-mitm-based-penetration-test-efficiency-improvement-approach-for-traffic-encrypted-mobile-apps-of-power-industry/>A MITM Based Penetration Test Efficiency Improvement Approach for Traffic-Encrypted Mobile Apps of Power Industry</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/meeting-paper/>Meeting Paper</a></div><p><h1 id=a-mitm-based-penetration-test-efficiency-improvement-approach-for-traffic-encrypted-mobile-applications-of-power-industry>A MITM Based Penetration Test Efficiency Improvement Approach for Traffic-Encrypted Mobile Applications of Power Industry
<a class=anchor href=#a-mitm-based-penetration-test-efficiency-improvement-approach-for-traffic-encrypted-mobile-applications-of-power-industry>#</a></h1><p>:::info
Zhang, L., Wang, B., Shen, Q., Song, Y., Guo, N., & Xie, L. (2021, April). A MITM Based Penetration Test Efficiency Improvement Approach for Traffic-Encrypted Mobile Applications of Power Industry. In 2021 IEEE 6th International Conference on Computer and Communication Systems (ICCCS) (pp. 743-747). IEEE.
:::
這一篇蠻有趣的，和我想要做的東西幾乎一樣，不過他論文闡述的重點不一樣，但也還是給我一些之後需要注意的地方，</p><h2 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h2><p>他是站在電力相關的Android App的角度去審視如果利用MITM Based做到滲透測試要怎麼做，以及和傳統的方式相比可以減少多少時間、效率提升多少。但其實內文和電力幾乎一點關係也沒有，代換成其他的App也可以，如果我們要利用MITM Based做到Penetration Testing，就必須要手動克服中間會加密的問題，所以他就試圖提出一個==3-Layers Proxy Based==的東西(如下圖)
<img src=https://hackmd.io/_uploads/B1TUn8oGA.png alt=圖片>
從上圖可知，手機到Web Server中間總共有三層的Proxy，第一和第三層都是MITM Proxy，主要是負責訊息的加解密，而中間的那一層就可以很彈性的替換成各式各樣的自動化測試工具或腳本，例如Burp Suite或是SQLMAP之類的
:::info
這個架構會需要三層其實是因為他所測試的App，不只是傳輸的那一層會被SSL加密，而在傳送的封包body還會再加密一次，所以需要三層，不然照理來說，一層的MITM Proxy就可以解決SSL加解密的問題，不需要用到三層那麼多，而且也不需要深入探索他用的是哪一套加解密演算法，因為傳輸層的演算法都一樣才對，這是和學長討論出來的結果
:::</p><a href=/survey-papers/android-+-security/a-mitm-based-penetration-test-efficiency-improvement-approach-for-traffic-encrypted-mobile-apps-of-power-industry/>...</a></p></article><article class="markdown book-post"><h2><a href=/survey-papers/android-+-security/a-mitmproxy-based-dynamic-vulnerability-detection-system-for-android-applications/>A Mitmproxy-based Dynamic Vulnerability Detection System For Android Applications</a></h2><div class=text-small><a href=/tags/meeting-paper/>Meeting Paper</a>,
<a href=/tags/ntu/>NTU</a></div><p><h1 id=a-mitmproxy-based-dynamic-vulnerability-detection-system-for-android-applications>A Mitmproxy-based Dynamic Vulnerability Detection System For Android Applications
<a class=anchor href=#a-mitmproxy-based-dynamic-vulnerability-detection-system-for-android-applications>#</a></h1><p>:::info
Lv, X., Peng, T., Tang, J., He, R., Hu, X., Jiang, M., &mldr; & Cao, W. (2022, December). A Mitmproxy-based Dynamic Vulnerability Detection System For Android Applications. In 2022 18th International Conference on Mobility, Sensing and Networking (MSN) (pp. 408-416). IEEE.
:::
這一篇也和我想做的主題有一點關聯，他是利用MITMProxy-based達到偵測應用程式在做Hotfix時，有沒有Code Injection(dex injection)的問題。</p><h2 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h2><p>現在有很多的App都會實現Hotfix這項技術，也就是不斷電更新，傳統的App更新方式為廠商發佈新的版本後，使用者需要重新卸載再安裝新的版本，但現在有了Hotfix的技術，使用者在沒有感知的情況下就會自動完成更新，如下圖所述，當然在更新之前會進行驗證Hash、SSL憑證和簽章，但如果沒有簽章呢?是不是就可以被MITM篡改Hash和進行Code Injection，這一篇文章就是在自動化的檢測這件事情的可行性
<img src=https://hackmd.io/_uploads/SkTTS9hGA.png alt=圖片></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li>Hotfix的流程
按照論文中的說明，利用hotfix更新patch的方式當然不是直接從server傳過來到client端，而是會把dex file打包成.jar或是.zip的patch package，然後放在某個地方。從server那邊會送出一個json file，裡面有一個URL Key會紀錄這個打包好的patch package在哪裡，然後client端自行去下載會來進行patch</li><li>Android的簽章
在Android系統安全中有3個主要的技術: Permission Management, Signature Authentication, 以及Sandbox Mechanism，現在主要探討的問題就是在簽章的技術底下。Android的數位簽章總共會包含三個東西: MANIFEST.MF, CERT.SF, CERT.RSA<ul><li>MANIFEST.MF
是一個Digest File也就是存所有更新的打包檔案的Hash Value</li><li>CERT.SF
是一個Signature File，他會用SHA1計算MANIFEST.MF中的所有東西再用Base64進行Encode</li><li>CERT.RSA
存放Public Key+加密演算法是哪一個+用自己的Private Key加密CERT.SF中的所有東西的結果
綜上所述，如果一個廠商在進行Hotfix更新時，被MITM Hijack，那MANIFEST.MF和CERT.SF可以被換掉，但CERT.RSA這個檔案，因為沒有廠商的私鑰，故無法替換</li></ul></li></ul><h2 id=proposed-method>Proposed Method
<a class=anchor href=#proposed-method>#</a></h2><p><img src=https://hackmd.io/_uploads/B1Ti653GA.png alt=圖片></p><a href=/survey-papers/android-+-security/a-mitmproxy-based-dynamic-vulnerability-detection-system-for-android-applications/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-padns/ad-of-network-security---lab-12/>A&amp;D of Network Security - Lab 12</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/ntu_padns/>NTU_PADNS</a></div><p><h1 id=ad-of-network-security---lab-12>A&amp;D of Network Security - Lab 12
<a class=anchor href=#ad-of-network-security---lab-12>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=video>Video
<a class=anchor href=#video>#</a></h2><p><a href="https://files-1.dlc.ntu.edu.tw/cool-video/202305/c6cc49a9-e1f9-4a9e-a7dc-70c4f79c98b1/transcoded.mp4?AWSAccessKeyId=C6ueMrUe5JyPkWQJAyKp&amp;Expires=1684429335&amp;Signature=UQaLvueX0U%2Bvs65WhFgrks9vg%2Fc%3D">NTU PADNS Lecture 12</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/strcmp-wcscmp-mbscmp?view=msvc-170">What is _mbscmp?</a></p><pre tabindex=0><code class=language-clike! data-lang=clike!>int _mbscmp(
   const unsigned char *string1,
   const unsigned char *string2
);
</code></pre><p>Return Value</p><blockquote><p>&lt;0 string1 is less than string2
=0 string1 is identical to string2
>0 string1 is greater than string2</p></blockquote><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><h3 id=static---ida-pro>Static - IDA Pro
<a class=anchor href=#static---ida-pro>#</a></h3><p>:::spoiler Main Source Code</p><a href=/security/course/ntu-padns/ad-of-network-security---lab-12/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-padns/ad-of-network-security---lab-13/>A&amp;D of Network Security - Lab 13</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/ntu_padns/>NTU_PADNS</a></div><p><h1 id=ad-of-network-security---lab-13>A&amp;D of Network Security - Lab 13
<a class=anchor href=#ad-of-network-security---lab-13>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=metasploit-with-bluekeep-vulnerability-cve-2019-0708>Metasploit with Bluekeep Vulnerability (CVE-2019-0708)
<a class=anchor href=#metasploit-with-bluekeep-vulnerability-cve-2019-0708>#</a></h2><h3 id=setting-up-environment>Setting up environment
<a class=anchor href=#setting-up-environment>#</a></h3><ul><li><p>Open Windows 7 and Kali-Linux with <code>localhost only</code> mode
:::spoiler Screenshot
<img src=https://hackmd.io/_uploads/Skg3sJ93Hh.png alt></p><p><img src=https://hackmd.io/_uploads/ByyTJqnHh.png alt>
:::</p></li><li><p>Then we can note that the IP of these two machines are different:
:::spoiler Screenshot
<img src=https://hackmd.io/_uploads/H1gOg5hSn.png alt></p><p><img src=https://hackmd.io/_uploads/H1VSlcnB3.png alt>
:::
Now, we know <code>Win7</code>&rsquo;s IP: <code>192.168.56.101</code>
Kali-Linux&rsquo;s IP: <code>192.168.56.102</code></p><a href=/security/course/ntu-padns/ad-of-network-security---lab-13/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-padns/ad-of-network-security---lab-14/>A&amp;D of Network Security - Lab 14</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/ntu_padns/>NTU_PADNS</a></div><p><h1 id=ad-of-network-security---lab-14>A&amp;D of Network Security - Lab 14
<a class=anchor href=#ad-of-network-security---lab-14>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=video>Video
<a class=anchor href=#video>#</a></h2><p><a href="https://files-1.dlc.ntu.edu.tw/cool-video/202305/f4f0b276-7211-448a-812b-89b3d194ccde/transcoded.mp4?AWSAccessKeyId=C6ueMrUe5JyPkWQJAyKp&amp;Expires=1685444669&amp;Signature=XXKzQ0FHD31E%2FdKWhlcyX%2BcLQXg%3D">Class Description</a>
<a href="https://files-1.dlc.ntu.edu.tw/cool-video/202305/b494d4d3-0d67-4672-95ab-37a8c35b70b3/transcoded.mp4?AWSAccessKeyId=C6ueMrUe5JyPkWQJAyKp&amp;Expires=1685432006&amp;Signature=sJvf4b%2BWXnkZY3dCFmX4vHCcyy0%3D">Lab Implementation</a></p><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><ul><li>snort Rule
:::spoiler Rule Screenshot<ul><li>Format
<img src=https://hackmd.io/_uploads/S1pKEV7Ln.png alt></li><li>Action
<img src=https://hackmd.io/_uploads/HygsNEXI2.png alt></li><li>Option
<img src=https://hackmd.io/_uploads/By83VNQUh.png alt></li><li>Option - Payload
<img src=https://hackmd.io/_uploads/rJ6p44QI2.png alt>
:::</li></ul></li></ul><h2 id=lab>Lab
<a class=anchor href=#lab>#</a></h2><h3 id=lab-1-packet-sniffer-mode-show出-sniff-icmp封包的結果>Lab 1: Packet sniffer Mode show出 sniff ICMP封包的結果
<a class=anchor href=#lab-1-packet-sniffer-mode-show%e5%87%ba-sniff-icmp%e5%b0%81%e5%8c%85%e7%9a%84%e7%b5%90%e6%9e%9c>#</a></h3><p>Payload:</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ sudo snort -vd -i eth0 -q
</code></pre><p>:::spoiler Result Screenshot
<img src=https://hackmd.io/_uploads/BJVrHN78h.png alt>
:::</p><hr><h3 id=lab-2-attacker-ssh爆破攻擊利用-snort偵測攻擊行為是否發生show出偵測結果-並說明snort-rule>Lab 2: Attacker SSH爆破攻擊，利用 Snort偵測攻擊行為是否發生，show出偵測結果 ，並說明snort rule
<a class=anchor href=#lab-2-attacker-ssh%e7%88%86%e7%a0%b4%e6%94%bb%e6%93%8a%e5%88%a9%e7%94%a8-snort%e5%81%b5%e6%b8%ac%e6%94%bb%e6%93%8a%e8%a1%8c%e7%82%ba%e6%98%af%e5%90%a6%e7%99%bc%e7%94%9fshow%e5%87%ba%e5%81%b5%e6%b8%ac%e7%b5%90%e6%9e%9c-%e4%b8%a6%e8%aa%aa%e6%98%8esnort-rule>#</a></h3><h4 id=threat-model>Threat Model
<a class=anchor href=#threat-model>#</a></h4><p><img src=https://hackmd.io/_uploads/SkDltNQU3.png alt></p><a href=/security/course/ntu-padns/ad-of-network-security---lab-14/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-padns/ad-of-network-security---lab-2/>A&amp;D of Network Security - Lab 2</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/ntu_padns/>NTU_PADNS</a></div><p><h1 id=ad-of-network-security---lab-2>A&amp;D of Network Security - Lab 2
<a class=anchor href=#ad-of-network-security---lab-2>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=lab-cheat-sheetcisco-packet-tracer>Lab Cheat Sheet(Cisco Packet Tracer)
<a class=anchor href=#lab-cheat-sheetcisco-packet-tracer>#</a></h2><h3 id=setting-vlan>Setting VLAN
<a class=anchor href=#setting-vlan>#</a></h3><p>:::spoiler Switch</p><pre tabindex=0><code class=language-bash! data-lang=bash!>Switch&gt;enable
Switch#configure 
Configuring from terminal, memory, or network [terminal]? 
Enter configuration commands, one per line.  End with CNTL/Z.
Switch(config)#vlan 10
Switch(config-vlan)#name green
Switch(config-vlan)#vlan 20
Switch(config-vlan)#name yellow
Switch(config-vlan)#
Switch#
%SYS-5-CONFIG_I: Configured from console by console

Switch#show vlan

VLAN Name                             Status    Ports
---- -------------------------------- --------- -------------------------------
1    default                          active    Fa0/5, Fa0/6, Fa0/7, Fa0/8
                                                Fa0/9, Fa0/10, Fa0/11, Fa0/12
                                                Fa0/13, Fa0/14, Fa0/15, Fa0/16
                                                Fa0/17, Fa0/18, Fa0/19, Fa0/20
                                                Fa0/21, Fa0/22, Fa0/23, Fa0/24
                                                Gig0/1, Gig0/2
10   green                            active
20   yellow                           active
...
</code></pre><p>:::
:::spoiler Switch相對應的Interface</p><a href=/security/course/ntu-padns/ad-of-network-security---lab-2/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-padns/ad-of-network-security---lab-3/>A&amp;D of Network Security - Lab 3</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/ntu_padns/>NTU_PADNS</a></div><p><h1 id=ad-of-network-security---lab-3>A&amp;D of Network Security - Lab 3
<a class=anchor href=#ad-of-network-security---lab-3>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Network setting type in virtual box
<img src=https://i.imgur.com/g2J83Xg.png alt></p><h2 id=ping-two-machine-in-internal-mode>Ping two machine in internal mode
<a class=anchor href=#ping-two-machine-in-internal-mode>#</a></h2><p>:::spoiler Detailed Process</p><ol><li><p>Clone another VM
<img src=https://i.imgur.com/vsI7lWa.png alt></p></li><li><p>Setting Network Configuration
<img src=https://i.imgur.com/OqZ9Owm.png alt>
Setting 2 VMs&rsquo; network config as above.
<strong>Note that</strong>, must check MAC address is different, promiscuous mode is <code>Allow All</code> and the adapter is the same.</p><a href=/security/course/ntu-padns/ad-of-network-security---lab-3/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-padns/ad-of-network-security---lab-4arp--dns-spoofing/>A&amp;D of Network Security - Lab 4(ARP & DNS SPOOFING)</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/ntu_padns/>NTU_PADNS</a></div><p><h1 id=ad-of-network-security---lab-4arp--dns-spoofing>A&amp;D of Network Security - Lab 4(ARP & DNS SPOOFING)
<a class=anchor href=#ad-of-network-security---lab-4arp--dns-spoofing>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href="https://youtu.be/ha4w30V2cLM?si=eK2wwkqROck5n3SY&amp;t=4497">ARP Spoofing at <code>1:15:00</code></a></p><h2 id=arp-spoofing>ARP SPOOFING
<a class=anchor href=#arp-spoofing>#</a></h2><ol><li><p>Setting 2 VMs&rsquo; network interface as Bridged adapter
:::danger
You supposed to use your own network instead of public network
:::</p></li><li><p>Checking IP
<img src=https://i.imgur.com/V1CTmtr.png alt></p><p><img src=https://i.imgur.com/i6RUqmM.png alt>
And check the victim gateway by <code>nmap</code></p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ sudo nmap -sP 192.168.43.0/24
Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-19 10:46 EDT
Nmap scan report for DESKTOP-D0UCTM3 (192.168.43.56)
Host is up (0.00020s latency).
MAC Address: 68:54:5A:DC:03:57 (Intel Corporate)
Nmap scan report for 192.168.43.66
Host is up (0.010s latency).
MAC Address: D4:38:9C:87:2F:C6 (Sony)
Nmap scan report for kali (192.168.43.222)
Host is up (0.00040s latency).
MAC Address: 08:00:27:B1:9D:67 (Oracle VirtualBox virtual NIC)
Nmap scan report for 192.168.43.78
Host is up.
Nmap done: 256 IP addresses (4 hosts up) scanned in 6.13 seconds
</code></pre><p>:::info
Victim VM $\to$ <code>192.168.43.222</code> / MAC $\to$ <code>08:00:27:F7:12:7A</code>
Attacker VM $\to$ <code>192.168.43.78</code> / MAC $\to$ <code>08:00:27:B1:9D:67</code>
Default Gateway $\to$ <code>192.168.43.66</code>
:::</p><a href=/security/course/ntu-padns/ad-of-network-security---lab-4arp--dns-spoofing/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-padns/ad-of-network-security---lab-7/>A&amp;D of Network Security - Lab 7</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/ntu_padns/>NTU_PADNS</a></div><p><h1 id=ad-of-network-security---lab-7>A&amp;D of Network Security - Lab 7
<a class=anchor href=#ad-of-network-security---lab-7>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://darkranger.no-ip.org/archives/v5/document/linux/foremost_recovery.htm>What is foremost and How to use it?</a></p><h2 id=rsa-ctf>RSA CTF
<a class=anchor href=#rsa-ctf>#</a></h2><h3 id=exercise---rsa>Exercise - RSA
<a class=anchor href=#exercise---rsa>#</a></h3><p>Given</p><pre tabindex=0><code>p =  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483
q =  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407
e =  65537
c =  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034
</code></pre><p>Then I can use decrypt function to fetch plaintext.
Flag(hex): <code>12058e43d9e0c22559c19774</code>
:::spoiler source code</p><pre tabindex=0><code class=language-python! data-lang=python!>from Crypto.Util.number import long_to_bytes, inverse, bytes_to_long

p =  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483
q =  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407
e =  65537
c =  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034

n = p * q
phi = (q-1)*(p-1)
d = inverse(e, phi)
print(long_to_bytes(pow(c,d,n)).hex())
</code></pre><p>:::</p><a href=/security/course/ntu-padns/ad-of-network-security---lab-7/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/course/ntu-padns/ad-of-network-security-note/>A&amp;D of Network Security Note</a></h2><div class=text-small><a href=/tags/ntu/>NTU</a>,
<a href=/tags/ntu_padns/>NTU_PADNS</a></div><p><h1 id=ad-of-network-security-note>A&amp;D of Network Security Note
<a class=anchor href=#ad-of-network-security-note>#</a></h1><h6 id=tags-practicum-of-ad-of-ns-ntu>tags: <code>Practicum of A&amp;D of NS</code> <code>NTU</code>
<a class=anchor href=#tags-practicum-of-ad-of-ns-ntu>#</a></h6><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>:::spoiler <a href="http://www.ess.nthu.edu.tw/p/16-1351-74716.php?Lang=zh-tw">IP / 遮罩 / 閘道 三者的關係</a></p><blockquote><p>用日常生活中的例子來比喻，IP 就好比在社區中的門牌地址，如果是要找同社區(一樣遮罩範圍的)，就只要透過社區廣播喊一聲。如果找不到人，表示在社區外，就要出社區大門(閘道)去外面問</p><p>所以遮罩設定錯誤，代表硬把兩個不同社區的給劃在一起，但是實際上遞送封包就會找不到 (明明住光復國宅結果你跟郵差說光復國宅跟孟竹國宅都在一區)</p><p>閘道設定錯誤則是連大門都搞錯了，這樣蓮社區都出不去，自然網路也無法連線
:::</p></blockquote><p>:::spoiler <a href=https://blog.downager.com/2013/07/03/%E7%B6%B2%E8%B7%AF-%E6%B7%BA%E8%AB%87-ARP-Address-Resolution-Protocol-%E9%81%8B%E4%BD%9C%E5%8E%9F%E7%90%86/>[網路] 淺談 ARP (Address Resolution Protocol) 運作原理</a></p><blockquote><p>在乙太網路上，資料的傳遞必須要有實體位址 (MAC Address)，Layer 2 設備會驗證 Frame 的實體位址，不是找它的一律捨棄，但設備一開機總不可能就有所有設備的實體位址吧？所以就需要 ARP 協定來協助取得各個設備的實體位址</p><p>ARP 是利用乙太網路的廣播功能所設計出來的位址解析協定，它的主要特性是它的位址對應關係是動態的，以查詢的方式來獲得 I P位址 (IP Address) 和實體位址 (MAC Address / Physical Address) 的對應關係。</p><p>只要是 Layer 3 的設備都一定會有 ARP Cache，並且會在 ARP 快取內建立 ARP 表格 (ARP Table) 用來記錄 IP 位址和實體位址的對應關係。這個 Table 會依據自身的存活時間遞減而消失，以確保資料的正確性。
<img src=https://i.imgur.com/Vg2RZHd.png alt></p><a href=/security/course/ntu-padns/ad-of-network-security-note/>...</a></p></article><ul class="pagination pagination-default"><li class="page-item disabled"><a aria-disabled=true aria-label=First class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Previous class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a aria-current=page aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/tags/ntu/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/tags/ntu/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/tags/ntu/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/tags/ntu/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/tags/ntu/page/2/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/tags/ntu/page/7/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>