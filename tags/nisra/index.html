<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/nisra/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="NISRA"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>NISRA | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/nisra/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/nisra/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>NISRA</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/practice/nisra/misc/nisra---%E7%9C%8B%E4%B8%8D%E8%A6%8B%E7%9A%84%E5%9C%B0%E6%96%B9/>Background</a></h2><div class=text-small><a href=/tags/nisra/>NISRA</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=nisra---看不見的地方>NISRA - 看不見的地方
<a class=anchor href=#nisra---%e7%9c%8b%e4%b8%8d%e8%a6%8b%e7%9a%84%e5%9c%b0%e6%96%b9>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=/uwox6r5hQ6St_8G-4mv1_g>advanced-potion-making:two::+1:</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這題出的不錯，我用了所有方法都沒看到甚麼奇怪的東西，除了pngcheck</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ pngcheck flag.png
flag.png  CRC error in chunk IHDR (computed 68ff0ded, expected 8c5880da)
ERROR: flag.png 
</code></pre><p>代表檔案可能有一些問題
原圖：
<img src=https://hackmd.io/_uploads/SkwQ2IPu3.png alt></p><h2 id=exploit---recover-png-file>Exploit - Recover PNG File
<a class=anchor href=#exploit---recover-png-file>#</a></h2><ol><li><p>參考<a href=https://zhuanlan.zhihu.com/p/599657891>UP主的腳本</a>，可以直接寫出長寬</p><pre tabindex=0><code class=language-python! data-lang=python!>import zlib
import struct
import sys

filename = sys.argv[1]
with open(filename, &#39;rb&#39;) as f:
    all_b = f.read()
    crc32key = int(all_b[29:33].hex(),16)
    data = bytearray(all_b[12:29])
    n = 4095
    for w in range(n): 
        width = bytearray(struct.pack(&#39;&gt;i&#39;, w))
        for h in range(n):
            height = bytearray(struct.pack(&#39;&gt;i&#39;, h))
            for x in range(4):
                data[x+4] = width[x]
                data[x+8] = height[x]
            crc32result = zlib.crc32(data)
            if crc32result == crc32key:
                print(&#34;寬為：{}(hex), {}(int)&#34;.format(width.hex(), int(width.hex(), 16)))
                print(&#34;高為：{}(hex), {}(int)&#34;.format(height.hex(), int(height.hex(), 16)))
                exit(0)
</code></pre><pre tabindex=0><code class=language-bash! data-lang=bash!>$ python exp.py flag.png
寬為：00000258(hex), 600(int)
高為：00000148(hex), 328(int)
</code></pre><p><img src=https://hackmd.io/_uploads/rkLuiLwuh.png alt>
可以看得出來高的數值不一樣</p><a href=/security/practice/nisra/misc/nisra---%E7%9C%8B%E4%B8%8D%E8%A6%8B%E7%9A%84%E5%9C%B0%E6%96%B9/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/nisra/web/nisra---different-places/>NISRA - different places</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a>,
<a href=/tags/nisra/>NISRA</a>,
<a href=/tags/book/>Book</a></div><p><h1 id=nisra---different-places>NISRA - different places
<a class=anchor href=#nisra---different-places>#</a></h1><h6 id=tags-nisra-ctf-web>tags: <code>NISRA</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-nisra-ctf-web>#</a></h6><p>Challenge: <a href=http://chall2.nisra.net:41025/>different places</a></p><h2 id=exploit---integrate-fragments-flags>Exploit - Integrate Fragments Flags
<a class=anchor href=#exploit---integrate-fragments-flags>#</a></h2><ol><li><p>View Page Sources
<img src=https://i.imgur.com/q3tSKo5.png alt>
<img src=https://i.imgur.com/yrKjnyr.png alt></p></li><li><p>base64 decode
<code>dXNlcm5hbWU6YWRtaW5fcGFzc3dvcmQ6bmlzcmE=</code> $\to$ <code>username:admin_password:nisra</code></p></li><li><p>Observe the form
It uses get method to fetch the parameters. So we can peek <code>login.php</code> first.
<img src=https://i.imgur.com/oGFwOoA.png alt>
Then we could use the username and password we got at previous step.
Payload: <code>view-source:http://chall2.nisra.net:41025/login.php?username=admin&amp;password=nisra</code>
Then we got the last fragment flag.</p><a href=/security/practice/nisra/web/nisra---different-places/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/nisra/misc/nisra---hidden_/>NISRA - Hidden?</a></h2><div class=text-small><a href=/tags/nisra/>NISRA</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=nisra---hidden>NISRA - Hidden?
<a class=anchor href=#nisra---hidden>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=/uwox6r5hQ6St_8G-4mv1_g>advanced-potion-making:two::+1:</a></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題也是蠻巧妙的，用pngcheck可以看到檔案有問題</p><pre tabindex=0><code class=language-bash! data-lang=bash!>$ pngcheck haha.png
haha.png  additional data after IEND chunk
ERROR: haha.png
</code></pre><h2 id=exploit---recover--unzip>Exploit - Recover + Unzip
<a class=anchor href=#exploit---recover--unzip>#</a></h2><ol><li><p>Recover PNG File
先找文件尾（00 00 00 00 49 45 4E 44 AE 42 60 82）
<img src=https://hackmd.io/_uploads/SySm_6DO3.png alt>
發現後續還有其他bytes，用<a href=https://en.wikipedia.org/wiki/List_of_file_signatures>list signature</a>追查後面是甚麼，<img src=https://hackmd.io/_uploads/Hy-5OpPOh.png alt>
發現應該是個zip file，所以獨立出來後解壓縮</p></li><li><p>Unzip
解壓縮後有一些文件，從裡面撈了一下flag就在./word/document.xml中
Flag: <code>NISRA{Oop5!_yoU_fOuNd_1t}</code></p></li></ol><p><img src=https://hackmd.io/_uploads/BkLoDTwO3.png alt></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/nisra/web/nisra---md5_1/>NISRA - MD5_1</a></h2><div class=text-small><a href=/tags/nisra/>NISRA</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=nisra---md5_1>NISRA - MD5_1
<a class=anchor href=#nisra---md5_1>#</a></h1><h6 id=tags-nisra-ctf-web>tags: <code>NISRA</code> <code>CTF</code> <code>Web</code>
<a class=anchor href=#tags-nisra-ctf-web>#</a></h6><p>Challenge: <a href=http://chall2.nisra.net:41022/>MD5_1</a></p><h2 id=source-code>Source code
<a class=anchor href=#source-code>#</a></h2><pre tabindex=0><code class="language-php=" data-lang="php="> &lt;?php
    highlight_file(__FILE__);
    $FROM_INCLUDE = true;
    include(&#34;flag.php&#34;);
    $msg = &#34;&#34;;
    if (isset($_GET[&#39;user&#39;]) &amp;&amp; isset($_GET[&#39;password&#39;])) {
        $user = $_GET[&#39;user&#39;];
        $password = $_GET[&#39;password&#39;];
        $check = &#34;QNKCDZO&#34;;
        // the md5 of &#34;QNKCDZO&#34; is 0e830400451993494058024219903391

        if ($user == &#34;admin&#34; &amp;&amp; $password != $check &amp;&amp; md5($password) == md5($check)) {
            $msg = &#34;Flag: &#34;.$flag;
        } else {
            $msg = &#34;Keep trying!&#34;;
        }
    }

    echo $msg;
?&gt; 
</code></pre><h2 id=exploit---md5-collision>Exploit - MD5 Collision
<a class=anchor href=#exploit---md5-collision>#</a></h2><p>Payload: <code>http://chall2.nisra.net:41022/?user=admin&amp;password=240610708</code>
:::spoiler flag
<code>Flag: NISRA{PhP_is_th3_BeST_laNgUA9E}</code>
:::</p><a href=/security/practice/nisra/web/nisra---md5_1/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/nisra/web/nisra---md5_2/>NISRA - MD5_2</a></h2><div class=text-small><a href=/tags/nisra/>NISRA</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/web/>Web</a></div><p><h1 id=nisra---md5_2>NISRA - MD5_2
<a class=anchor href=#nisra---md5_2>#</a></h1><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><p>Payload: <code>curl http://chall2.nisra.net:41023/ -H "Content-Type: application/x-www-form-urlencoded" -X POST -d "user=240610708&amp;password=QNKCDZO"</code>
Flag: <code>NISRA{S3CuR17y_1ssuEs_Of_pHP_@ND_Md5}</code></p><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href="https://news.ycombinator.com/item?id=9484757">md5(&lsquo;240610708&rsquo;) == md5(&lsquo;QNKCDZO&rsquo;)</a></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/nisra/misc/nisra-2023-enlightened---jack%E7%9A%84flag/>NISRA 2023 Enlightened - Jack的flag</a></h2><div class=text-small><a href=/tags/nisra/>NISRA</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=nisra-2023-enlightened---jack的flag>NISRA 2023 Enlightened - Jack的flag
<a class=anchor href=#nisra-2023-enlightened---jack%e7%9a%84flag>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>Microsoft Word Forensics</p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這是第一次寫到有關word的隱寫，蠻特別的就紀錄一下，但看得出來應該是考古古古古古古題了ㄅ</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><p>有兩種方法</p><ol><li>強制解壓縮
直接把副檔名改成.zip，然後用解壓縮軟體解壓縮，接著就可以在<code>Final-Jack\word\document.xml</code>中可以找到flag</li><li>把隱藏設定打開
直接在word中的<code>檔案/選項/顯示/隱藏文字</code>的方塊打勾，就可以直接在下面看到flag了</li></ol><p>Flag: <code>NISRA{Word'$_h1Dden_7eXT_reVEaLed}</code></p></p></article><article class="markdown book-post"><h2><a href=/security/practice/nisra/misc/nisra-2023-enlightened---magic-function/>NISRA 2023 Enlightened - Magic Function</a></h2><div class=text-small><a href=/tags/nisra/>NISRA</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=nisra-2023-enlightened---magic-function>NISRA 2023 Enlightened - Magic Function
<a class=anchor href=#nisra-2023-enlightened---magic-function>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p><a href=https://hacktricks.boitatech.com.br/misc/basic-python/magic-methods>Magic Function of Python</a></p><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><pre tabindex=0><code class="language-python=" data-lang="python=">class Test():
	def __init__(self, email=&#39;test@nisra.net&#39;):
		self.info = &#39;test&#39;
		self.email = email

class Secret():
	flag = open(&#34;./NISRA-Enlightened-2023/flag.txt&#34;, &#34;r&#34;).read().strip()


if __name__ == &#39;__main__&#39;:
	email = input(&#39;Your email: &#39;)

	if email:
		test = Test(email)
	else:
		test = Test()

	msg = (&#39;this is for {test.info}, please contact &#39; + email + &#39;.&#39;).format(test=test)

	print(msg)
</code></pre><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題真的很有趣，但也是算通靈的奇淫怪招，仔細看了一下直覺應該是跟format string有關係，比賽的時候的確有想到，但我當時想的payload有點偏掉了，當時的payload是: <code>{test.email}.format(test=Test(Secret().flag))</code>，也就是先傳入Secret().flag給Test這個class，然後再利用format傳入給</p><a href=/security/practice/nisra/misc/nisra-2023-enlightened---magic-function/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/practice/nisra/misc/nisra-2023-enlightened---pixel/>NISRA 2023 Enlightened - Pixel</a></h2><div class=text-small><a href=/tags/nisra/>NISRA</a>,
<a href=/tags/ctf/>CTF</a>,
<a href=/tags/misc/>Misc</a></div><p><h1 id=nisra-2023-enlightened---pixel>NISRA 2023 Enlightened - Pixel
<a class=anchor href=#nisra-2023-enlightened---pixel>#</a></h1><h2 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h2><p><img src=https://hackmd.io/_uploads/HkF8f_702.png alt></p><h2 id=recon>Recon
<a class=anchor href=#recon>#</a></h2><p>這一題真的很難，應該說有想過，不過很麻煩就是了，每一個色塊都有一組RGB的數值，然後只要把它轉換成ASCII，再把每一個字元串起來，就會是一組base64的code，轉換之後就拿到一組ciphertext，接著就丟到cyberchef看看一般的工具可不可以解，最後是用rot13解出來，除了最一開始的地方需要一點通靈之外，其他都很簡單，但&mldr;寫script頗麻煩</p><h2 id=exploit>Exploit
<a class=anchor href=#exploit>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> PIL <span style=color:#f92672>import</span> Image
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64decode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>img <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span>open(<span style=color:#e6db74>&#34;./NISRA-Enlightened-2023/Misc/Final-Pixel.png&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pixels <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>8</span>):	<span style=color:#75715e># 8 rows</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>8</span>):	<span style=color:#75715e># 8 columns</span>
</span></span><span style=display:flex><span>		r, g, b <span style=color:#f92672>=</span> img<span style=color:#f92672>.</span>getpixel((row <span style=color:#f92672>*</span> <span style=color:#ae81ff>64</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, col <span style=color:#f92672>*</span> <span style=color:#ae81ff>64</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>))	<span style=color:#75715e># each grid: 64 x 64</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> r <span style=color:#f92672>==</span> <span style=color:#ae81ff>255</span> <span style=color:#f92672>and</span> g <span style=color:#f92672>==</span> <span style=color:#ae81ff>255</span> <span style=color:#f92672>and</span> b <span style=color:#f92672>==</span> <span style=color:#ae81ff>255</span>:
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>			pixels<span style=color:#f92672>.</span>append((chr(r), chr(g), chr(b)))
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> r <span style=color:#f92672>==</span> <span style=color:#ae81ff>255</span> <span style=color:#f92672>and</span> g <span style=color:#f92672>==</span> <span style=color:#ae81ff>255</span> <span style=color:#f92672>and</span> b <span style=color:#f92672>==</span> <span style=color:#ae81ff>255</span>:
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>print(pixels)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> r, g, b <span style=color:#f92672>in</span> pixels:
</span></span><span style=display:flex><span>	flag <span style=color:#f92672>+=</span> r <span style=color:#f92672>+</span> g <span style=color:#f92672>+</span> b
</span></span><span style=display:flex><span>print(flag)
</span></span><span style=display:flex><span>print(b64decode(flag<span style=color:#f92672>.</span>encode()))
</span></span></code></pre></div><pre tabindex=0><code class=language-bash! data-lang=bash!>$ python exp.py
[(&#39;c&#39;, &#39;3&#39;, &#39;l&#39;), (&#39;u&#39;, &#39;d&#39;, &#39;D&#39;), (&#39;o&#39;, &#39;g&#39;, &#39;Q&#39;), (&#39;V&#39;, &#39;Z&#39;, &#39;G&#39;), (&#39;R&#39;, &#39;U&#39;, &#39;5&#39;), (&#39;7&#39;, &#39;T&#39;, &#39;l&#39;), (&#39;9&#39;, &#39;l&#39;, &#39;T&#39;), (&#39;m&#39;, &#39;Y&#39;, &#39;3&#39;), (&#39;U&#39;, &#39;k&#39;, &#39;V&#39;), (&#39;f&#39;, &#39;N&#39;, &#39;k&#39;), (&#39;U&#39;, &#39;0&#39;, &#39;Q&#39;), (&#39;1&#39;, &#39;U&#39;, &#39;x&#39;), (&#39;U&#39;, &#39;F&#39;, &#39;9&#39;), (&#39;l&#39;, &#39;U&#39;, &#39;m&#39;), (&#39;N&#39;, &#39;F&#39;, &#39;U&#39;), (&#39;m&#39;, &#39;Z&#39;, &#39;S&#39;), (&#39;Q&#39;, &#39;W&#39;, &#39;c&#39;), (&#39;k&#39;, &#39;X&#39;, &#39;0&#39;), (&#39;5&#39;, &#39;f&#39;, &#39;R&#39;), (&#39;2&#39;, &#39;o&#39;, &#39;w&#39;), (&#39;L&#39;, &#39;V&#39;, &#39;E&#39;), (&#39;x&#39;, &#39;W&#39;, &#39;j&#39;), (&#39;N&#39;, &#39;h&#39;, &#39;Z&#39;), (&#39;j&#39;, &#39;E&#39;, &#39;w&#39;), (&#39;Y&#39;, &#39;T&#39;, &#39;Q&#39;), (&#39;x&#39;, &#39;X&#39;, &#39;2&#39;), (&#39;N&#39;, &#39;2&#39;, &#39;c&#39;), (&#39;G&#39;, &#39;d&#39;, &#39;o&#39;), (&#39;R&#39;, &#39;X&#39;, &#39;J&#39;), (&#39;f&#39;, &#39;T&#39;, &#39;m&#39;), (&#39;Z&#39;, &#39;f&#39;, &#39;N&#39;), (&#39;F&#39;, &#39;9&#39;, &#39;l&#39;), (&#39;U&#39;, &#39;n&#39;, &#39;B&#39;), (&#39;H&#39;, &#39;b&#39;, &#39;m&#39;), (&#39;E&#39;, &#39;2&#39;, &#39;S&#39;), (&#39;D&#39;, &#39;F&#39;, &#39;O&#39;), (&#39;R&#39;, &#39;V&#39;, &#39;9&#39;), (&#39;a&#39;, &#39;b&#39;, &#39;j&#39;), (&#39;d&#39;, &#39;l&#39;, &#39;d&#39;), (&#39;m&#39;, &#39;t&#39;, &#39;f&#39;), (&#39;Y&#39;, &#39;m&#39;, &#39;V&#39;), (&#39;f&#39;, &#39;d&#39;, &#39;G&#39;), (&#39;V&#39;, &#39;W&#39;, &#39;c&#39;), (&#39;V&#39;, &#39;9&#39;, &#39;i&#39;), (&#39;U&#39;, &#39;1&#39;, &#39;9&#39;), (&#39;G&#39;, &#39;Z&#39;, &#39;E&#39;), (&#39;h&#39;, &#39;A&#39;, &#39;Z&#39;), (&#39;V&#39;, &#39;J&#39;, &#39;f&#39;), (&#39;Q&#39;, &#39;1&#39;, &#39;Z&#39;), (&#39;L&#39;, &#39;c&#39;, &#39;n&#39;), (&#39;l&#39;, &#39;m&#39;, &#39;f&#39;), (&#39;Q&#39;, &#39;=&#39;, &#39;=&#39;)]
c3ludDogQVZGRU57Tl9lTmY3UkVfNkU0Q1UxUF9lUmNFUmZSQWckX05fR2owLVExWjNhZjEwYTQxX2N2cGdoRXJfTmZfNF9lUnBHbmE2SDFORV9abjdldmtfYmVfdGVWcV9iU19GZEhAZVJfQ1ZLcnlmfQ==
b&#39;synt: AVFEN{N_eNf7RE_6E4CU1P_eRcERfRAg$_N_Gj0-Q1Z3af10a41_cvpghEr_Nf_4_eRpGna6H1NE_Zn7evk_be_teVq_bS_FdH@eR_CVKryf}&#39;
</code></pre><p>Flag: <code>NISRA{A_rAs7ER_6R4PH1C_rEpREsENt$_A_Tw0-D1M3ns10n41_pictuRe_As_4_rEcTan6U1AR_Ma7rix_or_grId_oF_SqU@rE_PIXels}</code></p><a href=/security/practice/nisra/misc/nisra-2023-enlightened---pixel/>...</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>