<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  side_project_weibo_hot
  #


  tags: Side Project Browser Automation Selenium
  #

:::spoiler
[TOC]
:::

  Side Project Background
  #


Inspired by Bilingual Podcast is the best podcast channel in Taiwan that introduces interesting news happening around the world. They said they had a problem that they can not get the hot news from Weibo immediately before Xi made it disappear. For instance, Shuai Peng(彭帥) and Zhang Gaoli(張高麗) event. So, I wrote a side project about an automatic web system that can refresh the web page and download it automatically and keep the data safe.


  Installation
  #

pip install pyautogui
pip install selenium

  Some Set-Up
  #


Make sure your web driver is the latest version. You can download it here(https://chromedriver.chromium.org/)
Make sure your desktop is the idle one in your home that you&rsquo;ll not use it for a while.
Make sure your desktop language keyboard is for English.


  Something can solve in the future
  #



The content data you download may not be the same as the latest because I just verify the hot news title before downloading.(Solved, I refresh the news_list.txt every day and then the page with the same title will download again.)"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://bernie6401.github.io/side-project/side_project_weibo_hot/"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="side_project_weibo_hot"><meta property="og:description" content="side_project_weibo_hot # tags: Side Project Browser Automation Selenium # :::spoiler [TOC] :::
Side Project Background # Inspired by Bilingual Podcast is the best podcast channel in Taiwan that introduces interesting news happening around the world. They said they had a problem that they can not get the hot news from Weibo immediately before Xi made it disappear. For instance, Shuai Peng(彭帥) and Zhang Gaoli(張高麗) event. So, I wrote a side project about an automatic web system that can refresh the web page and download it automatically and keep the data safe. Installation # pip install pyautogui pip install selenium Some Set-Up # Make sure your web driver is the latest version. You can download it here(https://chromedriver.chromium.org/) Make sure your desktop is the idle one in your home that you’ll not use it for a while. Make sure your desktop language keyboard is for English. Something can solve in the future # The content data you download may not be the same as the latest because I just verify the hot news title before downloading.(Solved, I refresh the news_list.txt every day and then the page with the same title will download again.)"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="side-project"><meta property="article:tag" content="Side Project"><title>side_project_weibo_hot | SBK Hugo Site</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://bernie6401.github.io/side-project/side_project_weibo_hot/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.acdc41c8d39e6c69d70d8a23779875e0a3733fefead3e428d5344966bb12f562.js integrity="sha256-rNxByNOebGnXDYojd5h14KNzP+/q0+Qo1TRJZrsS9WI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>SBK Hugo Site</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>side_project_weibo_hot</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#side-project-background>Side Project Background</a></li><li><a href=#installation>Installation</a></li><li><a href=#some-set-up>Some Set-Up</a></li><li><a href=#something-can-solve-in-the-future>Something can solve in the future</a></li><li><a href=#update>Update</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=side_project_weibo_hot>side_project_weibo_hot
<a class=anchor href=#side_project_weibo_hot>#</a></h1><h6 id=tags-side-project-browser-automation-selenium>tags: <code>Side Project</code> <code>Browser Automation</code> <code>Selenium</code>
<a class=anchor href=#tags-side-project-browser-automation-selenium>#</a></h6><p>:::spoiler
[TOC]
:::</p><h2 id=side-project-background>Side Project Background
<a class=anchor href=#side-project-background>#</a></h2><ul><li>Inspired by Bilingual Podcast is the best podcast channel in Taiwan that introduces interesting news happening around the world. They said they had a problem that they can not get the hot news from Weibo immediately before Xi made it disappear. For instance, Shuai Peng(彭帥) and Zhang Gaoli(張高麗) event. So, I wrote a side project about an automatic web system that can refresh the web page and download it automatically and keep the data safe.</li></ul><h2 id=installation>Installation
<a class=anchor href=#installation>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install pyautogui
</span></span><span style=display:flex><span>pip install selenium
</span></span></code></pre></div><h2 id=some-set-up>Some Set-Up
<a class=anchor href=#some-set-up>#</a></h2><ol><li>Make sure your web driver is the latest version. You can download it here(<a href=https://chromedriver.chromium.org/>https://chromedriver.chromium.org/</a>)</li><li>Make sure your desktop is the idle one in your home that you&rsquo;ll not use it for a while.</li><li>Make sure your desktop language keyboard is for English.</li></ol><h2 id=something-can-solve-in-the-future>Something can solve in the future
<a class=anchor href=#something-can-solve-in-the-future>#</a></h2><ul><li><p>The content data you download may not be the same as the latest because I just verify the hot news title before downloading.(Solved, I refresh the news_list.txt every day and then the page with the same title will download again.)</p></li><li><p>Maybe someone can write about the login part that not only needs account and password but the id verification. This is very hard to solve in this system.</p></li><li><p>(Solved)Someone can use a more efficient searching Algorithm instead of linear searching and clean up the news list in the file to speed up the searching time. For instance, clean up all titles saved a week ago and always make the list lighter. I used the method that I mentioned above that cleans up the news_list.txt every day and that&rsquo;ll make the searching time more efficient.</p></li><li><p>(Solved)When you refresh the page many times, the server will reject the request from your desktop. So I add a file named run.py to solve this problem that used subprocess function independently in a while loop. That can lead the web to close completely and reboot again and again.</p></li><li><p>The web driver will shut down when the times up. But that will make the downloading file be aborted. So, maybe someone can add a function to detect whether the download process succeed or not.</p></li><li><p>To be continued&mldr;</p></li></ul><h2 id=update>Update
<a class=anchor href=#update>#</a></h2><ul><li>Time: 2022-11-29<ul><li><p>In addition to update chrome driver, I also tried to run the whole program but not work because of the <strong>wrong redirection</strong> of weibo webpage.
The page I expected is shown as below.<img src=https://imgur.com/G6p2qEu.png alt="weibo page I expect">
But actually, drive got the page as below →
<img src=https://imgur.com/phlJ6Ov.png alt="actual page it shown">
In order to execute my program with slightly revise, I add these line to login. Refer to <a href=https://blog.51cto.com/u_9177933/2985943>使用Selenium实现微博爬虫：预登录、展开全文、翻页</a></p><pre tabindex=0><code class="language-python=59" data-lang="python=59">wait = WebDriverWait(driver,5)
time.sleep(60)
</code></pre><p>:writing_hand:<strong>Notes</strong> This program became a semi-automatic features.</p></li><li><p>Becasue chrome driver halt with the message <code>Chrome is being controlled by automated test software</code>, I refer to (自動化初步-使用pyautogui)[https://ithelp.ithome.com.tw/articles/10267172] and set the code below to solve this problem.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>options <span style=color:#f92672>=</span> webdriver<span style=color:#f92672>.</span>ChromeOptions()
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span>add_experimental_option(<span style=color:#e6db74>&#34;excludeSwitches&#34;</span>, [<span style=color:#e6db74>&#34;enable-automation&#34;</span>])
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span>add_experimental_option(<span style=color:#e6db74>&#39;useAutomationExtension&#39;</span>, <span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span>add_experimental_option(<span style=color:#e6db74>&#34;prefs&#34;</span>, {<span style=color:#e6db74>&#34;profile.password_manager_enabled&#34;</span>: <span style=color:#66d9ef>False</span>, <span style=color:#e6db74>&#34;credentials_enable_service&#34;</span>: <span style=color:#66d9ef>False</span>})
</span></span></code></pre></div></li></ul></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#side-project-background>Side Project Background</a></li><li><a href=#installation>Installation</a></li><li><a href=#some-set-up>Some Set-Up</a></li><li><a href=#something-can-solve-in-the-future>Something can solve in the future</a></li><li><a href=#update>Update</a></li></ul></nav></div></aside></main></body></html>