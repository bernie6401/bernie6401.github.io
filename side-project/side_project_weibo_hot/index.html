<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.145.0"><meta name=generator content="Relearn 7.6.0+b932d301d7838f3c1a50e318e216b55ce5cc9148"><meta name=description content="side_project_weibo_hot tags: Side Project Browser Automation Selenium :::spoiler [TOC] :::
Side Project Background Inspired by Bilingual Podcast is the best podcast channel in Taiwan that introduces interesting news happening around the world. They said they had a problem that they can not get the hot news from Weibo immediately before Xi made it disappear. For instance, Shuai Peng(彭帥) and Zhang Gaoli(張高麗) event. So, I wrote a side project about an automatic web system that can refresh the web page and download it automatically and keep the data safe. Installation pip install pyautogui pip install selenium Some Set-Up Make sure your web driver is the latest version. You can download it here(https://chromedriver.chromium.org/) Make sure your desktop is the idle one in your home that you’ll not use it for a while. Make sure your desktop language keyboard is for English. Something can solve in the future The content data you download may not be the same as the latest because I just verify the hot news title before downloading.(Solved, I refresh the news_list.txt every day and then the page with the same title will download again.)"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="side_project_weibo_hot :: SBK Hugo Site"><meta name=twitter:description content="side_project_weibo_hot tags: Side Project Browser Automation Selenium :::spoiler [TOC] :::
Side Project Background Inspired by Bilingual Podcast is the best podcast channel in Taiwan that introduces interesting news happening around the world. They said they had a problem that they can not get the hot news from Weibo immediately before Xi made it disappear. For instance, Shuai Peng(彭帥) and Zhang Gaoli(張高麗) event. So, I wrote a side project about an automatic web system that can refresh the web page and download it automatically and keep the data safe. Installation pip install pyautogui pip install selenium Some Set-Up Make sure your web driver is the latest version. You can download it here(https://chromedriver.chromium.org/) Make sure your desktop is the idle one in your home that you’ll not use it for a while. Make sure your desktop language keyboard is for English. Something can solve in the future The content data you download may not be the same as the latest because I just verify the hot news title before downloading.(Solved, I refresh the news_list.txt every day and then the page with the same title will download again.)"><meta property="og:url" content="https://bernie6401.github.io/side-project/side_project_weibo_hot/index.html"><meta property="og:site_name" content="SBK Hugo Site"><meta property="og:title" content="side_project_weibo_hot :: SBK Hugo Site"><meta property="og:description" content="side_project_weibo_hot tags: Side Project Browser Automation Selenium :::spoiler [TOC] :::
Side Project Background Inspired by Bilingual Podcast is the best podcast channel in Taiwan that introduces interesting news happening around the world. They said they had a problem that they can not get the hot news from Weibo immediately before Xi made it disappear. For instance, Shuai Peng(彭帥) and Zhang Gaoli(張高麗) event. So, I wrote a side project about an automatic web system that can refresh the web page and download it automatically and keep the data safe. Installation pip install pyautogui pip install selenium Some Set-Up Make sure your web driver is the latest version. You can download it here(https://chromedriver.chromium.org/) Make sure your desktop is the idle one in your home that you’ll not use it for a while. Make sure your desktop language keyboard is for English. Something can solve in the future The content data you download may not be the same as the latest because I just verify the hot news title before downloading.(Solved, I refresh the news_list.txt every day and then the page with the same title will download again.)"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Side Projects"><meta property="article:tag" content="Side Project"><meta itemprop=name content="side_project_weibo_hot :: SBK Hugo Site"><meta itemprop=description content="side_project_weibo_hot tags: Side Project Browser Automation Selenium :::spoiler [TOC] :::
Side Project Background Inspired by Bilingual Podcast is the best podcast channel in Taiwan that introduces interesting news happening around the world. They said they had a problem that they can not get the hot news from Weibo immediately before Xi made it disappear. For instance, Shuai Peng(彭帥) and Zhang Gaoli(張高麗) event. So, I wrote a side project about an automatic web system that can refresh the web page and download it automatically and keep the data safe. Installation pip install pyautogui pip install selenium Some Set-Up Make sure your web driver is the latest version. You can download it here(https://chromedriver.chromium.org/) Make sure your desktop is the idle one in your home that you’ll not use it for a while. Make sure your desktop language keyboard is for English. Something can solve in the future The content data you download may not be the same as the latest because I just verify the hot news title before downloading.(Solved, I refresh the news_list.txt every day and then the page with the same title will download again.)"><meta itemprop=wordCount content="480"><meta itemprop=keywords content="Side Project"><title>side_project_weibo_hot :: SBK Hugo Site</title>
<link href=/fonts/fontawesome/css/fontawesome-all.min.css?1743619851 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1743619851 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1743619851 rel=stylesheet><link href=/css/theme.min.css?1743619851 rel=stylesheet><link href=/css/format-html.min.css?1743619851 rel=stylesheet id=R-format-style><link href=/css/auto-complete/auto-complete.min.css?1743619851 rel=stylesheet><script src=/js/auto-complete/auto-complete.min.js?1743619851 defer></script><script src=/js/lunr/lunr.min.js?1743619851 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1743619851 defer></script><script src=/js/lunr/lunr.multi.min.js?1743619851 defer></script><script src=/js/lunr/lunr.en.min.js?1743619851 defer></script><script src=/js/search.min.js?1743619851 defer></script><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/side-project/side_project_weibo_hot/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="https://bernie6401.github.io",window.relearn.contentLangs=["en"],window.relearn.index_js_url="/searchindex.en.js?1743619851",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.relearn.themevariants=["auto"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script></head><body class="mobile-support html" data-url=/side-project/side_project_weibo_hot/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><ul><li></li></ul></li><li><a href=#side-project-background>Side Project Background</a></li><li><a href=#installation>Installation</a></li><li><a href=#some-set-up>Some Set-Up</a></li><li><a href=#something-can-solve-in-the-future>Something can solve in the future</a></li><li><a href=#update>Update</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>SBK Hugo Site</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/side-project/index.html><span itemprop=name>Side Projects</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>side_project_weibo_hot</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/side-project/side_project_lightbulb_control/index.html title="side_project_lightbulb_control (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/side-project/special-topic-of-tzu-chi-at-tcivs/index.html title="Special Topic of Tzu-Chi at TCIVS (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable side-project" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline><div class="R-taxonomy taxonomy-tags cstyle tags" title=Tags style=--VARIABLE-TAGS-BG-color:var(--INTERNAL-TAG-BG-color)><ul><li><a class=term-link href=/tags/side-project/index.html>Side Project</a></li></ul></div></header><h1 id=side_project_weibo_hot>side_project_weibo_hot</h1><h1 id=side_project_weibo_hot>side_project_weibo_hot</h1><h6 id=tags-side-project-browser-automation-selenium>tags: <code>Side Project</code> <code>Browser Automation</code> <code>Selenium</code></h6><p>:::spoiler
[TOC]
:::</p><h2 id=side-project-background>Side Project Background</h2><ul><li>Inspired by Bilingual Podcast is the best podcast channel in Taiwan that introduces interesting news happening around the world. They said they had a problem that they can not get the hot news from Weibo immediately before Xi made it disappear. For instance, Shuai Peng(彭帥) and Zhang Gaoli(張高麗) event. So, I wrote a side project about an automatic web system that can refresh the web page and download it automatically and keep the data safe.</li></ul><h2 id=installation>Installation</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install pyautogui
</span></span><span style=display:flex><span>pip install selenium</span></span></code></pre></div><h2 id=some-set-up>Some Set-Up</h2><ol><li>Make sure your web driver is the latest version. You can download it here(<a href=https://chromedriver.chromium.org/ rel=external target=_blank>https://chromedriver.chromium.org/</a>)</li><li>Make sure your desktop is the idle one in your home that you&rsquo;ll not use it for a while.</li><li>Make sure your desktop language keyboard is for English.</li></ol><h2 id=something-can-solve-in-the-future>Something can solve in the future</h2><ul><li><p>The content data you download may not be the same as the latest because I just verify the hot news title before downloading.(Solved, I refresh the news_list.txt every day and then the page with the same title will download again.)</p></li><li><p>Maybe someone can write about the login part that not only needs account and password but the id verification. This is very hard to solve in this system.</p></li><li><p>(Solved)Someone can use a more efficient searching Algorithm instead of linear searching and clean up the news list in the file to speed up the searching time. For instance, clean up all titles saved a week ago and always make the list lighter. I used the method that I mentioned above that cleans up the news_list.txt every day and that&rsquo;ll make the searching time more efficient.</p></li><li><p>(Solved)When you refresh the page many times, the server will reject the request from your desktop. So I add a file named run.py to solve this problem that used subprocess function independently in a while loop. That can lead the web to close completely and reboot again and again.</p></li><li><p>The web driver will shut down when the times up. But that will make the downloading file be aborted. So, maybe someone can add a function to detect whether the download process succeed or not.</p></li><li><p>To be continued&mldr;</p></li></ul><h2 id=update>Update</h2><ul><li>Time: 2022-11-29<ul><li><p>In addition to update chrome driver, I also tried to run the whole program but not work because of the <strong>wrong redirection</strong> of weibo webpage.
The page I expected is shown as below.<a href=#R-image-28ef8ebdaf250be2a0512ae1441dcff9 class=lightbox-link><img alt="weibo page I expect" class="lazy lightbox figure-image" loading=lazy src=https://imgur.com/G6p2qEu.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-28ef8ebdaf250be2a0512ae1441dcff9><img alt="weibo page I expect" class="lazy lightbox lightbox-image" loading=lazy src=https://imgur.com/G6p2qEu.png></a>
But actually, drive got the page as below →
<a href=#R-image-b227351fede223bb257e85bb441c7fe2 class=lightbox-link><img alt="actual page it shown" class="lazy lightbox figure-image" loading=lazy src=https://imgur.com/phlJ6Ov.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b227351fede223bb257e85bb441c7fe2><img alt="actual page it shown" class="lazy lightbox lightbox-image" loading=lazy src=https://imgur.com/phlJ6Ov.png></a>
In order to execute my program with slightly revise, I add these line to login. Refer to <a href=https://blog.51cto.com/u_9177933/2985943 rel=external target=_blank>使用Selenium实现微博爬虫：预登录、展开全文、翻页</a></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class="language-python=59" data-lang="python=59">wait = WebDriverWait(driver,5)
time.sleep(60)</code></pre></div><p>:writing_hand:<strong>Notes</strong> This program became a semi-automatic features.</p></li><li><p>Becasue chrome driver halt with the message <code>Chrome is being controlled by automated test software</code>, I refer to (自動化初步-使用pyautogui)[https://ithelp.ithome.com.tw/articles/10267172] and set the code below to solve this problem.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>options <span style=color:#f92672>=</span> webdriver<span style=color:#f92672>.</span>ChromeOptions()
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span>add_experimental_option(<span style=color:#e6db74>&#34;excludeSwitches&#34;</span>, [<span style=color:#e6db74>&#34;enable-automation&#34;</span>])
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span>add_experimental_option(<span style=color:#e6db74>&#39;useAutomationExtension&#39;</span>, <span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span>add_experimental_option(<span style=color:#e6db74>&#34;prefs&#34;</span>, {<span style=color:#e6db74>&#34;profile.password_manager_enabled&#34;</span>: <span style=color:#66d9ef>False</span>, <span style=color:#e6db74>&#34;credentials_enable_service&#34;</span>: <span style=color:#66d9ef>False</span>})</span></span></code></pre></div></li></ul></li></ul><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=/index.html><div class=logo-title>SBK Hugo Site</div></a></div><search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-id=/index.html><a class=padding href=/index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/books-notes/index.html><a class=padding href=/books-notes/index.html>Books Notes</a><ul id=R-subsections-0771445a148f63eb6cc1a9b7ad45a36a class=collapsible-menu></ul></li><li data-nav-id=/data-structure/index.html><a class=padding href=/data-structure/index.html>Data Structures</a><ul id=R-subsections-58892abc7cea06bf1839098c82b3eb4d class=collapsible-menu></ul></li><li data-nav-id=/job/index.html><a class=padding href=/job/index.html>Jobs</a><ul id=R-subsections-0fce2c1f4d6d23f49b605855a82f55aa class=collapsible-menu></ul></li><li data-nav-id=/knowledge/index.html><a class=padding href=/knowledge/index.html>Knowledges</a><ul id=R-subsections-0bdb754d722e03f187f2117c1ef8015d class=collapsible-menu></ul></li><li data-nav-id=/leetcode/index.html><a class=padding href=/leetcode/index.html>LeetCodes</a><ul id=R-subsections-76e85062179d09303530c47eb73fc667 class=collapsible-menu></ul></li><li data-nav-id=/problem-solutions/index.html><a class=padding href=/problem-solutions/index.html>Problem Solutions</a><ul id=R-subsections-4f9e0f3095337026c1723515d5409f89 class=collapsible-menu></ul></li><li data-nav-id=/security/index.html><a class=padding href=/security/index.html>Securities</a><ul id=R-subsections-66815ecaaecfc1c209e5637d03b258b2 class=collapsible-menu></ul></li><li class=parent data-nav-id=/side-project/index.html><a class=padding href=/side-project/index.html>Side Projects</a><ul id=R-subsections-3295de6e89859c4cf23a4292e734c881 class=collapsible-menu><li data-nav-id=/side-project/a-hybrid-facial-expression-recognition-system-based-on-facial-features-and-pose-estimation/index.html><a class=padding href=/side-project/a-hybrid-facial-expression-recognition-system-based-on-facial-features-and-pose-estimation/index.html>A Hybrid Facial Expression Recognition System Based on Facial Features and Pose Estimation</a></li><li data-nav-id=/side-project/side_project_lightbulb_control/index.html><a class=padding href=/side-project/side_project_lightbulb_control/index.html>side_project_lightbulb_control</a></li><li class=active data-nav-id=/side-project/side_project_weibo_hot/index.html><a class=padding href=/side-project/side_project_weibo_hot/index.html>side_project_weibo_hot</a></li><li data-nav-id=/side-project/special-topic-of-tzu-chi-at-tcivs/index.html><a class=padding href=/side-project/special-topic-of-tzu-chi-at-tcivs/index.html>Special Topic of Tzu-Chi at TCIVS</a></li></ul></li><li data-nav-id=/survey-papers/index.html><a class=padding href=/survey-papers/index.html>Survey Papers</a><ul id=R-subsections-baa5a308e222e800d6e93248dad73a11 class=collapsible-menu></ul></li><li data-nav-id=/terminology/index.html><a class=padding href=/terminology/index.html>Terminologies</a><ul id=R-subsections-a19bf87a9a9aaf0a4146b803a35492f8 class=collapsible-menu></ul></li><li data-nav-id=/toc/index.html><a class=padding href=/toc/index.html>TOCs</a><ul id=R-subsections-451d3779340ac1afa8683c0232808cbf class=collapsible-menu></ul></li><li data-nav-id=/tools/index.html><a class=padding href=/tools/index.html>Tools</a><ul id=R-subsections-bf1399820dde3dd110e03ace4147ff86 class=collapsible-menu></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul></ul></div><div id=R-footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=/js/clipboard/clipboard.min.js?1743619851 defer></script><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1743619851 defer></script><script src=/js/theme.min.js?1743619851 defer></script></body></html>